<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Leetcodeæ€»ç»“â€”äºŒå‰æ ‘çš„æ„é€ </title>
      <link href="/2020/12/13/er-cha-shu-de-gou-zao/"/>
      <url>/2020/12/13/er-cha-shu-de-gou-zao/</url>
      
        <content type="html"><![CDATA[<p>äºŒå‰æ ‘æ˜¯é¢è¯•ä¸­å¸¸è§çš„é¢˜ç›®ç±»å‹ï¼Œè¿™é‡Œï¼Œé’ˆå¯¹leetcodeå‰200é“é¢˜ä¸­çš„äºŒå‰æ ‘ç›¸å…³é—®é¢˜è¿›è¡Œæ€»ç»“ä¸æ€è€ƒï¼ŒåŠ›æ±‚çƒ‚ç†Ÿäºå¿ƒï¼Œèƒ½æ ¹æ®é¢˜ç›®åå›å¿†èµ·é¢˜ç›®çš„å…·ä½“æè¿°ï¼Œè¿›è€Œç”¨ç®€æ´çš„è¯­è¨€æè¿°å‡ºç®—æ³•çš„æ ¸å¿ƒã€‚å…·ä½“çš„é¢˜ç›®ç­”æ¡ˆå¯æ‰“å¼€leetcodeæŸ¥çœ‹å†å²æäº¤è®°å½•ã€‚</p><p><a href="https://www.yuque.com/ugdongzhou/sivpgk/b97740505d86178e7fe86be2088b42c2/edit" target="_blank" rel="noopener">äºŒå‰æ ‘çš„éå†</a>æ˜¯ä¸Šä¸€ç¯‡çš„å†…å®¹ï¼Œå¯å…ˆå›é¡¾ï¼›æœ¬ç¯‡ä¸»è¦æ•´ç†äºŒå‰æ ‘çš„æ„é€ ç›¸å…³é¢˜ç›®å’Œæ€è·¯ã€‚</p><h2 id="äºŒå‰æ ‘çš„æ„é€ ï¼ˆbinary-tree-traversalï¼‰"><a href="#äºŒå‰æ ‘çš„æ„é€ ï¼ˆbinary-tree-traversalï¼‰" class="headerlink" title="äºŒå‰æ ‘çš„æ„é€ ï¼ˆbinary-tree-traversalï¼‰"></a>äºŒå‰æ ‘çš„æ„é€ ï¼ˆbinary-tree-traversalï¼‰</h2><blockquote><p>ç»™å®šäºŒå‰æ ‘ç‰¹å®šéå†ä¸‹çš„ç»“æœï¼Œæ„é€ å‡ºåŸæœ¬çš„äºŒå‰æ ‘ã€‚</p></blockquote><p>è§£é¢˜å…³é”®åœ¨äºå®šä½å‡ºæ ¹èŠ‚ç‚¹ï¼Œåˆ’åˆ†å‡ºå·¦å³å­æ ‘ï¼Œç„¶å é€’å½’ æ„å»ºå·¦å³å­æ ‘</p><h2 id="1-ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘"><a href="#1-ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘" class="headerlink" title="1.ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘"></a><a href="https://leetcode-cn.com/problems/construct-binary-tree-from-preorder-and-inorder-traversal/" target="_blank" rel="noopener">1.ä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘</a></h2><p>è¯¥é¢˜æ˜¯leetcode105é¢˜ï¼Œmediuméš¾åº¦ï¼Œä¸€å¥è¯é¢˜å¹²æè¿°ï¼šä»å‰åºä¸ä¸­åºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ1(å¤æ‚åº¦é«˜)ï¼š</strong> å…ˆåºéå†çš„é¡ºåºæ˜¯æ ¹èŠ‚ç‚¹ï¼Œå·¦å­æ ‘ï¼Œå³å­æ ‘ã€‚ä¸­åºéå†çš„é¡ºåºæ˜¯å·¦å­æ ‘ï¼Œæ ¹èŠ‚ç‚¹ï¼Œå³å­æ ‘ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ ¹æ®å…ˆåºéå†å¾—åˆ°æ ¹èŠ‚ç‚¹ï¼Œç„¶ååœ¨ä¸­åºéå†ä¸­æ‰¾åˆ°æ ¹èŠ‚ç‚¹çš„ä½ç½®ï¼Œå®ƒçš„å·¦è¾¹å°±æ˜¯å·¦å­æ ‘çš„èŠ‚ç‚¹ï¼Œå³è¾¹å°±æ˜¯å³å­æ ‘çš„èŠ‚ç‚¹ã€‚ç”Ÿæˆå·¦å­æ ‘å’Œå³å­æ ‘å°±å¯ä»¥é€’å½’çš„è¿›è¡Œäº†ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201214104215.png" alt="image.png"></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> TreeNode <span class="token function">buildTree</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> preorder<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inorder<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//é€’å½’ç»ˆæ­¢æ¡ä»¶</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>preorder<span class="token punctuation">.</span>length<span class="token operator">==</span><span class="token number">0</span><span class="token operator">||</span>inorder<span class="token punctuation">.</span>length<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>preorder<span class="token punctuation">.</span>length<span class="token operator">!=</span>inorder<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"è¾“å…¥é”™è¯¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    TreeNode root<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span>preorder<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>preorder<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>preorder<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span>inorder<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pre_left<span class="token operator">=</span>Arrays<span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>preorder<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pre_right<span class="token operator">=</span>Arrays<span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>preorder<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>preorder<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> in_left<span class="token operator">=</span>Arrays<span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>inorder<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> in_right<span class="token operator">=</span>Arrays<span class="token punctuation">.</span><span class="token function">copyOfRange</span><span class="token punctuation">(</span>inorder<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>inorder<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>            root<span class="token punctuation">.</span>left<span class="token operator">=</span><span class="token function">buildTree</span><span class="token punctuation">(</span>pre_left<span class="token punctuation">,</span>in_left<span class="token punctuation">)</span><span class="token punctuation">;</span>            root<span class="token punctuation">.</span>right<span class="token operator">=</span><span class="token function">buildTree</span><span class="token punctuation">(</span>pre_right<span class="token punctuation">,</span>in_right<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> root<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201214104223.gif" alt="image"></p><p>äºŒå‰æ ‘ç›¸å…³çš„å¾ˆå¤šé—®é¢˜çš„è§£å†³æ€è·¯éƒ½æœ‰åˆ†æ²»æ³•çš„æ€æƒ³åœ¨é‡Œé¢ã€‚æˆ‘ä»¬å¤ä¹ ä¸€ä¸‹åˆ†æ²»æ³•çš„æ€æƒ³ï¼šæŠŠåŸé—®é¢˜æ‹†è§£æˆè‹¥å¹²ä¸ªä¸åŸé—®é¢˜ç»“æ„ç›¸åŒä½†è§„æ¨¡æ›´å°çš„å­é—®é¢˜ï¼Œå¾…å­é—®é¢˜è§£å†³ä»¥åï¼ŒåŸé—®é¢˜å°±å¾—ä»¥è§£å†³ï¼Œâ€œå½’å¹¶æ’åºâ€å’Œâ€œå¿«é€Ÿæ’åºâ€éƒ½æ˜¯åˆ†æ²»æ³•æ€æƒ³çš„åº”ç”¨ï¼Œå…¶ä¸­â€œå½’å¹¶æ’åºâ€å…ˆæ— è„‘åœ°â€œåˆ†â€ï¼Œåœ¨â€œåˆâ€çš„æ—¶å€™å°±éº»çƒ¦ä¸€äº›ï¼›â€œå¿«é€Ÿæ’åºâ€å¼€å§‹åœ¨ partition ä¸ŠèŠ±äº†å¾ˆå¤šæ—¶é—´ï¼Œå³åœ¨â€œåˆ†â€ä¸Šä½¿äº†å¾ˆå¤šåŠ²ï¼Œç„¶åå°±é€’å½’å¤„ç†ä¸‹å»å°±å¥½äº†ï¼Œæ²¡æœ‰åœ¨â€œåˆâ€ä¸Šå†èŠ±æ—¶é—´ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ2(ä¼˜åŒ–ç‰ˆ)ï¼š</strong> ä»¥ä¸Šçš„è§£æ³•ï¼Œå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š</p><p>1.åœ¨ä¸­åºéå†ä¸­æ‰¾åˆ°æ ¹èŠ‚ç‚¹çš„ä½ç½®æ¯æ¬¡éƒ½å¾—éå†ä¸­åºéå†çš„æ•°ç»„å»å¯»æ‰¾ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªHashMapæŠŠä¸­åºéå†æ•°ç»„çš„æ¯ä¸ªå…ƒç´ çš„å€¼å’Œä¸‹æ ‡å­˜èµ·æ¥ï¼Œè¿™æ ·å¯»æ‰¾æ ¹èŠ‚ç‚¹çš„ä½ç½®å°±å¯ä»¥ç›´æ¥å¾—åˆ°ï¼›</p><p>2.æ¯æ¬¡é€’å½’éƒ½åˆ†å‰²æ•°ç»„ï¼Œå ç”¨ç©ºé—´å¤§ï¼Œå…¶æ¬¡åªè¦ä¼ æ•°ç»„ç´¢å¼•ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201214104245.png" alt="image.png"></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> preorder<span class="token punctuation">;</span>    <span class="token keyword">private</span> Map<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span>Integer<span class="token operator">></span> hash<span class="token punctuation">;</span>    <span class="token keyword">public</span> TreeNode <span class="token function">buildTree</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> preorder<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inorder<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> prelength<span class="token operator">=</span>preorder<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">int</span> inlength<span class="token operator">=</span>inorder<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>prelength<span class="token operator">!=</span>inlength<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"è¾“å…¥é”™è¯¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>preorder<span class="token operator">=</span>preorder<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>hash<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>inlength<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            hash<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>inorder<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token function">buildTree</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>prelength<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>inlength<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>     <span class="token keyword">private</span> TreeNode <span class="token function">buildTree</span><span class="token punctuation">(</span><span class="token keyword">int</span> preleft<span class="token punctuation">,</span><span class="token keyword">int</span> preright<span class="token punctuation">,</span> <span class="token keyword">int</span> inleft<span class="token punctuation">,</span><span class="token keyword">int</span> inright<span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token comment" spellcheck="true">// å› ä¸ºæ˜¯é€’å½’è°ƒç”¨çš„æ–¹æ³•ï¼ŒæŒ‰ç…§å›½é™…æƒ¯ä¾‹ï¼Œå…ˆå†™é€’å½’ç»ˆæ­¢æ¡ä»¶</span>         <span class="token keyword">if</span><span class="token punctuation">(</span>preleft<span class="token operator">></span>preright <span class="token operator">||</span> inleft<span class="token operator">></span>inright<span class="token punctuation">)</span><span class="token punctuation">{</span>             <span class="token keyword">return</span> null<span class="token punctuation">;</span>         <span class="token punctuation">}</span>         TreeNode root<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span>preorder<span class="token punctuation">[</span>preleft<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">int</span> inindex<span class="token operator">=</span>hash<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>preorder<span class="token punctuation">[</span>preleft<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         root<span class="token punctuation">.</span>left<span class="token operator">=</span><span class="token function">buildTree</span><span class="token punctuation">(</span>preleft<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>inindex<span class="token operator">-</span>inleft<span class="token operator">+</span>preleft<span class="token punctuation">,</span>inleft<span class="token punctuation">,</span>inindex<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         root<span class="token punctuation">.</span>right<span class="token operator">=</span><span class="token function">buildTree</span><span class="token punctuation">(</span>inindex<span class="token operator">-</span>inleft<span class="token operator">+</span>preleft<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>preright<span class="token punctuation">,</span>inindex<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>inright<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">return</span> root<span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘"><a href="#2-ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘" class="headerlink" title="2.ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘"></a><a href="https://leetcode-cn.com/problems/construct-binary-tree-from-inorder-and-postorder-traversal/" target="_blank" rel="noopener">2.ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘</a></h2><p>è¯¥é¢˜æ˜¯ leetcode106 é¢˜ï¼Œmedium éš¾åº¦ï¼Œä¸€å¥è¯é¢˜å¹²æè¿°ï¼šä»ä¸­åºå’Œååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> å’Œä¸Šä¸€é¢˜ç±»ä¼¼ï¼Œä¸­åºéå†çš„é¡ºåºæ˜¯å·¦å­æ ‘ï¼Œæ ¹èŠ‚ç‚¹ï¼Œå³å­æ ‘ï¼Œååºéå†çš„é¡ºåºæ˜¯å·¦å­æ ‘ï¼Œå³å­æ ‘ï¼Œæ ¹èŠ‚ç‚¹ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ ¹æ®ååºéå†å¾—åˆ°æ ¹èŠ‚ç‚¹ï¼Œç„¶ååœ¨ä¸­åºéå†ä¸­æ‰¾åˆ°æ ¹èŠ‚ç‚¹çš„ä½ç½®ï¼Œå®ƒçš„å·¦è¾¹å°±æ˜¯å·¦å­æ ‘çš„èŠ‚ç‚¹ï¼Œå³è¾¹å°±æ˜¯å³å­æ ‘çš„èŠ‚ç‚¹ã€‚ç”Ÿæˆå·¦å­æ ‘å’Œå³å­æ ‘å°±å¯ä»¥é€’å½’çš„è¿›è¡Œäº†ã€‚ä¸‹é¢æ˜¯æ›´è¯¦ç»†çš„å›¾è§£ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201214104301.png" alt="image"></p><p>ç›´æ¥å¥—ç”¨ä¸Šä¸€é¢˜çš„è§£å†³æ–¹æ¡ˆ2,ä½¿ç”¨å“ˆå¸Œè¡¨å’Œä¼ æ•°ç»„ç´¢å¼•çš„æ–¹æ³•é™ä½å¤æ‚åº¦ã€‚</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> postorder<span class="token punctuation">;</span>    <span class="token keyword">private</span> Map<span class="token operator">&lt;</span>Integer<span class="token punctuation">,</span>Integer<span class="token operator">></span> hash<span class="token punctuation">;</span>    <span class="token keyword">public</span> TreeNode <span class="token function">buildTree</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> inorder<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> postorder<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> inLen<span class="token operator">=</span>inorder<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">int</span> postLen<span class="token operator">=</span>postorder<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>inLen<span class="token operator">!=</span>postLen<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">"è¾“å…¥é”™è¯¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>hash<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>postorder<span class="token operator">=</span>postorder<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>inLen<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            hash<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>inorder<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token function">buildTree</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>inLen<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>postLen<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> TreeNode <span class="token function">buildTree</span><span class="token punctuation">(</span><span class="token keyword">int</span> inLeft<span class="token punctuation">,</span><span class="token keyword">int</span> inRight<span class="token punctuation">,</span><span class="token keyword">int</span> postLeft<span class="token punctuation">,</span><span class="token keyword">int</span> postRight<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//é€’å½’ç»ˆæ­¢æ¡ä»¶</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>inLeft<span class="token operator">></span>inRight <span class="token operator">||</span> postLeft<span class="token operator">></span>postRight<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> null<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        TreeNode root<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span>postorder<span class="token punctuation">[</span>postRight<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> inindex<span class="token operator">=</span>hash<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>postorder<span class="token punctuation">[</span>postRight<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        root<span class="token punctuation">.</span>left<span class="token operator">=</span><span class="token function">buildTree</span><span class="token punctuation">(</span>inLeft<span class="token punctuation">,</span>inindex<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>postLeft<span class="token punctuation">,</span>inindex<span class="token operator">-</span>inLeft<span class="token operator">+</span>postLeft<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        root<span class="token punctuation">.</span>right<span class="token operator">=</span><span class="token function">buildTree</span><span class="token punctuation">(</span>inindex<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>inRight<span class="token punctuation">,</span>inindex<span class="token operator">-</span>inLeft<span class="token operator">+</span>postLeft<span class="token punctuation">,</span>postRight<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> root<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-å°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘"><a href="#3-å°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘" class="headerlink" title="3.å°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘"></a><a href="https://leetcode-cn.com/problems/convert-sorted-array-to-binary-search-tree/" target="_blank" rel="noopener">3.å°†æœ‰åºæ•°ç»„è½¬æ¢ä¸ºäºŒå‰æœç´¢æ ‘</a></h2><p>è¯¥é¢˜æ˜¯ leetcode108 é¢˜ï¼Œeasyéš¾åº¦ï¼Œä¸€å¥è¯é¢˜å¹²æè¿°ï¼šæ ¹æ®å‡åºæ•°ç»„ï¼Œæ¢å¤ä¸€æ£µé«˜åº¦å¹³è¡¡çš„BSTğŸŒ²ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>BSTçš„ä¸­åºéå†æ˜¯å‡åºçš„ï¼Œå› æ­¤æœ¬é¢˜ç­‰åŒäº<strong>æ ¹æ®ä¸­åºéå†çš„åºåˆ—æ¢å¤äºŒå‰æœç´¢æ ‘</strong>ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ä»¥å‡åºåºåˆ—ä¸­çš„ä»»ä¸€ä¸ªå…ƒç´ ä½œä¸ºæ ¹èŠ‚ç‚¹ï¼Œä»¥è¯¥å…ƒç´ å·¦è¾¹çš„å‡åºåºåˆ—æ„å»ºå·¦å­æ ‘ï¼Œä»¥è¯¥å…ƒç´ å³è¾¹çš„å‡åºåºåˆ—æ„å»ºå³å­æ ‘ï¼Œè¿™æ ·å¾—åˆ°çš„æ ‘å°±æ˜¯ä¸€æ£µäºŒå‰æœç´¢æ ‘å•¦ï½ åˆå› ä¸ºæœ¬é¢˜è¦æ±‚é«˜åº¦å¹³è¡¡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é€‰æ‹©å‡åºåºåˆ—çš„ä¸­é—´å…ƒç´ ä½œä¸ºæ ¹èŠ‚ç‚¹ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201214104317.png" alt="å¾®ä¿¡å›¾ç‰‡_20201209103046.png"></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> TreeNode <span class="token function">sortedArrayToBST</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">dfs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>nums<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> TreeNode <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> nums<span class="token punctuation">,</span><span class="token keyword">int</span> left<span class="token punctuation">,</span><span class="token keyword">int</span> right<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>left<span class="token operator">></span>right<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> null<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span> mid<span class="token operator">=</span>left<span class="token operator">+</span><span class="token punctuation">(</span>right<span class="token operator">-</span>left<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>        TreeNode root<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>mid<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        root<span class="token punctuation">.</span>left<span class="token operator">=</span><span class="token function">dfs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>left<span class="token punctuation">,</span>mid<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        root<span class="token punctuation">.</span>right<span class="token operator">=</span><span class="token function">dfs</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span>mid<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> root<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-æœ‰åºé“¾è¡¨è½¬æ¢äºŒå‰æœç´¢æ ‘"><a href="#4-æœ‰åºé“¾è¡¨è½¬æ¢äºŒå‰æœç´¢æ ‘" class="headerlink" title="4.æœ‰åºé“¾è¡¨è½¬æ¢äºŒå‰æœç´¢æ ‘"></a><a href="https://leetcode-cn.com/problems/convert-sorted-list-to-binary-search-tree/" target="_blank" rel="noopener">4.æœ‰åºé“¾è¡¨è½¬æ¢äºŒå‰æœç´¢æ ‘</a></h2><p>è¯¥é¢˜æ˜¯ leetcode109 é¢˜ï¼Œmedium éš¾åº¦ï¼Œä¸€å¥è¯é¢˜å¹²æè¿°ï¼šæ ¹æ®å‡åºæ•°ç»„ï¼Œæ¢å¤ä¸€æ£µé«˜åº¦å¹³è¡¡çš„BSTğŸŒ²ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>ä¸ä¸Šä¸€é¢˜ leetcode108 é¢˜ç±»ä¼¼ï¼Œå”¯ä¸€çš„ä¸åŒåœ¨ä¸æ•°æ®ç»“æ„ï¼Œä¸Šä¸€é¢˜æ˜¯æ•°ç»„ï¼Œè¿™ä¸€é¢˜æ˜¯é“¾è¡¨ï¼Œé“¾è¡¨æ‰¾ä¸­é—´æ ¹èŠ‚ç‚¹å¯ä»¥ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆæ³•ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201214104334.png" alt="image"></p><p>ä¸‹é¢çš„ä»£ç ä¸ä¸Šå›¾ä¸åŒçš„åœ°æ–¹æ˜¯ æ„å»ºå·¦BSTæ—¶æ²¡æœ‰æ–­å¼€é“¾è¡¨ï¼Œé‚£å¤„ç†çš„æ—¶å€™å°±æ˜¯è¦æ”¹ä¸€ä¸‹å¯»æ‰¾ä¸­é—´èŠ‚ç‚¹çš„ä»£ç ã€‚<code>while (fast != null &amp;&amp; fast.next != null) ---ã€‹   while(fast!=tail &amp;&amp; fast.next!=tail)</code></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> TreeNode <span class="token function">sortedListToBST</span><span class="token punctuation">(</span>ListNode head<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>head<span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> null<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        ListNode tail<span class="token operator">=</span>head<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>tail<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>            tail<span class="token operator">=</span>tail<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token function">dfs</span><span class="token punctuation">(</span>head<span class="token punctuation">,</span>tail<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> TreeNode <span class="token function">dfs</span><span class="token punctuation">(</span>ListNode head<span class="token punctuation">,</span>ListNode tail<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>head<span class="token operator">==</span>tail<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> null<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        ListNode node<span class="token operator">=</span><span class="token function">findMid</span><span class="token punctuation">(</span>head<span class="token punctuation">,</span>tail<span class="token punctuation">)</span><span class="token punctuation">;</span>        TreeNode root<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">TreeNode</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>        root<span class="token punctuation">.</span>left<span class="token operator">=</span><span class="token function">dfs</span><span class="token punctuation">(</span>head<span class="token punctuation">,</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>        root<span class="token punctuation">.</span>right<span class="token operator">=</span><span class="token function">dfs</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>next<span class="token punctuation">,</span>tail<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> root<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> ListNode <span class="token function">findMid</span><span class="token punctuation">(</span>ListNode head<span class="token punctuation">,</span>ListNode tail<span class="token punctuation">)</span> <span class="token punctuation">{</span>        ListNode slow<span class="token operator">=</span>head<span class="token punctuation">;</span>        ListNode fast<span class="token operator">=</span>head<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>fast<span class="token operator">!=</span>tail <span class="token operator">&amp;&amp;</span> fast<span class="token punctuation">.</span>next<span class="token operator">!=</span>tail<span class="token punctuation">)</span><span class="token punctuation">{</span>            slow<span class="token operator">=</span>slow<span class="token punctuation">.</span>next<span class="token punctuation">;</span>            fast<span class="token operator">=</span>fast<span class="token punctuation">.</span>next<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> slow<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-å¹³è¡¡äºŒå‰æ ‘"><a href="#5-å¹³è¡¡äºŒå‰æ ‘" class="headerlink" title="5. å¹³è¡¡äºŒå‰æ ‘"></a><a href="https://leetcode-cn.com/problems/balanced-binary-tree/" target="_blank" rel="noopener">5. å¹³è¡¡äºŒå‰æ ‘</a></h2><p>è¯¥é¢˜æ˜¯ leetcode110 é¢˜ï¼Œeasyéš¾åº¦ï¼Œä¸€å¥è¯é¢˜å¹²æè¿°ï¼šç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œåˆ¤æ–­å®ƒæ˜¯å¦æ˜¯é«˜åº¦å¹³è¡¡çš„äºŒå‰æ ‘ã€‚</p><p>å‰ä¸¤é¢˜è¦æ±‚æ„å»ºçš„æ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼Œæˆ‘ä»¬çš„å¤„ç†åŠæ³•æ˜¯ä»ä¸­é—´èŠ‚ç‚¹å¼€å§‹å·¦å³åˆ†åˆ«æ„å»ºï¼Œè¿™æ ·çš„äºŒå‰æ ‘æ¯ä¸ªèŠ‚ç‚¹ çš„å·¦å³ä¸¤ä¸ªå­æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼ä¸è¶…è¿‡ 1 ï¼Œä¹Ÿç§°ä½œå¹³è¡¡äºŒå‰æ ‘ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ(æš´åŠ›æ³•è‡ªé¡¶å‘ä¸‹)ï¼š</strong>æ„é€ ä¸€ä¸ªè·å–å½“å‰èŠ‚ç‚¹æœ€å¤§æ·±åº¦çš„æ–¹æ³•<code>depth(root)</code> ï¼Œé€šè¿‡æ¯”è¾ƒæ­¤å­æ ‘çš„å·¦å³å­æ ‘çš„æœ€å¤§é«˜åº¦å·®<code>abs(depth(root.left) - depth(root.right))</code>ï¼Œæ¥åˆ¤æ–­æ­¤å­æ ‘æ˜¯å¦æ˜¯äºŒå‰å¹³è¡¡æ ‘ã€‚è‹¥æ ‘çš„æ‰€æœ‰å­æ ‘éƒ½å¹³è¡¡æ—¶ï¼Œæ­¤æ ‘æ‰å¹³è¡¡ã€‚</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isBalanced</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">==</span>null<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token function">depth</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token operator">-</span><span class="token function">depth</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isBalanced</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isBalanced</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">depth</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">==</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token function">depth</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">depth</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//ä¸Šé¢çš„æ–¹æ³•è¦ä¸æ–­é€’å½’å·¦å³å­æ ‘, æœ‰é‡å¤éƒ¨åˆ†,æ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸ºO(n2)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è§£å†³æ–¹æ¡ˆ(ä¼˜åŒ–æ³•è‡ªåº•å‘ä¸Š)ï¼š</strong>ååºéå†ï¼Œå·¦å³ä¸­ï¼Œä»åº•è‡³é¡¶è¿”å›å­æ ‘æœ€å¤§é«˜åº¦ï¼Œè‹¥åˆ¤å®šæŸå­æ ‘ä¸æ˜¯å¹³è¡¡æ ‘åˆ™ â€œå‰ªæâ€ ï¼Œç›´æ¥å‘ä¸Šè¿”å›ã€‚</p><p><strong>NOTE:</strong>å‚æ•°çš„è¯ä¸ºä¼ å…¥çš„èŠ‚ç‚¹æŒ‡é’ˆï¼Œå°±æ²¡æœ‰å…¶ä»–å‚æ•°éœ€è¦ä¼ é€’äº†ï¼Œè¿”å›å€¼è¦è¿”å›ä¼ å…¥èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹æ ‘çš„æ·±åº¦ã€‚</p><p><strong>é‚£ä¹ˆå¦‚ä½•æ ‡è®°å·¦å³å­æ ‘æ˜¯å¦å·®å€¼å¤§äº1å‘¢ã€‚</strong></p><p>å¦‚æœå½“å‰ä¼ å…¥èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„äºŒå‰æ ‘å·²ç»ä¸æ˜¯äºŒå‰å¹³è¡¡æ ‘äº†ï¼Œè¿˜è¿”å›é«˜åº¦çš„è¯å°±æ²¡æœ‰æ„ä¹‰äº†ã€‚æ‰€ä»¥å¦‚æœå·²ç»ä¸æ˜¯äºŒå‰å¹³è¡¡æ ‘äº†ï¼Œå¯ä»¥è¿”å›-1 æ¥æ ‡è®°å·²ç»ä¸ç¬¦åˆå¹³è¡¡æ ‘çš„è§„åˆ™äº†ã€‚</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isBalanced</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// è¿”å›ä»¥è¯¥èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹çš„äºŒå‰æ ‘çš„é«˜åº¦ï¼Œå¦‚æœä¸æ˜¯äºŒå‰æœç´¢æ ‘äº†åˆ™è¿”å›-1</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> <span class="token function">dfs</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">==</span>null<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> left<span class="token operator">=</span><span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¯´æ˜å·¦å­æ ‘å·²ç»ä¸æ˜¯äºŒå‰å¹³è¡¡æ ‘</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>left<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> right<span class="token operator">=</span><span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¯´æ˜å³å­æ ‘å·²ç»ä¸æ˜¯äºŒå‰å¹³è¡¡æ ‘</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>right<span class="token operator">==</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>left<span class="token operator">-</span>right<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">2</span><span class="token operator">?</span>Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span>right<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‚è€ƒèµ„æ–™ï¼šleetcodeé¢˜è§£ï¼Œæ„Ÿè°¢è¿™äº›å¤§ä½¬çš„é…å›¾ä»¥åŠæ˜“æ‡‚çš„è¯­è¨€ï¼ï¼</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> åˆ·é¢˜ </tag>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iCAN (BMVC2018)</title>
      <link href="/2020/12/10/lun-wen-ican-bmvc2018/"/>
      <url>/2020/12/10/lun-wen-ican-bmvc2018/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–‡çŒ®-iCAN-Instance-Centric-Attention-Network-for-Human-Object-Interaction-Detection"><a href="#æ–‡çŒ®-iCAN-Instance-Centric-Attention-Network-for-Human-Object-Interaction-Detection" class="headerlink" title="æ–‡çŒ®-iCAN: Instance-Centric Attention Network for Human-Object Interaction Detection"></a>æ–‡çŒ®-iCAN: Instance-Centric Attention Network for Human-Object Interaction Detection</h1><ul><li>æ¦‚è¿°ï¼šäººæˆ–ç‰©ä½“å®ä¾‹çš„å¤–è§‚åŒ…å«ä¸Šä¸‹æ–‡çº¿ç´¢ï¼Œåˆ©ç”¨è¿™äº›ä¿¡æ¯å¯ä»¥æ³¨æ„åˆ°å›¾åƒä¸­å¯ä»¥ä¿ƒè¿›äº¤äº’é¢„æµ‹çš„éƒ¨åˆ†ã€‚ä¸ºäº†åˆ©ç”¨è¿™äº›çº¿ç´¢ï¼Œç ”ç©¶è€…æå‡ºäº†ä¸€ä¸ªä»¥å®ä¾‹ä¸ºä¸­å¿ƒçš„æ³¨æ„åŠ›æ¨¡å—ï¼Œå­¦ä¹ æ ¹æ®æ¯ä¸ªå®ä¾‹çš„å¤–è§‚åŠ¨æ€çªå‡ºæ˜¾ç¤ºå›¾åƒä¸­çš„åŒºåŸŸã€‚è¿™ç§åŸºäºæ³¨æ„åŠ›çš„ç½‘ç»œå…è®¸ç ”ç©¶è€…é€‰æ‹©æ€§åœ°èšåˆä¸è¯†åˆ« HOIç›¸å…³çš„ç‰¹å¾ã€‚åœ¨InteractNetä¸Šåšçš„æ”¹è¿›,è¾¾åˆ°äº† V-COCO 45.3%ã€‚</li><li>å…³é”®è¯ï¼šæ³¨æ„åŠ›æœºåˆ¶</li><li>è®ºæ–‡åœ°å€ï¼š<a href="https://www.yuque.com/ugdongzhou/io8kmc/1661063" target="_blank" rel="noopener">https://www.yuque.com/ugdongzhou/io8kmc/1661063</a></li><li>æºç :  <a href="https://github.com/vt-vl-lab/iCAN" target="_blank" rel="noopener">https://github.com/vt-vl-lab/iCAN</a>  å’ŒDRG2020åŒå±<a href="https://github.com/vt-vl-lab" target="_blank" rel="noopener">vt-vl-lab</a>å®éªŒå®¤</li></ul><h2 id="ç½‘ç»œç»“æ„"><a href="#ç½‘ç»œç»“æ„" class="headerlink" title="ç½‘ç»œç»“æ„"></a>ç½‘ç»œç»“æ„</h2><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134848.png" alt="image-20201209144401235"></p><h2 id="ä¸»è¦è´¡çŒ®"><a href="#ä¸»è¦è´¡çŒ®" class="headerlink" title="ä¸»è¦è´¡çŒ®"></a>ä¸»è¦è´¡çŒ®</h2><ul><li>å¼•å…¥äº†ä¸€ä¸ªä»¥å®ä¾‹ä¸ºä¸­å¿ƒçš„æ³¨æ„åŠ›æ¨¡å—ï¼Œå®ƒå…è®¸ç½‘ç»œåŠ¨æ€çªå‡ºä¿¡æ¯åŒºåŸŸä»¥æ”¹è¿› HOI æ£€æµ‹ã€‚</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134849.png" alt="image-20201209152307633"></p><ol><li><p>åœ¨ç”±hæˆ–è€…oè®¡ç®—açš„åˆ†æ•°æ—¶ï¼Œä¸æ­¢ç”¨å®ƒä»¬æœ¬èº«çš„ç‰¹å¾ï¼Œè¿˜concatäº†contextç‰¹å¾ï¼Œcontexç‰¹å¾åˆ™æ˜¯æ ¹æ®intanceäº§ç”Ÿçš„æ³¨æ„åŠ›åœ¨åŸå›¾çš„ç‰¹å¾ä¸Šå¾—åˆ°çš„ã€‚</p><p>ç»™å®šå›¾åƒçš„å·ç§¯ç‰¹å¾ï¼ˆä»¥ç°è‰²æ˜¾ç¤ºï¼‰å’Œäºº/ç‰©ä½“è¾¹ç•Œæ¡†ï¼ˆä»¥çº¢è‰²æ˜¾ç¤ºï¼‰ï¼ŒiCAN æ¨¡å—æå–å®ä¾‹</p><p>ï¼ˆäººç±»ï¼‰æˆ–ï¼ˆç‰©ä½“ï¼‰çš„å¤–è§‚ç‰¹å¾ä»¥åŠæ¥è‡ªä»¥å®ä¾‹ä¸ºä¸­å¿ƒçš„æ³¨æ„åŠ›æ˜ å°„çš„ç‰¹å¾ã€‚ä¸ºäº†è®¡ç®—æ³¨æ„åŠ›æ˜ å°„ï¼Œç ”ç©¶è€…ä½¿ç”¨ 512 ä¸ªé€šé“çš„ bottleneck æ¥è¯„ä¼°åµŒå…¥ç©ºé—´ä¸­çš„ç›¸ä¼¼æ€§ã€37ã€‘ã€38ã€‘ã€‚å…·ä½“æ¥è¯´ï¼Œç ”ç©¶è€…ç”¨ 1Ã—1 å·ç§¯å’Œå®ä¾‹å¤–è§‚ç‰¹å¾å°†å›¾åƒç‰¹å¾åµŒå…¥åˆ°å…¨è¿æ¥å±‚ä¸­ã€‚è¿™é‡Œçš„ res5 è¡¨ç¤ºç¬¬äº”ä¸ªæ®‹å·®å—ï¼ŒGAP è¡¨ç¤ºå…¨å±€å¹³å‡æ± åŒ–å±‚ï¼ŒFC è¡¨ç¤ºå…¨è¿æ¥å±‚ã€‚</p></li><li><p>åŒæ ·éœ€è¦åˆ¤æ–­hå’Œoæ˜¯å¦æœ‰å…³ç³»ï¼Œè¯¥æ–¹æ³•æ˜¯ç”¨ç©ºé—´çš„interaction patternï¼ˆneural-motifä¸­æœ‰è¿™ä¸ªï¼‰å¹¶concat human instanceè®¡ç®—å¾—åˆ°çš„ã€‚</p></li></ol><p>ã€37ã€‘ Ashish V aswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez,<br>Åukasz Kaiser, and Illia Polosukhin. Attention is all you need. In NIPS, 2017.</p><p>ã€38ã€‘Xiaolong Wang, Ross Girshick, Abhinav Gupta, and Kaiming He. Non-local neural networks. InCVPR, 2018.</p><h2 id="ã€38ã€‘Non-local-Neural-Networks-facebook"><a href="#ã€38ã€‘Non-local-Neural-Networks-facebook" class="headerlink" title="ã€38ã€‘Non-local Neural Networks -facebook"></a>ã€38ã€‘Non-local Neural Networks -facebook</h2><h4 id="ç®€ä»‹ï¼š"><a href="#ç®€ä»‹ï¼š" class="headerlink" title="ç®€ä»‹ï¼š"></a>ç®€ä»‹ï¼š</h4><p>è®¡ç®—æœºè§†è§‰é¢†åŸŸæ³¨æ„åŠ›æœºåˆ¶çš„å¼€ç¯‡ä¹‹ä½œã€‚æå‡ºäº†non-local operationsï¼Œä½¿ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶å»ºç«‹è¿œç¨‹ä¾èµ–ã€‚ - local operations: å·ç§¯(å¯¹å±€éƒ¨é¢†åŸŸ)ã€recurrent(å¯¹å½“å‰/å‰ä¸€æ—¶åˆ»)ç­‰æ“ä½œã€‚ - non-local operationsç”¨äºæ•è·é•¿è·ç¦»ä¾èµ–ï¼ˆlong-range dependenciesï¼‰ï¼Œå³å¦‚ä½•å»ºç«‹å›¾åƒä¸Šä¸¤ä¸ªæœ‰ä¸€å®šè·ç¦»çš„åƒç´ ä¹‹é—´çš„è”ç³»ï¼Œå¦‚ä½•å»ºç«‹è§†é¢‘é‡Œä¸¤å¸§çš„è”ç³»ï¼Œå¦‚ä½•å»ºç«‹ä¸€æ®µè¯ä¸­ä¸åŒè¯çš„è”ç³»ç­‰ã€‚ Non-local operations åœ¨è®¡ç®—æŸä¸ªä½ç½®çš„å“åº”æ—¶ï¼Œæ˜¯è€ƒè™‘æ‰€æœ‰ä½ç½® features çš„åŠ æƒâ€”â€”æ‰€æœ‰ä½ç½®å¯ä»¥æ˜¯ç©ºé—´çš„ï¼Œæ—¶é—´çš„ï¼Œæ—¶ç©ºçš„ã€‚</p><h4 id="ç½‘ç»œç»“æ„-1"><a href="#ç½‘ç»œç»“æ„-1" class="headerlink" title="ç½‘ç»œç»“æ„"></a>ç½‘ç»œç»“æ„</h4><p>ç»™å‡ºéå±€éƒ¨æ“ä½œçš„å…·ä½“å…¬å¼ã€‚é¦–å…ˆåœ¨æ·±åº¦å­¦ä¹ ä¸­éå±€éƒ¨æ“ä½œå¯ä»¥è¡¨è¾¾ä¸ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134850.png" alt="img"></p><p>iæ˜¯è¾“å‡ºç‰¹å¾å›¾çš„å…¶ä¸­ä¸€ä¸ªä½ç½®ï¼Œé€šç”¨æ¥è¯´è¿™ä¸ªä½ç½®å¯ä»¥æ˜¯æ—¶é—´ã€ç©ºé—´å’Œæ—¶ç©ºã€‚jæ˜¯æ‰€æœ‰å¯èƒ½ä½ç½®çš„ç´¢å¼•ï¼Œxæ˜¯è¾“å…¥ä¿¡å·ï¼Œå¯ä»¥æ˜¯å›¾åƒã€åºåˆ—å’Œè§†é¢‘ï¼Œé€šå¸¸æ˜¯ç‰¹å¾å›¾ã€‚yæ˜¯å’Œxå°ºåº¦ä¸€æ ·çš„è¾“å‡ºå›¾ï¼Œfæ˜¯é…å¯¹è®¡ç®—å‡½æ•°ï¼Œè®¡ç®—ç¬¬iä¸ªä½ç½®å’Œå…¶ä»–æ‰€æœ‰ä½ç½®çš„ç›¸å…³æ€§ï¼Œgæ˜¯ä¸€å…ƒè¾“å…¥å‡½æ•°ï¼Œç›®çš„æ˜¯è¿›è¡Œä¿¡æ¯å˜æ¢ï¼ŒC(x)æ˜¯å½’ä¸€åŒ–å‡½æ•°ï¼Œä¿è¯å˜æ¢å‰åæ•´ä½“ä¿¡æ¯ä¸å˜ã€‚ä»¥ä¸Šæ˜¯ä¸€ä¸ªéå¸¸æ³›åŒ–çš„å…¬å¼ï¼Œç»“åˆç¥ç»ç½‘ç»œç‰¹å®šï¼Œéœ€è¦è€ƒè™‘å…¶å…·ä½“å½¢å¼ã€‚é¦–å…ˆ g ç”±äºæ˜¯ä¸€å…ƒè¾“å‡ºï¼Œæ¯”è¾ƒç®€å•ï¼Œæˆ‘å¯ä»¥é‡‡ç”¨1x1å·ç§¯ï¼Œä»£è¡¨çº¿æ€§åµŒå…¥ï¼Œå…¶å½¢å¼ä¸º</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134851.png" alt="img"></p><p>å¯¹äºfï¼Œå‰é¢æˆ‘ä»¬è¯´è¿‡å…¶å®å°±æ˜¯è®¡ç®—ä¸¤ä¸ªä½ç½®çš„ç›¸å…³æ€§ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªéå¸¸è‡ªç„¶çš„å‡½æ•°æ˜¯Gaussian</p><p><strong>(1) Gaussian</strong></p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134852.png" alt="img"></p><p>å¯¹ä¸¤ä¸ªä½ç½®è¿›è¡Œç‚¹ä¹˜ï¼Œç„¶åé€šè¿‡æŒ‡æ•°æ˜ å°„ï¼Œæ”¾å¤§å·®å¼‚ã€‚</p><p><strong>(2) Embedded Gaussian</strong></p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134853.png" alt="img"></p><p>å‰é¢çš„gaussianå½¢å¼æ˜¯ç›´æ¥åœ¨å½“å‰ç©ºé—´è®¡ç®—ï¼Œè€Œ(2)æ›´åŠ é€šç”¨ï¼Œåœ¨åµŒå…¥ç©ºé—´ä¸­è®¡ç®—é«˜æ–¯è·ç¦»ã€‚è¿™é‡Œï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134854.png" alt="img"></p><p>å®Œæ•´è€ƒè™‘æ˜¯ï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134855.png" alt="img"></p><p><strong>(3) Dot product</strong></p><p>è€ƒè™‘ä¸€ç§æœ€ç®€å•çš„éå±€éƒ¨æ“ä½œå½¢å¼ï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134856.png" alt="image-20201210134835084"></p><p>å…¶ä¸­C(x)=Nï¼Œåƒç´ ä¸ªæ•°ã€‚å¯ä»¥çœ‹å‡º(2) (3)çš„ä¸»è¦åŒºåˆ«æ˜¯æ˜¯å¦å«æœ‰æ¿€æ´»å‡½æ•°softmaxã€‚</p><p><strong>(4) Concatenation</strong></p><p>å‚è€ƒ Relation Networkså¯ä»¥æå‡ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134857.png" alt="image-20201210134825277"></p><h4 id="Non-local-Block"><a href="#Non-local-Block" class="headerlink" title="Non-local Block"></a>Non-local Block</h4><p>å‰é¢æ˜¯åŸºæœ¬çš„éå±€éƒ¨æ“ä½œç®—å­ï¼Œåˆ©ç”¨è¿™äº›ç®—å­ï¼Œä¸‹é¢å¼€å§‹æ„é€ æˆæ¨¡å—ã€‚ </p><p><img src="/medias/loading.gif" data-original="https:////upload-images.jianshu.io/upload_images/11692737-fd82671ed688abb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/140/format/webp" alt="img"></p><p>å¯ä»¥çœ‹å‡ºï¼Œä¸Šé¢æ„é€ æˆäº†æ®‹å·®å½¢å¼ã€‚ä¸Šé¢çš„åšæ³•çš„<strong>å¥½å¤„æ˜¯å¯ä»¥éšæ„åµŒå…¥åˆ°ä»»ä½•ä¸€ä¸ªé¢„è®­ç»ƒå¥½çš„ç½‘ç»œä¸­ï¼Œå› ä¸ºåªè¦è®¾ç½®W_zåˆå§‹åŒ–ä¸º0ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰ä»»ä½•å½±å“ï¼Œç„¶ååœ¨è¿ç§»å­¦ä¹ ä¸­å­¦ä¹ æ–°çš„æƒé‡ã€‚è¿™æ ·å°±ä¸ä¼šå› ä¸ºå¼•å…¥äº†æ–°çš„æ¨¡å—è€Œå¯¼è‡´é¢„è®­ç»ƒæƒé‡æ— æ³•ä½¿ç”¨</strong>ã€‚</p><p>ä¸‹é¢ç»“åˆå…·ä½“å®ä¾‹åˆ†æï¼šã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201210134858.png" alt="img"></p><p>ç”±äºæˆ‘ä»¬è€ƒè™‘çš„æ˜¯å›¾ç‰‡ï¼Œæ•…å¯ä»¥ç›´æ¥è®¾ç½®T=1ï¼Œæˆ–è€…è¯´ä¸å­˜åœ¨ã€‚</p><ul><li><p>é¦–å…ˆç½‘ç»œè¾“å…¥æ˜¯X= (batch, h, w, 1024) ï¼Œç»è¿‡Embedded Gaussianä¸­çš„ä¸¤ä¸ªåµŒå…¥æƒé‡å˜æ¢<img src="/medias/loading.gif" data-original="https://img2018.cnblogs.com/blog/1470684/201911/1470684-20191118183432078-1492031547.png" alt="W_{\theta}"> ï¼Œ <img src="/medias/loading.gif" data-original="https://img2018.cnblogs.com/blog/1470684/201911/1470684-20191118183432402-981947511.png" alt="W_{\phi}">å¾—åˆ°(batch, h, w, 512), (batch, h, w, 512), å…¶å®è¿™é‡Œçš„ç›®çš„æ˜¯é™ä½é€šé“æ•°ï¼Œå‡å°‘è®¡ç®—é‡ï¼›</p></li><li><p>ç„¶ååˆ†åˆ«å¯¹è¿™ä¸¤ä¸ªè¾“å‡ºè¿›è¡Œreshapeæ“ä½œï¼Œå˜æˆ(batch, hw, 512)ï¼Œåå¯¹è¿™ä¸¤ä¸ªè¾“å‡ºè¿›è¡ŒçŸ©é˜µä¹˜(å…¶ä¸­ä¸€ä¸ªè¦è½¬ç½®)ï¼Œè®¡ç®—ç›¸ä¼¼æ€§ï¼Œå¾—åˆ°(batch, hw, hw),</p></li><li><p>ç„¶ååœ¨ç¬¬2ä¸ªç»´åº¦å³æœ€åä¸€ä¸ªç»´åº¦ä¸Šè¿›è¡Œsoftmaxæ“ä½œï¼Œå¾—åˆ°(batch, hw, hw), æ„è¿™æ ·åšå°±æ˜¯ç©ºé—´æ³¨æ„åŠ›ï¼Œç›¸å½“äºæ‰¾åˆ°äº†å½“å‰å›¾ç‰‡æˆ–ç‰¹å¾å›¾ä¸­æ¯ä¸ªåƒç´ ä¸å…¶ä»–æ‰€æœ‰ä½ç½®åƒç´ çš„å½’ä¸€åŒ–ç›¸å…³æ€§ï¼›ä¹Ÿå°±æ˜¯å¾—åˆ°0~1çš„weightsï¼Œè¿™é‡Œå°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ Self-attention ç³»æ•°ï¼›</p></li><li><p>ç„¶åå°† g ä¹Ÿé‡‡ç”¨ä¸€æ ·çš„æ“ä½œï¼Œå…ˆé€šé“é™ç»´ï¼Œç„¶åreshapeï¼›ç„¶åå’Œ (batch, hw, hw)è¿›è¡ŒçŸ©é˜µä¹˜ï¼Œå¾—åˆ°(batch, h, w, 512), å³å°†ç©ºé—´æ³¨æ„åŠ›æœºåˆ¶åº”ç”¨åˆ°äº†æ‰€æœ‰é€šé“çš„æ¯å¼ ç‰¹å¾å›¾å¯¹åº”ä½ç½®ä¸Šï¼Œæœ¬è´¨å°±æ˜¯è¾“å‡ºçš„æ¯ä¸ªä½ç½®å€¼éƒ½æ˜¯å…¶ä»–æ‰€æœ‰ä½ç½®çš„åŠ æƒå¹³å‡å€¼ï¼Œé€šè¿‡softmaxæ“ä½œå¯ä»¥è¿›ä¸€æ­¥çªå‡ºå…±æ€§ã€‚æœ€åç»è¿‡ä¸€ä¸ª1x1å·ç§¯æ¢å¤è¾“å‡ºé€šé“ï¼Œä¿è¯è¾“å…¥è¾“å‡ºå°ºåº¦å®Œå…¨ç›¸åŒã€‚</p></li></ul><p>ä»£ç åœ°å€  <a href="https://github.com/AlexHex7/Non-local_pytorch" target="_blank" rel="noopener">https://github.com/AlexHex7/Non-local_pytorch</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æ–‡çŒ®é˜…è¯» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HOI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HICO-DETæ•°æ®é›†</title>
      <link href="/2020/12/03/lun-wen-hico-det-shu-ju-ji/"/>
      <url>/2020/12/03/lun-wen-hico-det-shu-ju-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–‡çŒ®-Learning-to-Detect-Human-Object-Interaction"><a href="#æ–‡çŒ®-Learning-to-Detect-Human-Object-Interaction" class="headerlink" title="æ–‡çŒ®-Learning to Detect Human-Object Interaction"></a>æ–‡çŒ®-Learning to Detect Human-Object Interaction</h1><ul><li>æ¦‚è¿°ï¼š2018å¹´ç”±å¯†æ­‡æ ¹å¤§å­¦å’Œåç››é¡¿å¤§å­¦å…±åŒæå‡ºHICO-DETæ•°æ®é›†</li><li>å…³é”®è¯ï¼šæ•°æ®é›†</li><li>è®ºæ–‡åœ°å€ï¼š<a href="https://www.yuque.com/ugdongzhou/io8kmc/1661139" target="_blank" rel="noopener">https://www.yuque.com/ugdongzhou/io8kmc/1661139</a></li><li>æ•°æ®é›†:  <a href="http://www-personal.umich.edu/~ywchao/hico/" target="_blank" rel="noopener">http://www-personal.umich.edu/~ywchao/hico/</a></li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201206213325.png" alt="image-20201203205600371"></p><h2 id="ä¸»è¦è´¡çŒ®"><a href="#ä¸»è¦è´¡çŒ®" class="headerlink" title="ä¸»è¦è´¡çŒ®"></a>ä¸»è¦è´¡çŒ®</h2><ul><li>æå‡ºä¸€ä¸ªæ–°çš„benchmark â€”â€”HICO-DETï¼Œæä¾›äº†è¶…è¿‡150,000ä¸ªæ ‡æ³¨åçš„äººç±»-ç‰©ä½“ç»„åˆï¼ŒåŒ…å«600ä¸ªHOIç±»åˆ«ï¼Œå³æ¯ä¸ªHOIç±»åˆ«å¹³å‡250ä¸ªç»„åˆå®ä¾‹ã€‚</li><li>æå‡ºäº†åŸºäºäºº-ç‰©åŒºåŸŸçš„å·ç§¯ç¥ç»ç½‘ç»œHO-RCNNã€‚åˆ†ä¸¤æ­¥ï¼Œ1. ä½¿ç”¨æœ€å…ˆè¿›çš„äººä½“å’Œç‰©ä½“æ£€æµ‹å™¨ç”Ÿæˆäººä½“-ç‰©ä½“åŒºåŸŸå¯¹çš„proposalï¼›2. å°†æ¯ä¸ªäºº-ç‰©æ¡†proposalé€å…¥CNNï¼Œä»¥ç”ŸæˆHOIåˆ†ç±»åˆ†æ•°ã€‚</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201206213222.png" alt="image-20201203211834372"></p><h2 id="æ•°æ®é›†"><a href="#æ•°æ®é›†" class="headerlink" title="æ•°æ®é›†"></a>æ•°æ®é›†</h2><h4 id="ä¸‰ä¸ªbenchmark"><a href="#ä¸‰ä¸ªbenchmark" class="headerlink" title="ä¸‰ä¸ªbenchmark"></a>ä¸‰ä¸ªbenchmark</h4><ul><li>Fullâ€”â€” æ‰€æœ‰çš„600ä¸ªHOIåˆ†ç±»</li><li>Rare â€”â€”138ä¸ªHOIç±»åˆ«ï¼ˆå°‘äº10ä¸ªè®­ç»ƒå®ä¾‹ï¼‰</li><li>Non-Rare â€”â€”462ä¸ªHOIç±»åˆ«ï¼ˆå¤§äºç­‰äº10ä¸ªè®­ç»ƒå®ä¾‹ï¼‰</li></ul><h4 id="ä¸¤ç§è¯„ä¼°æ–¹æ³•"><a href="#ä¸¤ç§è¯„ä¼°æ–¹æ³•" class="headerlink" title="ä¸¤ç§è¯„ä¼°æ–¹æ³•"></a>ä¸¤ç§è¯„ä¼°æ–¹æ³•</h4><ul><li>Known Object â€”â€”å®šä½HOI(å¦‚äºº-è‡ªè¡Œè½¦å¯¹)ä»¥åŠåŒºåˆ†äº’åŠ¨(å¦‚â€œéª‘è¡Œâ€)</li><li>Default setting â€”â€”æ›´æœ‰æŒ‘æˆ˜æ€§ï¼Œå›¾åƒä¸­å¯èƒ½ä¸å­˜åœ¨ç›®æ ‡å¯¹è±¡</li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æ–‡çŒ®é˜…è¯» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HOI </tag>
            
            <tag> æ•°æ®é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCP/IP+HTTPé¢è¯•é¢˜</title>
      <link href="/2020/12/03/tcpip-http-mian-shi-ti/"/>
      <url>/2020/12/03/tcpip-http-mian-shi-ti/</url>
      
        <content type="html"><![CDATA[<h2 id="smile-ä»€ä¹ˆæ˜¯-é€šä¿¡åè®®ï¼Ÿ"><a href="#smile-ä»€ä¹ˆæ˜¯-é€šä¿¡åè®®ï¼Ÿ" class="headerlink" title=":smile:ä»€ä¹ˆæ˜¯ é€šä¿¡åè®®ï¼Ÿ"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8">ğŸ˜„</span>ä»€ä¹ˆæ˜¯ é€šä¿¡åè®®ï¼Ÿ</h2><p>é€šä¿¡åè®®(protocol) æŒ‡åŒæ–¹å®ä½“å®Œæˆé€šä¿¡æˆ–æœåŠ¡æ‰€å¿…é¡»éµå®ˆçš„è§„åˆ™å’Œçº¦æŸã€‚ä¸åŒåœ°ç†ä½ç½®çš„æ•°æ®é€šä¿¡ç³»ç»Ÿï¼Œè¦å®ç°ä¿¡æ¯äº¤æ¢å’Œèµ„æºå…±äº«ï¼Œå¿…é¡»ä½¿ç”¨å…±åŒçš„è¯­è¨€æˆ–è€…è¯´æ˜¯è§„åˆ™ï¼Œè¿™ä¸ªè§„åˆ™å°±æ˜¯é€šä¿¡åè®®ã€‚</p><h2 id="smile-èƒ½è¯´è¯´-ISO-ä¸ƒå±‚æ¨¡å‹å’Œ-TCP-IP-å››å±‚æ¨¡å‹å—ï¼Ÿ"><a href="#smile-èƒ½è¯´è¯´-ISO-ä¸ƒå±‚æ¨¡å‹å’Œ-TCP-IP-å››å±‚æ¨¡å‹å—ï¼Ÿ" class="headerlink" title=":smile: èƒ½è¯´è¯´ ISO ä¸ƒå±‚æ¨¡å‹å’Œ TCP/IP å››å±‚æ¨¡å‹å—ï¼Ÿ"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8">ğŸ˜„</span> èƒ½è¯´è¯´ ISO ä¸ƒå±‚æ¨¡å‹å’Œ TCP/IP å››å±‚æ¨¡å‹å—ï¼Ÿ</h2><h3 id="a-ISO-ä¸ƒå±‚æ¨¡å‹"><a href="#a-ISO-ä¸ƒå±‚æ¨¡å‹" class="headerlink" title=":a:  ISO ä¸ƒå±‚æ¨¡å‹"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f170.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f170.png?v8">ğŸ…°</span>  ISO ä¸ƒå±‚æ¨¡å‹</h3><p>æ¯ä¸ªå…·æœ‰ç‹¬ç«‹è®¡ç®—æœåŠ¡ä½“ç³»çš„ä¿¡æ¯æŠ€æœ¯å…¬å¸éƒ½ä¼šå»ºç«‹è‡ªå·±çš„è®¡ç®—æœºé€šä¿¡è§„åˆ™ï¼Œè€Œè¿™ç§æƒ…å†µä¼šå¯¼è‡´å¼‚æ„è®¡ç®—æœºä¹‹é—´æ— æ³•é€šä¿¡ï¼Œæå¤§çš„é˜»ç¢äº†ç½‘ç»œé€šä¿¡çš„å‘å±•ï¼Œè‡³æ­¤ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼ˆISOï¼‰åˆ¶å®šäº†OSIæ¨¡å‹ï¼Œè¯¥æ¨¡å‹å®šä¹‰äº†ä¸åŒè®¡ç®—æœºäº’è”çš„æ ‡å‡†ï¼ŒOSIæ¨¡å‹æŠŠç½‘ç»œé€šä¿¡çš„å·¥ä½œåˆ†ä¸º7å±‚ï¼Œåˆ†åˆ«æ˜¯<strong>ç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€ä¼šè¯å±‚ã€è¡¨ç¤ºå±‚å’Œåº”ç”¨å±‚</strong>ã€‚</p><p>åˆ†å±‚çš„å¥½å¤„åœ¨äºæ¸…æ™°å’ŒåŠŸèƒ½ç‹¬ç«‹æ€§ï¼Œä½†åˆ†å±‚è¿‡å¤šä¼šä½¿å±‚æ¬¡å˜çš„æ›´åŠ å¤æ‚ï¼Œè™½ç„¶ä¸éœ€è¦å®ç°æœ¬å±‚çš„åŠŸèƒ½ï¼Œä½†æ˜¯ä¹Ÿéœ€è¦æ„é€ æœ¬å±‚çš„ä¸Šä¸‹æ–‡ï¼Œç©ºè€—ç³»ç»Ÿèµ„æºï¼Œæ‰€ä»¥åœ¨è½åœ°å®æ–½ç½‘ç»œé€šä¿¡æ¨¡å‹çš„æ—¶å€™å°†è¿™ä¸ƒå±‚æ¨¡å‹ç®€åŒ–åˆå¹¶ä¸ºå››å±‚æ¨¡å‹åˆ†åˆ«æ˜¯<strong>åº”ç”¨å±‚ã€ä¼ è¾“å±‚ã€ç½‘ç»œå±‚ã€ç½‘ç»œæ¥å£å±‚</strong>ï¼ˆå„å±‚ä¹‹é—´çš„æ¨¡å‹ã€åè®®ç»Ÿç§°ä¸ºï¼š<strong>TCP/IPåè®®ç°‡</strong>ï¼‰ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201201151635968.png" alt="image-20201201151635968"></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼ŒTCP/IPæ¨¡å‹åˆå¹¶äº†OSIæ¨¡å‹çš„åº”ç”¨å±‚ã€è¡¨ç¤ºå±‚å’Œä¼šè¯å±‚ï¼Œå°†OSIæ¨¡å‹çš„æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚åˆå¹¶ä¸ºç½‘ç»œè®¿é—®å±‚ã€‚</p><p>ä¸Šå›¾è¿˜åˆ—å‡ºäº†å„å±‚æ¨¡å‹å¯¹åº”TCP/IPåè®®æ ˆä¸­çš„åè®®ä»¥åŠå„å±‚åè®®ä¹‹é—´çš„å…³ç³»ã€‚æ¯”å¦‚DNSåè®®æ˜¯å»ºç«‹åœ¨TCPå’ŒUDPåè®®çš„åŸºç¡€ä¸Šï¼ŒFTPã€HTTPã€TELNETåè®®å»ºç«‹åœ¨TCPåè®®çš„åŸºç¡€ä¸Šï¼ŒNTPã€TFTPã€SNMPå»ºç«‹åœ¨UDPåè®®çš„åŸºç¡€ä¸Šï¼Œè€ŒTCPã€UDPåè®®åˆå»ºç«‹åœ¨IPåè®®çš„åŸºç¡€ä¸Šï¼Œä»¥æ­¤ç±»æ¨â€¦.</p><table><thead><tr><th align="left">OSIä¸­çš„å±‚</th><th align="left">åŠŸèƒ½</th><th align="left">TCP/IPåè®®æ—</th></tr></thead><tbody><tr><td align="left"><strong>åº”ç”¨å±‚</strong></td><td align="left">æ–‡ä»¶ä¼ è¾“ï¼Œç”µå­é‚®ä»¶ï¼Œæ–‡ä»¶æœåŠ¡ï¼Œè™šæ‹Ÿç»ˆç«¯</td><td align="left">TFTPï¼ŒHTTPï¼ŒSNMPï¼ŒFTPï¼ŒSMTPï¼ŒDNSï¼ŒRIPï¼ŒTelnet</td></tr><tr><td align="left"><strong>è¡¨ç¤ºå±‚</strong></td><td align="left">æ•°æ®æ ¼å¼åŒ–ï¼Œä»£ç è½¬æ¢ï¼Œæ•°æ®åŠ å¯†</td><td align="left">æ— </td></tr><tr><td align="left"><strong>ä¼šè¯å±‚</strong></td><td align="left">æ§åˆ¶åº”ç”¨ç¨‹åºä¹‹é—´ä¼šè¯èƒ½åŠ›ï¼›å¦‚ä¸åŒè½¯ä»¶æ•°æ®åˆ†å‘ç»™ä¸åŒè½¯ä»¶</td><td align="left">ASAPã€TLSã€SSHã€ISO 8327 / CCITT X.225ã€RPCã€NetBIOSã€ASPã€Winsockã€BSD sockets</td></tr><tr><td align="left"><strong>ä¼ è¾“å±‚</strong></td><td align="left">ç«¯åˆ°ç«¯ä¼ è¾“æ•°æ®çš„åŸºæœ¬åŠŸèƒ½</td><td align="left">TCPã€UDP</td></tr><tr><td align="left"><strong>ç½‘ç»œå±‚</strong></td><td align="left">å®šä¹‰IPç¼–å€ï¼Œå®šä¹‰è·¯ç”±åŠŸèƒ½ï¼›å¦‚ä¸åŒè®¾å¤‡çš„æ•°æ®è½¬å‘</td><td align="left">IPï¼ŒICMPï¼ŒRIPï¼ŒOSPFï¼ŒBGPï¼ŒIGMP</td></tr><tr><td align="left"><strong>æ•°æ®é“¾è·¯å±‚</strong></td><td align="left">å®šä¹‰æ•°æ®çš„åŸºæœ¬æ ¼å¼ï¼Œå¦‚ä½•ä¼ è¾“ï¼Œå¦‚ä½•æ ‡è¯†</td><td align="left">SLIPï¼ŒCSLIPï¼ŒPPPï¼ŒARPï¼ŒRARPï¼ŒMTU</td></tr><tr><td align="left"><strong>ç‰©ç†å±‚</strong></td><td align="left">ä»¥<strong>äºŒè¿›åˆ¶</strong>æ•°æ®å½¢å¼åœ¨ç‰©ç†åª’ä½“ä¸Šä¼ è¾“æ•°æ®</td><td align="left">ISO2110ï¼ŒIEEE802</td></tr></tbody></table><h3 id="b-TCP-IP-å››å±‚æ¨¡å‹"><a href="#b-TCP-IP-å››å±‚æ¨¡å‹" class="headerlink" title=":b:  TCP/IP å››å±‚æ¨¡å‹"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f171.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f171.png?v8">ğŸ…±</span>  TCP/IP å››å±‚æ¨¡å‹</h3><blockquote><p>ç½‘ç»œæ•°æ®ä¼ è¾“å°±åƒå¿«é€’é‚®å¯„ï¼Œæ•°æ®å°±æ˜¯å¿«ä»¶ã€‚åªæœ‰è·¯æ‰“é€šäº†ï¼Œä½ çš„â€å¿«é€’â€æ‰èƒ½é€åˆ°ï¼Œå› æ­¤ç‰©ç†ä»‹è´¨æ˜¯ç½‘ç»œé€šä¿¡çš„åŸºçŸ³ã€‚</p><p>å¯„å¿«é€’é¦–å…ˆå¾—ç§°é‡ã€ç¡®è®¤ä½“ç§¯(ç¡®è®¤æ•°æ®å¤§å°)ï¼Œè´µé‡ç‰©å“è¿˜å¾—å±‚å±‚åŒ…è£¹å¡«å……ç‰©ç¡®ä¿å®‰å…¨ï¼Œå°è£…ï¼Œç„¶åå¡«å†™å‘ä»¶åœ°å€(æºä¸»æœºåœ°å€)å’Œæ”¶ä»¶åœ°å€(ç›®æ ‡ä¸»æœºåœ°å€)ï¼Œç¡®è®¤å¿«é€’æ–¹å¼ã€‚å¯¹äºåè¿œåœ°åŒºï¼Œå¿«é€’ä¸èƒ½ç›´è¾¾ï¼Œè¿˜éœ€è¦ä¸­é€”è½¬å‘ã€‚ç½‘ç»œé€šä¿¡ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼Œåªä¸è¿‡æŠŠè¿™äº›æ­¥éª¤éƒ½è§„å®šæˆäº†å„ç§åè®®ã€‚</p></blockquote><p>TCP/IPçš„æ¨¡å‹çš„æ¯ä¸€å±‚éƒ½éœ€è¦ä¸‹ä¸€å±‚æ‰€æä¾›çš„åè®®æ¥å®Œæˆè‡ªå·±çš„ç›®çš„ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹æ•°æ®æ˜¯æ€ä¹ˆé€šè¿‡TCP/IPåè®®æ¨¡å‹ä»ä¸€å°ä¸»æœºå‘é€åˆ°å¦ä¸€å°ä¸»æœºçš„ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201201151706737.png" alt="image-20201201151706737"></p><p>å½“ç”¨æˆ·é€šè¿‡HTTPåè®®å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œåº”ç”¨å±‚ã€ä¼ è¾“å±‚ã€ç½‘ç»œäº’è”å±‚å’Œç½‘ç»œè®¿é—®å±‚çš„ç›¸å…³åè®®ä¾æ¬¡å¯¹è¯¥è¯·æ±‚è¿›è¡Œ<strong>åŒ…è£…å¹¶æºå¸¦å¯¹åº”çš„é¦–éƒ¨</strong>ï¼Œæœ€ç»ˆåœ¨ç½‘ç»œè®¿é—®å±‚ç”Ÿæˆä»¥å¤ªç½‘æ•°æ®åŒ…ï¼Œä»¥å¤ªç½‘æ•°æ®åŒ…é€šè¿‡ç‰©ç†ä»‹è´¨ä¼ è¾“ç»™å¯¹æ–¹ä¸»æœºï¼Œå¯¹æ–¹æ¥æ”¶åˆ°æ•°æ®åŒ…ä»¥åï¼Œç„¶åå†ä¸€å±‚ä¸€å±‚é‡‡ç”¨å¯¹åº”çš„åè®®è¿›è¡Œæ‹†åŒ…ï¼Œæœ€åæŠŠåº”ç”¨å±‚æ•°æ®äº¤ç»™åº”ç”¨ç¨‹åºå¤„ç†ã€‚</p><h2 id="smile-TCP-IP-ä¸-HTTP-æœ‰ä»€ä¹ˆå…³ç³»å—ï¼Ÿ"><a href="#smile-TCP-IP-ä¸-HTTP-æœ‰ä»€ä¹ˆå…³ç³»å—ï¼Ÿ" class="headerlink" title=":smile: TCP/IP ä¸ HTTP æœ‰ä»€ä¹ˆå…³ç³»å—ï¼Ÿ"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8">ğŸ˜„</span> TCP/IP ä¸ HTTP æœ‰ä»€ä¹ˆå…³ç³»å—ï¼Ÿ</h2><p>TCP/IPï¼ˆTransmission Control Protocol/Internet Protocolï¼Œä¼ è¾“æ§åˆ¶åè®®/ç½‘é™…åè®®ï¼‰æ˜¯æŒ‡èƒ½å¤Ÿåœ¨å¤šä¸ªä¸åŒç½‘ç»œé—´å®ç°ä¿¡æ¯ä¼ è¾“çš„åè®®ç°‡ã€‚TCP/IP åè®®ä¸ä»…ä»…æŒ‡çš„æ˜¯ TCP  å’Œ IP ä¸¤ä¸ªåè®®ï¼Œè€Œæ˜¯æŒ‡ä¸€ä¸ªç”±FTPã€SMTPã€TCPã€UDPã€IPç­‰åè®®æ„æˆçš„åè®®ç°‡ï¼Œ åªæ˜¯å› ä¸ºåœ¨TCP/IPåè®®ä¸­TCPåè®®å’ŒIPåè®®æœ€å…·ä»£è¡¨æ€§ï¼Œæ‰€ä»¥è¢«ç§°ä¸ºTCP/IPåè®®ã€‚</p><p><strong>è€ŒHTTPæ˜¯åº”ç”¨å±‚åè®®ï¼Œä¸»è¦è§£å†³å¦‚ä½•åŒ…è£…æ•°æ®ã€‚</strong></p><p>â€œIPâ€ä»£è¡¨ç½‘é™…åè®®ï¼ŒTCP å’Œ UDP ä½¿ç”¨è¯¥åè®®ä»ä¸€ä¸ªç½‘ç»œä¼ é€æ•°æ®åŒ…åˆ°å¦ä¸€ä¸ªç½‘ç»œã€‚æŠŠ<strong>IPæƒ³åƒæˆä¸€ç§é«˜é€Ÿå…¬è·¯</strong>ï¼Œå®ƒå…è®¸å…¶å®ƒåè®®åœ¨ä¸Šé¢è¡Œé©¶å¹¶æ‰¾åˆ°åˆ°å…¶å®ƒç”µè„‘çš„å‡ºå£ã€‚<strong>TCPå’ŒUDPæ˜¯é«˜é€Ÿå…¬è·¯ä¸Šçš„â€œå¡è½¦â€ï¼Œå®ƒä»¬æºå¸¦çš„è´§ç‰©å°±æ˜¯åƒHTTP</strong>ï¼Œæ–‡ä»¶ä¼ è¾“åè®®FTPè¿™æ ·çš„åè®®ç­‰ã€‚</p><h2 id="smile-TCPåè®®ä¸UDPåè®®çš„åŒºåˆ«ï¼Ÿ"><a href="#smile-TCPåè®®ä¸UDPåè®®çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title=":smile: TCPåè®®ä¸UDPåè®®çš„åŒºåˆ«ï¼Ÿ"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8">ğŸ˜„</span> TCPåè®®ä¸UDPåè®®çš„åŒºåˆ«ï¼Ÿ</h2><p>é¦–å…ˆä»–ä»¬éƒ½å±äºéƒ½å±äº<strong>ä¼ è¾“å±‚åè®®</strong>ã€‚</p><p>TCPï¼ˆTransmission Control Protocolï¼Œä¼ è¾“æ§åˆ¶åè®®ï¼‰æ˜¯é¢å‘è¿æ¥çš„åè®®ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ”¶å‘æ•°æ®å‰ï¼Œ<strong>å¿…é¡»å’Œå¯¹æ–¹å»ºç«‹å¯é çš„è¿æ¥</strong>ã€‚ä¸€ä¸ªTCPè¿æ¥å¿…é¡»æœ‰<strong>ä¸‰æ¬¡æ¡æ‰‹ã€å››æ¬¡æŒ¥æ‰‹</strong>ã€‚</p><p>UDPï¼ˆUser Data Protocolï¼Œç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰æ˜¯ä¸€ä¸ª<strong>éè¿æ¥</strong>çš„åè®®ï¼Œä¼ è¾“æ•°æ®ä¹‹å‰æºç«¯å’Œç»ˆç«¯ä¸å»ºç«‹è¿æ¥ï¼Œ å½“å®ƒæƒ³ä¼ é€æ—¶å°±ç®€å•åœ°å»æŠ“å–æ¥è‡ªåº”ç”¨ç¨‹åºçš„æ•°æ®ï¼Œå¹¶å°½å¯èƒ½å¿«åœ°æŠŠå®ƒæ‰”åˆ°ç½‘ç»œä¸Šï¼Œå› æ­¤ä¸€å°æœåŠ¡æœºå¯åŒæ—¶å‘å¤šä¸ªå®¢æˆ·æœºä¼ è¾“ç›¸åŒçš„æ¶ˆæ¯ã€‚</p><table><thead><tr><th align="left"></th><th align="left">TCP</th><th align="left">UDP</th></tr></thead><tbody><tr><td align="left">è¿æ¥æ€§</td><td align="left">é¢å‘è¿æ¥</td><td align="left">é¢å‘éè¿æ¥</td></tr><tr><td align="left">ä¼ è¾“å¯é æ€§</td><td align="left">å¯é </td><td align="left">ä¸å¯é </td></tr><tr><td align="left">æŠ¥æ–‡</td><td align="left">é¢å‘å­—èŠ‚æµ</td><td align="left">é¢å‘æŠ¥æ–‡</td></tr><tr><td align="left">æ•ˆç‡</td><td align="left">ä¼ è¾“æ•ˆç‡ä½</td><td align="left">ä¼ è¾“æ•ˆç‡é«˜</td></tr><tr><td align="left">æµé‡æ§åˆ¶</td><td align="left">æ»‘åŠ¨çª—å£</td><td align="left">æ— </td></tr><tr><td align="left">æ‹¥å¡æ§åˆ¶</td><td align="left">æ…¢å¼€å§‹ã€æ‹¥å¡é¿å…ã€å¿«é‡ä¼ ã€å¿«æ¢å¤</td><td align="left">æ— </td></tr><tr><td align="left">ä¼ è¾“é€Ÿåº¦</td><td align="left">æ…¢</td><td align="left">å¿«</td></tr><tr><td align="left">åº”ç”¨åœºåˆ</td><td align="left">å¯¹æ•ˆç‡è¦æ±‚ä½ï¼Œå¯¹å‡†ç¡®æ€§è¦æ±‚é«˜æˆ–è¦æ±‚æœ‰è¿æ¥çš„åœºæ™¯</td><td align="left">å¯¹æ•ˆç‡è¦æ±‚é«˜ï¼Œå¯¹å‡†ç¡®æ€§è¦æ±‚ä½</td></tr></tbody></table><p>TCPå’ŒUDPåè®®çš„ä¸€äº›åº”ç”¨</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201201153131634.png" alt="image-20201201153131634"></p><h2 id="smile-æ¸…è¯¦ç»†ä»‹ç»ä¸€ä¸‹-TCP-çš„ä¸‰æ¬¡æ¡æ‰‹æœºåˆ¶ï¼Œä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹ï¼ŸæŒ¥æ‰‹å´åˆæ˜¯å››æ¬¡å‘¢ï¼Ÿ"><a href="#smile-æ¸…è¯¦ç»†ä»‹ç»ä¸€ä¸‹-TCP-çš„ä¸‰æ¬¡æ¡æ‰‹æœºåˆ¶ï¼Œä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹ï¼ŸæŒ¥æ‰‹å´åˆæ˜¯å››æ¬¡å‘¢ï¼Ÿ" class="headerlink" title=":smile: æ¸…è¯¦ç»†ä»‹ç»ä¸€ä¸‹ TCP çš„ä¸‰æ¬¡æ¡æ‰‹æœºåˆ¶ï¼Œä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹ï¼ŸæŒ¥æ‰‹å´åˆæ˜¯å››æ¬¡å‘¢ï¼Ÿ"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8">ğŸ˜„</span> æ¸…è¯¦ç»†ä»‹ç»ä¸€ä¸‹ TCP çš„ä¸‰æ¬¡æ¡æ‰‹æœºåˆ¶ï¼Œä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹ï¼ŸæŒ¥æ‰‹å´åˆæ˜¯å››æ¬¡å‘¢ï¼Ÿ</h2><p>æ‰€è°“ä¸‰æ¬¡æ¡æ‰‹(Three-way Handshake)ï¼Œæ˜¯æŒ‡å»ºç«‹ä¸€ä¸ª TCP è¿æ¥æ—¶ï¼Œéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ€»å…±å‘é€3ä¸ªåŒ…ã€‚</p><p>ä¸‰æ¬¡æ¡æ‰‹çš„ç›®çš„æ˜¯è¿æ¥æœåŠ¡å™¨æŒ‡å®šç«¯å£ï¼Œå»ºç«‹ TCP è¿æ¥ï¼Œå¹¶åŒæ­¥è¿æ¥åŒæ–¹çš„åºåˆ—å·å’Œç¡®è®¤å·ï¼Œäº¤æ¢ TCP çª—å£å¤§å°ä¿¡æ¯ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201202003.png" alt="image-20201201154520172"></p><ul><li>å®¢æˆ·ç«¯â€”â€”å‘é€å¸¦æœ‰SYNæ ‡å¿—çš„æ•°æ®åŒ…â€”â€”ä¸€æ¬¡æ¡æ‰‹â€”â€”æœåŠ¡ç«¯</li><li>æœåŠ¡ç«¯â€”â€”å‘é€å¸¦æœ‰SYN/ACKæ ‡å¿—çš„æ•°æ®åŒ…â€”â€”äºŒæ¬¡æ¡æ‰‹â€”â€”å®¢æˆ·ç«¯</li><li>å®¢æˆ·ç«¯â€”â€”å‘é€å¸¦æœ‰ACKæ ‡å¿—çš„æ•°æ®åŒ…â€”â€”ä¸‰æ¬¡æ¡æ‰‹â€”â€”æœåŠ¡ç«¯</li></ul><h4 id="ä¸ºä»€ä¹ˆè¦ä¼ å›SYN"><a href="#ä¸ºä»€ä¹ˆè¦ä¼ å›SYN" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä¼ å›SYN"></a>ä¸ºä»€ä¹ˆè¦ä¼ å›SYN</h4><p>æ¥æ”¶ç«¯ä¼ å›å‘é€ç«¯æ‰€å‘é€çš„SYNæ˜¯ä¸ºäº†å‘Šè¯‰å‘é€ç«¯ï¼Œæˆ‘æ¥æ”¶åˆ°çš„ä¿¡æ¯ç¡®å®å°±æ˜¯ä½ æ‰€å‘é€çš„ä¿¡å·ã€‚</p><h4 id="ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹å‘¢ï¼Ÿä¸¤æ¬¡ä¸è¡Œå—ï¼Ÿä¸ºå•¥è¿˜è¦ä¼ å›ACK"><a href="#ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹å‘¢ï¼Ÿä¸¤æ¬¡ä¸è¡Œå—ï¼Ÿä¸ºå•¥è¿˜è¦ä¼ å›ACK" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹å‘¢ï¼Ÿä¸¤æ¬¡ä¸è¡Œå—ï¼Ÿä¸ºå•¥è¿˜è¦ä¼ å›ACK"></a>ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹å‘¢ï¼Ÿä¸¤æ¬¡ä¸è¡Œå—ï¼Ÿä¸ºå•¥è¿˜è¦ä¼ å›ACK</h4><p>åŒæ–¹é€šä¿¡æ— è¯¯å¿…é¡»æ˜¯ä¸¤è€…äº’ç›¸å‘é€çš„é€šé“éƒ½æ— è¯¯ï¼Œä¼ å›SYNä»£è¡¨å‘é€æ–¹åˆ°æ¥æ”¶ç«¯çš„é€šé“æ²¡é—®é¢˜ï¼Œä½†æ˜¯æ¥æ”¶æ–¹åˆ°å‘é€æ–¹çš„é€šé“è¿˜éœ€è¦ACKä¿¡å·æ¥éªŒè¯ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201202002.png" alt="image-20201201160701690"></p><blockquote><p>ä¸€å¥è¯ï¼Œä¸»è¦é˜²æ­¢å·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡çªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡å™¨ï¼Œä»è€Œäº§ç”Ÿé”™è¯¯ã€‚</p><p>å¦‚æœä½¿ç”¨çš„æ˜¯ä¸¤æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥ï¼Œå‡è®¾æœ‰è¿™æ ·ä¸€ç§åœºæ™¯ï¼Œå®¢æˆ·ç«¯å‘é€äº†ç¬¬ä¸€ä¸ªè¯·æ±‚è¿æ¥å¹¶ä¸”æ²¡æœ‰ä¸¢å¤±ï¼Œåªæ˜¯å› ä¸ºåœ¨ç½‘ç»œç»“ç‚¹ä¸­æ»ç•™çš„æ—¶é—´å¤ªé•¿äº†ï¼Œç”±äºTCPçš„å®¢æˆ·ç«¯è¿Ÿè¿Ÿæ²¡æœ‰æ”¶åˆ°ç¡®è®¤æŠ¥æ–‡ï¼Œä»¥ä¸ºæœåŠ¡å™¨æ²¡æœ‰æ”¶åˆ°ï¼Œæ­¤æ—¶é‡æ–°å‘æœåŠ¡å™¨å‘é€è¿™æ¡æŠ¥æ–‡ï¼Œæ­¤åå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç»è¿‡ä¸¤æ¬¡æ¡æ‰‹å®Œæˆè¿æ¥ï¼Œä¼ è¾“æ•°æ®ï¼Œç„¶åå…³é—­è¿æ¥ã€‚æ­¤æ—¶æ­¤å‰æ»ç•™çš„é‚£ä¸€æ¬¡è¯·æ±‚è¿æ¥ï¼Œç½‘ç»œé€šç•…äº†åˆ°è¾¾äº†æœåŠ¡å™¨ï¼Œè¿™ä¸ªæŠ¥æ–‡æœ¬è¯¥æ˜¯å¤±æ•ˆçš„ï¼Œä½†æ˜¯ï¼Œä¸¤æ¬¡æ¡æ‰‹çš„æœºåˆ¶å°†ä¼šè®©å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å†æ¬¡å»ºç«‹è¿æ¥ï¼Œè¿™å°†å¯¼è‡´ä¸å¿…è¦çš„é”™è¯¯å’Œèµ„æºçš„æµªè´¹ã€‚</p></blockquote><h4 id="è®²ä¸€è®²SYNè¶…æ—¶ï¼Œæ´ªæ³›æ”»å‡»ï¼Œä»¥åŠè§£å†³ç­–ç•¥"><a href="#è®²ä¸€è®²SYNè¶…æ—¶ï¼Œæ´ªæ³›æ”»å‡»ï¼Œä»¥åŠè§£å†³ç­–ç•¥" class="headerlink" title="è®²ä¸€è®²SYNè¶…æ—¶ï¼Œæ´ªæ³›æ”»å‡»ï¼Œä»¥åŠè§£å†³ç­–ç•¥"></a>è®²ä¸€è®²SYNè¶…æ—¶ï¼Œæ´ªæ³›æ”»å‡»ï¼Œä»¥åŠè§£å†³ç­–ç•¥</h4><p>åœ¨ TCP çš„ä¸‰æ¬¡æ¡æ‰‹æœºåˆ¶çš„ç¬¬ä¸€æ­¥ä¸­ï¼Œå®¢æˆ·ç«¯ä¼šå‘æœåŠ¡å™¨å‘é€ SYN æŠ¥æ–‡æ®µã€‚æœåŠ¡å™¨æ¥æ”¶åˆ° SYN æŠ¥æ–‡æ®µåä¼šä¸ºè¯¥TCPåˆ†é…ç¼“å­˜å’Œå˜é‡ï¼Œå¦‚æœæ”»å‡»åˆ†å­å¤§é‡åœ°å¾€æœåŠ¡å™¨å‘é€ SYN æŠ¥æ–‡æ®µï¼ŒæœåŠ¡å™¨çš„è¿æ¥èµ„æºç»ˆå°†è¢«è€—å°½ï¼Œå¯¼è‡´å†…å­˜æº¢å‡ºæ— æ³•ç»§ç»­æœåŠ¡ã€‚</p><p>è§£å†³ç­–ç•¥ï¼šå½“æœåŠ¡å™¨æ¥å—åˆ° SYN æŠ¥æ–‡æ®µæ—¶ï¼Œä¸ç›´æ¥ä¸ºè¯¥ TCP åˆ†é…èµ„æºï¼Œè€Œåªæ˜¯æ‰“å¼€ä¸€ä¸ªåŠå¼€çš„å¥—æ¥å­—ã€‚æ¥ç€ä¼šä½¿ç”¨ SYN æŠ¥æ–‡æ®µçš„æºIdï¼Œç›®çš„Idï¼Œç«¯å£å·ä»¥åŠåªæœ‰æœåŠ¡å™¨è‡ªå·±çŸ¥é“çš„ä¸€ä¸ªç§˜å¯†å‡½æ•°ç”Ÿæˆä¸€ä¸ª cookieï¼Œå¹¶æŠŠ cookie ä½œä¸ºåºåˆ—å·å“åº”ç»™å®¢æˆ·ç«¯ã€‚</p><p>å¦‚æœå®¢æˆ·ç«¯æ˜¯æ­£å¸¸å»ºç«‹è¿æ¥ï¼Œå°†ä¼šè¿”å›ä¸€ä¸ªç¡®è®¤å­—æ®µä¸º cookie + 1 çš„æŠ¥æ–‡æ®µã€‚æ¥ä¸‹æ¥æœåŠ¡å™¨ä¼šæ ¹æ®ç¡®è®¤æŠ¥æ–‡çš„æºIdï¼Œç›®çš„Idï¼Œç«¯å£å·ä»¥åŠç§˜å¯†å‡½æ•°è®¡ç®—å‡ºä¸€ä¸ªç»“æœï¼Œå¦‚æœç»“æœçš„å€¼ + 1ç­‰äºç¡®è®¤å­—æ®µçš„å€¼ï¼Œåˆ™è¯æ˜æ˜¯åˆšåˆšè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œè¿™æ—¶å€™æ‰ä¸ºè¯¥ TCP åˆ†é…èµ„æº</p><p>è¿™æ ·ä¸€æ¥å°±ä¸ä¼šä¸ºæ¶æ„æ”»å‡»çš„ SYN æŠ¥æ–‡æ®µåˆ†é…èµ„æºç©ºé—´ï¼Œé¿å…äº†æ”»å‡»ã€‚</p><p>å¸¸è§çš„é˜²å¾¡ SYN æ”»å‡»çš„æ–¹æ³•æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p><ul><li>ç¼©çŸ­è¶…æ—¶ï¼ˆSYN Timeoutï¼‰æ—¶é—´</li><li>å¢åŠ æœ€å¤§åŠè¿æ¥æ•°(ä¹Ÿå°±æ˜¯å¤„äºSYN_RCVDçš„è¿æ¥æ•°)</li><li>è¿‡æ»¤ç½‘å…³é˜²æŠ¤</li><li>SYN cookiesæŠ€æœ¯</li></ul><h4 id="è®²ä¸€è®²æ–­å¼€TCPè¿æ¥çš„å››æ¬¡æŒ¥æ‰‹"><a href="#è®²ä¸€è®²æ–­å¼€TCPè¿æ¥çš„å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="è®²ä¸€è®²æ–­å¼€TCPè¿æ¥çš„å››æ¬¡æŒ¥æ‰‹"></a>è®²ä¸€è®²æ–­å¼€TCPè¿æ¥çš„å››æ¬¡æŒ¥æ‰‹</h4><p>TCP çš„è¿æ¥çš„æ‹†é™¤éœ€è¦å‘é€å››ä¸ªåŒ…ï¼Œå› æ­¤ç§°ä¸ºå››æ¬¡æŒ¥æ‰‹(Four-way handshake)ï¼Œä¹Ÿå«åšæ”¹è¿›çš„ä¸‰æ¬¡æ¡æ‰‹ã€‚<strong>å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨å‡å¯ä¸»åŠ¨å‘èµ·æŒ¥æ‰‹åŠ¨ä½œ</strong>ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/640" alt="img"></p><ul><li><p>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹(FIN=1ï¼Œseq=x)</p><p>ä¸»æœº1ï¼ˆå¯ä»¥ä½¿å®¢æˆ·ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯æœåŠ¡å™¨ç«¯ï¼‰ï¼Œè®¾ç½®seq=xï¼Œå‘ä¸»æœº2å‘é€ä¸€ä¸ªFINæŠ¥æ–‡æ®µï¼›æ­¤æ—¶ï¼Œä¸»æœº1è¿›å…¥<code>FIN_WAIT_1</code>çŠ¶æ€ï¼›è¿™è¡¨ç¤ºä¸»æœº1æ²¡æœ‰æ•°æ®è¦å‘é€ç»™ä¸»æœº2äº†ï¼›</p></li><li><p>ç¬¬äºŒæ¬¡æŒ¥æ‰‹(ACK=1ï¼ŒACKnum=x+1)</p><p>ä¸»æœº2æ”¶åˆ°äº†ä¸»æœº1å‘é€çš„FINæŠ¥æ–‡æ®µï¼Œå‘ä¸»æœº1å›ä¸€ä¸ªACKæŠ¥æ–‡æ®µï¼ŒAcknnum=x+1ï¼Œä¸»æœº1è¿›å…¥<code>FIN_WAIT_2</code>çŠ¶æ€ï¼›ä¸»æœº2å‘Šè¯‰ä¸»æœº1ï¼Œæˆ‘â€œåŒæ„â€ä½ çš„å…³é—­è¯·æ±‚ï¼›</p></li><li><p>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹(FIN=1ï¼Œseq=y)</p><p>ä¸»æœº2å‘ä¸»æœº1å‘é€FINæŠ¥æ–‡æ®µï¼Œè¯·æ±‚å…³é—­è¿æ¥ï¼ŒåŒæ—¶ä¸»æœº2è¿›å…¥<code>LAST_ACK</code> çŠ¶æ€</p></li><li><p>ç¬¬å››æ¬¡æŒ¥æ‰‹(ACK=1ï¼ŒACKnum=y+1)</p><p>ä¸»æœº1æ”¶åˆ°ä¸»æœº2å‘é€çš„FINæŠ¥æ–‡æ®µï¼Œå‘ä¸»æœº2å‘é€ACKæŠ¥æ–‡æ®µï¼Œç„¶åä¸»æœº1è¿›å…¥<code>TIME_WAIT</code>çŠ¶æ€ï¼›ä¸»æœº2æ”¶åˆ°ä¸»æœº1çš„ACKæŠ¥æ–‡æ®µä»¥åï¼Œå°±å…³é—­è¿æ¥ï¼›æ­¤æ—¶ï¼Œ<strong>ä¸»æœº1ç­‰å¾…2MSLåä¾ç„¶æ²¡æœ‰æ”¶åˆ°å›å¤</strong>ï¼Œåˆ™è¯æ˜Serverç«¯å·²æ­£å¸¸å…³é—­ï¼Œé‚£å¥½ï¼Œä¸»æœº1ä¹Ÿå¯ä»¥å…³é—­è¿æ¥äº†ï¼Œè¿›å…¥ <code>CLOSED</code> çŠ¶æ€ã€‚</p><p>ä¸»æœº 1 ç­‰å¾…äº†æŸä¸ªå›ºå®šæ—¶é—´ï¼ˆä¸¤ä¸ªæœ€å¤§æ®µç”Ÿå‘½å‘¨æœŸï¼Œ2MSLï¼Œ2 Maximum Segment Lifetimeï¼‰ä¹‹åï¼Œæ²¡æœ‰æ”¶åˆ°æœåŠ¡å™¨ç«¯çš„ ACK ï¼Œè®¤ä¸ºæœåŠ¡å™¨ç«¯å·²ç»æ­£å¸¸å…³é—­è¿æ¥ï¼Œäºæ˜¯è‡ªå·±ä¹Ÿå…³é—­è¿æ¥ï¼Œè¿›å…¥ <code>CLOSED</code> çŠ¶æ€ã€‚</p></li></ul><h4 id="æœåŠ¡å™¨å‡ºç°äº†å¤§é‡CLOSE-WAITçŠ¶æ€å¦‚ä½•è§£å†³"><a href="#æœåŠ¡å™¨å‡ºç°äº†å¤§é‡CLOSE-WAITçŠ¶æ€å¦‚ä½•è§£å†³" class="headerlink" title="æœåŠ¡å™¨å‡ºç°äº†å¤§é‡CLOSE_WAITçŠ¶æ€å¦‚ä½•è§£å†³"></a>æœåŠ¡å™¨å‡ºç°äº†å¤§é‡CLOSE_WAITçŠ¶æ€å¦‚ä½•è§£å†³</h4><p>å¤§é‡ <code>CLOSE_WAIT</code> è¡¨ç¤ºç¨‹åºå‡ºç°äº†é—®é¢˜ï¼Œå¯¹æ–¹çš„ socket å·²ç»å…³é—­è¿æ¥ï¼Œè€Œæˆ‘æ–¹å¿™äºè¯»æˆ–å†™æ²¡æœ‰åŠæ—¶å…³é—­è¿æ¥ï¼Œéœ€è¦æ£€æŸ¥ä»£ç ï¼Œç‰¹åˆ«æ˜¯é‡Šæ”¾èµ„æºçš„ä»£ç ï¼Œæˆ–è€…æ˜¯å¤„ç†è¯·æ±‚çš„çº¿ç¨‹é…ç½®ã€‚</p><h4 id="ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¿æ¥çš„æ—¶å€™æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œå…³é—­çš„æ—¶å€™å´æ˜¯å››æ¬¡æ¡æ‰‹ï¼Ÿ</h4><p>å› ä¸ºå½“Serverç«¯æ”¶åˆ°Clientç«¯çš„SYNè¿æ¥è¯·æ±‚æŠ¥æ–‡åï¼Œå¯ä»¥ç›´æ¥å‘é€SYN+ACKæŠ¥æ–‡ã€‚å…¶ä¸­ACKæŠ¥æ–‡æ˜¯ç”¨æ¥åº”ç­”çš„ï¼ŒSYNæŠ¥æ–‡æ˜¯ç”¨æ¥åŒæ­¥çš„ã€‚ä½†æ˜¯å…³é—­è¿æ¥æ—¶ï¼Œå½“Serverç«¯æ”¶åˆ°FINæŠ¥æ–‡æ—¶ï¼Œå¾ˆå¯èƒ½å¹¶ä¸ä¼šç«‹å³å…³é—­SOCKETï¼Œæ‰€ä»¥åªèƒ½å…ˆå›å¤ä¸€ä¸ªACKæŠ¥æ–‡ï¼Œå‘Šè¯‰Clientç«¯ï¼Œâ€ä½ å‘çš„FINæŠ¥æ–‡æˆ‘æ”¶åˆ°äº†â€ã€‚åªæœ‰ç­‰åˆ°æˆ‘Serverç«¯æ‰€æœ‰çš„æŠ¥æ–‡éƒ½å‘é€å®Œäº†ï¼Œæˆ‘æ‰èƒ½å‘é€FINæŠ¥æ–‡ï¼Œå› æ­¤ä¸èƒ½ä¸€èµ·å‘é€ã€‚æ•…éœ€è¦å››æ­¥æ¡æ‰‹ã€‚</p><p>ç”±äº TCP åè®®æ˜¯å…¨åŒå·¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥å‘èµ·æ–­å¼€è¿æ¥ã€‚ä¸¤è¾¹å„å‘èµ·ä¸€æ¬¡æ–­å¼€è¿æ¥çš„ç”³è¯·ï¼ŒåŠ ä¸Šå„è‡ªçš„ä¸¤æ¬¡ç¡®è®¤ï¼Œçœ‹èµ·æ¥å°±åƒæ‰§è¡Œäº†å››æ¬¡æŒ¥æ‰‹ã€‚</p><blockquote><p>ä¸¾ä¾‹ï¼šAå’ŒBæ‰“ç”µè¯ï¼Œé€šè¯å³å°†ç»“æŸåï¼ŒAè¯´â€œæˆ‘æ²¡å•¥è¯´çš„äº†â€ï¼ŒBå›ç­”â€œæˆ‘çŸ¥é“äº†â€ï¼Œä½†æ˜¯Bå¯èƒ½è¿˜æœ‰è¦è¯´çš„ï¼ŒAä¸èƒ½è¦æ±‚Bè·Ÿç€è‡ªå·±çš„èŠ‚å¥ç»“æŸé€šè¯ï¼Œäºæ˜¯Bå¯èƒ½åˆè¯´äº†ä¸€é€šï¼Œæœ€åBè¯´â€œæˆ‘è¯´å®Œäº†â€ï¼ŒAå›ç­”â€œæˆ‘çŸ¥é“äº†â€ï¼Œè¿™æ ·é€šè¯æ‰ç»“æŸ</p></blockquote><h4 id="ä¸ºä»€ä¹ˆTIME-WAITçŠ¶æ€éœ€è¦ç»è¿‡2MSL-æœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´-æ‰èƒ½è¿”å›åˆ°CLOSEçŠ¶æ€ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆTIME-WAITçŠ¶æ€éœ€è¦ç»è¿‡2MSL-æœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´-æ‰èƒ½è¿”å›åˆ°CLOSEçŠ¶æ€ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆTIME_WAITçŠ¶æ€éœ€è¦ç»è¿‡2MSL(æœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´)æ‰èƒ½è¿”å›åˆ°CLOSEçŠ¶æ€ï¼Ÿ"></a>ä¸ºä»€ä¹ˆTIME_WAITçŠ¶æ€éœ€è¦ç»è¿‡2MSL(æœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´)æ‰èƒ½è¿”å›åˆ°CLOSEçŠ¶æ€ï¼Ÿ</h4><p>è™½ç„¶æŒ‰é“ç†ï¼Œå››ä¸ªæŠ¥æ–‡éƒ½å‘é€å®Œæ¯•ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›å…¥CLOSEçŠ¶æ€äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å¿…é¡»å‡è±¡ç½‘ç»œæ˜¯ä¸å¯é çš„ï¼Œæœ‰å¯ä»¥æœ€åä¸€ä¸ªACKä¸¢å¤±ã€‚è¿™æ ·å¯è®©TCPå†æ¬¡å‘é€æœ€åçš„ACKä»¥é˜²è¿™ä¸ªACKä¸¢å¤±ï¼ˆå¦ä¸€ç«¯è¶…æ—¶å¹¶é‡å‘æœ€åçš„FINï¼‰ã€‚å‡è®¾å®¢æˆ·ç«¯ä¸ç­‰å¾…2MSLï¼Œè€Œæ˜¯åœ¨å‘é€å®ŒACKä¹‹åç›´æ¥é‡Šæ”¾å…³é—­ï¼Œä¸€ä½†è¿™ä¸ªACKä¸¢å¤±çš„è¯ï¼ŒæœåŠ¡å™¨å°±æ— æ³•æ­£å¸¸çš„è¿›å…¥å…³é—­è¿æ¥çŠ¶æ€ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œä¸¤ç‚¹åŸå› ï¼š</p><ul><li><p>ä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ªACKæŠ¥æ–‡æ®µèƒ½å¤Ÿåˆ°è¾¾æœåŠ¡ç«¯ã€‚</p></li><li><p>é˜²æ­¢â€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€å‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªåŸå› ï¼Œé˜²æ­¢ç±»ä¼¼ä¸â€œä¸‰æ¬¡æ¡æ‰‹â€ä¸­æåˆ°äº†çš„â€œå·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€å‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚å®¢æˆ·ç«¯å‘é€å®Œæœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡åï¼Œåœ¨è¿™ä¸ª2MSLæ—¶é—´ä¸­ï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ã€‚è¿™æ ·æ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°æ—§è¿æ¥çš„è¯·æ±‚æŠ¥æ–‡ã€‚</p></li></ul><h2 id="smile-TCPåè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§"><a href="#smile-TCPåè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§" class="headerlink" title=":smile: TCPåè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8">ğŸ˜„</span> TCPåè®®å¦‚ä½•æ¥ä¿è¯ä¼ è¾“çš„å¯é æ€§</h2><p>å¯¹äºå¯é æ€§ï¼ŒTCPé€šè¿‡ä»¥ä¸‹æ–¹å¼è¿›è¡Œä¿è¯ï¼š</p><ul><li>æ•°æ®åŒ…æ ¡éªŒï¼š<strong>ç›®çš„æ˜¯æ£€æµ‹æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­çš„ä»»ä½•å˜åŒ–</strong>ï¼Œè‹¥æ ¡éªŒå‡ºåŒ…æœ‰é”™ï¼Œåˆ™ä¸¢å¼ƒæŠ¥æ–‡æ®µå¹¶ä¸”ä¸ç»™å‡ºå“åº”ï¼Œè¿™æ—¶TCPå‘é€æ•°æ®ç«¯è¶…æ—¶åä¼šé‡å‘æ•°æ®ï¼›</li><li>ä¸¢å¼ƒé‡å¤æ•°æ®ï¼šå¯¹äºé‡å¤æ•°æ®ï¼Œèƒ½å¤Ÿä¸¢å¼ƒé‡å¤æ•°æ®ï¼›</li><li>ç¡®è®¤åº”ç­”ä¸åºåˆ—å·ï¼šå½“TCPæ”¶åˆ°å‘è‡ªTCPè¿æ¥å¦ä¸€ç«¯çš„æ•°æ®ï¼Œå®ƒå°†å‘é€ä¸€ä¸ªç¡®è®¤ï¼Œä¹Ÿå°±æ˜¯ACKæŠ¥æ–‡ï¼Œè¿™ä¸ªACKæŠ¥æ–‡å½“ä¸­å¸¦æœ‰å¯¹åº”çš„<strong>ç¡®è®¤åºåˆ—å·</strong>ï¼Œå‘Šè¯‰å‘é€æ–¹ï¼Œæ¥æ”¶åˆ°äº†å“ªäº›æ•°æ®ï¼Œä¸‹ä¸€æ¬¡çš„æ•°æ®ä»å“ªé‡Œå‘ã€‚åºåˆ—å·çš„ä½œç”¨ä¸ä»…ä»…æ˜¯åº”ç­”çš„ä½œç”¨ï¼Œæœ‰äº†åºåˆ—å·èƒ½å¤Ÿ**å°†æ¥æ”¶åˆ°çš„æ•°æ®æ ¹æ®åºåˆ—å·æ’åºï¼Œå¹¶ä¸”å»æ‰é‡å¤åºåˆ—å·çš„æ•°æ®ã€‚è¿™ä¹Ÿæ˜¯TCPä¼ è¾“å¯é æ€§çš„ä¿è¯ä¹‹ä¸€ã€‚</li><li>è¶…æ—¶é‡å‘ï¼šå½“TCPå‘å‡ºä¸€ä¸ªæ®µåï¼Œå®ƒå¯åŠ¨ä¸€ä¸ªå®šæ—¶å™¨ï¼Œç­‰å¾…ç›®çš„ç«¯ç¡®è®¤æ”¶åˆ°è¿™ä¸ªæŠ¥æ–‡æ®µã€‚å¦‚æœä¸èƒ½åŠæ—¶æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°†é‡å‘è¿™ä¸ªæŠ¥æ–‡æ®µï¼›</li><li>æµé‡æ§åˆ¶ï¼šTCPè¿æ¥çš„æ¯ä¸€æ–¹éƒ½æœ‰å›ºå®šå¤§å°çš„ç¼“å†²ç©ºé—´ã€‚TCPçš„æ¥æ”¶ç«¯åªå…è®¸å¦ä¸€ç«¯å‘é€æ¥æ”¶ç«¯ç¼“å†²åŒºæ‰€èƒ½æ¥çº³çš„æ•°æ®ï¼Œè¿™å¯ä»¥é˜²æ­¢è¾ƒå¿«ä¸»æœºè‡´ä½¿è¾ƒæ…¢ä¸»æœºçš„ç¼“å†²åŒºæº¢å‡ºï¼Œè¿™å°±æ˜¯æµé‡æ§åˆ¶ã€‚TCPä½¿ç”¨çš„æµé‡æ§åˆ¶åè®®æ˜¯å¯å˜å¤§å°çš„æ»‘åŠ¨çª—å£åè®®ã€‚</li></ul><h2 id="smile-è¯¦ç»†è®²ä¸€ä¸‹TCPçš„æ»‘åŠ¨çª—å£ï¼ŸçŸ¥é“æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶å—ï¼Ÿ"><a href="#smile-è¯¦ç»†è®²ä¸€ä¸‹TCPçš„æ»‘åŠ¨çª—å£ï¼ŸçŸ¥é“æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶å—ï¼Ÿ" class="headerlink" title=":smile: è¯¦ç»†è®²ä¸€ä¸‹TCPçš„æ»‘åŠ¨çª—å£ï¼ŸçŸ¥é“æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶å—ï¼Ÿ"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png?v8">ğŸ˜„</span> è¯¦ç»†è®²ä¸€ä¸‹TCPçš„æ»‘åŠ¨çª—å£ï¼ŸçŸ¥é“æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶å—ï¼Ÿ</h2><p>å¦‚æœå‘é€æ–¹æŠŠæ•°æ®å‘é€å¾—è¿‡å¿«ï¼Œæ¥æ”¶æ–¹å¯èƒ½ä¼šæ¥ä¸åŠæ¥æ”¶ï¼Œè¿™å°±ä¼šé€ æˆæ•°æ®çš„ä¸¢å¤±ã€‚æ‰€è°“<strong>æµé‡æ§åˆ¶</strong>å°±æ˜¯è®©å‘é€æ–¹çš„å‘é€é€Ÿç‡ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚</p><p>åˆ©ç”¨<strong>æ»‘åŠ¨çª—å£æœºåˆ¶</strong>å¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨TCPè¿æ¥ä¸Šå®ç°å¯¹å‘é€æ–¹çš„æµé‡æ§åˆ¶ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201202001.png" alt="img"></p><p>ä»ä¸Šé¢çš„å›¾å¯ä»¥çœ‹åˆ°æ»‘åŠ¨çª—å£å·¦è¾¹çš„æ˜¯å·²å‘é€å¹¶ä¸”è¢«ç¡®è®¤çš„åˆ†ç»„ï¼Œæ»‘åŠ¨çª—å£å³è¾¹æ˜¯è¿˜æ²¡æœ‰è½®åˆ°çš„åˆ†ç»„ã€‚æ»‘åŠ¨çª—å£é‡Œé¢ä¹Ÿåˆ†ä¸ºä¸¤å—ï¼Œä¸€å—æ˜¯å·²ç»å‘é€ä½†æ˜¯æœªè¢«ç¡®è®¤çš„åˆ†ç»„ï¼Œå¦ä¸€å—æ˜¯çª—å£å†…ç­‰å¾…å‘é€çš„åˆ†ç»„ã€‚éšç€å·²å‘é€çš„åˆ†ç»„ä¸æ–­è¢«ç¡®è®¤ï¼Œçª—å£å†…ç­‰å¾…å‘é€çš„åˆ†ç»„ä¹Ÿä¼šä¸æ–­è¢«å‘é€ã€‚æ•´ä¸ªçª—å£å°±ä¼šå¾€å³ç§»åŠ¨ï¼Œè®©è¿˜æ²¡è½®åˆ°çš„åˆ†ç»„è¿›å…¥çª—å£å†…ã€‚</p><p><strong>å¯ä»¥çœ‹åˆ°æ»‘åŠ¨çª—å£èµ·åˆ°äº†ä¸€ä¸ªé™æµçš„ä½œç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‰æ»‘åŠ¨çª—å£çš„å¤§å°å†³å®šäº†å½“å‰ TCP å‘é€åŒ…çš„é€Ÿç‡ï¼Œè€Œæ»‘åŠ¨çª—å£çš„å¤§å°å–å†³äºæ‹¥å¡æ§åˆ¶çª—å£å’Œæµé‡æ§åˆ¶çª—å£çš„ä¸¤è€…é—´çš„æœ€å°å€¼ã€‚</strong></p><h4 id="æµé‡æ§åˆ¶"><a href="#æµé‡æ§åˆ¶" class="headerlink" title="æµé‡æ§åˆ¶"></a>æµé‡æ§åˆ¶</h4><p>TCP æ˜¯å…¨åŒå·¥çš„ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‡å¯ä½œä¸ºå‘é€æ–¹æˆ–æ¥æ”¶æ–¹ï¼Œæˆ‘ä»¬ç°åœ¨å‡è®¾ä¸€ä¸ªå‘é€æ–¹å‘æ¥æ”¶æ–¹å‘é€æ•°æ®çš„åœºæ™¯æ¥è®²è§£æµé‡æ§åˆ¶ã€‚é¦–å…ˆæˆ‘ä»¬çš„æ¥æ”¶æ–¹æœ‰ä¸€å—æ¥æ”¶ç¼“å­˜ï¼Œå½“æ•°æ®æ¥åˆ°æ—¶ä¼šå…ˆæŠŠæ•°æ®æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œä¸Šå±‚åº”ç”¨ç­‰ç¼“å­˜ä¸­æœ‰æ•°æ®æ—¶å°±ä¼šåˆ°ç¼“å­˜ä¸­å–æ•°æ®ã€‚å‡å¦‚å‘é€æ–¹æ²¡æœ‰é™åˆ¶åœ°ä¸æ–­åœ°å‘æ¥æ”¶æ–¹å‘é€æ•°æ®ï¼Œæ¥æ”¶æ–¹çš„åº”ç”¨ç¨‹åºåˆæ²¡æœ‰åŠæ—¶æŠŠæ¥æ”¶ç¼“å­˜ä¸­çš„æ•°æ®è¯»èµ°ï¼Œå°±ä¼šå‡ºç°ç¼“å­˜æº¢å‡ºï¼Œæ•°æ®ä¸¢å¤±çš„ç°è±¡ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¼•å…¥æµé‡æ§åˆ¶çª—å£ã€‚</p><p>å‡è®¾åº”ç”¨ç¨‹åºæœ€åè¯»èµ°çš„æ•°æ®åºå·æ˜¯ <code>lastByteRead</code>ï¼Œæ¥æ”¶ç¼“å­˜ä¸­æ¥æ”¶åˆ°çš„æœ€åä¸€ä¸ªæ•°æ®åºå·æ˜¯ <code>lastByteRcv</code>ï¼Œæ¥æ”¶ç¼“å­˜çš„å¤§å°ä¸º <code>RcvSize</code>ï¼Œé‚£ä¹ˆå¿…é¡»è¦æ»¡è¶³ <code>lastByteRcv - lastByteRead &lt;= RcvSize</code> æ‰èƒ½ä¿è¯æ¥æ”¶ç¼“å­˜ä¸ä¼šæº¢å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰æµé‡çª—å£ä¸ºæ¥æ”¶ç¼“å­˜å‰©ä½™çš„ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯<code>Rcv = RcvSize - (lastByteRcv - lastByteRead)</code>ã€‚åªè¦æ¥æ”¶æ–¹åœ¨å“åº” ACK çš„æ—¶å€™æŠŠè¿™ä¸ªçª—å£çš„å€¼å¸¦ç»™å‘é€æ–¹ï¼Œå‘é€æ–¹å°±èƒ½çŸ¥é“æ¥æ”¶æ–¹çš„æ¥æ”¶ç¼“å­˜è¿˜æœ‰å¤šå¤§çš„ç©ºé—´ï¼Œè¿›è€Œè®¾ç½®æ»‘åŠ¨çª—å£çš„å¤§å°ã€‚</p><h4 id="æ‹¥å¡å¤„ç†"><a href="#æ‹¥å¡å¤„ç†" class="headerlink" title="æ‹¥å¡å¤„ç†"></a>æ‹¥å¡å¤„ç†</h4><p>è®¡ç®—æœºç½‘ç»œä¸­çš„å¸¦å®½ã€äº¤æ¢ç»“ç‚¹ä¸­çš„ç¼“å­˜åŠå¤„ç†æœºç­‰éƒ½æ˜¯ç½‘ç»œçš„èµ„æºã€‚åœ¨æŸæ®µæ—¶é—´ï¼Œè‹¥å¯¹ç½‘ç»œä¸­æŸä¸€èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†è¯¥èµ„æºæ‰€èƒ½æä¾›çš„å¯ç”¨éƒ¨åˆ†ï¼Œç½‘ç»œçš„æ€§èƒ½å°±ä¼šå˜åï¼Œè¿™ç§æƒ…å†µå°±å«åšæ‹¥å¡ã€‚æ‹¥å¡æ§åˆ¶å°±æ˜¯é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥ç½‘ç»œä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚æ³¨æ„ï¼Œ<strong>æ‹¥å¡æ§åˆ¶å’Œæµé‡æ§åˆ¶ä¸åŒ</strong>ï¼Œå‰è€…æ˜¯ä¸€ä¸ªå…¨å±€æ€§çš„è¿‡ç¨‹ï¼Œè€Œåè€…æŒ‡ç‚¹å¯¹ç‚¹é€šä¿¡é‡çš„æ§åˆ¶ã€‚æ‹¥å¡æ§åˆ¶çš„æ–¹æ³•ä¸»è¦æœ‰ä»¥ä¸‹å››ç§ï¼š</p><blockquote><p>ä¸ºäº†é˜²æ­¢æ‹¥å¡çª—å£ <code>cwnd</code> å¢é•¿è¿‡å¤§è€Œå¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œè®¾ç½®ä¸€ä¸ªæ…¢å¼€å§‹é—¨é™<code>ssthresh</code>ã€‚</p><p>1.å½“ <code>cwnd&lt;ssthresh</code>ï¼Œä½¿ç”¨ä¸‹è¿°çš„æ…¢å¼€å§‹ç®—æ³•</p><p>2.å½“ <code>cwnd&gt;ssthresh</code>ï¼Œåœæ­¢ä½¿ç”¨æ…¢å¼€å§‹ï¼Œä½¿ç”¨æ‹¥å¡é¿å…ç®—æ³•</p><p>3.å½“ <code>cwnd==ssthresh</code>ï¼Œä¸¤è€…éƒ½å¯ä»¥ä½¿ç”¨</p></blockquote><ol><li>æ…¢å¯åŠ¨ï¼šä¸è¦ä¸€å¼€å§‹å°±å‘é€å¤§é‡çš„æ•°æ®ï¼Œå…ˆæ¢æµ‹ä¸€ä¸‹ç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ç”±å°åˆ°å¤§é€æ¸å¢åŠ æ‹¥å¡çª—å£çš„å¤§å°; å¼€å§‹æ—¶å‘é€æ–¹(æ‹¥å¡çª—å£)<code>cwnd=1</code> ï¼Œæ¯ç»è¿‡ä¸€ä¸ªä¼ è¾“ä¼¦æ¬¡ï¼ˆRTTæ—¶é—´ï¼‰ï¼Œ<code>cwnd</code>åŠ å€ã€‚</li><li>æ‹¥å¡é¿å…ï¼šæ‹¥å¡é¿å…ç®—æ³•è®©æ‹¥å¡çª—å£ç¼“æ…¢å¢é•¿ï¼Œå³æ¯ç»è¿‡ä¸€ä¸ªå¾€è¿”æ—¶é—´RTTå°±æŠŠå‘é€æ–¹çš„æ‹¥å¡çª—å£ <code>cwnd</code> åŠ 1ï¼Œè€Œä¸æ˜¯åŠ å€ï¼Œè¿™æ ·æ‹¥å¡çª—å£æŒ‰çº¿æ€§è§„å¾‹ç¼“æ…¢å¢é•¿ã€‚</li><li>å¿«é‡ä¼ ï¼šå¿«é‡ä¼ è¦æ±‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°ä¸€ä¸ª å¤±åºçš„æŠ¥æ–‡æ®µ åå°±ç«‹å³å‘å‡º é‡å¤ç¡®è®¤ï¼ˆä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹ï¼‰è€Œä¸è¦ç­‰åˆ°è‡ªå·±å‘é€æ•°æ®æ—¶æå¸¦ç¡®è®¤ã€‚å¿«é‡ä¼ ç®—æ³•è§„å®šï¼Œå‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸã€‚</li><li>å¿«æ¢å¤ï¼šå¿«é‡ä¼ é…åˆä½¿ç”¨çš„è¿˜æœ‰å¿«æ¢å¤ç®—æ³•ï¼Œ1. å½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œâ€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠ <code>ssthresh</code> é—¨é™å‡åŠï¼Œ2. ç”±äºå‘é€æ–¹å¯èƒ½è®¤ä¸ºç½‘ç»œç°åœ¨æ²¡æœ‰æ‹¥å¡ï¼Œå› æ­¤ä¸æ…¢å¼€å§‹ä¸åŒï¼ŒæŠŠ<code>cwnd</code>å€¼è®¾ç½®ä¸º<code>ssthresh</code>å‡åŠä¹‹åçš„å€¼ï¼Œç„¶åæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ï¼Œçº¿æ€§å¢å¤§<code>cwnd</code></li></ol><blockquote><p>æ€»ç»“ï¼šæ‹¥å¡æ§åˆ¶æ˜¯æŒ‡å‘é€æ–¹å…ˆè®¾ç½®ä¸€ä¸ªå°çš„çª—å£å€¼ä½œä¸ºå‘é€é€Ÿç‡ï¼Œå½“æˆåŠŸå‘åŒ…å¹¶æ¥æ”¶åˆ°ACKæ—¶ï¼Œä¾¿ä»¥æŒ‡æ•°é€Ÿç‡å¢å¤§å‘é€çª—å£çš„å¤§å°ï¼Œç›´åˆ°é‡åˆ°ä¸¢åŒ…ï¼ˆè¶…æ—¶/ä¸‰ä¸ªå†—ä½™ACKï¼‰ï¼Œæ‰åœæ­¢å¹¶è°ƒæ•´çª—å£çš„å¤§å°ã€‚è¿™ä¹ˆåšèƒ½æœ€å¤§é™åº¦åœ°åˆ©ç”¨å¸¦å®½ï¼Œåˆä¸è‡³äºè®©ç½‘ç»œç¯å¢ƒå˜å¾—å¤ªè¿‡æ‹¥æŒ¤ã€‚</p><p>æœ€ç»ˆæ»‘åŠ¨çª—å£çš„å€¼å°†è®¾ç½®ä¸ºæµé‡æ§åˆ¶çª—å£å’Œæ‹¥å¡æ§åˆ¶çª—å£ä¸­çš„è¾ƒå°å€¼ã€‚</p></blockquote><h2 id="heart-eyes-URI-å’Œ-URLçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#heart-eyes-URI-å’Œ-URLçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title=":heart_eyes: URI å’Œ URLçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8">ğŸ˜</span> URI å’Œ URLçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><code>ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼ˆUniform Resource Identifier,URIï¼‰</code>:æ¯ä¸ªWeb æœåŠ¡å™¨èµ„æºéƒ½æœ‰ä¸€ä¸ªåå­—ï¼Œè¿™æ ·å®¢æˆ·ç«¯å°±å¯ä»¥è¯´æ˜ä»–ä»¬æ„Ÿå…´è¶£çš„èµ„æºæ˜¯ä»€ä¹ˆäº†ï¼ŒæœåŠ¡å™¨èµ„æºåè¢«ç§°ä¸ºã€‚URI å°±åƒå› ç‰¹ç½‘ä¸Šçš„é‚®æ”¿åœ°å€ä¸€æ ·ï¼Œåœ¨ä¸–ç•ŒèŒƒå›´å†…å”¯ä¸€æ ‡è¯†å¹¶å®šä½ä¿¡æ¯èµ„æºã€‚</p><p><code>ç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼ˆURLï¼‰</code>: æ˜¯èµ„æºæ ‡è¯†ç¬¦æœ€å¸¸è§çš„å½¢å¼ã€‚URL æè¿°äº†ä¸€å°ç‰¹å®šæœåŠ¡å™¨ä¸ŠæŸèµ„æºçš„ç‰¹å®šä½ç½®ã€‚</p><p>URLæ˜¯ä¸€ç§æ›´åŠ å…·ä½“çš„URI ï¼Œä¸ä»…åŒ…å«å”¯ä¸€æ ‡è¯†èµ„æºã€‚ä¹ŸåŒ…å«å®šä½è¯¥èµ„æºçš„ä¿¡æ¯ã€‚</p><h2 id="heart-eyes-HTTP1-0ã€HTTP1-1çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#heart-eyes-HTTP1-0ã€HTTP1-1çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title=":heart_eyes: HTTP1.0ã€HTTP1.1çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8">ğŸ˜</span> HTTP1.0ã€HTTP1.1çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>HTTP1.0 æœ€æ—©åœ¨ç½‘é¡µä¸­ä½¿ç”¨æ˜¯åœ¨1996å¹´ï¼Œé‚£ä¸ªæ—¶å€™åªæ˜¯ä½¿ç”¨ä¸€äº›è¾ƒä¸ºç®€å•çš„ç½‘é¡µä¸Šå’Œç½‘ç»œè¯·æ±‚ä¸Šï¼Œè€ŒHTTP1.1åˆ™åœ¨1999å¹´æ‰å¼€å§‹å¹¿æ³›åº”ç”¨äºç°åœ¨çš„å„å¤§æµè§ˆå™¨ç½‘ç»œè¯·æ±‚ä¸­ï¼ŒåŒæ—¶HTTP1.1ä¹Ÿæ˜¯å½“å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„HTTPåè®®ã€‚ ä¸»è¦åŒºåˆ«ä¸»è¦ä½“ç°åœ¨ï¼š</p><ol><li><strong>ç¼“å­˜å¤„ç†</strong>ï¼Œåœ¨HTTP1.0ä¸­ä¸»è¦ä½¿ç”¨headeré‡Œçš„If-Modified-Since,Expiresæ¥åšä¸ºç¼“å­˜åˆ¤æ–­çš„æ ‡å‡†ï¼ŒHTTP1.1åˆ™å¼•å…¥äº†æ›´å¤šçš„ç¼“å­˜æ§åˆ¶ç­–ç•¥ä¾‹å¦‚Entity tagï¼ŒIf-Unmodified-Since, If-Match, If-None-Matchç­‰æ›´å¤šå¯ä¾›é€‰æ‹©çš„ç¼“å­˜å¤´æ¥æ§åˆ¶ç¼“å­˜ç­–ç•¥ã€‚</li><li><strong>å¸¦å®½ä¼˜åŒ–åŠç½‘ç»œè¿æ¥çš„ä½¿ç”¨</strong>ï¼ŒHTTP1.0ä¸­ï¼Œå­˜åœ¨ä¸€äº›æµªè´¹å¸¦å®½çš„ç°è±¡ï¼Œä¾‹å¦‚å®¢æˆ·ç«¯åªæ˜¯éœ€è¦æŸä¸ªå¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œè€ŒæœåŠ¡å™¨å´å°†æ•´ä¸ªå¯¹è±¡é€è¿‡æ¥äº†ï¼Œå¹¶ä¸”ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ åŠŸèƒ½ï¼ŒHTTP1.1åˆ™åœ¨è¯·æ±‚å¤´å¼•å…¥äº†rangeå¤´åŸŸï¼Œå®ƒå…è®¸åªè¯·æ±‚èµ„æºçš„æŸä¸ªéƒ¨åˆ†ï¼Œå³è¿”å›ç æ˜¯206ï¼ˆPartial Contentï¼‰ï¼Œè¿™æ ·å°±æ–¹ä¾¿äº†å¼€å‘è€…è‡ªç”±çš„é€‰æ‹©ä»¥ä¾¿äºå……åˆ†åˆ©ç”¨å¸¦å®½å’Œè¿æ¥ã€‚</li><li><strong>é”™è¯¯é€šçŸ¥çš„ç®¡ç†</strong>ï¼Œåœ¨HTTP1.1ä¸­æ–°å¢äº†24ä¸ªé”™è¯¯çŠ¶æ€å“åº”ç ï¼Œå¦‚409ï¼ˆConflictï¼‰è¡¨ç¤ºè¯·æ±‚çš„èµ„æºä¸èµ„æºçš„å½“å‰çŠ¶æ€å‘ç”Ÿå†²çªï¼›410ï¼ˆGoneï¼‰è¡¨ç¤ºæœåŠ¡å™¨ä¸Šçš„æŸä¸ªèµ„æºè¢«æ°¸ä¹…æ€§çš„åˆ é™¤ã€‚</li><li><strong>Hostå¤´å¤„ç†</strong>ï¼Œåœ¨HTTP1.0ä¸­è®¤ä¸ºæ¯å°æœåŠ¡å™¨éƒ½ç»‘å®šä¸€ä¸ªå”¯ä¸€çš„IPåœ°å€ï¼Œå› æ­¤ï¼Œè¯·æ±‚æ¶ˆæ¯ä¸­çš„URLå¹¶æ²¡æœ‰ä¼ é€’ä¸»æœºåï¼ˆhostnameï¼‰ã€‚ä½†éšç€è™šæ‹Ÿä¸»æœºæŠ€æœ¯çš„å‘å±•ï¼Œåœ¨ä¸€å°ç‰©ç†æœåŠ¡å™¨ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ªè™šæ‹Ÿä¸»æœºï¼ˆMulti-homed Web Serversï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬å…±äº«ä¸€ä¸ªIPåœ°å€ã€‚HTTP1.1çš„è¯·æ±‚æ¶ˆæ¯å’Œå“åº”æ¶ˆæ¯éƒ½åº”æ”¯æŒHostå¤´åŸŸï¼Œä¸”è¯·æ±‚æ¶ˆæ¯ä¸­å¦‚æœæ²¡æœ‰Hostå¤´åŸŸä¼šæŠ¥å‘Šä¸€ä¸ªé”™è¯¯ï¼ˆ400 Bad Requestï¼‰ã€‚</li><li><strong>é•¿è¿æ¥</strong>ï¼ŒHTTP 1.1æ”¯æŒé•¿è¿æ¥ï¼ˆPersistentConnectionï¼‰å’Œè¯·æ±‚çš„æµæ°´çº¿ï¼ˆPipeliningï¼‰å¤„ç†ï¼Œåœ¨ä¸€ä¸ªTCPè¿æ¥ä¸Šå¯ä»¥ä¼ é€å¤šä¸ªHTTPè¯·æ±‚å’Œå“åº”ï¼Œå‡å°‘äº†å»ºç«‹å’Œå…³é—­è¿æ¥çš„æ¶ˆè€—å’Œå»¶è¿Ÿï¼Œåœ¨HTTP1.1ä¸­é»˜è®¤å¼€å¯Connectionï¼š keep-aliveï¼Œä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†HTTP1.0æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ›å»ºè¿æ¥çš„ç¼ºç‚¹ã€‚</li></ol><p><strong>HTTP/2.0ï¼ˆåˆå HTTP-NGï¼‰</strong></p><ul><li>http/2å‘å¸ƒäº2015å¹´ï¼Œç›®å‰åº”ç”¨è¿˜æ¯”è¾ƒå°‘ã€‚</li><li>http/2æ˜¯ä¸€ä¸ªå½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸ºâ€å¸§â€ï¼ˆframeï¼‰ï¼šå¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚</li><li>å¤ç”¨TCPè¿æ¥ï¼Œåœ¨ä¸€ä¸ªè¿æ¥é‡Œï¼Œå®¢æˆ·ç«¯å’Œæµè§ˆå™¨éƒ½å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚æˆ–å›åº”ï¼Œä¸”ä¸ç”¨æŒ‰é¡ºåºä¸€ä¸€å¯¹åº”ï¼Œé¿å…äº†é˜Ÿå¤´å µå¡çš„é—®é¢˜,æ­¤åŒå‘çš„å®æ—¶é€šä¿¡ç§°ä¸ºå¤šå·¥ï¼ˆ Multiplexingï¼‰ã€‚</li><li>HTTP/2 å…è®¸æœåŠ¡å™¨æœªç»è¯·æ±‚ï¼Œä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘é€èµ„æºï¼Œå³æœåŠ¡å™¨æ¨é€ã€‚</li><li>å¼•å…¥å¤´ä¿¡æ¯å‹ç¼©æœºåˆ¶ï¼ˆ header compressionï¼‰ ,å¤´ä¿¡æ¯ä½¿ç”¨gzipæˆ–compresså‹ç¼©åå†å‘é€ã€‚</li></ul><h2 id="heart-eyes-åœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ç½‘å€æŒ‰å›è½¦åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"><a href="#heart-eyes-åœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ç½‘å€æŒ‰å›è½¦åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title=":heart_eyes: åœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ç½‘å€æŒ‰å›è½¦åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8">ğŸ˜</span> åœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ç½‘å€æŒ‰å›è½¦åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h2><ol><li>æµè§ˆå™¨æŸ¥è¯¢ DNSï¼Œè·å–åŸŸåå¯¹åº”çš„IPåœ°å€:å…·ä½“è¿‡ç¨‹åŒ…æ‹¬æµè§ˆå™¨æœç´¢è‡ªèº«çš„DNSç¼“å­˜ã€æœç´¢æ“ä½œç³»ç»Ÿçš„DNSç¼“å­˜ã€è¯»å–æœ¬åœ°çš„Hostæ–‡ä»¶å’Œå‘æœ¬åœ°DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ç­‰ã€‚å¯¹äºå‘æœ¬åœ°DNSæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœè¦æŸ¥è¯¢çš„åŸŸååŒ…å«åœ¨æœ¬åœ°é…ç½®åŒºåŸŸèµ„æºä¸­ï¼Œåˆ™è¿”å›è§£æç»“æœç»™å®¢æˆ·æœºï¼Œå®ŒæˆåŸŸåè§£æ(æ­¤è§£æå…·æœ‰æƒå¨æ€§)ï¼›å¦‚æœè¦æŸ¥è¯¢çš„åŸŸåä¸ç”±æœ¬åœ°DNSæœåŠ¡å™¨åŒºåŸŸè§£æï¼Œä½†è¯¥æœåŠ¡å™¨å·²ç¼“å­˜äº†æ­¤ç½‘å€æ˜ å°„å…³ç³»ï¼Œåˆ™è°ƒç”¨è¿™ä¸ªIPåœ°å€æ˜ å°„ï¼Œå®ŒæˆåŸŸåè§£æï¼ˆæ­¤è§£æä¸å…·æœ‰æƒå¨æ€§ï¼‰ã€‚å¦‚æœæœ¬åœ°åŸŸåæœåŠ¡å™¨å¹¶æœªç¼“å­˜è¯¥ç½‘å€æ˜ å°„å…³ç³»ï¼Œé‚£ä¹ˆå°†æ ¹æ®å…¶è®¾ç½®å‘èµ·é€’å½’æŸ¥è¯¢æˆ–è€…è¿­ä»£æŸ¥è¯¢ï¼›</li><li>æµè§ˆå™¨è·å¾—åŸŸåå¯¹åº”çš„IPåœ°å€ä»¥åï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨è¯·æ±‚å»ºç«‹é“¾æ¥ï¼Œå‘èµ·ä¸‰æ¬¡æ¡æ‰‹ï¼›</li><li>TCP/IPé“¾æ¥å»ºç«‹èµ·æ¥åï¼Œæµè§ˆå™¨å‘æœåŠ¡å™¨å‘é€HTTPè¯·æ±‚ï¼›</li><li>æœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ï¼Œå¹¶æ ¹æ®è·¯å¾„å‚æ•°æ˜ å°„åˆ°ç‰¹å®šçš„è¯·æ±‚å¤„ç†å™¨è¿›è¡Œå¤„ç†ï¼Œå¹¶å°†å¤„ç†ç»“æœåŠç›¸åº”çš„è§†å›¾è¿”å›ç»™æµè§ˆå™¨ï¼›</li><li>æµè§ˆå™¨è§£æå¹¶æ¸²æŸ“è§†å›¾ï¼Œè‹¥é‡åˆ°å¯¹jsæ–‡ä»¶ã€cssæ–‡ä»¶åŠå›¾ç‰‡ç­‰é™æ€èµ„æºçš„å¼•ç”¨ï¼Œåˆ™é‡å¤ä¸Šè¿°æ­¥éª¤å¹¶å‘æœåŠ¡å™¨è¯·æ±‚è¿™äº›èµ„æºï¼›</li><li>æµè§ˆå™¨æ ¹æ®å…¶è¯·æ±‚åˆ°çš„èµ„æºã€æ•°æ®æ¸²æŸ“é¡µé¢ï¼Œæœ€ç»ˆå‘ç”¨æˆ·å‘ˆç°ä¸€ä¸ªå®Œæ•´çš„é¡µé¢ã€‚</li></ol><p><a href="https://segmentfault.com/a/1190000006879700" target="_blank" rel="noopener">https://segmentfault.com/a/1190000006879700</a></p><h2 id="heart-eyes-â€‹-å„ç§åè®®ä¸-HTTP-åè®®çš„å…³ç³»"><a href="#heart-eyes-â€‹-å„ç§åè®®ä¸-HTTP-åè®®çš„å…³ç³»" class="headerlink" title=":heart_eyes: â€‹ å„ç§åè®®ä¸ HTTP åè®®çš„å…³ç³»"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8">ğŸ˜</span> â€‹ å„ç§åè®®ä¸ HTTP åè®®çš„å…³ç³»</h2><p>åœ¨ HTTP å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æŠ¥æ–‡ä¹‹å‰ï¼Œéœ€è¦ç”¨ç½‘ç»œåè®®ï¼ˆInternet Protocolï¼ŒIPï¼‰åœ°å€å’Œç«¯å£å·åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹ä¸€æ¡ TCP/IP åè®®ã€‚è€Œ IP åœ°å€å°±æ˜¯é€šè¿‡ URL æä¾›çš„ï¼Œåƒ <code>http://207.200.21.11:80/index.html</code>ï¼Œè¿˜æœ‰ä½¿ç”¨åŸŸåæœåŠ¡ï¼ˆDomain Name Servicesï¼ŒDNSï¼‰çš„ <code>http://www.lazyegg.net</code>ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201202102813307.png" alt="image-20201202102813307"></p><h2 id="heart-eyes-HTTPå’ŒHTTPSçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#heart-eyes-HTTPå’ŒHTTPSçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title=":heart_eyes: HTTPå’ŒHTTPSçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8">ğŸ˜</span> HTTPå’ŒHTTPSçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h2><ol><li><p>ç«¯å£ä¸åŒï¼šHTTPå’ŒHTTPSä½¿ç”¨çš„æ˜¯å®Œå…¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯80ï¼Œåè€…æ˜¯443ã€‚</p></li><li><p>å®‰å…¨æ€§å’Œèµ„æºæ¶ˆè€— ï¼šHTTPåè®®è¿è¡Œåœ¨TCPä¹‹ä¸Šï¼Œæ‰€æœ‰ä¼ è¾“çš„å†…å®¹éƒ½æ˜¯æ˜æ–‡ï¼ŒHTTPSè¿è¡Œåœ¨SSL/TLSä¹‹ä¸Šï¼ŒSSL/TLSè¿è¡Œåœ¨TCPä¹‹ä¸Šï¼Œæ‰€æœ‰ä¼ è¾“çš„å†…å®¹éƒ½ç»è¿‡åŠ å¯†çš„ã€‚åŠ å¯†é‡‡ç”¨<strong>å¯¹ç§°åŠ å¯†</strong>ï¼Œä½†å¯¹ç§°åŠ å¯†çš„å¯†é’¥ç”¨æœåŠ¡å™¨æ–¹çš„è¯ä¹¦è¿›è¡Œäº†éå¯¹ç§°åŠ å¯†ã€‚æ‰€ä»¥è¯´ï¼ŒHTTPSå®‰å…¨æ€§æ¯”HTTPé«˜ï¼Œä½†æ˜¯ç›¸åHTTPSè€—è´¹æ›´å¤šçš„æœåŠ¡å™¨èµ„æº</p><ul><li>å¯¹ç§°åŠ å¯†ï¼š å¯†é’¥åªæœ‰ä¸€ä¸ªï¼ŒåŠ å¯†è§£å¯†ä¸ºåŒä¸€ä¸ªå¯†ç ï¼Œåœ¨å‘é€å¯†é’¥è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé€ æˆå¯†é’¥è¢«çªƒå–ï¼›åŠ å¯†è§£å¯†é€Ÿåº¦å¿«ï¼Œå…¸å‹çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰DESã€AESç­‰ï¼›</li><li>éå¯¹ç§°åŠ å¯†ï¼šä½¿ç”¨ä¸€å¯¹éå¯¹ç§°å¯†é’¥ã€‚ä¸€æŠŠå«ç§æœ‰å¯†é’¥ï¼Œå¦ä¸€æŠŠå«å…¬å¼€å¯†é’¥ã€‚ç§æœ‰å¯†é’¥ä¸è®©ä»»ä½•äººçŸ¥é“ï¼Œå…¬æœ‰å¯†é’¥éšæ„å‘é€ã€‚å…¬é’¥åŠ å¯†çš„ä¿¡æ¯ï¼Œåªæœ‰ç§é’¥æ‰èƒ½è§£å¯†ã€‚åŠ å¯†è§£å¯†ä½¿ç”¨ä¸åŒå¯†é’¥ï¼ˆå…¬é’¥åŠ å¯†éœ€è¦ç§é’¥è§£å¯†ï¼Œç§é’¥åŠ å¯†éœ€è¦å…¬é’¥è§£å¯†ï¼‰ç›¸å¯¹å¯¹ç§°åŠ å¯†é€Ÿåº¦è¾ƒæ…¢ï¼Œå…¸å‹çš„éå¯¹ç§°åŠ å¯†ç®—æ³•æœ‰RSAã€DSAç­‰</li></ul></li></ol><h2 id="heart-eyes-çŠ¶æ€ç "><a href="#heart-eyes-çŠ¶æ€ç " class="headerlink" title=":heart_eyes: çŠ¶æ€ç "></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8">ğŸ˜</span> çŠ¶æ€ç </h2><p>æ¯æ¡HTTPå“åº”æŠ¥æ–‡è¿”å›æ—¶éƒ½ä¼šæºå¸¦ä¸€ä¸ªçŠ¶æ€ç ã€‚çŠ¶æ€ç æ˜¯ä¸€ä¸ªä¸‰ä½æ•°å­—çš„ä»£ç ï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯è¯·æ±‚æ˜¯å¦æˆåŠŸï¼Œæˆ–è€…æ˜¯éƒ½éœ€è¦é‡‡å–å…¶ä»–åŠ¨ä½œã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201202101754474.png" alt="image-20201202101754474"></p><ul><li><strong>200 OK</strong>ï¼šè¡¨ç¤ºä»å®¢æˆ·ç«¯å‘é€ç»™æœåŠ¡å™¨çš„è¯·æ±‚è¢«æ­£å¸¸å¤„ç†å¹¶è¿”å›ï¼›</li><li><strong>204 No Content</strong>ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯å‘é€ç»™å®¢æˆ·ç«¯çš„è¯·æ±‚å¾—åˆ°äº†æˆåŠŸå¤„ç†ï¼Œä½†åœ¨è¿”å›çš„å“åº”æŠ¥æ–‡ä¸­ä¸å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ï¼ˆæ²¡æœ‰èµ„æºå¯ä»¥è¿”å›ï¼‰</li><li><strong>206 Patial Content</strong>ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ï¼Œå¹¶ä¸”æœåŠ¡å™¨æˆåŠŸæ‰§è¡Œäº†è¿™éƒ¨åˆ†çš„GETè¯·æ±‚ï¼Œå“åº”æŠ¥æ–‡ä¸­åŒ…å«ç”±Content-RangeæŒ‡å®šèŒƒå›´çš„å®ä½“å†…å®¹ã€‚</li><li><strong>301 Moved Permanently</strong>ï¼šæ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºè¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„URLï¼Œä¹‹ååº”ä½¿ç”¨æ›´æ”¹çš„URLï¼›</li><li><strong>302 Found</strong>ï¼šä¸´æ—¶æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºè¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„URLï¼Œå¸Œæœ›æœ¬æ¬¡è®¿é—®ä½¿ç”¨æ–°çš„URLï¼›</li><li><strong>303 See Other</strong>ï¼šè¡¨ç¤ºè¯·æ±‚çš„èµ„æºè¢«åˆ†é…äº†æ–°çš„URLï¼Œåº”ä½¿ç”¨GETæ–¹æ³•å®šå‘è·å–è¯·æ±‚çš„èµ„æº</li><li>304 Not Modifiedï¼šè¡¨ç¤ºå®¢æˆ·ç«¯å‘é€é™„å¸¦æ¡ä»¶ï¼ˆæ˜¯æŒ‡é‡‡ç”¨GETæ–¹æ³•çš„è¯·æ±‚æŠ¥æ–‡ä¸­åŒ…å«if-Matchã€If-Modified-Sinceã€If-None-Matchã€If-Rangeã€If-Unmodified-Sinceä¸­ä»»ä¸€é¦–éƒ¨ï¼‰çš„è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯å…è®¸è®¿é—®èµ„æºï¼Œä½†æ˜¯è¯·æ±‚ä¸ºæ»¡è¶³æ¡ä»¶çš„æƒ…å†µä¸‹è¿”å›æ”¹çŠ¶æ€ç ï¼›</li><li><strong>400 Bad Request</strong>:è¡¨ç¤ºè¯·æ±‚æŠ¥æ–‡ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯ï¼›</li><li><strong>401 Unauthorized</strong>ï¼šç»è®¸å¯ï¼Œéœ€è¦é€šè¿‡HTTPè®¤è¯ï¼›</li><li><strong>403 Forbidden</strong>ï¼šæœåŠ¡å™¨æ‹’ç»è¯¥æ¬¡è®¿é—®ï¼ˆè®¿é—®æƒé™å‡ºç°é—®é¢˜ï¼‰</li><li><strong>404 Not Found</strong>ï¼šè¡¨ç¤ºæœåŠ¡å™¨ä¸Šæ— æ³•æ‰¾åˆ°è¯·æ±‚çš„èµ„æºï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨æœåŠ¡å™¨æ‹’ç»è¯·æ±‚ä½†ä¸æƒ³ç»™æ‹’ç»åŸå› æ—¶ä½¿ç”¨ï¼›</li><li><strong>500 Inter Server Error</strong>ï¼šè¡¨ç¤ºæœåŠ¡å™¨åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯webåº”ç”¨å­˜åœ¨çš„bugæˆ–æŸäº›ä¸´æ—¶çš„é”™è¯¯æ—¶ï¼›</li><li><strong>503 Server Unavailable</strong>ï¼šè¡¨ç¤ºæœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨è¿›è¡Œåœæœºç»´æŠ¤ï¼Œæ— æ³•å¤„ç†è¯·æ±‚ï¼›</li></ul><h2 id="heart-eyes-Getä¸POSTçš„åŒºåˆ«"><a href="#heart-eyes-Getä¸POSTçš„åŒºåˆ«" class="headerlink" title=":heart_eyes: Getä¸POSTçš„åŒºåˆ«"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8">ğŸ˜</span> Getä¸POSTçš„åŒºåˆ«</h2><p>GETä¸POSTæ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ä¸¤ç§HTTP Methodï¼ŒäºŒè€…ä¹‹é—´çš„åŒºåˆ«ä¸»è¦åŒ…æ‹¬å¦‚ä¸‹äº”ä¸ªæ–¹é¢ï¼š</p><ol><li>ä»åŠŸèƒ½ä¸Šè®²ï¼ŒGETä¸€èˆ¬ç”¨æ¥ä»æœåŠ¡å™¨ä¸Šè·å–èµ„æºï¼ŒPOSTä¸€èˆ¬ç”¨æ¥æ›´æ–°æœåŠ¡å™¨ä¸Šçš„èµ„æºï¼›</li><li>ä»RESTæœåŠ¡è§’åº¦ä¸Šè¯´ï¼ŒGETæ˜¯å¹‚ç­‰çš„ï¼Œå³è¯»å–åŒä¸€ä¸ªèµ„æºï¼Œæ€»æ˜¯å¾—åˆ°ç›¸åŒçš„æ•°æ®ï¼Œè€ŒPOSTä¸æ˜¯å¹‚ç­‰çš„ï¼Œå› ä¸ºæ¯æ¬¡è¯·æ±‚å¯¹èµ„æºçš„æ”¹å˜å¹¶ä¸æ˜¯ç›¸åŒçš„ï¼›è¿›ä¸€æ­¥åœ°ï¼ŒGETä¸ä¼šæ”¹å˜æœåŠ¡å™¨ä¸Šçš„èµ„æºï¼Œè€ŒPOSTä¼šå¯¹æœåŠ¡å™¨èµ„æºè¿›è¡Œæ”¹å˜ï¼›</li><li>ä»è¯·æ±‚å‚æ•°å½¢å¼ä¸Šçœ‹ï¼ŒGETè¯·æ±‚çš„æ•°æ®ä¼šé™„åœ¨URLä¹‹åï¼Œå³å°†è¯·æ±‚æ•°æ®æ”¾ç½®åœ¨HTTPæŠ¥æ–‡çš„ è¯·æ±‚å¤´ ä¸­ï¼Œä»¥?åˆ†å‰²URLå’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥&amp;ç›¸è¿ã€‚ç‰¹åˆ«åœ°ï¼Œå¦‚æœæ•°æ®æ˜¯è‹±æ–‡å­—æ¯/æ•°å­—ï¼ŒåŸæ ·å‘é€ï¼›å¦åˆ™ï¼Œä¼šå°†å…¶ç¼–ç ä¸º application/x-www-form-urlencoded MIME å­—ç¬¦ä¸²(å¦‚æœæ˜¯ç©ºæ ¼ï¼Œè½¬æ¢ä¸º+ï¼Œå¦‚æœæ˜¯ä¸­æ–‡/å…¶ä»–å­—ç¬¦ï¼Œåˆ™ç›´æ¥æŠŠå­—ç¬¦ä¸²ç”¨BASE64åŠ å¯†ï¼Œå¾—å‡ºå¦‚ï¼š%E4%BD%A0%E5%A5%BDï¼Œå…¶ä¸­ï¼…XXä¸­çš„XXä¸ºè¯¥ç¬¦å·ä»¥16è¿›åˆ¶è¡¨ç¤ºçš„ASCII)ï¼›è€ŒPOSTè¯·æ±‚ä¼šæŠŠæäº¤çš„æ•°æ®åˆ™æ”¾ç½®åœ¨æ˜¯HTTPè¯·æ±‚æŠ¥æ–‡çš„ è¯·æ±‚ä½“ ä¸­ã€‚</li><li>å°±å®‰å…¨æ€§è€Œè¨€ï¼ŒPOSTçš„å®‰å…¨æ€§è¦æ¯”GETçš„å®‰å…¨æ€§é«˜ï¼Œå› ä¸ºGETè¯·æ±‚æäº¤çš„æ•°æ®å°†æ˜æ–‡å‡ºç°åœ¨URLä¸Šï¼Œè€Œä¸”POSTè¯·æ±‚å‚æ•°åˆ™è¢«åŒ…è£…åˆ°è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹æ›´å®‰å…¨ã€‚</li><li>ä»è¯·æ±‚çš„å¤§å°çœ‹ï¼ŒGETè¯·æ±‚çš„é•¿åº¦å—é™äºæµè§ˆå™¨æˆ–æœåŠ¡å™¨å¯¹URLé•¿åº¦çš„é™åˆ¶ï¼Œå…è®¸å‘é€çš„æ•°æ®é‡æ¯”è¾ƒå°ï¼Œè€ŒPOSTè¯·æ±‚åˆ™æ˜¯æ²¡æœ‰å¤§å°é™åˆ¶çš„ã€‚</li></ol><p>HTTPè¯·æ±‚ç»“æ„ï¼šè¯·æ±‚æ–¹å¼ + è¯·æ±‚URI + åè®®åŠå…¶ç‰ˆæœ¬</p><p>HTTPå“åº”ç»“æ„ï¼šçŠ¶æ€ç  + åŸå› çŸ­è¯­ + åè®®åŠå…¶ç‰ˆæœ¬</p><h2 id="heart-eyes-cookieå’Œsessionæœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#heart-eyes-cookieå’Œsessionæœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title=":heart_eyes: cookieå’Œsessionæœ‰ä»€ä¹ˆåŒºåˆ«?"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8">ğŸ˜</span> cookieå’Œsessionæœ‰ä»€ä¹ˆåŒºåˆ«?</h2><p>ç”±äº http åè®®æ˜¯æ— çŠ¶æ€åè®®ï¼Œå¦‚æœå®¢æˆ·é€šè¿‡æµè§ˆå™¨è®¿é—® web åº”ç”¨æ—¶æ²¡æœ‰ä¸€ä¸ªä¿å­˜ç”¨æˆ·è®¿é—®çŠ¶æ€çš„æœºåˆ¶ï¼Œé‚£ä¹ˆå°†ä¸èƒ½æŒç»­è·Ÿè¸ªåº”ç”¨çš„æ“ä½œã€‚cookieå’Œsessionéƒ½æ˜¯ç”¨æ¥è·Ÿè¸ªæµè§ˆå™¨ç”¨æˆ·èº«ä»½çš„ä¼šè¯æ–¹å¼ï¼Œä½†æ˜¯ä¸¤è€…çš„åº”ç”¨åœºæ™¯ä¸åŒã€‚</p><ul><li>cookieä¸€èˆ¬ç”¨æ¥ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œæ˜¯æµè§ˆå™¨çš„ä¸€ç§ç¼“å­˜æœºåˆ¶ã€‚æ¯”å¦‚å½“ç”¨æˆ·å¾€è´­ç‰©è½¦ä¸­æ·»åŠ äº†å•†å“ï¼Œweb åº”ç”¨å¿…é¡»åœ¨ç”¨æˆ·æµè§ˆåˆ«çš„å•†å“çš„æ—¶å€™ä»ä¿å­˜è´­ç‰©è½¦çš„çŠ¶æ€ï¼Œä»¥ä¾¿ç”¨æˆ·ç»§ç»­å¾€è´­ç‰©è½¦ä¸­æ·»åŠ å•†å“ã€‚<strong>å¼ºè°ƒcookieå°†æ•°æ®ä¿å­˜åœ¨å®¢æˆ·ç«¯</strong>ã€‚</li><li>sessionçš„ä¸»è¦ä½œç”¨æ˜¯é€šè¿‡æœåŠ¡å™¨ç«¯è®°å½•ç”¨æˆ·çš„çŠ¶æ€ï¼Œç»´æŒå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¼šè¯çš„ä¸€ç§æœºåˆ¶ã€‚æ¯”å¦‚å½“è¦æ·»åŠ å•†å“åˆ°è´­ç‰©è½¦æ—¶å€™ï¼Œç³»ç»Ÿä¸çŸ¥é“æ˜¯å“ªä¸ªç”¨æˆ·æ“ä½œçš„ï¼Œå› ä¸ºHTTPæ˜¯æ— çŠ¶æ€åè®®ï¼ŒæœåŠ¡å™¨ç»™ç‰¹å®šçš„ç”¨æˆ·åˆ›å»ºç‰¹å®šçš„Sessionä¹‹åå°±å¯ä»¥æ ‡è¯†è¿™ä¸ªç”¨æˆ·å¹¶ä¸”è·Ÿè¸ªè¿™ä¸ªç”¨æˆ·äº†ã€‚<strong>å¼ºè°ƒsessionå°†æ•°æ®ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯</strong>ã€‚</li></ul><h2 id="heart-eyes-IPåœ°å€çš„åˆ†ç±»"><a href="#heart-eyes-IPåœ°å€çš„åˆ†ç±»" class="headerlink" title=":heart_eyes: IPåœ°å€çš„åˆ†ç±»"></a><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f60d.png?v8">ğŸ˜</span> IPåœ°å€çš„åˆ†ç±»</h2><p>IPåœ°å€æ˜¯æŒ‡äº’è”ç½‘åè®®åœ°å€ï¼Œæ˜¯IPåè®®æä¾›çš„ä¸€ç§ç»Ÿä¸€çš„åœ°å€æ ¼å¼ï¼Œå®ƒä¸ºäº’è”ç½‘ä¸Šçš„æ¯ä¸€ä¸ªç½‘ç»œå’Œæ¯ä¸€å°ä¸»æœºåˆ†é…ä¸€ä¸ªé€»è¾‘åœ°å€ï¼Œä»¥æ­¤æ¥å±è”½ç‰©ç†åœ°å€çš„å·®å¼‚ã€‚IPåœ°å€ç¼–å€æ–¹æ¡ˆå°†IPåœ°å€ç©ºé—´åˆ’åˆ†ä¸ºAã€Bã€Cã€Dã€Eäº”ç±»ï¼Œå…¶ä¸­Aã€Bã€Cæ˜¯åŸºæœ¬ç±»ï¼ŒDã€Eç±»ä½œä¸ºå¤šæ’­å’Œä¿ç•™ä½¿ç”¨ï¼Œä¸ºç‰¹æ®Šåœ°å€ã€‚</p><p>æ¯ä¸ªIPåœ°å€åŒ…æ‹¬ä¸¤ä¸ªæ ‡è¯†ç ï¼ˆIDï¼‰ï¼Œå³ç½‘ç»œIDå’Œä¸»æœºIDã€‚åŒä¸€ä¸ªç‰©ç†ç½‘ç»œä¸Šçš„æ‰€æœ‰ä¸»æœºéƒ½ä½¿ç”¨åŒä¸€ä¸ªç½‘ç»œIDï¼Œç½‘ç»œä¸Šçš„ä¸€ä¸ªä¸»æœºï¼ˆåŒ…æ‹¬ç½‘ç»œä¸Šå·¥ä½œç«™ï¼ŒæœåŠ¡å™¨å’Œè·¯ç”±å™¨ç­‰ï¼‰æœ‰ä¸€ä¸ªä¸»æœºIDä¸å…¶å¯¹åº”ã€‚A~Eç±»åœ°å€çš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>Aç±»åœ°å€ï¼šä»¥0å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚èŒƒå›´ï¼š0~127ï¼›</li><li>Bç±»åœ°å€ï¼šä»¥10å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚èŒƒå›´ï¼š128~191ï¼›</li><li>Cç±»åœ°å€ï¼šä»¥110å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚èŒƒå›´ï¼š192~223ï¼›</li><li>Dç±»åœ°å€ï¼šä»¥1110å¼€å¤´ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚èŒƒå›´ä¸º224~239ï¼›</li><li>Eç±»åœ°å€ï¼šä»¥1111å¼€å¤´ï¼Œä¿ç•™åœ°å€</li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tcp/ip </tag>
            
            <tag> http </tag>
            
            <tag> ç½‘ç»œ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å›¾è§£HTTPæ€»ç»“</title>
      <link href="/2020/11/29/tu-jie-http-zong-jie/"/>
      <url>/2020/11/29/tu-jie-http-zong-jie/</url>
      
        <content type="html"><![CDATA[<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>ä¸Šé‡å®£. å›¾è§£ HTTP[M]. äººæ°‘é‚®ç”µå‡ºç‰ˆç¤¾, 2014.</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129164421.jpg" alt="image-20201129163253254"></p><h2 id="ä¸€-ã€åŸºç¡€æ¦‚å¿µ"><a href="#ä¸€-ã€åŸºç¡€æ¦‚å¿µ" class="headerlink" title="ä¸€ ã€åŸºç¡€æ¦‚å¿µ"></a>ä¸€ ã€åŸºç¡€æ¦‚å¿µ</h2><h3 id="è¯·æ±‚å’Œå“åº”æŠ¥æ–‡"><a href="#è¯·æ±‚å’Œå“åº”æŠ¥æ–‡" class="headerlink" title="è¯·æ±‚å’Œå“åº”æŠ¥æ–‡"></a>è¯·æ±‚å’Œå“åº”æŠ¥æ–‡</h3><p>å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚æŠ¥æ–‡ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ ¹æ®è¯·æ±‚æŠ¥æ–‡ä¸­çš„ä¿¡æ¯è¿›è¡Œå¤„ç†ï¼Œå¹¶å°†å¤„ç†ç»“æœæ”¾å…¥å“åº”æŠ¥æ–‡ä¸­è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>è¯·æ±‚æŠ¥æ–‡ç»“æ„ï¼š</p><ul><li>ç¬¬ä¸€è¡Œæ˜¯åŒ…å«äº†è¯·æ±‚æ–¹æ³•ã€URLã€åè®®ç‰ˆæœ¬ï¼›</li><li>æ¥ä¸‹æ¥çš„å¤šè¡Œéƒ½æ˜¯è¯·æ±‚é¦–éƒ¨ Headerï¼Œæ¯ä¸ªé¦–éƒ¨éƒ½æœ‰ä¸€ä¸ªé¦–éƒ¨åç§°ï¼Œä»¥åŠå¯¹åº”çš„å€¼ã€‚</li><li>ä¸€ä¸ªç©ºè¡Œç”¨æ¥åˆ†éš”é¦–éƒ¨å’Œå†…å®¹ä¸»ä½“ Body</li><li>æœ€åæ˜¯è¯·æ±‚çš„å†…å®¹ä¸»ä½“</li></ul><pre class="line-numbers language-yaml"><code class="language-yaml">GET http<span class="token punctuation">:</span>//www.example.com/ HTTP/1.1<span class="token key atrule">Accept</span><span class="token punctuation">:</span> text/html<span class="token punctuation">,</span>application/xhtml+xml<span class="token punctuation">,</span>application/xml;q=0.9<span class="token punctuation">,</span>image/webp<span class="token punctuation">,</span>image/apng<span class="token punctuation">,</span>*/*;q=0.8<span class="token punctuation">,</span>application/signed<span class="token punctuation">-</span>exchange;v=b3;q=0.9<span class="token key atrule">Accept-Encoding</span><span class="token punctuation">:</span> gzip<span class="token punctuation">,</span> deflate<span class="token key atrule">Accept-Language</span><span class="token punctuation">:</span> zh<span class="token punctuation">-</span>CN<span class="token punctuation">,</span>zh;q=0.9<span class="token punctuation">,</span>en;q=0.8<span class="token key atrule">Cache-Control</span><span class="token punctuation">:</span> max<span class="token punctuation">-</span>age=0<span class="token key atrule">Host</span><span class="token punctuation">:</span> www.example.com<span class="token key atrule">If-Modified-Since</span><span class="token punctuation">:</span> Thu<span class="token punctuation">,</span> 17 Oct 2019 07<span class="token punctuation">:</span>18<span class="token punctuation">:</span>26 GMT<span class="token key atrule">If-None-Match</span><span class="token punctuation">:</span> <span class="token string">"3147526947+gzip"</span><span class="token key atrule">Proxy-Connection</span><span class="token punctuation">:</span> keep<span class="token punctuation">-</span>alive<span class="token key atrule">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token key atrule">User-Agent</span><span class="token punctuation">:</span> Mozilla/5.0 xxx//ç©ºè¡Œparam1=1<span class="token important">&amp;param2</span>=2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å“åº”æŠ¥æ–‡ç»“æ„ï¼š</p><ul><li>ç¬¬ä¸€è¡ŒåŒ…å«åè®®ç‰ˆæœ¬ã€çŠ¶æ€ç ä»¥åŠæè¿°ï¼Œæœ€å¸¸è§çš„æ˜¯ 200 OK è¡¨ç¤ºè¯·æ±‚æˆåŠŸäº†</li><li>æ¥ä¸‹æ¥å¤šè¡Œä¹Ÿæ˜¯é¦–éƒ¨å†…å®¹ï¼ŒåŒ…å«å¾ˆå¤šé¦–éƒ¨å­—æ®µ</li><li>ä¸€ä¸ªç©ºè¡Œåˆ†éš”é¦–éƒ¨å’Œå†…å®¹ä¸»ä½“</li><li>æœ€åæ˜¯å“åº”çš„å†…å®¹ä¸»ä½“</li></ul><pre class="line-numbers language-yaml"><code class="language-yaml">HTTP/1.1 200 OK<span class="token key atrule">Age</span><span class="token punctuation">:</span> <span class="token number">529651</span><span class="token key atrule">Cache-Control</span><span class="token punctuation">:</span> max<span class="token punctuation">-</span>age=604800<span class="token key atrule">Connection</span><span class="token punctuation">:</span> keep<span class="token punctuation">-</span>alive<span class="token key atrule">Content-Encoding</span><span class="token punctuation">:</span> gzip<span class="token key atrule">Content-Length</span><span class="token punctuation">:</span> <span class="token number">648</span><span class="token key atrule">Content-Type</span><span class="token punctuation">:</span> text/html; charset=UTF<span class="token punctuation">-</span><span class="token number">8</span><span class="token key atrule">Date</span><span class="token punctuation">:</span> Mon<span class="token punctuation">,</span> 02 Nov 2020 17<span class="token punctuation">:</span>53<span class="token punctuation">:</span>39 GMT<span class="token key atrule">Etag</span><span class="token punctuation">:</span> <span class="token string">"3147526947+ident+gzip"</span><span class="token key atrule">Expires</span><span class="token punctuation">:</span> Mon<span class="token punctuation">,</span> 09 Nov 2020 17<span class="token punctuation">:</span>53<span class="token punctuation">:</span>39 GMT<span class="token key atrule">Keep-Alive</span><span class="token punctuation">:</span> timeout=4<span class="token key atrule">Last-Modified</span><span class="token punctuation">:</span> Thu<span class="token punctuation">,</span> 17 Oct 2019 07<span class="token punctuation">:</span>18<span class="token punctuation">:</span>26 GMT<span class="token key atrule">Proxy-Connection</span><span class="token punctuation">:</span> keep<span class="token punctuation">-</span>alive<span class="token key atrule">Server</span><span class="token punctuation">:</span> ECS (sjc/16DF)<span class="token key atrule">Vary</span><span class="token punctuation">:</span> Accept<span class="token punctuation">-</span>Encoding<span class="token key atrule">X-Cache</span><span class="token punctuation">:</span> HIT//ç©ºè¡Œ&lt;<span class="token tag">!doctype</span> html<span class="token punctuation">></span>&lt;html<span class="token punctuation">></span>&lt;head<span class="token punctuation">></span>    &lt;title<span class="token punctuation">></span>Example Domain&lt;/title<span class="token punctuation">></span>    // çœç•¥<span class="token punctuation">...</span> &lt;/body<span class="token punctuation">></span>&lt;/html<span class="token punctuation">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h3><p>HTTP ä½¿ç”¨ URLï¼ˆ <strong>U</strong> niform <strong>R</strong>esource <strong>L</strong>ocatorï¼Œ<strong>ç»Ÿä¸€èµ„æºå®šä½ç¬¦</strong>ï¼‰æ¥å®šä½èµ„æºï¼Œå®ƒæ˜¯  URIï¼ˆ<strong>U</strong>niform <strong>R</strong>esource <strong>I</strong>dentifierï¼Œ<strong>ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦</strong>ï¼‰çš„å­é›†ï¼ŒURL åœ¨ URI çš„åŸºç¡€ä¸Šå¢åŠ äº†å®šä½èƒ½åŠ›ã€‚URI é™¤äº†åŒ…å« URLï¼Œè¿˜åŒ…å« URNï¼ˆUniform Resource Nameï¼Œç»Ÿä¸€èµ„æºåç§°ï¼‰ï¼Œå®ƒåªæ˜¯ç”¨æ¥å®šä¹‰ä¸€ä¸ªèµ„æºçš„åç§°ï¼Œå¹¶ä¸å…·å¤‡å®šä½è¯¥èµ„æºçš„èƒ½åŠ›ã€‚ä¾‹å¦‚ urn:isbn:0451450523 ç”¨æ¥å®šä¹‰ä¸€ä¸ªä¹¦ç±åç§°ï¼Œä½†æ˜¯å´æ²¡æœ‰è¡¨ç¤ºæ€ä¹ˆæ‰¾åˆ°è¿™æœ¬ä¹¦ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162304.png" alt="image"></p><ul><li><a href="https://zh.wikipedia.org/wiki/ç»Ÿä¸€èµ„æºæ ‡å¿—ç¬¦" target="_blank" rel="noopener">wikipediaï¼šç»Ÿä¸€èµ„æºæ ‡å¿—ç¬¦</a></li><li><a href="https://en.wikipedia.org/wiki/URL" target="_blank" rel="noopener">wikipedia: URL</a></li><li><a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.2" target="_blank" rel="noopener">rfc2616ï¼š3.2.2 http URL</a></li><li><a href="https://stackoverflow.com/questions/176264/what-is-the-difference-between-a-uri-a-url-and-a-urn" target="_blank" rel="noopener">What is the difference between a URI, a URL and a URN?</a></li></ul><h2 id="äºŒã€HTTP-æ–¹æ³•"><a href="#äºŒã€HTTP-æ–¹æ³•" class="headerlink" title="äºŒã€HTTP æ–¹æ³•"></a>äºŒã€HTTP æ–¹æ³•</h2><p>å®¢æˆ·ç«¯å‘é€çš„  <strong>è¯·æ±‚æŠ¥æ–‡</strong>  ç¬¬ä¸€è¡Œä¸ºè¯·æ±‚è¡Œï¼ŒåŒ…å«äº†æ–¹æ³•å­—æ®µã€‚</p><h3 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h3><blockquote><p>è·å–èµ„æº</p></blockquote><p>å½“å‰ç½‘ç»œè¯·æ±‚ä¸­ï¼Œç»å¤§éƒ¨åˆ†ä½¿ç”¨çš„æ˜¯ GET æ–¹æ³•ã€‚</p><h3 id="HEAD"><a href="#HEAD" class="headerlink" title="HEAD"></a>HEAD</h3><blockquote><p>è·å–æŠ¥æ–‡é¦–éƒ¨</p></blockquote><p>å’Œ GET æ–¹æ³•ç±»ä¼¼ï¼Œä½†æ˜¯ä¸è¿”å›æŠ¥æ–‡å®ä½“ä¸»ä½“éƒ¨åˆ†ã€‚ä¸»è¦ç”¨äºç¡®è®¤ URL çš„æœ‰æ•ˆæ€§ä»¥åŠèµ„æºæ›´æ–°çš„æ—¥æœŸæ—¶é—´ç­‰ã€‚</p><h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h3><blockquote><p>ä¼ è¾“å®ä½“ä¸»ä½“</p></blockquote><p>POST ä¸»è¦ç”¨æ¥ä¼ è¾“æ•°æ®ï¼Œè€Œ GET ä¸»è¦ç”¨æ¥è·å–èµ„æºã€‚æ›´å¤š POST ä¸ GET çš„æ¯”è¾ƒè¯·è§ç¬¬ä¹ç« ã€‚</p><h3 id="PUT"><a href="#PUT" class="headerlink" title="PUT"></a>PUT</h3><blockquote><p>ä¸Šä¼ æ–‡ä»¶</p></blockquote><p>ç”±äºè‡ªèº«ä¸å¸¦éªŒè¯æœºåˆ¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨å®‰å…¨æ€§é—®é¢˜ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨è¯¥æ–¹æ³•ã€‚</p><pre><code>PUT /new.html HTTP/1.1Host: example.comContent-type: text/htmlContent-length: 16&lt;p&gt;New File&lt;/p&gt;</code></pre><h3 id="PATCH"><a href="#PATCH" class="headerlink" title="PATCH"></a>PATCH</h3><blockquote><p>å¯¹èµ„æºè¿›è¡Œéƒ¨åˆ†ä¿®æ”¹</p></blockquote><p>PUT ä¹Ÿå¯ä»¥ç”¨äºä¿®æ”¹èµ„æºï¼Œä½†æ˜¯åªèƒ½å®Œå…¨æ›¿ä»£åŸå§‹èµ„æºï¼ŒPATCH å…è®¸éƒ¨åˆ†ä¿®æ”¹ã€‚</p><pre><code>PATCH /file.txt HTTP/1.1Host: www.example.comContent-Type: application/exampleIf-Match: "e0023aa4e"Content-Length: 100[description of changes]</code></pre><h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><blockquote><p>åˆ é™¤æ–‡ä»¶</p></blockquote><p>ä¸ PUT åŠŸèƒ½ç›¸åï¼Œå¹¶ä¸”åŒæ ·ä¸å¸¦éªŒè¯æœºåˆ¶ã€‚</p><pre><code>DELETE /file.html HTTP/1.1</code></pre><h3 id="OPTIONS"><a href="#OPTIONS" class="headerlink" title="OPTIONS"></a>OPTIONS</h3><blockquote><p>æŸ¥è¯¢æ”¯æŒçš„æ–¹æ³•</p></blockquote><p>æŸ¥è¯¢æŒ‡å®šçš„ URL èƒ½å¤Ÿæ”¯æŒçš„æ–¹æ³•ã€‚ä¼šè¿”å› <code>Allow: GET, POST, HEAD, OPTIONS</code> è¿™æ ·çš„å†…å®¹ã€‚</p><h3 id="CONNECT"><a href="#CONNECT" class="headerlink" title="CONNECT"></a>CONNECT</h3><blockquote><p>è¦æ±‚åœ¨ä¸ä»£ç†æœåŠ¡å™¨é€šä¿¡æ—¶å»ºç«‹éš§é“</p></blockquote><p>ä½¿ç”¨ SSLï¼ˆSecure Sockets Layerï¼Œå®‰å…¨å¥—æ¥å±‚ï¼‰å’Œ TLSï¼ˆTransport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨ï¼‰åè®®æŠŠé€šä¿¡å†…å®¹åŠ å¯†åç»ç½‘ç»œéš§é“ä¼ è¾“ã€‚</p><pre><code>CONNECT www.example.com:443 HTTP/1.1</code></pre><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162326.jpeg" alt="image"></p><h3 id="TRACE"><a href="#TRACE" class="headerlink" title="TRACE"></a>TRACE</h3><blockquote><p>è¿½è¸ªè·¯å¾„</p></blockquote><p>æœåŠ¡å™¨ä¼šå°†é€šä¿¡è·¯å¾„è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å‘é€è¯·æ±‚æ—¶ï¼Œåœ¨ Max-Forwards é¦–éƒ¨å­—æ®µä¸­å¡«å…¥æ•°å€¼ï¼Œæ¯ç»è¿‡ä¸€ä¸ªæœåŠ¡å™¨å°±ä¼šå‡ 1ï¼Œå½“æ•°å€¼ä¸º 0 æ—¶å°±åœæ­¢ä¼ è¾“ã€‚é€šå¸¸ä¸ä¼šä½¿ç”¨ TRACEï¼Œå¹¶ä¸”å®ƒå®¹æ˜“å—åˆ° XST æ”»å‡»ï¼ˆCross-Site Tracingï¼Œè·¨ç«™è¿½è¸ªï¼‰ã€‚</p><h2 id="ä¸‰ã€HTTP-çŠ¶æ€ç "><a href="#ä¸‰ã€HTTP-çŠ¶æ€ç " class="headerlink" title="ä¸‰ã€HTTP çŠ¶æ€ç "></a>ä¸‰ã€HTTP çŠ¶æ€ç </h2><p>æœåŠ¡å™¨è¿”å›çš„  <strong>å“åº”æŠ¥æ–‡</strong>  ä¸­ç¬¬ä¸€è¡Œä¸ºçŠ¶æ€è¡Œï¼ŒåŒ…å«äº†çŠ¶æ€ç ä»¥åŠåŸå› çŸ­è¯­ï¼Œç”¨æ¥å‘ŠçŸ¥å®¢æˆ·ç«¯è¯·æ±‚çš„ç»“æœã€‚</p><table><thead><tr><th align="center">çŠ¶æ€ç </th><th align="center">ç±»åˆ«</th><th align="center">å«ä¹‰</th></tr></thead><tbody><tr><td align="center">1XX</td><td align="center">Informationalï¼ˆä¿¡æ¯æ€§çŠ¶æ€ç ï¼‰</td><td align="center">æ¥æ”¶çš„è¯·æ±‚æ­£åœ¨å¤„ç†</td></tr><tr><td align="center">2XX</td><td align="center">Successï¼ˆæˆåŠŸçŠ¶æ€ç ï¼‰</td><td align="center">è¯·æ±‚æ­£å¸¸å¤„ç†å®Œæ¯•</td></tr><tr><td align="center">3XX</td><td align="center">Redirectionï¼ˆé‡å®šå‘çŠ¶æ€ç ï¼‰</td><td align="center">éœ€è¦è¿›è¡Œé™„åŠ æ“ä½œä»¥å®Œæˆè¯·æ±‚</td></tr><tr><td align="center">4XX</td><td align="center">Client Errorï¼ˆå®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç ï¼‰</td><td align="center">æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚</td></tr><tr><td align="center">5XX</td><td align="center">Server Errorï¼ˆæœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç ï¼‰</td><td align="center">æœåŠ¡å™¨å¤„ç†è¯·æ±‚å‡ºé”™</td></tr></tbody></table><h3 id="1XX-ä¿¡æ¯"><a href="#1XX-ä¿¡æ¯" class="headerlink" title="1XX ä¿¡æ¯"></a>1XX ä¿¡æ¯</h3><ul><li><strong>100 Continue</strong>  ï¼šè¡¨æ˜åˆ°ç›®å‰ä¸ºæ­¢éƒ½å¾ˆæ­£å¸¸ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç»§ç»­å‘é€è¯·æ±‚æˆ–è€…å¿½ç•¥è¿™ä¸ªå“åº”ã€‚</li></ul><h3 id="2XX-æˆåŠŸ"><a href="#2XX-æˆåŠŸ" class="headerlink" title="2XX æˆåŠŸ"></a>2XX æˆåŠŸ</h3><ul><li><strong>200 OK</strong></li><li><strong>204 No Content</strong>  ï¼šè¯·æ±‚å·²ç»æˆåŠŸå¤„ç†ï¼Œä½†æ˜¯è¿”å›çš„å“åº”æŠ¥æ–‡ä¸åŒ…å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ã€‚ä¸€èˆ¬åœ¨åªéœ€è¦ä»å®¢æˆ·ç«¯å¾€æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦è¿”å›æ•°æ®æ—¶ä½¿ç”¨ã€‚</li><li><strong>206 Partial Content</strong>  ï¼šè¡¨ç¤ºå®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ï¼Œå“åº”æŠ¥æ–‡åŒ…å«ç”± Content-Range æŒ‡å®šèŒƒå›´çš„å®ä½“å†…å®¹ã€‚</li></ul><h3 id="3XX-é‡å®šå‘"><a href="#3XX-é‡å®šå‘" class="headerlink" title="3XX é‡å®šå‘"></a>3XX é‡å®šå‘</h3><ul><li><strong>301 Moved Permanently</strong>  ï¼šæ°¸ä¹…æ€§é‡å®šå‘</li><li><strong>302 Found</strong>  ï¼šä¸´æ—¶æ€§é‡å®šå‘</li><li><strong>303 See Other</strong>  ï¼šå’Œ 302 æœ‰ç€ç›¸åŒçš„åŠŸèƒ½ï¼Œä½†æ˜¯ 303 æ˜ç¡®è¦æ±‚å®¢æˆ·ç«¯åº”è¯¥é‡‡ç”¨ GET æ–¹æ³•è·å–èµ„æºã€‚</li><li>æ³¨ï¼šè™½ç„¶ HTTP åè®®è§„å®š 301ã€302 çŠ¶æ€ä¸‹é‡å®šå‘æ—¶ä¸å…è®¸æŠŠ POST æ–¹æ³•æ”¹æˆ GET æ–¹æ³•ï¼Œä½†æ˜¯å¤§å¤šæ•°æµè§ˆå™¨éƒ½ä¼šåœ¨ 301ã€302 å’Œ 303 çŠ¶æ€ä¸‹çš„é‡å®šå‘æŠŠ POST æ–¹æ³•æ”¹æˆ GET æ–¹æ³•ã€‚</li><li><strong>304 Not Modified</strong>  ï¼šå¦‚æœè¯·æ±‚æŠ¥æ–‡é¦–éƒ¨åŒ…å«ä¸€äº›æ¡ä»¶ï¼Œä¾‹å¦‚ï¼šIf-Matchï¼ŒIf-Modified-Sinceï¼ŒIf-None-Matchï¼ŒIf-Rangeï¼ŒIf-Unmodified-Sinceï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™æœåŠ¡å™¨ä¼šè¿”å› 304 çŠ¶æ€ç ã€‚</li><li><strong>307 Temporary Redirect</strong>  ï¼šä¸´æ—¶é‡å®šå‘ï¼Œä¸ 302 çš„å«ä¹‰ç±»ä¼¼ï¼Œä½†æ˜¯ 307 è¦æ±‚æµè§ˆå™¨ä¸ä¼šæŠŠé‡å®šå‘è¯·æ±‚çš„ POST æ–¹æ³•æ”¹æˆ GET æ–¹æ³•ã€‚</li></ul><h3 id="4XX-å®¢æˆ·ç«¯é”™è¯¯"><a href="#4XX-å®¢æˆ·ç«¯é”™è¯¯" class="headerlink" title="4XX å®¢æˆ·ç«¯é”™è¯¯"></a>4XX å®¢æˆ·ç«¯é”™è¯¯</h3><ul><li><strong>400 Bad Request</strong>  ï¼šè¯·æ±‚æŠ¥æ–‡ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯ã€‚</li><li><strong>401 Unauthorized</strong>  ï¼šè¯¥çŠ¶æ€ç è¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰è®¤è¯ä¿¡æ¯ï¼ˆBASIC è®¤è¯ã€DIGEST è®¤è¯ï¼‰ã€‚å¦‚æœä¹‹å‰å·²è¿›è¡Œè¿‡ä¸€æ¬¡è¯·æ±‚ï¼Œåˆ™è¡¨ç¤ºç”¨æˆ·è®¤è¯å¤±è´¥ã€‚</li><li><strong>403 Forbidden</strong>  ï¼šè¯·æ±‚è¢«æ‹’ç»ã€‚</li><li><strong>404 Not Found</strong></li></ul><h3 id="5XX-æœåŠ¡å™¨é”™è¯¯"><a href="#5XX-æœåŠ¡å™¨é”™è¯¯" class="headerlink" title="5XX æœåŠ¡å™¨é”™è¯¯"></a>5XX æœåŠ¡å™¨é”™è¯¯</h3><ul><li><strong>500 Internal Server Error</strong>  ï¼šæœåŠ¡å™¨æ­£åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿé”™è¯¯ã€‚</li><li><strong>503 Service Unavailable</strong>  ï¼šæœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨è¿›è¡Œåœæœºç»´æŠ¤ï¼Œç°åœ¨æ— æ³•å¤„ç†è¯·æ±‚ã€‚</li></ul><h2 id="å››ã€HTTP-é¦–éƒ¨"><a href="#å››ã€HTTP-é¦–éƒ¨" class="headerlink" title="å››ã€HTTP é¦–éƒ¨"></a>å››ã€HTTP é¦–éƒ¨</h2><p>æœ‰ 4 ç§ç±»å‹çš„é¦–éƒ¨å­—æ®µï¼šé€šç”¨é¦–éƒ¨å­—æ®µã€è¯·æ±‚é¦–éƒ¨å­—æ®µã€å“åº”é¦–éƒ¨å­—æ®µå’Œå®ä½“é¦–éƒ¨å­—æ®µã€‚</p><p>å„ç§é¦–éƒ¨å­—æ®µåŠå…¶å«ä¹‰å¦‚ä¸‹ï¼ˆä¸éœ€è¦å…¨è®°ï¼Œä»…ä¾›æŸ¥é˜…ï¼‰ï¼š</p><h3 id="é€šç”¨é¦–éƒ¨å­—æ®µ"><a href="#é€šç”¨é¦–éƒ¨å­—æ®µ" class="headerlink" title="é€šç”¨é¦–éƒ¨å­—æ®µ"></a>é€šç”¨é¦–éƒ¨å­—æ®µ</h3><table><thead><tr><th align="center">é¦–éƒ¨å­—æ®µå</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">Cache-Control</td><td align="center">æ§åˆ¶ç¼“å­˜çš„è¡Œä¸º</td></tr><tr><td align="center">Connection</td><td align="center">æ§åˆ¶ä¸å†è½¬å‘ç»™ä»£ç†çš„é¦–éƒ¨å­—æ®µã€ç®¡ç†æŒä¹…è¿æ¥</td></tr><tr><td align="center">Date</td><td align="center">åˆ›å»ºæŠ¥æ–‡çš„æ—¥æœŸæ—¶é—´</td></tr><tr><td align="center">Pragma</td><td align="center">æŠ¥æ–‡æŒ‡ä»¤</td></tr><tr><td align="center">Trailer</td><td align="center">æŠ¥æ–‡æœ«ç«¯çš„é¦–éƒ¨ä¸€è§ˆ</td></tr><tr><td align="center">Transfer-Encoding</td><td align="center">æŒ‡å®šæŠ¥æ–‡ä¸»ä½“çš„ä¼ è¾“ç¼–ç æ–¹å¼</td></tr><tr><td align="center">Upgrade</td><td align="center">å‡çº§ä¸ºå…¶ä»–åè®®</td></tr><tr><td align="center">Via</td><td align="center">ä»£ç†æœåŠ¡å™¨çš„ç›¸å…³ä¿¡æ¯</td></tr><tr><td align="center">Warning</td><td align="center">é”™è¯¯é€šçŸ¥</td></tr></tbody></table><h3 id="è¯·æ±‚é¦–éƒ¨å­—æ®µ"><a href="#è¯·æ±‚é¦–éƒ¨å­—æ®µ" class="headerlink" title="è¯·æ±‚é¦–éƒ¨å­—æ®µ"></a>è¯·æ±‚é¦–éƒ¨å­—æ®µ</h3><table><thead><tr><th align="center">é¦–éƒ¨å­—æ®µå</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">Accept</td><td align="center">ç”¨æˆ·ä»£ç†å¯å¤„ç†çš„åª’ä½“ç±»å‹</td></tr><tr><td align="center">Accept-Charset</td><td align="center">ä¼˜å…ˆçš„å­—ç¬¦é›†</td></tr><tr><td align="center">Accept-Encoding</td><td align="center">ä¼˜å…ˆçš„å†…å®¹ç¼–ç </td></tr><tr><td align="center">Accept-Language</td><td align="center">ä¼˜å…ˆçš„è¯­è¨€ï¼ˆè‡ªç„¶è¯­è¨€ï¼‰</td></tr><tr><td align="center">Authorization</td><td align="center">Web è®¤è¯ä¿¡æ¯</td></tr><tr><td align="center">Expect</td><td align="center">æœŸå¾…æœåŠ¡å™¨çš„ç‰¹å®šè¡Œä¸º</td></tr><tr><td align="center">From</td><td align="center">ç”¨æˆ·çš„ç”µå­é‚®ç®±åœ°å€</td></tr><tr><td align="center">Host</td><td align="center">è¯·æ±‚èµ„æºæ‰€åœ¨æœåŠ¡å™¨</td></tr><tr><td align="center">If-Match</td><td align="center">æ¯”è¾ƒå®ä½“æ ‡è®°ï¼ˆETagï¼‰</td></tr><tr><td align="center">If-Modified-Since</td><td align="center">æ¯”è¾ƒèµ„æºçš„æ›´æ–°æ—¶é—´</td></tr><tr><td align="center">If-None-Match</td><td align="center">æ¯”è¾ƒå®ä½“æ ‡è®°ï¼ˆä¸ If-Match ç›¸åï¼‰</td></tr><tr><td align="center">If-Range</td><td align="center">èµ„æºæœªæ›´æ–°æ—¶å‘é€å®ä½“ Byte çš„èŒƒå›´è¯·æ±‚</td></tr><tr><td align="center">If-Unmodified-Since</td><td align="center">æ¯”è¾ƒèµ„æºçš„æ›´æ–°æ—¶é—´ï¼ˆä¸ If-Modified-Since ç›¸åï¼‰</td></tr><tr><td align="center">Max-Forwards</td><td align="center">æœ€å¤§ä¼ è¾“é€è·³æ•°</td></tr><tr><td align="center">Proxy-Authorization</td><td align="center">ä»£ç†æœåŠ¡å™¨è¦æ±‚å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯</td></tr><tr><td align="center">Range</td><td align="center">å®ä½“çš„å­—èŠ‚èŒƒå›´è¯·æ±‚</td></tr><tr><td align="center">Referer</td><td align="center">å¯¹è¯·æ±‚ä¸­ URI çš„åŸå§‹è·å–æ–¹</td></tr><tr><td align="center">TE</td><td align="center">ä¼ è¾“ç¼–ç çš„ä¼˜å…ˆçº§</td></tr><tr><td align="center">User-Agent</td><td align="center">HTTP å®¢æˆ·ç«¯ç¨‹åºçš„ä¿¡æ¯</td></tr></tbody></table><h3 id="å“åº”é¦–éƒ¨å­—æ®µ"><a href="#å“åº”é¦–éƒ¨å­—æ®µ" class="headerlink" title="å“åº”é¦–éƒ¨å­—æ®µ"></a>å“åº”é¦–éƒ¨å­—æ®µ</h3><table><thead><tr><th align="center">é¦–éƒ¨å­—æ®µå</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">Accept-Ranges</td><td align="center">æ˜¯å¦æ¥å—å­—èŠ‚èŒƒå›´è¯·æ±‚</td></tr><tr><td align="center">Age</td><td align="center">æ¨ç®—èµ„æºåˆ›å»ºç»è¿‡æ—¶é—´</td></tr><tr><td align="center">ETag</td><td align="center">èµ„æºçš„åŒ¹é…ä¿¡æ¯</td></tr><tr><td align="center">Location</td><td align="center">ä»¤å®¢æˆ·ç«¯é‡å®šå‘è‡³æŒ‡å®š URI</td></tr><tr><td align="center">Proxy-Authenticate</td><td align="center">ä»£ç†æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯</td></tr><tr><td align="center">Retry-After</td><td align="center">å¯¹å†æ¬¡å‘èµ·è¯·æ±‚çš„æ—¶æœºè¦æ±‚</td></tr><tr><td align="center">Server</td><td align="center">HTTP æœåŠ¡å™¨çš„å®‰è£…ä¿¡æ¯</td></tr><tr><td align="center">Vary</td><td align="center">ä»£ç†æœåŠ¡å™¨ç¼“å­˜çš„ç®¡ç†ä¿¡æ¯</td></tr><tr><td align="center">WWW-Authenticate</td><td align="center">æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è®¤è¯ä¿¡æ¯</td></tr></tbody></table><h3 id="å®ä½“é¦–éƒ¨å­—æ®µ"><a href="#å®ä½“é¦–éƒ¨å­—æ®µ" class="headerlink" title="å®ä½“é¦–éƒ¨å­—æ®µ"></a>å®ä½“é¦–éƒ¨å­—æ®µ</h3><table><thead><tr><th align="center">é¦–éƒ¨å­—æ®µå</th><th align="center">è¯´æ˜</th></tr></thead><tbody><tr><td align="center">Allow</td><td align="center">èµ„æºå¯æ”¯æŒçš„ HTTP æ–¹æ³•</td></tr><tr><td align="center">Content-Encoding</td><td align="center">å®ä½“ä¸»ä½“é€‚ç”¨çš„ç¼–ç æ–¹å¼</td></tr><tr><td align="center">Content-Language</td><td align="center">å®ä½“ä¸»ä½“çš„è‡ªç„¶è¯­è¨€</td></tr><tr><td align="center">Content-Length</td><td align="center">å®ä½“ä¸»ä½“çš„å¤§å°</td></tr><tr><td align="center">Content-Location</td><td align="center">æ›¿ä»£å¯¹åº”èµ„æºçš„ URI</td></tr><tr><td align="center">Content-MD5</td><td align="center">å®ä½“ä¸»ä½“çš„æŠ¥æ–‡æ‘˜è¦</td></tr><tr><td align="center">Content-Range</td><td align="center">å®ä½“ä¸»ä½“çš„ä½ç½®èŒƒå›´</td></tr><tr><td align="center">Content-Type</td><td align="center">å®ä½“ä¸»ä½“çš„åª’ä½“ç±»å‹</td></tr><tr><td align="center">Expires</td><td align="center">å®ä½“ä¸»ä½“è¿‡æœŸçš„æ—¥æœŸæ—¶é—´</td></tr><tr><td align="center">Last-Modified</td><td align="center">èµ„æºçš„æœ€åä¿®æ”¹æ—¥æœŸæ—¶é—´</td></tr></tbody></table><h2 id="äº”ã€å…·ä½“åº”ç”¨"><a href="#äº”ã€å…·ä½“åº”ç”¨" class="headerlink" title="äº”ã€å…·ä½“åº”ç”¨"></a>äº”ã€å…·ä½“åº”ç”¨</h2><h3 id="è¿æ¥ç®¡ç†"><a href="#è¿æ¥ç®¡ç†" class="headerlink" title="è¿æ¥ç®¡ç†"></a>è¿æ¥ç®¡ç†</h3><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162349.png" alt="image"></p><h4 id="1-çŸ­è¿æ¥ä¸é•¿è¿æ¥"><a href="#1-çŸ­è¿æ¥ä¸é•¿è¿æ¥" class="headerlink" title="1. çŸ­è¿æ¥ä¸é•¿è¿æ¥"></a>1. çŸ­è¿æ¥ä¸é•¿è¿æ¥</h4><p>å½“æµè§ˆå™¨è®¿é—®ä¸€ä¸ªåŒ…å«å¤šå¼ å›¾ç‰‡çš„ HTML é¡µé¢æ—¶ï¼Œé™¤äº†è¯·æ±‚è®¿é—®çš„ HTML é¡µé¢èµ„æºï¼Œè¿˜ä¼šè¯·æ±‚å›¾ç‰‡èµ„æºã€‚å¦‚æœæ¯è¿›è¡Œä¸€æ¬¡ HTTP é€šä¿¡å°±è¦æ–°å»ºä¸€ä¸ª TCP è¿æ¥ï¼Œé‚£ä¹ˆå¼€é”€ä¼šå¾ˆå¤§ã€‚</p><p>é•¿è¿æ¥åªéœ€è¦å»ºç«‹ä¸€æ¬¡ TCP è¿æ¥å°±èƒ½è¿›è¡Œå¤šæ¬¡ HTTP é€šä¿¡ã€‚</p><ul><li>ä» HTTP/1.1 å¼€å§‹é»˜è®¤æ˜¯é•¿è¿æ¥çš„ï¼Œå¦‚æœè¦æ–­å¼€è¿æ¥ï¼Œéœ€è¦ç”±å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡å™¨ç«¯æå‡ºæ–­å¼€ï¼Œä½¿ç”¨ <code>Connection : close</code>ï¼›</li><li>åœ¨ HTTP/1.1 ä¹‹å‰é»˜è®¤æ˜¯çŸ­è¿æ¥çš„ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨é•¿è¿æ¥ï¼Œåˆ™ä½¿ç”¨ <code>Connection : Keep-Alive</code>ã€‚</li></ul><h4 id="2-æµæ°´çº¿"><a href="#2-æµæ°´çº¿" class="headerlink" title="2. æµæ°´çº¿"></a>2. æµæ°´çº¿</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒHTTP è¯·æ±‚æ˜¯æŒ‰é¡ºåºå‘å‡ºçš„ï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚åªæœ‰åœ¨å½“å‰è¯·æ±‚æ”¶åˆ°å“åº”ä¹‹åæ‰ä¼šè¢«å‘å‡ºã€‚ç”±äºå—åˆ°ç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½çš„é™åˆ¶ï¼Œåœ¨ä¸‹ä¸€ä¸ªè¯·æ±‚è¢«å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…å¾ˆé•¿æ—¶é—´ã€‚</p><p>æµæ°´çº¿æ˜¯åœ¨åŒä¸€æ¡é•¿è¿æ¥ä¸Šè¿ç»­å‘å‡ºè¯·æ±‚ï¼Œè€Œä¸ç”¨ç­‰å¾…å“åº”è¿”å›ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å»¶è¿Ÿã€‚</p><h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>HTTP åè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œä¸»è¦æ˜¯ä¸ºäº†è®© HTTP åè®®å°½å¯èƒ½ç®€å•ï¼Œä½¿å¾—å®ƒèƒ½å¤Ÿå¤„ç†å¤§é‡äº‹åŠ¡ã€‚HTTP/1.1 å¼•å…¥ Cookie æ¥ä¿å­˜çŠ¶æ€ä¿¡æ¯ã€‚</p><p>Cookie æ˜¯æœåŠ¡å™¨å‘é€åˆ°ç”¨æˆ·æµè§ˆå™¨å¹¶ä¿å­˜åœ¨æœ¬åœ°çš„ä¸€å°å—æ•°æ®ï¼Œå®ƒä¼šåœ¨æµè§ˆå™¨ä¹‹åå‘åŒä¸€æœåŠ¡å™¨å†æ¬¡å‘èµ·è¯·æ±‚æ—¶è¢«æºå¸¦ä¸Šï¼Œç”¨äºå‘ŠçŸ¥æœåŠ¡ç«¯ä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ¥è‡ªåŒä¸€æµè§ˆå™¨ã€‚ç”±äºä¹‹åæ¯æ¬¡è¯·æ±‚éƒ½ä¼šéœ€è¦æºå¸¦ Cookie æ•°æ®ï¼Œå› æ­¤ä¼šå¸¦æ¥é¢å¤–çš„æ€§èƒ½å¼€é”€ï¼ˆå°¤å…¶æ˜¯åœ¨ç§»åŠ¨ç¯å¢ƒä¸‹ï¼‰ã€‚</p><p>Cookie æ›¾ä¸€åº¦ç”¨äºå®¢æˆ·ç«¯æ•°æ®çš„å­˜å‚¨ï¼Œå› ä¸ºå½“æ—¶å¹¶æ²¡æœ‰å…¶å®ƒåˆé€‚çš„å­˜å‚¨åŠæ³•è€Œä½œä¸ºå”¯ä¸€çš„å­˜å‚¨æ‰‹æ®µï¼Œä½†ç°åœ¨éšç€ç°ä»£æµè§ˆå™¨å¼€å§‹æ”¯æŒå„ç§å„æ ·çš„å­˜å‚¨æ–¹å¼ï¼ŒCookie æ¸æ¸è¢«æ·˜æ±°ã€‚æ–°çš„æµè§ˆå™¨ API å·²ç»å…è®¸å¼€å‘è€…ç›´æ¥å°†æ•°æ®å­˜å‚¨åˆ°æœ¬åœ°ï¼Œå¦‚ä½¿ç”¨ Web storage APIï¼ˆæœ¬åœ°å­˜å‚¨å’Œä¼šè¯å­˜å‚¨ï¼‰æˆ– IndexedDBã€‚</p><h4 id="1-ç”¨é€”"><a href="#1-ç”¨é€”" class="headerlink" title="1. ç”¨é€”"></a>1. ç”¨é€”</h4><ul><li>ä¼šè¯çŠ¶æ€ç®¡ç†ï¼ˆå¦‚ç”¨æˆ·ç™»å½•çŠ¶æ€ã€è´­ç‰©è½¦ã€æ¸¸æˆåˆ†æ•°æˆ–å…¶å®ƒéœ€è¦è®°å½•çš„ä¿¡æ¯ï¼‰</li><li>ä¸ªæ€§åŒ–è®¾ç½®ï¼ˆå¦‚ç”¨æˆ·è‡ªå®šä¹‰è®¾ç½®ã€ä¸»é¢˜ç­‰ï¼‰</li><li>æµè§ˆå™¨è¡Œä¸ºè·Ÿè¸ªï¼ˆå¦‚è·Ÿè¸ªåˆ†æç”¨æˆ·è¡Œä¸ºç­‰ï¼‰</li></ul><h4 id="2-åˆ›å»ºè¿‡ç¨‹"><a href="#2-åˆ›å»ºè¿‡ç¨‹" class="headerlink" title="2. åˆ›å»ºè¿‡ç¨‹"></a>2. åˆ›å»ºè¿‡ç¨‹</h4><p>æœåŠ¡å™¨å‘é€çš„å“åº”æŠ¥æ–‡åŒ…å« Set-Cookie é¦–éƒ¨å­—æ®µï¼Œå®¢æˆ·ç«¯å¾—åˆ°å“åº”æŠ¥æ–‡åæŠŠ Cookie å†…å®¹ä¿å­˜åˆ°æµè§ˆå™¨ä¸­ã€‚</p><pre><code>HTTP/1.0 200 OKContent-type: text/htmlSet-Cookie: yummy_cookie=chocoSet-Cookie: tasty_cookie=strawberry[page content]</code></pre><p>å®¢æˆ·ç«¯ä¹‹åå¯¹åŒä¸€ä¸ªæœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œä¼šä»æµè§ˆå™¨ä¸­å–å‡º Cookie ä¿¡æ¯å¹¶é€šè¿‡ Cookie è¯·æ±‚é¦–éƒ¨å­—æ®µå‘é€ç»™æœåŠ¡å™¨ã€‚</p><pre><code>GET /sample_page.html HTTP/1.1Host: www.example.orgCookie: yummy_cookie=choco; tasty_cookie=strawberry</code></pre><h4 id="3-åˆ†ç±»"><a href="#3-åˆ†ç±»" class="headerlink" title="3. åˆ†ç±»"></a>3. åˆ†ç±»</h4><ul><li>ä¼šè¯æœŸ Cookieï¼šæµè§ˆå™¨å…³é—­ä¹‹åå®ƒä¼šè¢«è‡ªåŠ¨åˆ é™¤ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»…åœ¨ä¼šè¯æœŸå†…æœ‰æ•ˆã€‚</li><li>æŒä¹…æ€§ Cookieï¼šæŒ‡å®šè¿‡æœŸæ—¶é—´ï¼ˆExpiresï¼‰æˆ–æœ‰æ•ˆæœŸï¼ˆmax-ageï¼‰ä¹‹åå°±æˆä¸ºäº†æŒä¹…æ€§çš„ Cookieã€‚</li></ul><pre><code>Set-Cookie: id=a3fWa; Expires=Wed, 21 Oct 2015 07:28:00 GMT;</code></pre><h4 id="4-ä½œç”¨åŸŸ"><a href="#4-ä½œç”¨åŸŸ" class="headerlink" title="4. ä½œç”¨åŸŸ"></a>4. ä½œç”¨åŸŸ</h4><p>Domain æ ‡è¯†æŒ‡å®šäº†å“ªäº›ä¸»æœºå¯ä»¥æ¥å— Cookieã€‚å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤ä¸ºå½“å‰æ–‡æ¡£çš„ä¸»æœºï¼ˆä¸åŒ…å«å­åŸŸåï¼‰ã€‚å¦‚æœæŒ‡å®šäº† Domainï¼Œåˆ™ä¸€èˆ¬åŒ…å«å­åŸŸåã€‚ä¾‹å¦‚ï¼Œå¦‚æœè®¾ç½® Domain=mozilla.orgï¼Œåˆ™ Cookie ä¹ŸåŒ…å«åœ¨å­åŸŸåä¸­ï¼ˆå¦‚ developer.mozilla.orgï¼‰ã€‚</p><p>Path æ ‡è¯†æŒ‡å®šäº†ä¸»æœºä¸‹çš„å“ªäº›è·¯å¾„å¯ä»¥æ¥å— Cookieï¼ˆè¯¥ URL è·¯å¾„å¿…é¡»å­˜åœ¨äºè¯·æ±‚ URL ä¸­ï¼‰ã€‚ä»¥å­—ç¬¦ %x2F (â€œ/â€œ) ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦ï¼Œå­è·¯å¾„ä¹Ÿä¼šè¢«åŒ¹é…ã€‚ä¾‹å¦‚ï¼Œè®¾ç½® Path=/docsï¼Œåˆ™ä»¥ä¸‹åœ°å€éƒ½ä¼šåŒ¹é…ï¼š</p><ul><li>/docs</li><li>/docs/Web/</li><li>/docs/Web/HTTP</li></ul><h4 id="5-JavaScript"><a href="#5-JavaScript" class="headerlink" title="5. JavaScript"></a>5. JavaScript</h4><p>æµè§ˆå™¨é€šè¿‡ <code>document.cookie</code> å±æ€§å¯åˆ›å»ºæ–°çš„ Cookieï¼Œä¹Ÿå¯é€šè¿‡è¯¥å±æ€§è®¿é—®é HttpOnly æ ‡è®°çš„ Cookieã€‚</p><pre><code>document.cookie = "yummy_cookie=choco";document.cookie = "tasty_cookie=strawberry";console.log(document.cookie);</code></pre><h4 id="6-HttpOnly"><a href="#6-HttpOnly" class="headerlink" title="6. HttpOnly"></a>6. HttpOnly</h4><p>æ ‡è®°ä¸º HttpOnly çš„ Cookie ä¸èƒ½è¢« JavaScript è„šæœ¬è°ƒç”¨ã€‚è·¨ç«™è„šæœ¬æ”»å‡» (XSS) å¸¸å¸¸ä½¿ç”¨ JavaScript çš„ <code>document.cookie</code> API çªƒå–ç”¨æˆ·çš„ Cookie ä¿¡æ¯ï¼Œå› æ­¤ä½¿ç”¨ HttpOnly æ ‡è®°å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šé¿å… XSS æ”»å‡»ã€‚</p><pre><code>Set-Cookie: id=a3fWa; Expires=Wed, 21 Oct 2015 07:28:00 GMT; Secure; HttpOnly</code></pre><h4 id="7-Secure"><a href="#7-Secure" class="headerlink" title="7. Secure"></a>7. Secure</h4><p>æ ‡è®°ä¸º Secure çš„ Cookie åªèƒ½é€šè¿‡è¢« HTTPS åè®®åŠ å¯†è¿‡çš„è¯·æ±‚å‘é€ç»™æœåŠ¡ç«¯ã€‚ä½†å³ä¾¿è®¾ç½®äº† Secure æ ‡è®°ï¼Œæ•æ„Ÿä¿¡æ¯ä¹Ÿä¸åº”è¯¥é€šè¿‡ Cookie ä¼ è¾“ï¼Œå› ä¸º Cookie æœ‰å…¶å›ºæœ‰çš„ä¸å®‰å…¨æ€§ï¼ŒSecure æ ‡è®°ä¹Ÿæ— æ³•æä¾›ç¡®å®çš„å®‰å…¨ä¿éšœã€‚</p><h4 id="8-Session"><a href="#8-Session" class="headerlink" title="8. Session"></a>8. Session</h4><p>é™¤äº†å¯ä»¥å°†ç”¨æˆ·ä¿¡æ¯é€šè¿‡ Cookie å­˜å‚¨åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ Session å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œå­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯çš„ä¿¡æ¯æ›´åŠ å®‰å…¨ã€‚</p><p>Session å¯ä»¥å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€æ•°æ®åº“æˆ–è€…å†…å­˜ä¸­ã€‚ä¹Ÿå¯ä»¥å°† Session å­˜å‚¨åœ¨ Redis è¿™ç§å†…å­˜å‹æ•°æ®åº“ä¸­ï¼Œæ•ˆç‡ä¼šæ›´é«˜ã€‚</p><p>ç”¨ Session ç»´æŠ¤ç”¨æˆ·ç™»å½•çŠ¶æ€çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>ç”¨æˆ·è¿›è¡Œç™»å½•æ—¶ï¼Œç”¨æˆ·æäº¤åŒ…å«ç”¨æˆ·åå’Œå¯†ç çš„è¡¨å•ï¼Œæ”¾å…¥ HTTP è¯·æ±‚æŠ¥æ–‡ä¸­ï¼›</li><li>æœåŠ¡å™¨éªŒè¯è¯¥ç”¨æˆ·åå’Œå¯†ç ï¼Œå¦‚æœæ­£ç¡®åˆ™æŠŠç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ° Redis ä¸­ï¼Œå®ƒåœ¨ Redis ä¸­çš„ Key ç§°ä¸º Session IDï¼›</li><li>æœåŠ¡å™¨è¿”å›çš„å“åº”æŠ¥æ–‡çš„ Set-Cookie é¦–éƒ¨å­—æ®µåŒ…å«äº†è¿™ä¸ª Session IDï¼Œå®¢æˆ·ç«¯æ”¶åˆ°å“åº”æŠ¥æ–‡ä¹‹åå°†è¯¥ Cookie å€¼å­˜å…¥æµè§ˆå™¨ä¸­ï¼›</li><li>å®¢æˆ·ç«¯ä¹‹åå¯¹åŒä¸€ä¸ªæœåŠ¡å™¨è¿›è¡Œè¯·æ±‚æ—¶ä¼šåŒ…å«è¯¥ Cookie å€¼ï¼ŒæœåŠ¡å™¨æ”¶åˆ°ä¹‹åæå–å‡º Session IDï¼Œä» Redis ä¸­å–å‡ºç”¨æˆ·ä¿¡æ¯ï¼Œç»§ç»­ä¹‹å‰çš„ä¸šåŠ¡æ“ä½œã€‚</li></ul><p>åº”è¯¥æ³¨æ„ Session ID çš„å®‰å…¨æ€§é—®é¢˜ï¼Œä¸èƒ½è®©å®ƒè¢«æ¶æ„æ”»å‡»è€…è½»æ˜“è·å–ï¼Œé‚£ä¹ˆå°±ä¸èƒ½äº§ç”Ÿä¸€ä¸ªå®¹æ˜“è¢«çŒœåˆ°çš„ Session ID å€¼ã€‚æ­¤å¤–ï¼Œè¿˜éœ€è¦ç»å¸¸é‡æ–°ç”Ÿæˆ Session IDã€‚åœ¨å¯¹å®‰å…¨æ€§è¦æ±‚æé«˜çš„åœºæ™¯ä¸‹ï¼Œä¾‹å¦‚è½¬è´¦ç­‰æ“ä½œï¼Œé™¤äº†ä½¿ç”¨ Session ç®¡ç†ç”¨æˆ·çŠ¶æ€ä¹‹å¤–ï¼Œè¿˜éœ€è¦å¯¹ç”¨æˆ·è¿›è¡Œé‡æ–°éªŒè¯ï¼Œæ¯”å¦‚é‡æ–°è¾“å…¥å¯†ç ï¼Œæˆ–è€…ä½¿ç”¨çŸ­ä¿¡éªŒè¯ç ç­‰æ–¹å¼ã€‚</p><h4 id="9-æµè§ˆå™¨ç¦ç”¨-Cookie"><a href="#9-æµè§ˆå™¨ç¦ç”¨-Cookie" class="headerlink" title="9. æµè§ˆå™¨ç¦ç”¨ Cookie"></a>9. æµè§ˆå™¨ç¦ç”¨ Cookie</h4><p>æ­¤æ—¶æ— æ³•ä½¿ç”¨ Cookie æ¥ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œåªèƒ½ä½¿ç”¨ Sessionã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¸èƒ½å†å°† Session ID å­˜æ”¾åˆ° Cookie ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨ URL é‡å†™æŠ€æœ¯ï¼Œå°† Session ID ä½œä¸º URL çš„å‚æ•°è¿›è¡Œä¼ é€’ã€‚</p><h4 id="10-Cookie-ä¸-Session-é€‰æ‹©"><a href="#10-Cookie-ä¸-Session-é€‰æ‹©" class="headerlink" title="10. Cookie ä¸ Session é€‰æ‹©"></a>10. Cookie ä¸ Session é€‰æ‹©</h4><ul><li>Cookie åªèƒ½å­˜å‚¨ ASCII ç å­—ç¬¦ä¸²ï¼Œè€Œ Session åˆ™å¯ä»¥å­˜å‚¨ä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œå› æ­¤åœ¨è€ƒè™‘æ•°æ®å¤æ‚æ€§æ—¶é¦–é€‰ Sessionï¼›</li><li>Cookie å­˜å‚¨åœ¨æµè§ˆå™¨ä¸­ï¼Œå®¹æ˜“è¢«æ¶æ„æŸ¥çœ‹ã€‚å¦‚æœéè¦å°†ä¸€äº›éšç§æ•°æ®å­˜åœ¨ Cookie ä¸­ï¼Œå¯ä»¥å°† Cookie å€¼è¿›è¡ŒåŠ å¯†ï¼Œç„¶ååœ¨æœåŠ¡å™¨è¿›è¡Œè§£å¯†ï¼›</li><li>å¯¹äºå¤§å‹ç½‘ç«™ï¼Œå¦‚æœç”¨æˆ·æ‰€æœ‰çš„ä¿¡æ¯éƒ½å­˜å‚¨åœ¨ Session ä¸­ï¼Œé‚£ä¹ˆå¼€é”€æ˜¯éå¸¸å¤§çš„ï¼Œå› æ­¤ä¸å»ºè®®å°†æ‰€æœ‰çš„ç”¨æˆ·ä¿¡æ¯éƒ½å­˜å‚¨åˆ° Session ä¸­ã€‚</li></ul><h3 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h3><h4 id="1-ä¼˜ç‚¹"><a href="#1-ä¼˜ç‚¹" class="headerlink" title="1. ä¼˜ç‚¹"></a>1. ä¼˜ç‚¹</h4><ul><li>ç¼“è§£æœåŠ¡å™¨å‹åŠ›ï¼›</li><li>é™ä½å®¢æˆ·ç«¯è·å–èµ„æºçš„å»¶è¿Ÿï¼šç¼“å­˜é€šå¸¸ä½äºå†…å­˜ä¸­ï¼Œè¯»å–ç¼“å­˜çš„é€Ÿåº¦æ›´å¿«ã€‚å¹¶ä¸”ç¼“å­˜æœåŠ¡å™¨åœ¨åœ°ç†ä½ç½®ä¸Šä¹Ÿæœ‰å¯èƒ½æ¯”æºæœåŠ¡å™¨æ¥å¾—è¿‘ï¼Œä¾‹å¦‚æµè§ˆå™¨ç¼“å­˜ã€‚</li></ul><h4 id="2-å®ç°æ–¹æ³•"><a href="#2-å®ç°æ–¹æ³•" class="headerlink" title="2. å®ç°æ–¹æ³•"></a>2. å®ç°æ–¹æ³•</h4><ul><li>è®©ä»£ç†æœåŠ¡å™¨è¿›è¡Œç¼“å­˜ï¼›</li><li>è®©å®¢æˆ·ç«¯æµè§ˆå™¨è¿›è¡Œç¼“å­˜ã€‚</li></ul><h4 id="3-Cache-Control"><a href="#3-Cache-Control" class="headerlink" title="3. Cache-Control"></a>3. Cache-Control</h4><p>HTTP/1.1 é€šè¿‡ Cache-Control é¦–éƒ¨å­—æ®µæ¥æ§åˆ¶ç¼“å­˜ã€‚</p><p><strong>3.1 ç¦æ­¢è¿›è¡Œç¼“å­˜</strong></p><p>no-tore æŒ‡ä»¤è§„å®šä¸èƒ½å¯¹è¯·æ±‚æˆ–å“åº”çš„ä»»ä½•ä¸€éƒ¨åˆ†è¿›è¡Œç¼“å­˜ã€‚</p><pre><code>Cache-Control: no-store</code></pre><p><strong>3.2 å¼ºåˆ¶ç¡®è®¤ç¼“å­˜</strong></p><p>no-cache æŒ‡ä»¤è§„å®šç¼“å­˜æœåŠ¡å™¨éœ€è¦å…ˆå‘æºæœåŠ¡å™¨éªŒè¯ç¼“å­˜èµ„æºçš„æœ‰æ•ˆæ€§ï¼Œåªæœ‰å½“ç¼“å­˜èµ„æºæœ‰æ•ˆæ—¶æ‰èƒ½ä½¿ç”¨è¯¥ç¼“å­˜å¯¹å®¢æˆ·ç«¯çš„è¯·æ±‚è¿›è¡Œå“åº”ã€‚</p><pre><code>Cache-Control: no-cache</code></pre><p><strong>3.3 ç§æœ‰ç¼“å­˜å’Œå…¬å…±ç¼“å­˜</strong></p><p>private æŒ‡ä»¤è§„å®šäº†å°†èµ„æºä½œä¸ºç§æœ‰ç¼“å­˜ï¼Œåªèƒ½è¢«å•ç‹¬ç”¨æˆ·ä½¿ç”¨ï¼Œä¸€èˆ¬å­˜å‚¨åœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­ã€‚</p><pre><code>Cache-Control: private</code></pre><p>public æŒ‡ä»¤è§„å®šäº†å°†èµ„æºä½œä¸ºå…¬å…±ç¼“å­˜ï¼Œå¯ä»¥è¢«å¤šä¸ªç”¨æˆ·ä½¿ç”¨ï¼Œä¸€èˆ¬å­˜å‚¨åœ¨ä»£ç†æœåŠ¡å™¨ä¸­ã€‚</p><pre><code>Cache-Control: public</code></pre><p><strong>3.4 ç¼“å­˜è¿‡æœŸæœºåˆ¶</strong></p><p>max-age æŒ‡ä»¤å‡ºç°åœ¨è¯·æ±‚æŠ¥æ–‡ï¼Œå¹¶ä¸”ç¼“å­˜èµ„æºçš„ç¼“å­˜æ—¶é—´å°äºè¯¥æŒ‡ä»¤æŒ‡å®šçš„æ—¶é—´ï¼Œé‚£ä¹ˆå°±èƒ½æ¥å—è¯¥ç¼“å­˜ã€‚</p><p>max-age æŒ‡ä»¤å‡ºç°åœ¨å“åº”æŠ¥æ–‡ï¼Œè¡¨ç¤ºç¼“å­˜èµ„æºåœ¨ç¼“å­˜æœåŠ¡å™¨ä¸­ä¿å­˜çš„æ—¶é—´ã€‚</p><pre><code>Cache-Control: max-age=31536000</code></pre><p>Exires é¦–éƒ¨å­—æ®µä¹Ÿå¯ä»¥ç”¨äºå‘ŠçŸ¥ç¼“å­˜æœåŠ¡å™¨è¯¥èµ„æºä»€ä¹ˆæ—¶å€™ä¼šè¿‡æœŸã€‚</p><pre><code>Expires: Wed, 04 Jul 2012 08:26:05 GMT</code></pre><ul><li>åœ¨ HTTP/1.1 ä¸­ï¼Œä¼šä¼˜å…ˆå¤„ç† max-age æŒ‡ä»¤ï¼›</li><li>åœ¨ HTTP/1.0 ä¸­ï¼Œmax-age æŒ‡ä»¤ä¼šè¢«å¿½ç•¥æ‰ã€‚</li></ul><h4 id="4-ç¼“å­˜éªŒè¯"><a href="#4-ç¼“å­˜éªŒè¯" class="headerlink" title="4. ç¼“å­˜éªŒè¯"></a>4. ç¼“å­˜éªŒè¯</h4><p>éœ€è¦å…ˆäº†è§£ ETag é¦–éƒ¨å­—æ®µçš„å«ä¹‰ï¼Œå®ƒæ˜¯èµ„æºçš„å”¯ä¸€æ ‡è¯†ã€‚URL ä¸èƒ½å”¯ä¸€è¡¨ç¤ºèµ„æºï¼Œä¾‹å¦‚ <code>http://www.google.com/</code> æœ‰ä¸­æ–‡å’Œè‹±æ–‡ä¸¤ä¸ªèµ„æºï¼Œåªæœ‰ ETag æ‰èƒ½å¯¹è¿™ä¸¤ä¸ªèµ„æºè¿›è¡Œå”¯ä¸€æ ‡è¯†ã€‚</p><pre><code>ETag: "82e22293907ce725faf67773957acd12"</code></pre><p>å¯ä»¥å°†ç¼“å­˜èµ„æºçš„ ETag å€¼æ”¾å…¥ If-None-Match é¦–éƒ¨ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯¥è¯·æ±‚åï¼Œåˆ¤æ–­ç¼“å­˜èµ„æºçš„ ETag å€¼å’Œèµ„æºçš„æœ€æ–° ETag å€¼æ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸€è‡´åˆ™è¡¨ç¤ºç¼“å­˜èµ„æºæœ‰æ•ˆï¼Œè¿”å› 304 Not Modifiedã€‚</p><pre><code>If-None-Match: "82e22293907ce725faf67773957acd12"</code></pre><p>Last-Modified é¦–éƒ¨å­—æ®µä¹Ÿå¯ä»¥ç”¨äºç¼“å­˜éªŒè¯ï¼Œå®ƒåŒ…å«åœ¨æºæœåŠ¡å™¨å‘é€çš„å“åº”æŠ¥æ–‡ä¸­ï¼ŒæŒ‡ç¤ºæºæœåŠ¡å™¨å¯¹èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ã€‚ä½†æ˜¯å®ƒæ˜¯ä¸€ç§å¼±æ ¡éªŒå™¨ï¼Œå› ä¸ºåªèƒ½ç²¾ç¡®åˆ°ä¸€ç§’ï¼Œæ‰€ä»¥å®ƒé€šå¸¸ä½œä¸º ETag çš„å¤‡ç”¨æ–¹æ¡ˆã€‚å¦‚æœå“åº”é¦–éƒ¨å­—æ®µé‡Œå«æœ‰è¿™ä¸ªä¿¡æ¯ï¼Œå®¢æˆ·ç«¯å¯ä»¥åœ¨åç»­çš„è¯·æ±‚ä¸­å¸¦ä¸Š If-Modified-Since æ¥éªŒè¯ç¼“å­˜ã€‚æœåŠ¡å™¨åªåœ¨æ‰€è¯·æ±‚çš„èµ„æºåœ¨ç»™å®šçš„æ—¥æœŸæ—¶é—´ä¹‹åå¯¹å†…å®¹è¿›è¡Œè¿‡ä¿®æ”¹çš„æƒ…å†µä¸‹æ‰ä¼šå°†èµ„æºè¿”å›ï¼ŒçŠ¶æ€ç ä¸º 200 OKã€‚å¦‚æœè¯·æ±‚çš„èµ„æºä»é‚£æ—¶èµ·æœªç»ä¿®æ”¹ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ªä¸å¸¦æœ‰å®ä½“ä¸»ä½“çš„ 304 Not Modified å“åº”æŠ¥æ–‡ã€‚</p><pre><code>Last-Modified: Wed, 21 Oct 2015 07:28:00 GMT</code></pre><pre><code>If-Modified-Since: Wed, 21 Oct 2015 07:28:00 GMT</code></pre><h3 id="å†…å®¹åå•†"><a href="#å†…å®¹åå•†" class="headerlink" title="å†…å®¹åå•†"></a>å†…å®¹åå•†</h3><p>é€šè¿‡å†…å®¹åå•†è¿”å›æœ€åˆé€‚çš„å†…å®¹ï¼Œä¾‹å¦‚æ ¹æ®æµè§ˆå™¨çš„é»˜è®¤è¯­è¨€é€‰æ‹©è¿”å›ä¸­æ–‡ç•Œé¢è¿˜æ˜¯è‹±æ–‡ç•Œé¢ã€‚</p><h4 id="1-ç±»å‹"><a href="#1-ç±»å‹" class="headerlink" title="1. ç±»å‹"></a>1. ç±»å‹</h4><p><strong>1.1 æœåŠ¡ç«¯é©±åŠ¨å‹</strong></p><p>å®¢æˆ·ç«¯è®¾ç½®ç‰¹å®šçš„ HTTP é¦–éƒ¨å­—æ®µï¼Œä¾‹å¦‚ Acceptã€Accept-Charsetã€Accept-Encodingã€Accept-Languageï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™äº›å­—æ®µè¿”å›ç‰¹å®šçš„èµ„æºã€‚</p><p>å®ƒå­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li>æœåŠ¡å™¨å¾ˆéš¾çŸ¥é“å®¢æˆ·ç«¯æµè§ˆå™¨çš„å…¨éƒ¨ä¿¡æ¯ï¼›</li><li>å®¢æˆ·ç«¯æä¾›çš„ä¿¡æ¯ç›¸å½“å†—é•¿ï¼ˆHTTP/2 åè®®çš„é¦–éƒ¨å‹ç¼©æœºåˆ¶ç¼“è§£äº†è¿™ä¸ªé—®é¢˜ï¼‰ï¼Œå¹¶ä¸”å­˜åœ¨éšç§é£é™©ï¼ˆHTTP æŒ‡çº¹è¯†åˆ«æŠ€æœ¯ï¼‰ï¼›</li><li>ç»™å®šçš„èµ„æºéœ€è¦è¿”å›ä¸åŒçš„å±•ç°å½¢å¼ï¼Œå…±äº«ç¼“å­˜çš„æ•ˆç‡ä¼šé™ä½ï¼Œè€ŒæœåŠ¡å™¨ç«¯çš„å®ç°ä¼šè¶Šæ¥è¶Šå¤æ‚ã€‚</li></ul><p><strong>1.2 ä»£ç†é©±åŠ¨å‹</strong></p><p>æœåŠ¡å™¨è¿”å› 300 Multiple Choices æˆ–è€… 406 Not Acceptableï¼Œå®¢æˆ·ç«¯ä»ä¸­é€‰å‡ºæœ€åˆé€‚çš„é‚£ä¸ªèµ„æºã€‚</p><h4 id="2-Vary"><a href="#2-Vary" class="headerlink" title="2. Vary"></a>2. Vary</h4><pre><code>Vary: Accept-Language</code></pre><p>åœ¨ä½¿ç”¨å†…å®¹åå•†çš„æƒ…å†µä¸‹ï¼Œåªæœ‰å½“ç¼“å­˜æœåŠ¡å™¨ä¸­çš„ç¼“å­˜æ»¡è¶³å†…å®¹åå•†æ¡ä»¶æ—¶ï¼Œæ‰èƒ½ä½¿ç”¨è¯¥ç¼“å­˜ï¼Œå¦åˆ™åº”è¯¥å‘æºæœåŠ¡å™¨è¯·æ±‚è¯¥èµ„æºã€‚</p><p>ä¾‹å¦‚ï¼Œä¸€ä¸ªå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªåŒ…å« Accept-Language é¦–éƒ¨å­—æ®µçš„è¯·æ±‚ä¹‹åï¼ŒæºæœåŠ¡å™¨è¿”å›çš„å“åº”åŒ…å« <code>Vary: Accept-Language</code> å†…å®¹ï¼Œç¼“å­˜æœåŠ¡å™¨å¯¹è¿™ä¸ªå“åº”è¿›è¡Œç¼“å­˜ä¹‹åï¼Œåœ¨å®¢æˆ·ç«¯ä¸‹ä¸€æ¬¡è®¿é—®åŒä¸€ä¸ª URL èµ„æºï¼Œå¹¶ä¸” Accept-Language ä¸ç¼“å­˜ä¸­çš„å¯¹åº”çš„å€¼ç›¸åŒæ—¶æ‰ä¼šè¿”å›è¯¥ç¼“å­˜ã€‚</p><h3 id="å†…å®¹ç¼–ç "><a href="#å†…å®¹ç¼–ç " class="headerlink" title="å†…å®¹ç¼–ç "></a>å†…å®¹ç¼–ç </h3><p>å†…å®¹ç¼–ç å°†å®ä½“ä¸»ä½“è¿›è¡Œå‹ç¼©ï¼Œä»è€Œå‡å°‘ä¼ è¾“çš„æ•°æ®é‡ã€‚</p><p>å¸¸ç”¨çš„å†…å®¹ç¼–ç æœ‰ï¼šgzipã€compressã€deflateã€identityã€‚</p><p>æµè§ˆå™¨å‘é€ Accept-Encoding é¦–éƒ¨ï¼Œå…¶ä¸­åŒ…å«æœ‰å®ƒæ‰€æ”¯æŒçš„å‹ç¼©ç®—æ³•ï¼Œä»¥åŠå„è‡ªçš„ä¼˜å…ˆçº§ã€‚æœåŠ¡å™¨åˆ™ä»ä¸­é€‰æ‹©ä¸€ç§ï¼Œä½¿ç”¨è¯¥ç®—æ³•å¯¹å“åº”çš„æ¶ˆæ¯ä¸»ä½“è¿›è¡Œå‹ç¼©ï¼Œå¹¶ä¸”å‘é€ Content-Encoding é¦–éƒ¨æ¥å‘ŠçŸ¥æµè§ˆå™¨å®ƒé€‰æ‹©äº†å“ªä¸€ç§ç®—æ³•ã€‚ç”±äºè¯¥å†…å®¹åå•†è¿‡ç¨‹æ˜¯åŸºäºç¼–ç ç±»å‹æ¥é€‰æ‹©èµ„æºçš„å±•ç°å½¢å¼çš„ï¼Œå“åº”æŠ¥æ–‡çš„ Vary é¦–éƒ¨å­—æ®µè‡³å°‘è¦åŒ…å« Content-Encodingã€‚</p><h3 id="èŒƒå›´è¯·æ±‚"><a href="#èŒƒå›´è¯·æ±‚" class="headerlink" title="èŒƒå›´è¯·æ±‚"></a>èŒƒå›´è¯·æ±‚</h3><p>å¦‚æœç½‘ç»œå‡ºç°ä¸­æ–­ï¼ŒæœåŠ¡å™¨åªå‘é€äº†ä¸€éƒ¨åˆ†æ•°æ®ï¼ŒèŒƒå›´è¯·æ±‚å¯ä»¥ä½¿å¾—å®¢æˆ·ç«¯åªè¯·æ±‚æœåŠ¡å™¨æœªå‘é€çš„é‚£éƒ¨åˆ†æ•°æ®ï¼Œä»è€Œé¿å…æœåŠ¡å™¨é‡æ–°å‘é€æ‰€æœ‰æ•°æ®ã€‚</p><h4 id="1-Range"><a href="#1-Range" class="headerlink" title="1. Range"></a>1. Range</h4><p>åœ¨è¯·æ±‚æŠ¥æ–‡ä¸­æ·»åŠ  Range é¦–éƒ¨å­—æ®µæŒ‡å®šè¯·æ±‚çš„èŒƒå›´ã€‚</p><pre><code>GET /z4d4kWk.jpg HTTP/1.1Host: i.imgur.comRange: bytes=0-1023</code></pre><p>è¯·æ±‚æˆåŠŸçš„è¯æœåŠ¡å™¨è¿”å›çš„å“åº”åŒ…å« 206 Partial Content çŠ¶æ€ç ã€‚</p><pre><code>HTTP/1.1 206 Partial ContentContent-Range: bytes 0-1023/146515Content-Length: 1024...(binary content)</code></pre><h4 id="2-Accept-Ranges"><a href="#2-Accept-Ranges" class="headerlink" title="2. Accept-Ranges"></a>2. Accept-Ranges</h4><p>å“åº”é¦–éƒ¨å­—æ®µ Accept-Ranges ç”¨äºå‘ŠçŸ¥å®¢æˆ·ç«¯æ˜¯å¦èƒ½å¤„ç†èŒƒå›´è¯·æ±‚ï¼Œå¯ä»¥å¤„ç†ä½¿ç”¨ bytesï¼Œå¦åˆ™ä½¿ç”¨ noneã€‚</p><pre><code>Accept-Ranges: bytes</code></pre><h4 id="3-å“åº”çŠ¶æ€ç "><a href="#3-å“åº”çŠ¶æ€ç " class="headerlink" title="3. å“åº”çŠ¶æ€ç "></a>3. å“åº”çŠ¶æ€ç </h4><ul><li>åœ¨è¯·æ±‚æˆåŠŸçš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä¼šè¿”å› 206 Partial Content çŠ¶æ€ç ã€‚</li><li>åœ¨è¯·æ±‚çš„èŒƒå›´è¶Šç•Œçš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä¼šè¿”å› 416 Requested Range Not Satisfiable çŠ¶æ€ç ã€‚</li><li>åœ¨ä¸æ”¯æŒèŒƒå›´è¯·æ±‚çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä¼šè¿”å› 200 OK çŠ¶æ€ç ã€‚</li></ul><h3 id="åˆ†å—ä¼ è¾“ç¼–ç "><a href="#åˆ†å—ä¼ è¾“ç¼–ç " class="headerlink" title="åˆ†å—ä¼ è¾“ç¼–ç "></a>åˆ†å—ä¼ è¾“ç¼–ç </h3><p>Chunked Transfer Encodingï¼Œå¯ä»¥æŠŠæ•°æ®åˆ†å‰²æˆå¤šå—ï¼Œè®©æµè§ˆå™¨é€æ­¥æ˜¾ç¤ºé¡µé¢ã€‚</p><h3 id="å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆ"><a href="#å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆ" class="headerlink" title="å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆ"></a>å¤šéƒ¨åˆ†å¯¹è±¡é›†åˆ</h3><p>ä¸€ä»½æŠ¥æ–‡ä¸»ä½“å†…å¯å«æœ‰å¤šç§ç±»å‹çš„å®ä½“åŒæ—¶å‘é€ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¹‹é—´ç”¨ boundary å­—æ®µå®šä¹‰çš„åˆ†éš”ç¬¦è¿›è¡Œåˆ†éš”ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥æœ‰é¦–éƒ¨å­—æ®µã€‚</p><p>ä¾‹å¦‚ï¼Œä¸Šä¼ å¤šä¸ªè¡¨å•æ—¶å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š</p><pre><code>Content-Type: multipart/form-data; boundary=AaB03x--AaB03xContent-Disposition: form-data; name="submit-name"Larry--AaB03xContent-Disposition: form-data; name="files"; filename="file1.txt"Content-Type: text/plain... contents of file1.txt ...--AaB03x--</code></pre><h3 id="è™šæ‹Ÿä¸»æœº"><a href="#è™šæ‹Ÿä¸»æœº" class="headerlink" title="è™šæ‹Ÿä¸»æœº"></a>è™šæ‹Ÿä¸»æœº</h3><p>HTTP/1.1 ä½¿ç”¨è™šæ‹Ÿä¸»æœºæŠ€æœ¯ï¼Œä½¿å¾—ä¸€å°æœåŠ¡å™¨æ‹¥æœ‰å¤šä¸ªåŸŸåï¼Œå¹¶ä¸”åœ¨é€»è¾‘ä¸Šå¯ä»¥çœ‹æˆå¤šä¸ªæœåŠ¡å™¨ã€‚</p><h3 id="é€šä¿¡æ•°æ®è½¬å‘"><a href="#é€šä¿¡æ•°æ®è½¬å‘" class="headerlink" title="é€šä¿¡æ•°æ®è½¬å‘"></a>é€šä¿¡æ•°æ®è½¬å‘</h3><h4 id="1-ä»£ç†"><a href="#1-ä»£ç†" class="headerlink" title="1. ä»£ç†"></a>1. ä»£ç†</h4><p>ä»£ç†æœåŠ¡å™¨æ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶ä¸”è½¬å‘ç»™å…¶å®ƒæœåŠ¡å™¨ã€‚</p><p>ä½¿ç”¨ä»£ç†çš„ä¸»è¦ç›®çš„æ˜¯ï¼š</p><ul><li>ç¼“å­˜</li><li>è´Ÿè½½å‡è¡¡</li><li>ç½‘ç»œè®¿é—®æ§åˆ¶</li><li>è®¿é—®æ—¥å¿—è®°å½•</li></ul><p>ä»£ç†æœåŠ¡å™¨åˆ†ä¸ºæ­£å‘ä»£ç†å’Œåå‘ä»£ç†ä¸¤ç§ï¼š</p><ul><li>ç”¨æˆ·å¯Ÿè§‰å¾—åˆ°æ­£å‘ä»£ç†çš„å­˜åœ¨ã€‚</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162424.png" alt="image"></p><ul><li>è€Œåå‘ä»£ç†ä¸€èˆ¬ä½äºå†…éƒ¨ç½‘ç»œä¸­ï¼Œç”¨æˆ·å¯Ÿè§‰ä¸åˆ°ã€‚</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162430.png" alt="image"></p><h4 id="2-ç½‘å…³"><a href="#2-ç½‘å…³" class="headerlink" title="2. ç½‘å…³"></a>2. ç½‘å…³</h4><p>ä¸ä»£ç†æœåŠ¡å™¨ä¸åŒçš„æ˜¯ï¼Œç½‘å…³æœåŠ¡å™¨ä¼šå°† HTTP è½¬åŒ–ä¸ºå…¶å®ƒåè®®è¿›è¡Œé€šä¿¡ï¼Œä»è€Œè¯·æ±‚å…¶å®ƒé HTTP æœåŠ¡å™¨çš„æœåŠ¡ã€‚</p><h4 id="3-éš§é“"><a href="#3-éš§é“" class="headerlink" title="3. éš§é“"></a>3. éš§é“</h4><p>ä½¿ç”¨ SSL ç­‰åŠ å¯†æ‰‹æ®µï¼Œåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹ä¸€æ¡å®‰å…¨çš„é€šä¿¡çº¿è·¯ã€‚</p><h2 id="å…­ã€HTTPS"><a href="#å…­ã€HTTPS" class="headerlink" title="å…­ã€HTTPS"></a>å…­ã€HTTPS</h2><p>HTTP æœ‰ä»¥ä¸‹å®‰å…¨æ€§é—®é¢˜ï¼š</p><ul><li>ä½¿ç”¨æ˜æ–‡è¿›è¡Œé€šä¿¡ï¼Œå†…å®¹å¯èƒ½ä¼šè¢«çªƒå¬ï¼›</li><li>ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œé€šä¿¡æ–¹çš„èº«ä»½æœ‰å¯èƒ½é­é‡ä¼ªè£…ï¼›</li><li>æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼ŒæŠ¥æ–‡æœ‰å¯èƒ½é­ç¯¡æ”¹ã€‚</li></ul><p>HTTPS å¹¶ä¸æ˜¯æ–°åè®®ï¼Œè€Œæ˜¯è®© HTTP å…ˆå’Œ SSLï¼ˆSecure Sockets Layerï¼‰é€šä¿¡ï¼Œå†ç”± SSL å’Œ TCP é€šä¿¡ï¼Œä¹Ÿå°±æ˜¯è¯´ HTTPS ä½¿ç”¨äº†éš§é“è¿›è¡Œé€šä¿¡ã€‚</p><p>é€šè¿‡ä½¿ç”¨ SSLï¼ŒHTTPS å…·æœ‰äº†åŠ å¯†ï¼ˆé˜²çªƒå¬ï¼‰ã€è®¤è¯ï¼ˆé˜²ä¼ªè£…ï¼‰å’Œå®Œæ•´æ€§ä¿æŠ¤ï¼ˆé˜²ç¯¡æ”¹ï¼‰ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162437.jpeg" alt="image"></p><h3 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h3><h4 id="1-å¯¹ç§°å¯†é’¥åŠ å¯†"><a href="#1-å¯¹ç§°å¯†é’¥åŠ å¯†" class="headerlink" title="1. å¯¹ç§°å¯†é’¥åŠ å¯†"></a>1. å¯¹ç§°å¯†é’¥åŠ å¯†</h4><p>å¯¹ç§°å¯†é’¥åŠ å¯†ï¼ˆSymmetric-Key Encryptionï¼‰ï¼ŒåŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€å¯†é’¥ã€‚</p><ul><li>ä¼˜ç‚¹ï¼šè¿ç®—é€Ÿåº¦å¿«ï¼›</li><li>ç¼ºç‚¹ï¼šæ— æ³•å®‰å…¨åœ°å°†å¯†é’¥ä¼ è¾“ç»™é€šä¿¡æ–¹ã€‚</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162449.png" alt="image"></p><h4 id="2-éå¯¹ç§°å¯†é’¥åŠ å¯†"><a href="#2-éå¯¹ç§°å¯†é’¥åŠ å¯†" class="headerlink" title="2.éå¯¹ç§°å¯†é’¥åŠ å¯†"></a>2.éå¯¹ç§°å¯†é’¥åŠ å¯†</h4><p>éå¯¹ç§°å¯†é’¥åŠ å¯†ï¼Œåˆç§°å…¬å¼€å¯†é’¥åŠ å¯†ï¼ˆPublic-Key Encryptionï¼‰ï¼ŒåŠ å¯†å’Œè§£å¯†ä½¿ç”¨ä¸åŒçš„å¯†é’¥ã€‚</p><p>å…¬å¼€å¯†é’¥æ‰€æœ‰äººéƒ½å¯ä»¥è·å¾—ï¼Œé€šä¿¡å‘é€æ–¹è·å¾—æ¥æ”¶æ–¹çš„å…¬å¼€å¯†é’¥ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨å…¬å¼€å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œæ¥æ”¶æ–¹æ”¶åˆ°é€šä¿¡å†…å®¹åä½¿ç”¨ç§æœ‰å¯†é’¥è§£å¯†ã€‚</p><p>éå¯¹ç§°å¯†é’¥é™¤äº†ç”¨æ¥åŠ å¯†ï¼Œè¿˜å¯ä»¥ç”¨æ¥è¿›è¡Œç­¾åã€‚å› ä¸ºç§æœ‰å¯†é’¥æ— æ³•è¢«å…¶ä»–äººè·å–ï¼Œå› æ­¤é€šä¿¡å‘é€æ–¹ä½¿ç”¨å…¶ç§æœ‰å¯†é’¥è¿›è¡Œç­¾åï¼Œé€šä¿¡æ¥æ”¶æ–¹ä½¿ç”¨å‘é€æ–¹çš„å…¬å¼€å¯†é’¥å¯¹ç­¾åè¿›è¡Œè§£å¯†ï¼Œå°±èƒ½åˆ¤æ–­è¿™ä¸ªç­¾åæ˜¯å¦æ­£ç¡®ã€‚</p><ul><li>ä¼˜ç‚¹ï¼šå¯ä»¥æ›´å®‰å…¨åœ°å°†å…¬å¼€å¯†é’¥ä¼ è¾“ç»™é€šä¿¡å‘é€æ–¹ï¼›</li><li>ç¼ºç‚¹ï¼šè¿ç®—é€Ÿåº¦æ…¢ã€‚</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162453.png" alt="image"></p><h4 id="3-HTTPS-é‡‡ç”¨çš„åŠ å¯†æ–¹å¼"><a href="#3-HTTPS-é‡‡ç”¨çš„åŠ å¯†æ–¹å¼" class="headerlink" title="3. HTTPS é‡‡ç”¨çš„åŠ å¯†æ–¹å¼"></a>3. HTTPS é‡‡ç”¨çš„åŠ å¯†æ–¹å¼</h4><p>ä¸Šé¢æåˆ°å¯¹ç§°å¯†é’¥åŠ å¯†æ–¹å¼çš„ä¼ è¾“æ•ˆç‡æ›´é«˜ï¼Œä½†æ˜¯æ— æ³•å®‰å…¨åœ°å°†å¯†é’¥ Secret Key ä¼ è¾“ç»™é€šä¿¡æ–¹ã€‚è€Œéå¯¹ç§°å¯†é’¥åŠ å¯†æ–¹å¼å¯ä»¥ä¿è¯ä¼ è¾“çš„å®‰å…¨æ€§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨éå¯¹ç§°å¯†é’¥åŠ å¯†æ–¹å¼å°† Secret Key  ä¼ è¾“ç»™é€šä¿¡æ–¹ã€‚HTTPS é‡‡ç”¨æ··åˆçš„åŠ å¯†æœºåˆ¶ï¼Œæ­£æ˜¯åˆ©ç”¨äº†ä¸Šé¢æåˆ°çš„æ–¹æ¡ˆï¼š</p><ul><li>ä½¿ç”¨éå¯¹ç§°å¯†é’¥åŠ å¯†æ–¹å¼ï¼Œä¼ è¾“å¯¹ç§°å¯†é’¥åŠ å¯†æ–¹å¼æ‰€éœ€è¦çš„ Secret Keyï¼Œä»è€Œä¿è¯å®‰å…¨æ€§;</li><li>è·å–åˆ° Secret Key åï¼Œå†ä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†æ–¹å¼è¿›è¡Œé€šä¿¡ï¼Œä»è€Œä¿è¯æ•ˆç‡ã€‚ï¼ˆä¸‹å›¾ä¸­çš„ Session Key å°±æ˜¯ Secret Keyï¼‰</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162457.png" alt="image"></p><h3 id="è®¤è¯"><a href="#è®¤è¯" class="headerlink" title="è®¤è¯"></a>è®¤è¯</h3><p>é€šè¿‡ä½¿ç”¨  <strong>è¯ä¹¦</strong>  æ¥å¯¹é€šä¿¡æ–¹è¿›è¡Œè®¤è¯ã€‚</p><p>æ•°å­—è¯ä¹¦è®¤è¯æœºæ„ï¼ˆCAï¼ŒCertificate Authorityï¼‰æ˜¯å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨åŒæ–¹éƒ½å¯ä¿¡èµ–çš„ç¬¬ä¸‰æ–¹æœºæ„ã€‚</p><p>æœåŠ¡å™¨çš„è¿è¥äººå‘˜å‘ CA æå‡ºå…¬å¼€å¯†é’¥çš„ç”³è¯·ï¼ŒCA åœ¨åˆ¤æ˜æå‡ºç”³è¯·è€…çš„èº«ä»½ä¹‹åï¼Œä¼šå¯¹å·²ç”³è¯·çš„å…¬å¼€å¯†é’¥åšæ•°å­—ç­¾åï¼Œç„¶ååˆ†é…è¿™ä¸ªå·²ç­¾åçš„å…¬å¼€å¯†é’¥ï¼Œå¹¶å°†è¯¥å…¬å¼€å¯†é’¥æ”¾å…¥å…¬å¼€å¯†é’¥è¯ä¹¦åç»‘å®šåœ¨ä¸€èµ·ã€‚</p><p>è¿›è¡Œ HTTPS é€šä¿¡æ—¶ï¼ŒæœåŠ¡å™¨ä¼šæŠŠè¯ä¹¦å‘é€ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯å–å¾—å…¶ä¸­çš„å…¬å¼€å¯†é’¥ä¹‹åï¼Œå…ˆä½¿ç”¨æ•°å­—ç­¾åè¿›è¡ŒéªŒè¯ï¼Œå¦‚æœéªŒè¯é€šè¿‡ï¼Œå°±å¯ä»¥å¼€å§‹é€šä¿¡äº†ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162501.png" alt="image"></p><h3 id="å®Œæ•´æ€§ä¿æŠ¤"><a href="#å®Œæ•´æ€§ä¿æŠ¤" class="headerlink" title="å®Œæ•´æ€§ä¿æŠ¤"></a>å®Œæ•´æ€§ä¿æŠ¤</h3><p>SSL æä¾›æŠ¥æ–‡æ‘˜è¦åŠŸèƒ½æ¥è¿›è¡Œå®Œæ•´æ€§ä¿æŠ¤ã€‚</p><p>HTTP ä¹Ÿæä¾›äº† MD5 æŠ¥æ–‡æ‘˜è¦åŠŸèƒ½ï¼Œä½†ä¸æ˜¯å®‰å…¨çš„ã€‚ä¾‹å¦‚æŠ¥æ–‡å†…å®¹è¢«ç¯¡æ”¹ä¹‹åï¼ŒåŒæ—¶é‡æ–°è®¡ç®— MD5 çš„å€¼ï¼Œé€šä¿¡æ¥æ”¶æ–¹æ˜¯æ— æ³•æ„è¯†åˆ°å‘ç”Ÿäº†ç¯¡æ”¹ã€‚</p><p>HTTPS çš„æŠ¥æ–‡æ‘˜è¦åŠŸèƒ½ä¹‹æ‰€ä»¥å®‰å…¨ï¼Œæ˜¯å› ä¸ºå®ƒç»“åˆäº†åŠ å¯†å’Œè®¤è¯è¿™ä¸¤ä¸ªæ“ä½œã€‚è¯•æƒ³ä¸€ä¸‹ï¼ŒåŠ å¯†ä¹‹åçš„æŠ¥æ–‡ï¼Œé­åˆ°ç¯¡æ”¹ä¹‹åï¼Œä¹Ÿå¾ˆéš¾é‡æ–°è®¡ç®—æŠ¥æ–‡æ‘˜è¦ï¼Œå› ä¸ºæ— æ³•è½»æ˜“è·å–æ˜æ–‡ã€‚</p><h3 id="HTTPS-çš„ç¼ºç‚¹"><a href="#HTTPS-çš„ç¼ºç‚¹" class="headerlink" title="HTTPS çš„ç¼ºç‚¹"></a>HTTPS çš„ç¼ºç‚¹</h3><ul><li>å› ä¸ºéœ€è¦è¿›è¡ŒåŠ å¯†è§£å¯†ç­‰è¿‡ç¨‹ï¼Œå› æ­¤é€Ÿåº¦ä¼šæ›´æ…¢ï¼›</li><li>éœ€è¦æ”¯ä»˜è¯ä¹¦æˆæƒçš„é«˜é¢è´¹ç”¨ã€‚</li></ul><h2 id="ä¸ƒã€HTTP-2-0"><a href="#ä¸ƒã€HTTP-2-0" class="headerlink" title="ä¸ƒã€HTTP/2.0"></a>ä¸ƒã€HTTP/2.0</h2><h3 id="HTTP-1-x-ç¼ºé™·"><a href="#HTTP-1-x-ç¼ºé™·" class="headerlink" title="HTTP/1.x ç¼ºé™·"></a>HTTP/1.x ç¼ºé™·</h3><p>HTTP/1.x å®ç°ç®€å•æ˜¯ä»¥ç‰ºç‰²æ€§èƒ½ä¸ºä»£ä»·çš„ï¼š</p><ul><li>å®¢æˆ·ç«¯éœ€è¦ä½¿ç”¨å¤šä¸ªè¿æ¥æ‰èƒ½å®ç°å¹¶å‘å’Œç¼©çŸ­å»¶è¿Ÿï¼›</li><li>ä¸ä¼šå‹ç¼©è¯·æ±‚å’Œå“åº”é¦–éƒ¨ï¼Œä»è€Œå¯¼è‡´ä¸å¿…è¦çš„ç½‘ç»œæµé‡ï¼›</li><li>ä¸æ”¯æŒæœ‰æ•ˆçš„èµ„æºä¼˜å…ˆçº§ï¼Œè‡´ä½¿åº•å±‚ TCP è¿æ¥çš„åˆ©ç”¨ç‡ä½ä¸‹ã€‚</li></ul><h3 id="äºŒè¿›åˆ¶åˆ†å¸§å±‚"><a href="#äºŒè¿›åˆ¶åˆ†å¸§å±‚" class="headerlink" title="äºŒè¿›åˆ¶åˆ†å¸§å±‚"></a>äºŒè¿›åˆ¶åˆ†å¸§å±‚</h3><p>HTTP/2.0 å°†æŠ¥æ–‡åˆ†æˆ HEADERS å¸§å’Œ DATA å¸§ï¼Œå®ƒä»¬éƒ½æ˜¯äºŒè¿›åˆ¶æ ¼å¼çš„ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162506.png" alt="image"></p><p>åœ¨é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œåªä¼šæœ‰ä¸€ä¸ª TCP è¿æ¥å­˜åœ¨ï¼Œå®ƒæ‰¿è½½äº†ä»»æ„æ•°é‡çš„åŒå‘æ•°æ®æµï¼ˆStreamï¼‰ã€‚</p><ul><li>ä¸€ä¸ªæ•°æ®æµï¼ˆStreamï¼‰éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦å’Œå¯é€‰çš„ä¼˜å…ˆçº§ä¿¡æ¯ï¼Œç”¨äºæ‰¿è½½åŒå‘ä¿¡æ¯ã€‚</li><li>æ¶ˆæ¯ï¼ˆMessageï¼‰æ˜¯ä¸é€»è¾‘è¯·æ±‚æˆ–å“åº”å¯¹åº”çš„å®Œæ•´çš„ä¸€ç³»åˆ—å¸§ã€‚</li><li>å¸§ï¼ˆFrameï¼‰æ˜¯æœ€å°çš„é€šä¿¡å•ä½ï¼Œæ¥è‡ªä¸åŒæ•°æ®æµçš„å¸§å¯ä»¥äº¤é”™å‘é€ï¼Œç„¶åå†æ ¹æ®æ¯ä¸ªå¸§å¤´çš„æ•°æ®æµæ ‡è¯†ç¬¦é‡æ–°ç»„è£…ã€‚</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162511.png" alt="image"></p><h3 id="æœåŠ¡ç«¯æ¨é€"><a href="#æœåŠ¡ç«¯æ¨é€" class="headerlink" title="æœåŠ¡ç«¯æ¨é€"></a>æœåŠ¡ç«¯æ¨é€</h3><p>HTTP/2.0 åœ¨å®¢æˆ·ç«¯è¯·æ±‚ä¸€ä¸ªèµ„æºæ—¶ï¼Œä¼šæŠŠç›¸å…³çš„èµ„æºä¸€èµ·å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å°±ä¸éœ€è¦å†æ¬¡å‘èµ·è¯·æ±‚äº†ã€‚ä¾‹å¦‚å®¢æˆ·ç«¯è¯·æ±‚ page.html é¡µé¢ï¼ŒæœåŠ¡ç«¯å°±æŠŠ script.js å’Œ style.css ç­‰ä¸ä¹‹ç›¸å…³çš„èµ„æºä¸€èµ·å‘ç»™å®¢æˆ·ç«¯ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162515.png" alt="image"></p><h3 id="é¦–éƒ¨å‹ç¼©"><a href="#é¦–éƒ¨å‹ç¼©" class="headerlink" title="é¦–éƒ¨å‹ç¼©"></a>é¦–éƒ¨å‹ç¼©</h3><p>HTTP/1.1 çš„é¦–éƒ¨å¸¦æœ‰å¤§é‡ä¿¡æ¯ï¼Œè€Œä¸”æ¯æ¬¡éƒ½è¦é‡å¤å‘é€ã€‚</p><p>HTTP/2.0 è¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ—¶ç»´æŠ¤å’Œæ›´æ–°ä¸€ä¸ªåŒ…å«ä¹‹å‰è§è¿‡çš„é¦–éƒ¨å­—æ®µè¡¨ï¼Œä»è€Œé¿å…äº†é‡å¤ä¼ è¾“ã€‚</p><p>ä¸ä»…å¦‚æ­¤ï¼ŒHTTP/2.0 ä¹Ÿä½¿ç”¨ Huffman ç¼–ç å¯¹é¦–éƒ¨å­—æ®µè¿›è¡Œå‹ç¼©ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201129162520.png" alt="image"></p><h2 id="å…«ã€HTTP-1-1-æ–°ç‰¹æ€§"><a href="#å…«ã€HTTP-1-1-æ–°ç‰¹æ€§" class="headerlink" title="å…«ã€HTTP/1.1 æ–°ç‰¹æ€§"></a>å…«ã€HTTP/1.1 æ–°ç‰¹æ€§</h2><p>è¯¦ç»†å†…å®¹è¯·è§ä¸Šæ–‡</p><ul><li>é»˜è®¤æ˜¯é•¿è¿æ¥</li><li>æ”¯æŒæµæ°´çº¿</li><li>æ”¯æŒåŒæ—¶æ‰“å¼€å¤šä¸ª TCP è¿æ¥</li><li>æ”¯æŒè™šæ‹Ÿä¸»æœº</li><li>æ–°å¢çŠ¶æ€ç  100</li><li>æ”¯æŒåˆ†å—ä¼ è¾“ç¼–ç </li><li>æ–°å¢ç¼“å­˜å¤„ç†æŒ‡ä»¤ max-age</li></ul><h2 id="ä¹ã€GET-å’Œ-POST-æ¯”è¾ƒ"><a href="#ä¹ã€GET-å’Œ-POST-æ¯”è¾ƒ" class="headerlink" title="ä¹ã€GET å’Œ POST æ¯”è¾ƒ"></a>ä¹ã€GET å’Œ POST æ¯”è¾ƒ</h2><h3 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h3><p>GET ç”¨äºè·å–èµ„æºï¼Œè€Œ POST ç”¨äºä¼ è¾“å®ä½“ä¸»ä½“ã€‚</p><h3 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h3><p>GET å’Œ POST çš„è¯·æ±‚éƒ½èƒ½ä½¿ç”¨é¢å¤–çš„å‚æ•°ï¼Œä½†æ˜¯ GET çš„å‚æ•°æ˜¯ä»¥æŸ¥è¯¢å­—ç¬¦ä¸²å‡ºç°åœ¨ URL ä¸­ï¼Œè€Œ POST çš„å‚æ•°å­˜å‚¨åœ¨å®ä½“ä¸»ä½“ä¸­ã€‚ä¸èƒ½å› ä¸º POST å‚æ•°å­˜å‚¨åœ¨å®ä½“ä¸»ä½“ä¸­å°±è®¤ä¸ºå®ƒçš„å®‰å…¨æ€§æ›´é«˜ï¼Œå› ä¸ºç…§æ ·å¯ä»¥é€šè¿‡ä¸€äº›æŠ“åŒ…å·¥å…·ï¼ˆFiddlerï¼‰æŸ¥çœ‹ã€‚</p><p>å› ä¸º URL åªæ”¯æŒ ASCII ç ï¼Œå› æ­¤ GET çš„å‚æ•°ä¸­å¦‚æœå­˜åœ¨ä¸­æ–‡ç­‰å­—ç¬¦å°±éœ€è¦å…ˆè¿›è¡Œç¼–ç ã€‚ä¾‹å¦‚ <code>ä¸­æ–‡</code> ä¼šè½¬æ¢ä¸º <code>%E4%B8%AD%E6%96%87</code>ï¼Œè€Œç©ºæ ¼ä¼šè½¬æ¢ä¸º <code>%20</code>ã€‚POST å‚æ•°æ”¯æŒæ ‡å‡†å­—ç¬¦é›†ã€‚</p><pre><code>GET /test/demo_form.asp?name1=value1&amp;name2=value2 HTTP/1.1</code></pre><pre><code>POST /test/demo_form.asp HTTP/1.1Host: w3schools.comname1=value1&amp;name2=value2</code></pre><h3 id="å®‰å…¨"><a href="#å®‰å…¨" class="headerlink" title="å®‰å…¨"></a>å®‰å…¨</h3><p>å®‰å…¨çš„ HTTP æ–¹æ³•ä¸ä¼šæ”¹å˜æœåŠ¡å™¨çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåªæ˜¯å¯è¯»çš„ã€‚</p><p>GET æ–¹æ³•æ˜¯å®‰å…¨çš„ï¼Œè€Œ POST å´ä¸æ˜¯ï¼Œå› ä¸º POST çš„ç›®çš„æ˜¯ä¼ é€å®ä½“ä¸»ä½“å†…å®¹ï¼Œè¿™ä¸ªå†…å®¹å¯èƒ½æ˜¯ç”¨æˆ·ä¸Šä¼ çš„è¡¨å•æ•°æ®ï¼Œä¸Šä¼ æˆåŠŸä¹‹åï¼ŒæœåŠ¡å™¨å¯èƒ½æŠŠè¿™ä¸ªæ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œå› æ­¤çŠ¶æ€ä¹Ÿå°±å‘ç”Ÿäº†æ”¹å˜ã€‚</p><p>å®‰å…¨çš„æ–¹æ³•é™¤äº† GET ä¹‹å¤–è¿˜æœ‰ï¼šHEADã€OPTIONSã€‚</p><p>ä¸å®‰å…¨çš„æ–¹æ³•é™¤äº† POST ä¹‹å¤–è¿˜æœ‰ PUTã€DELETEã€‚</p><h3 id="å¹‚ç­‰æ€§"><a href="#å¹‚ç­‰æ€§" class="headerlink" title="å¹‚ç­‰æ€§"></a>å¹‚ç­‰æ€§</h3><p>å¹‚ç­‰çš„ HTTP æ–¹æ³•ï¼ŒåŒæ ·çš„è¯·æ±‚è¢«æ‰§è¡Œä¸€æ¬¡ä¸è¿ç»­æ‰§è¡Œå¤šæ¬¡çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼ŒæœåŠ¡å™¨çš„çŠ¶æ€ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚æ¢å¥è¯è¯´å°±æ˜¯ï¼Œå¹‚ç­‰æ–¹æ³•ä¸åº”è¯¥å…·æœ‰å‰¯ä½œç”¨ï¼ˆç»Ÿè®¡ç”¨é€”é™¤å¤–ï¼‰ã€‚</p><p>æ‰€æœ‰çš„å®‰å…¨æ–¹æ³•ä¹Ÿéƒ½æ˜¯å¹‚ç­‰çš„ã€‚</p><p>åœ¨æ­£ç¡®å®ç°çš„æ¡ä»¶ä¸‹ï¼ŒGETï¼ŒHEADï¼ŒPUT å’Œ DELETE ç­‰æ–¹æ³•éƒ½æ˜¯å¹‚ç­‰çš„ï¼Œè€Œ POST æ–¹æ³•ä¸æ˜¯ã€‚</p><p>GET /pageX HTTP/1.1 æ˜¯å¹‚ç­‰çš„ï¼Œè¿ç»­è°ƒç”¨å¤šæ¬¡ï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼š</p><pre><code>GET /pageX HTTP/1.1GET /pageX HTTP/1.1GET /pageX HTTP/1.1GET /pageX HTTP/1.1</code></pre><p>POST /add_row HTTP/1.1 ä¸æ˜¯å¹‚ç­‰çš„ï¼Œå¦‚æœè°ƒç”¨å¤šæ¬¡ï¼Œå°±ä¼šå¢åŠ å¤šè¡Œè®°å½•ï¼š</p><pre><code>POST /add_row HTTP/1.1   -&gt; Adds a 1nd rowPOST /add_row HTTP/1.1   -&gt; Adds a 2nd rowPOST /add_row HTTP/1.1   -&gt; Adds a 3rd row</code></pre><p>DELETE /idX/delete HTTP/1.1 æ˜¯å¹‚ç­‰çš„ï¼Œå³ä½¿ä¸åŒçš„è¯·æ±‚æ¥æ”¶åˆ°çš„çŠ¶æ€ç ä¸ä¸€æ ·ï¼š</p><pre><code>DELETE /idX/delete HTTP/1.1   -&gt; Returns 200 if idX existsDELETE /idX/delete HTTP/1.1   -&gt; Returns 404 as it just got deletedDELETE /idX/delete HTTP/1.1   -&gt; Returns 404</code></pre><h3 id="å¯ç¼“å­˜"><a href="#å¯ç¼“å­˜" class="headerlink" title="å¯ç¼“å­˜"></a>å¯ç¼“å­˜</h3><p>å¦‚æœè¦å¯¹å“åº”è¿›è¡Œç¼“å­˜ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li>è¯·æ±‚æŠ¥æ–‡çš„ HTTP æ–¹æ³•æœ¬èº«æ˜¯å¯ç¼“å­˜çš„ï¼ŒåŒ…æ‹¬ GET å’Œ HEADï¼Œä½†æ˜¯ PUT å’Œ DELETE ä¸å¯ç¼“å­˜ï¼ŒPOST åœ¨å¤šæ•°æƒ…å†µä¸‹ä¸å¯ç¼“å­˜çš„ã€‚</li><li>å“åº”æŠ¥æ–‡çš„çŠ¶æ€ç æ˜¯å¯ç¼“å­˜çš„ï¼ŒåŒ…æ‹¬ï¼š200, 203, 204, 206, 300, 301, 404, 405, 410, 414, and 501ã€‚</li><li>å“åº”æŠ¥æ–‡çš„ Cache-Control é¦–éƒ¨å­—æ®µæ²¡æœ‰æŒ‡å®šä¸è¿›è¡Œç¼“å­˜ã€‚</li></ul><h3 id="XMLHttpRequest"><a href="#XMLHttpRequest" class="headerlink" title="XMLHttpRequest"></a>XMLHttpRequest</h3><p>ä¸ºäº†é˜è¿° POST å’Œ GET çš„å¦ä¸€ä¸ªåŒºåˆ«ï¼Œéœ€è¦å…ˆäº†è§£ XMLHttpRequestï¼š</p><blockquote><p>XMLHttpRequest æ˜¯ä¸€ä¸ª APIï¼Œå®ƒä¸ºå®¢æˆ·ç«¯æä¾›äº†åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ•°æ®çš„åŠŸèƒ½ã€‚å®ƒæä¾›äº†ä¸€ä¸ªé€šè¿‡ URL æ¥è·å–æ•°æ®çš„ç®€å•æ–¹å¼ï¼Œå¹¶ä¸”ä¸ä¼šä½¿æ•´ä¸ªé¡µé¢åˆ·æ–°ã€‚è¿™ä½¿å¾—ç½‘é¡µåªæ›´æ–°ä¸€éƒ¨åˆ†é¡µé¢è€Œä¸ä¼šæ‰“æ‰°åˆ°ç”¨æˆ·ã€‚XMLHttpRequest åœ¨ AJAX ä¸­è¢«å¤§é‡ä½¿ç”¨ã€‚</p></blockquote><ul><li>åœ¨ä½¿ç”¨ XMLHttpRequest çš„ POST æ–¹æ³•æ—¶ï¼Œæµè§ˆå™¨ä¼šå…ˆå‘é€ Header å†å‘é€ Dataã€‚ä½†å¹¶ä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨ä¼šè¿™ä¹ˆåšï¼Œä¾‹å¦‚ç«ç‹å°±ä¸ä¼šã€‚</li><li>è€Œ GET æ–¹æ³• Header å’Œ Data ä¼šä¸€èµ·å‘é€ã€‚</li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http </tag>
            
            <tag> ç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcodeæ€»ç»“â€”äºŒå‰æ ‘çš„éå†</title>
      <link href="/2020/11/27/er-cha-shu-de-bian-li/"/>
      <url>/2020/11/27/er-cha-shu-de-bian-li/</url>
      
        <content type="html"><![CDATA[<p>äºŒå‰æ ‘æ˜¯é¢è¯•ä¸­å¸¸è§çš„é¢˜ç›®ç±»å‹ï¼Œè¿™é‡Œï¼Œé’ˆå¯¹ leetcode å‰200é“é¢˜ä¸­çš„äºŒå‰æ ‘ç›¸å…³é—®é¢˜è¿›è¡Œæ€»ç»“ä¸æ€è€ƒï¼ŒåŠ›æ±‚çƒ‚ç†Ÿäºå¿ƒï¼Œèƒ½æ ¹æ®é¢˜ç›®åå›å¿†èµ·é¢˜ç›®çš„å…·ä½“æè¿°ï¼Œè¿›è€Œç”¨ç®€æ´çš„è¯­è¨€æè¿°å‡ºç®—æ³•çš„æ ¸å¿ƒã€‚å…·ä½“çš„é¢˜ç›®ç­”æ¡ˆå¯æ‰“å¼€ leetcode æŸ¥çœ‹å†å²æäº¤è®°å½•ã€‚</p><h2 id="äºŒå‰æ ‘çš„éå†ï¼ˆbinary-tree-traversalï¼‰"><a href="#äºŒå‰æ ‘çš„éå†ï¼ˆbinary-tree-traversalï¼‰" class="headerlink" title="äºŒå‰æ ‘çš„éå†ï¼ˆbinary-tree-traversalï¼‰"></a>äºŒå‰æ ‘çš„éå†ï¼ˆbinary-tree-traversalï¼‰</h2><blockquote><p>äºŒå‰æ ‘çš„éå†æ˜¯æŒ‡ä»æ ¹ç»“ç‚¹å‡ºå‘ï¼ŒæŒ‰ç…§æŸç§æ¬¡åºä¾æ¬¡è®¿é—®äºŒå‰æ ‘ä¸­æ‰€æœ‰ç»“ç‚¹ï¼Œä½¿å¾—æ¯ä¸ªç»“ç‚¹è¢«è®¿é—®ä¸€æ¬¡ä¸”ä»…è¢«è®¿é—®ä¸€æ¬¡ã€‚</p></blockquote><p><strong>ä¸ºä»€ä¹ˆç ”ç©¶äºŒå‰æ ‘çš„éå†ï¼Ÿ</strong></p><p>å› ä¸ºè®¡ç®—æœºåªä¼šå¤„ç†çº¿æ€§åºåˆ—ï¼Œè€Œæˆ‘ä»¬ç ”ç©¶éå†ï¼Œå°±æ˜¯æŠŠæ ‘ä¸­çš„ç»“ç‚¹å˜æˆæŸç§æ„ä¹‰çš„çº¿æ€§åºåˆ—ï¼Œè¿™ç»™ç¨‹åºçš„å®ç°å¸¦æ¥äº†å¥½å¤„ã€‚</p><h2 id="1-ä¸‰ç§åŸºæœ¬éå†æ–¹å¼"><a href="#1-ä¸‰ç§åŸºæœ¬éå†æ–¹å¼" class="headerlink" title="1 ä¸‰ç§åŸºæœ¬éå†æ–¹å¼"></a>1 ä¸‰ç§åŸºæœ¬éå†æ–¹å¼</h2><p>é¦–å…ˆæ˜¯äºŒå‰æ ‘çš„éå†æ–¹å¼ï¼Œæœ€ç®€å•åŸºç¡€çš„ä¹Ÿå°±æ˜¯å‰åº(preorder)ã€ä¸­åº(inorder)ã€ååº(postorder)ä¸‰ç§éå†æ–¹å¼ï¼Œå¯¹åº”é¢˜ç›® <a href="https://leetcode-cn.com/problems/binary-tree-preorder-traversal/" target="_blank" rel="noopener">144.äºŒå‰æ ‘çš„å‰åºéå†</a> ã€<a href="https://leetcode-cn.com/problems/binary-tree-inorder-traversal/" target="_blank" rel="noopener">94. äºŒå‰æ ‘çš„ä¸­åºéå†</a> ã€<a href="https://leetcode-cn.com/problems/binary-tree-postorder-traversal/" target="_blank" rel="noopener">145. äºŒå‰æ ‘çš„ååºéå†</a>ã€‚</p><blockquote><p>å‰ä¸­åï¼ŒæŒ‡çš„æ˜¯æ ¹èŠ‚ç‚¹ç›¸å¯¹äºå·¦å³ç»“ç‚¹çš„è®¿é—®é¡ºåº</p></blockquote><p><strong>å…ˆåºï¼š</strong>è€ƒå¯Ÿåˆ°ä¸€ä¸ªèŠ‚ç‚¹åï¼Œå³åˆ»è¾“å‡ºè¯¥èŠ‚ç‚¹çš„å€¼ï¼Œå¹¶ç»§ç»­éå†å…¶å·¦å³å­æ ‘ã€‚(æ ¹å·¦å³)</p><p><strong>ä¸­åºï¼š</strong>è€ƒå¯Ÿåˆ°ä¸€ä¸ªèŠ‚ç‚¹åï¼Œå°†å…¶æš‚å­˜ï¼Œéå†å®Œå·¦å­æ ‘åï¼Œå†è¾“å‡ºè¯¥èŠ‚ç‚¹çš„å€¼ï¼Œç„¶åéå†å³å­æ ‘ã€‚(å·¦æ ¹å³)</p><p><strong>ååºï¼š</strong>è€ƒå¯Ÿåˆ°ä¸€ä¸ªèŠ‚ç‚¹åï¼Œå°†å…¶æš‚å­˜ï¼Œéå†å®Œå·¦å³å­æ ‘åï¼Œå†è¾“å‡ºè¯¥èŠ‚ç‚¹çš„å€¼ã€‚(å·¦å³æ ¹)</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165620.png" alt="image"></p><p><strong>è¿™ç§ç±»å‹çš„é¢˜ä¸€èˆ¬éƒ½æ˜¯æœ‰ä¸¤ç§è§£é¢˜æ€è·¯ï¼šé€’å½’å’Œè¿­ä»£ã€‚</strong></p><h3 id="1-1-é€’å½’æ³•æ¨¡æ¿"><a href="#1-1-é€’å½’æ³•æ¨¡æ¿" class="headerlink" title="1.1 é€’å½’æ³•æ¨¡æ¿"></a>1.1 é€’å½’æ³•æ¨¡æ¿</h3><blockquote><p>æˆ‘ä»¬å¹¶ä¸éœ€è¦å¤ªè¿‡äºåœ¨æ„å…·ä½“çš„é€’å½’è¿‡ç¨‹ï¼Œè€Œæ˜¯è¦æƒ³æ¸…æ¥šè®©è®¡ç®—æœºå¹²ä»€ä¹ˆã€‚è®¡ç®—æœºéƒ½å¯èƒ½æº¢å‡ºï¼Œç”¨äººè„‘å»éå†å°±ä¸ç°å®äº†ã€‚</p></blockquote><p>æ€è·¯ï¼š åˆ¤æ–­ä»€ä¹ˆæ—¶å€™æŠŠç»“ç‚¹çš„ <code>val</code> åŠ å…¥ <code>res</code> æ•°ç»„ä¸­ï¼Œ<code>res.add(root.val)</code>æ”¾çš„ä½ç½®å†³å®šäº†éå†é¡ºåºã€‚</p><pre class="line-numbers language-java"><code class="language-java">è¾¹ç•Œæ¡ä»¶å®šä¹‰ dfs å‡½æ•°ï¼š    å¦‚æœrootä¸ºç©ºï¼šè¿”å›    é€’å½’å·¦å­æ ‘    é€’å½’å³å­æ ‘    <span class="token comment" spellcheck="true">// root çš„å€¼åŠ å…¥åˆ°ç»“æœ</span>æ‰§è¡Œé€’å½’å‡½æ•°ï¼Œè¿”å›ç»“æœ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> <span class="token function">preorderTraversal</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> res<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">helper</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// é€’å½’ä¸»ç¨‹åº</span>    <span class="token keyword">private</span> <span class="token keyword">void</span>  <span class="token function">helper</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">,</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// åˆ¤æ–­rootæ˜¯å¦ä¸ºç©ºï¼Œæ˜¯ä¸€ä¸ªé‡è¦çš„é€’å½’ç»ˆæ­¢çš„æ¡ä»¶ã€‚</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">==</span>null<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// res.add(root.val);</span>        <span class="token function">helper</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">helper</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€æ ·çš„ä»£ç ï¼Œç¨å¾®è°ƒç”¨ä¸€ä¸‹ä½ç½®å°±å¯ä»¥ï¼Œå¦‚æ­¤å›ºå®šçš„å¥—è·¯ï¼Œä½¿å¾—åªæŒæ¡é€’å½’è§£æ³•å¹¶ä¸è¶³ä»¥ä»¤é¢è¯•å®˜ä¿¡æœ=`=æ‰€ä»¥å¿…é¡»æŒæ¡è¿­ä»£æ³•åŠ æ·±å¯¹äºŒå‰æ ‘çš„ç†è§£ï¼ï¼</p><h3 id="1-2-è¿­ä»£æ³•æ¨¡æ¿"><a href="#1-2-è¿­ä»£æ³•æ¨¡æ¿" class="headerlink" title="1.2 è¿­ä»£æ³•æ¨¡æ¿"></a>1.2 è¿­ä»£æ³•æ¨¡æ¿</h3><p>æœ¬è´¨ä¸Šæ˜¯åœ¨æ¨¡æ‹Ÿé€’å½’ï¼Œå› ä¸ºåœ¨é€’å½’çš„è¿‡ç¨‹ä¸­ä½¿ç”¨äº†ç³»ç»Ÿæ ˆï¼Œæ‰€ä»¥åœ¨è¿­ä»£çš„è§£æ³•ä¸­å¸¸ç”¨<code>Stack</code>æ¥æ¨¡æ‹Ÿç³»ç»Ÿæ ˆã€‚</p><p><strong>æ€è·¯ï¼š</strong>ç”¨<code>while</code>å¾ªç¯å…ˆå°†æ ¹èŠ‚ç‚¹å’Œæ‰€æœ‰å·¦å­©å­åŠ å…¥æ ˆå’Œç»“æœæ•°ç»„ä¸­ï¼Œç›´è‡³<code>cur</code>ä¸ºç©ºã€‚ç„¶åï¼Œæ¯å¼¹å‡ºä¸€ä¸ªæ ˆé¡¶å…ƒç´  <code>tmp</code>ï¼Œå°±åˆ°è¾¾å®ƒçš„å³å­©å­ï¼Œå†å°†è¿™ä¸ªèŠ‚ç‚¹å½“ä½œ <code>cur</code> é‡æ–°æŒ‰ä¸Šé¢çš„æ­¥éª¤æ¥ä¸€éï¼Œç›´è‡³æ ˆä¸ºç©ºã€‚è¿™é‡Œåˆéœ€è¦ä¸€ä¸ª <code>while</code> å¾ªç¯ã€‚</p><p>ä½¿ç”¨è¿™ä¸ªè¿­ä»£æ¨¡æ¿å¤„ç†å‰åºå’Œä¸­åºéå†ï¼Œåªè¦æ›´æ”¹ <code>res.add(cur.val)</code> çš„ä½ç½®å³å¯ã€‚</p><pre class="line-numbers language-java"><code class="language-java">è¾¹ç•Œæ¡ä»¶åˆå§‹åŒ–stack<span class="token punctuation">,</span>res<span class="token punctuation">,</span>cur<span class="token keyword">while</span> stackæˆ–cur éç©ºï¼š    <span class="token keyword">while</span> curéç©ºï¼š        curçš„å€¼å…¥æ ˆstack        <span class="token comment" spellcheck="true">// curçš„å€¼åŠ å…¥res å‰åº</span>        cur å‘å·¦ä¸‹æˆ–å³ä¸‹éå†    å¼¹å‡ºèŠ‚ç‚¹tmp    curå›åˆ°tmpçš„å·¦æˆ–å³å­æ ‘è¿”å›ç»“æœ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> <span class="token function">preorderTraversal</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> res<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Deque<span class="token operator">&lt;</span>TreeNode<span class="token operator">></span> stack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        TreeNode cur<span class="token operator">=</span>root<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>cur<span class="token operator">!=</span>null<span class="token operator">||</span><span class="token operator">!</span>stack<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>cur<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>                stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">//res.add(cur.val);å‰åº</span>                cur<span class="token operator">=</span>cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>            <span class="token punctuation">}</span>            tmp<span class="token operator">=</span>stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//res.add(tmp.val);ä¸­åº</span>            cur<span class="token operator">=</span>tmp<span class="token punctuation">.</span>right<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>      <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯ååºå¹¶ä¸èƒ½ä½¿ç”¨ï¼Œå–å·§çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ¨¡æ¿(æ ¹å³å·¦)ï¼Œå¯¹å…¶å–å<code>Collections.reverse(res)</code>å°±æ˜¯ååºéå†çš„ç»“æœ(å·¦å³æ ¹)</p><blockquote><p>åˆ©ç”¨äº†ç»“æœçš„ç‰¹ç‚¹åå‘è¾“å‡ºï¼Œä¸å…æ˜¾å¾—æŠ€æœ¯å«é‡ä¸è¶³ï¼Œå› æ­¤æŒæ¡ååºéå†æ ‡å‡†çš„æ ˆæ“ä½œè§£æ³•æ˜¯å¿…è¦çš„ï¼</p></blockquote><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> <span class="token function">postorderTraversal</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> res<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Deque<span class="token operator">&lt;</span>TreeNode<span class="token operator">></span> stack<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        TreeNode cur<span class="token operator">=</span>root<span class="token punctuation">;</span>        TreeNode p<span class="token operator">=</span>null<span class="token punctuation">;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span>cur<span class="token operator">!=</span>null <span class="token operator">||</span> <span class="token operator">!</span>stack<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">while</span><span class="token punctuation">(</span>cur<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>                stack<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span><span class="token punctuation">;</span>                cur<span class="token operator">=</span>cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true">//peekä¸åˆ é™¤æ ˆé¡¶ï¼Œpopåˆ é™¤</span>            cur<span class="token operator">=</span>stack<span class="token punctuation">.</span><span class="token function">peek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// ä¸€ç§æƒ…å†µæ˜¯curä¸ºæœ€ä¸‹é¢çš„å­èŠ‚ç‚¹ï¼Œéœ€è¦åŠ å…¥åˆ°resï¼Œå¦ä¸€ç§æ˜¯å½“å‰ä¸ºéå†è¿‡å³å­æ ‘çš„æ ¹èŠ‚ç‚¹ä¹Ÿéœ€è¦åŠ å…¥åˆ°res</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>right<span class="token operator">==</span>null<span class="token operator">||</span>cur<span class="token punctuation">.</span>right<span class="token operator">==</span>p<span class="token punctuation">)</span><span class="token punctuation">{</span>                res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>                stack<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                p<span class="token operator">=</span>cur<span class="token punctuation">;</span>                cur<span class="token operator">=</span>null<span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                cur<span class="token operator">=</span>cur<span class="token punctuation">.</span>right<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-å±‚åºéå†åŠå…¶å˜é¢˜"><a href="#2-å±‚åºéå†åŠå…¶å˜é¢˜" class="headerlink" title="2 å±‚åºéå†åŠå…¶å˜é¢˜"></a>2 å±‚åºéå†åŠå…¶å˜é¢˜</h2><p>é™¤äº†åŸºæœ¬çš„ä¸‰ç§éå†ä½¿ç”¨DFSï¼Œä½¿ç”¨BFSå¹¿åº¦ä¼˜å…ˆæœç´¢çš„å±‚åºéå†ä¹Ÿå¾ˆé‡è¦<a href="https://leetcode-cn.com/problems/binary-tree-level-order-traversal/" target="_blank" rel="noopener">102. äºŒå‰æ ‘çš„å±‚åºéå†</a></p><p>ä¸‹é¢æ˜¯ä¸¤ç§è§£å†³æ­¤ç±»é—®é¢˜çš„æ–¹æ³•ï¼Œä¸€èˆ¬ä½¿ç”¨å·¦è¾¹çš„BFS</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165618.png" alt="image.png"></p><h3 id="2-1-BFSå±‚åºéå†"><a href="#2-1-BFSå±‚åºéå†" class="headerlink" title="2.1 BFSå±‚åºéå†"></a>2.1 BFSå±‚åºéå†</h3><p>BFSéå†çš„æ ‡å‡†å†™æ³•å¦‚ä¸‹ï¼Œä½¿ç”¨çš„æ˜¯<strong>é˜Ÿåˆ—</strong>æ•°æ®ç»“æ„ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">void</span> <span class="token function">bfs</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>    Queue<span class="token operator">&lt;</span>TreeNode<span class="token operator">></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayDeque</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        TreeNode node <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// Queue ä¸­ remove() å’Œ poll()éƒ½æ˜¯ç”¨æ¥ä»é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤ä¸€ä¸ªå…ƒç´ ã€‚</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>left <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>right <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ BFS å¾—å‡ºå±‚åºéå†ç»“æœã€‚ç„¶è€Œï¼Œå±‚åºéå†è¦æ±‚çš„è¾“å…¥ç»“æœå’Œ BFS æ˜¯ä¸åŒçš„ã€‚å±‚åºéå†è¦æ±‚æˆ‘ä»¬åŒºåˆ†æ¯ä¸€å±‚ï¼Œä¹Ÿå°±æ˜¯è¿”å›ä¸€ä¸ªäºŒç»´æ•°ç»„ã€‚è€Œ BFS çš„éå†ç»“æœæ˜¯ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œæ— æ³•åŒºåˆ†æ¯ä¸€å±‚ï¼Œè§ä¸‹å›¾çš„å¯¹æ¯”ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165619.jpeg" alt="image"></p><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ¯ä¸€å±‚å‰å¾®ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼Œåœ¨æ¯ä¸€å±‚éå†å¼€å§‹å‰ï¼Œå…ˆè®°å½•é˜Ÿåˆ—ä¸­çš„ç»“ç‚¹æ•°é‡ nï¼ˆä¹Ÿå°±æ˜¯è¿™ä¸€å±‚çš„èŠ‚ç‚¹æ•°é‡ï¼‰ï¼Œç„¶åä¸€å£æ°”å¤„ç†å®Œè¿™ä¸€å±‚çš„ nä¸ªç»“ç‚¹ã€‚</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> <span class="token function">levelOrder</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>    List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Queue<span class="token operator">&lt;</span>TreeNode<span class="token operator">></span> queue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayDeque</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> level <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>             TreeNode node <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            level<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>left <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>right <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>level<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> res<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨BFSæ¥è§£å†³å±‚åºéå†é—®é¢˜äº†ï¼Œ<strong>é‡ç‚¹æ˜¯è®°å½•äº†æ¯ä¸€å±‚èŠ‚ç‚¹çš„æ•°é‡ï¼ŒåŠ¨å›¾å¦‚ä¸‹</strong></p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165622.gif" alt="image"></p><h3 id="2-2-é€‰çœ‹-DFSå±‚åºéå†"><a href="#2-2-é€‰çœ‹-DFSå±‚åºéå†" class="headerlink" title="2.2 (é€‰çœ‹)DFSå±‚åºéå†"></a>2.2 (é€‰çœ‹)DFSå±‚åºéå†</h3><p>DFS éå†æ ‡å‡†å†™æ³•å¦‚ä¸‹ï¼Œä½¿ç”¨çš„æ˜¯<strong>é€’å½’</strong></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹èµ·æ¥æ¯”BFSçš„ä»£ç ç®€æ´å¾ˆå¤šï¼Œä½†è§‚çœ‹ä¸‹å›¾å°±å¯ä»¥å‘ç°ä¸¤è€…çš„éå†é¡ºåºæ˜¯ä¸åŒçš„ï¼ŒBFSå…¶å®æ›´è´´è¿‘æˆ‘ä»¬æƒ³è¦çš„å±‚åºéå†é€»è¾‘ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165621.gif" alt="image"></p><p>é‚£DFSç©¶ç«Ÿå¯ä¸å¯ä»¥è§£å†³å±‚åºéå†é—®é¢˜å‘¢ï¼Ÿå½“ç„¶æ˜¯å¯ä»¥çš„ï¼</p><p>æŠŠè¿™ä¸ªäºŒå‰æ ‘çš„æ ·å­è°ƒæ•´ä¸€ä¸‹ï¼Œæ‘†æˆä¸€ä¸ªç”°å­—å½¢çš„æ ·å­ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165623.jpeg" alt="image"><br><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165626.gif" alt="image"></p><p>ç”°å­—å½¢çš„æ¯ä¸€å±‚å°±å¯¹åº”ä¸€ä¸ª listï¼Œæ¯æ¬¡é€’å½’çš„æ—¶å€™éƒ½éœ€è¦<strong>å¸¦ä¸€ä¸ª index(è¡¨ç¤ºå½“å‰çš„å±‚æ•°)</strong>ï¼Œä¹Ÿå°±å¯¹åº”é‚£ä¸ªç”°å­—æ ¼å­ä¸­çš„ç¬¬å‡ è¡Œï¼Œå¦‚æœå½“å‰è¡Œå¯¹åº”çš„ list ä¸å­˜åœ¨ï¼Œå°±åŠ å…¥ä¸€ä¸ªç©º list è¿›å»ã€‚ä»£ç å®ç°å¦‚ä¸‹ã€‚</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>*<span class="token punctuation">;</span> <span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> <span class="token function">levelOrder</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">==</span>null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//ç”¨æ¥å­˜æ”¾æœ€ç»ˆç»“æœ</span>        List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> res <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>root<span class="token punctuation">,</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span>TreeNode root<span class="token punctuation">,</span> List<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Integer<span class="token operator">>></span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//å‡è®¾resæ˜¯[ [1],[2,3] ]ï¼Œ indexæ˜¯3ï¼Œå°±å†æ’å…¥ä¸€ä¸ªç©ºlistæ”¾åˆ°resä¸­</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>            res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>Integer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//å°†å½“å‰èŠ‚ç‚¹çš„å€¼åŠ å…¥åˆ°resä¸­ï¼Œindexä»£è¡¨å½“å‰å±‚ï¼Œå‡è®¾indexæ˜¯3ï¼ŒèŠ‚ç‚¹å€¼æ˜¯99</span>        <span class="token comment" spellcheck="true">//resæ˜¯[ [1],[2,3] [4] ]ï¼ŒåŠ å…¥åreså°±å˜ä¸º [ [1],[2,3] [4,99] ]</span>        res<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>index<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//é€’å½’çš„å¤„ç†å·¦å­æ ‘ï¼Œå³å­æ ‘ï¼ŒåŒæ—¶å°†å±‚æ•°index+1</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token operator">!=</span>null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> root<span class="token punctuation">.</span>left<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token operator">!=</span>null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">dfs</span><span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> root<span class="token punctuation">.</span>right<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„Ÿè§‰æœ‰ç‚¹åƒäºŒå‰æ ‘çš„å‰åºéå†ï¼Œæ ¹å·¦å³</p><h3 id="2-3-å˜é¢˜-äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚æ¬¡éå†"><a href="#2-3-å˜é¢˜-äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚æ¬¡éå†" class="headerlink" title="2.3 (å˜é¢˜) äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚æ¬¡éå†"></a>2.3 (å˜é¢˜) <a href="https://leetcode-cn.com/problems/binary-tree-zigzag-level-order-traversal/" target="_blank" rel="noopener">äºŒå‰æ ‘çš„é”¯é½¿å½¢å±‚æ¬¡éå†</a></h3><p>è¯¥é¢˜æ˜¯leetcode103é¢˜ï¼Œmediuméš¾åº¦ï¼Œä¸€å¥è¯é¢˜å¹²æè¿°ï¼šå±‚åºéå†ï¼Œä¸è¿‡æ˜¯ä¹‹å­—å½¢çš„ã€‚</p><p>æ€»ä½“æ€è·¯ï¼šç”¨ä¸ªå˜é‡flagæ¥åˆ¤æ–­æ˜¯ä»å·¦å¾€å³è¿˜æ˜¯ä»å³å¾€å·¦æ‰“å°</p><p><strong>è§£å†³æ–¹æ¡ˆ1(å®¹æ˜“ç†è§£)ï¼š</strong> åœ¨å±‚åºéå†ä»£ç çš„åŸºç¡€ä¸Šï¼Œæ›´æ”¹èŠ‚ç‚¹æ•°å€¼è¿›å…¥listçš„é¡ºåº</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">if</span> <span class="token punctuation">(</span>leftToRight<span class="token punctuation">)</span> <span class="token punctuation">{</span>    level<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    level<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> node<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è§£å†³æ–¹æ¡ˆ2(ç”»å›¾ç†è§£)ï¼š</strong> ä½¿ç”¨deuqeåŒç«¯é˜Ÿåˆ—ï¼šå¯ä»¥åœ¨ä¸¤è¾¹åŒæ—¶æ·»åŠ å’Œåˆ é™¤çš„é˜Ÿåˆ—</p><pre class="line-numbers language-java"><code class="language-java"># Deque<span class="token operator">&lt;</span>TreeNode<span class="token operator">></span> deque<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">LinkedList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>leftToRight<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//ä»å·¦è¾¹å¾€å³è¾¹æ‰“å°</span>    <span class="token comment" spellcheck="true">//ç§»é™¤é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´ ï¼Œå¦‚æœå­èŠ‚ç‚¹ä¸ä¸ºç©ºåŠ å…¥åˆ°é˜Ÿåˆ—çš„å°¾éƒ¨</span>    cur <span class="token operator">=</span> deque<span class="token punctuation">.</span><span class="token function">removeFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>right <span class="token operator">!=</span> null<span class="token punctuation">)</span>        deque<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>left <span class="token operator">!=</span> null<span class="token punctuation">)</span>        deque<span class="token punctuation">.</span><span class="token function">addLast</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//ä»å³è¾¹å¾€å·¦è¾¹æ‰“å°</span>    <span class="token comment" spellcheck="true">//ç§»é™¤é˜Ÿåˆ—å°¾éƒ¨çš„å…ƒç´ ï¼Œå¦‚æœå­èŠ‚ç‚¹ä¸ä¸ºç©ºåŠ å…¥åˆ°é˜Ÿåˆ—çš„å¤´éƒ¨</span>    cur <span class="token operator">=</span> deque<span class="token punctuation">.</span><span class="token function">removeLast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>left <span class="token operator">!=</span> null<span class="token punctuation">)</span>        deque<span class="token punctuation">.</span><span class="token function">addFirst</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>cur<span class="token punctuation">.</span>right <span class="token operator">!=</span> null<span class="token punctuation">)</span>        deque<span class="token punctuation">.</span><span class="token function">addFirst</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>level<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>dequeä¸­æŠŠæ¯ä¸€è¡Œçš„èŠ‚ç‚¹å€¼ååºåˆ—è¡¨ç¤ºï¼Œç„¶åæ¯æ¬¡æ‰“å°åˆ¤æ–­ä»å·¦å¾€å³è¯»dequeè¿˜æ˜¯ä»å³å¾€å·¦ã€‚è¯»çš„æ—¶å€™ç›¸åº”çš„ä¹Ÿè¦æ”¹å˜å·¦å³å­©å­å…¥é˜Ÿåˆ—çš„é¡ºåºæ¥ä¿æŒ dequeä¸­æ¯ä¸€è¡Œçš„èŠ‚ç‚¹å€¼ååºè¡¨ç¤ºã€‚</p><h3 id="2-4-å˜é¢˜-äºŒå‰æ ‘çš„å³è§†å›¾"><a href="#2-4-å˜é¢˜-äºŒå‰æ ‘çš„å³è§†å›¾" class="headerlink" title="2.4 (å˜é¢˜) äºŒå‰æ ‘çš„å³è§†å›¾"></a>2.4 (å˜é¢˜) <a href="https://leetcode-cn.com/problems/binary-tree-right-side-view/" target="_blank" rel="noopener">äºŒå‰æ ‘çš„å³è§†å›¾</a></h3><p>è¯¥é¢˜æ˜¯leetcode199é¢˜ï¼Œmediuméš¾åº¦ï¼Œä¸€å¥è¯é¢˜å¹²æè¿°ï¼šä»ä¸Šåˆ°ä¸‹è¿”å›æ¯ä¸€å±‚æœ€åä¸€ä¸ªå…ƒç´ </p><p>æ€»ä½“æ€è·¯ï¼šåˆ©ç”¨ BFS è¿›è¡Œå±‚æ¬¡éå†ï¼Œè®°å½•ä¸‹æ¯å±‚çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ1(BFS)ï¼š</strong> åœ¨å±‚åºéå†ä»£ç åŸºç¡€ä¸Šï¼Œåˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯ä¸æ˜¯è¿™å±‚çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ˜¯çš„è¯æ‰æ·»åŠ è¿›ç»“æœæ•°ç»„ã€‚</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>è§£å†³æ–¹æ¡ˆ2(DFS)ï¼š</strong>æˆ‘ä»¬æŒ‰ç…§ ã€Œæ ¹ç»“ç‚¹ -&gt; å³å­æ ‘ -&gt; å·¦å­æ ‘ã€ çš„é¡ºåºè®¿é—®ï¼Œå°±å¯ä»¥ä¿è¯æ¯å±‚éƒ½æ˜¯æœ€å…ˆè®¿é—®æœ€å³è¾¹çš„èŠ‚ç‚¹çš„ã€‚ï¼ˆä¸å…ˆåºéå† ã€Œæ ¹ç»“ç‚¹ -&gt; å·¦å­æ ‘ -&gt; å³å­æ ‘ã€ æ­£å¥½ç›¸åï¼Œå…ˆåºéå†æ¯å±‚æœ€å…ˆè®¿é—®çš„æ˜¯æœ€å·¦è¾¹çš„èŠ‚ç‚¹ï¼‰</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span>    List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> res<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>Integer<span class="token operator">></span> <span class="token function">rightSideView</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span>TreeNode root<span class="token punctuation">,</span><span class="token keyword">int</span> depth<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">==</span>null<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>depth<span class="token operator">==</span>res<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            res<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        depth<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">,</span>depth<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">,</span>depth<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-5-å˜é¢˜-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ"><a href="#2-5-å˜é¢˜-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ" class="headerlink" title="2.5 (å˜é¢˜) å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ"></a>2.5 (å˜é¢˜) <a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node/" target="_blank" rel="noopener">å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ</a></h3><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165624.png" alt="image"></p><p>è¯¥é¢˜æ˜¯leetcode116é¢˜ï¼Œmediuméš¾åº¦ï¼Œä¸€å¥è¯é¢˜å¹²æè¿°ï¼šä½¿å¾—æ¯ä¸ªèŠ‚ç‚¹çš„nextæŒ‡é’ˆæŒ‡å‘å®ƒå³ä¾§çš„èŠ‚ç‚¹<strong>(å®Œå…¨äºŒå‰æ ‘)</strong></p><p>æ€»ä½“æ€è·¯ï¼šåˆ©ç”¨ BFS è¿›è¡Œå±‚æ¬¡éå†é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­ä¿å­˜äº†ç¬¬ i å±‚èŠ‚ç‚¹çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ï¼Œå°†é˜Ÿåˆ—ä¸­çš„å…ƒç´ éƒ½ä¸²è”ä¸€éå°±å¯ä»¥äº†ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ1(åŸºç¡€ç‰ˆ)ï¼š</strong>ä½¿ç”¨é˜Ÿåˆ—<strong>ï¼Œ</strong>ç›´æ¥æŠŠå±‚åºéå†çš„ä»£ç æ”¹ä¸€æ”¹ï¼Œ æŠŠæ¯ä¸€å±‚çš„èŠ‚ç‚¹è¿æ¥èµ·æ¥,è¿™ç§æ–¹æ³•åŒæ ·é€‚ç”¨äºä¸æ˜¯å®Œå…¨äºŒå‰æ ‘çš„æƒ…å†µã€‚</p><pre class="line-numbers language-java"><code class="language-java"> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span>queue<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>     <span class="token keyword">int</span> size<span class="token operator">=</span>queue<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//å‰ä¸€ä¸ªèŠ‚ç‚¹</span>     Node pre <span class="token operator">=</span> null<span class="token punctuation">;</span>     <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token comment" spellcheck="true">//å‡ºé˜Ÿ</span>         Node node <span class="token operator">=</span> queue<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token comment" spellcheck="true">//å¦‚æœpreä¸ºç©ºå°±è¡¨ç¤ºnodeèŠ‚ç‚¹æ˜¯è¿™ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªï¼Œ</span>         <span class="token comment" spellcheck="true">//æ²¡æœ‰å‰ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘ä»–ï¼Œå¦åˆ™å°±è®©å‰ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘ä»–</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>pre <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>             pre<span class="token punctuation">.</span>next <span class="token operator">=</span> node<span class="token punctuation">;</span>         <span class="token punctuation">}</span>         <span class="token comment" spellcheck="true">//ç„¶åå†è®©å½“å‰èŠ‚ç‚¹æˆä¸ºå‰ä¸€ä¸ªèŠ‚ç‚¹</span>         pre <span class="token operator">=</span> node<span class="token punctuation">;</span>         <span class="token comment" spellcheck="true">//å±‚åºéå†çš„ä»£ç ï¼šå·¦å³å­èŠ‚ç‚¹å¦‚æœä¸ä¸ºç©ºå°±å…¥é˜Ÿ</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>left <span class="token operator">!=</span> null<span class="token punctuation">)</span>             queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>right <span class="token operator">!=</span> null<span class="token punctuation">)</span>             queue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢è¿è¡Œæ•ˆç‡å¹¶ä¸æ˜¯å¾ˆé«˜ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æŠŠèŠ‚ç‚¹ä¸åœçš„å…¥é˜Ÿç„¶åå†ä¸åœçš„å‡ºé˜Ÿï¼Œå…¶å®å¯ä»¥ä¸éœ€è¦é˜Ÿåˆ—ï¼Œæ¯ä¸€è¡Œéƒ½å¯ä»¥çœ‹æˆä¸€ä¸ªé“¾è¡¨æ¯”å¦‚ç¬¬ä¸€è¡Œå°±æ˜¯åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„é“¾è¡¨ï¼Œç¬¬äºŒè¡Œæ˜¯åªæœ‰ä¸¤ä¸ªèŠ‚ç‚¹çš„é“¾è¡¨</p><p><strong>è§£å†³æ–¹æ¡ˆ2(ä¼˜åŒ–ç‰ˆ)ï¼š</strong>è§‚å¯Ÿè¿™æ ·çš„ä¸²è”æ ‘å¯ä»¥å‘ç°ï¼Œæœ‰ä¸¤ç§äº†è¿æ¥æ–¹å¼</p><ol><li>ä¸¤ä¸ªä¸²è”çš„èŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„çˆ¶èŠ‚ç‚¹ï¼Œé€šè¿‡çˆ¶èŠ‚ç‚¹å°±å¯ä»¥å°†è¿™ä¸¤ä¸ªå­èŠ‚ç‚¹ä¸²è”èµ·æ¥</li><li>è¿™ä¸¤ä¸ªä¸²è”çš„èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸åŒï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œå¦‚æœæˆ‘ä»¬èƒ½å°†è¿™ä¸€å±‚çš„ä¸Šä¸€å±‚ä¸²è”å¥½ã€‚é‚£ä¹ˆå¯ä»¥é€šè¿‡çˆ¶èŠ‚ç‚¹çš„ <code>next</code> æ‰¾åˆ°é‚»å±…ï¼Œå®Œæˆä¸²è”ã€‚å³ <code>root.right.next =&gt; root.next.left</code>ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ä¿è¯ root.next ä¸ä¸ºç©ºå°±å¯ä»¥äº†ã€‚</li></ol><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165625.gif" alt="image"></p><pre class="line-numbers language-java"><code class="language-java">Node pre<span class="token operator">=</span>root<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å½“å‰èŠ‚ç‚¹çš„leftä¸ºç©ºåˆ™é€€å‡ºå¾ªç¯</span><span class="token keyword">while</span><span class="token punctuation">(</span>pre<span class="token punctuation">.</span>left<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>    Node tmp<span class="token operator">=</span>pre<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è¿™å±‚è¿æ¥å®Œæˆï¼Œåˆ™é€€å‡º</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>tmp<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//å°†tmpçš„å·¦å³èŠ‚ç‚¹éƒ½ä¸²è”èµ·æ¥</span>        <span class="token comment" spellcheck="true">//æ³¨:å¤–å±‚å¾ªç¯å·²ç»åˆ¤æ–­äº†å½“å‰èŠ‚ç‚¹çš„leftä¸ä¸ºç©º</span>        tmp<span class="token punctuation">.</span>left<span class="token punctuation">.</span>next <span class="token operator">=</span> tmp<span class="token punctuation">.</span>right<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//ä¸‹ä¸€ä¸ªä¸ä¸ºç©ºè¯´æ˜ä¸Šä¸€å±‚å·²ç»å¸®æˆ‘ä»¬å®Œæˆä¸²è”äº†</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>tmp<span class="token punctuation">.</span>next<span class="token operator">!=</span>null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            tmp<span class="token punctuation">.</span>right<span class="token punctuation">.</span>next <span class="token operator">=</span> tmp<span class="token punctuation">.</span>next<span class="token punctuation">.</span>left<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//ç»§ç»­å³è¾¹éå†</span>        tmp <span class="token operator">=</span> tmp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//ä»ä¸‹ä¸€å±‚çš„æœ€å·¦è¾¹å¼€å§‹éå†</span>    pre <span class="token operator">=</span> pre<span class="token punctuation">.</span>left<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è§£å†³æ–¹æ¡ˆ3(é€’å½’éªšæ“ä½œ)ï¼š</strong>é€’å½’ä»ä¸Šå¾€ä¸‹ï¼Œå…ˆå¤„ç†å½“å‰èŠ‚ç‚¹ï¼Œå†å¤„ç†å®ƒçš„å·¦ã€å³å­æ ‘ä¸­çš„èŠ‚ç‚¹â€”â€”å‰åºéå†ã€‚</p><p>é€’å½’ç»ˆæ­¢æ¡ä»¶ï¼šå½“éå†åˆ°å¶å­èŠ‚ç‚¹ï¼Œæ²¡æœ‰å­©å­èŠ‚ç‚¹ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165627.png" alt="image"></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> Node <span class="token function">connect</span><span class="token punctuation">(</span>Node root<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">dfs</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> root<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span>Node root<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token operator">==</span>null<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>        root<span class="token punctuation">.</span>left<span class="token punctuation">.</span>next <span class="token operator">=</span> root<span class="token punctuation">.</span>right<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>next<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>            root<span class="token punctuation">.</span>right<span class="token punctuation">.</span>next <span class="token operator">=</span> root<span class="token punctuation">.</span>next<span class="token punctuation">.</span>left<span class="token punctuation">;</span>        <span class="token punctuation">}</span>         <span class="token punctuation">}</span>    <span class="token function">connect</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">connect</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// æ›´ç‰›é€¼çš„å†™æ³•</span><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">dfs</span><span class="token punctuation">(</span>Node node<span class="token punctuation">,</span> Node next<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>node <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>        node<span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">,</span> node<span class="token punctuation">.</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">dfs</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">,</span> node<span class="token punctuation">.</span>next <span class="token operator">!=</span> null <span class="token operator">?</span> node<span class="token punctuation">.</span>next<span class="token punctuation">.</span>left <span class="token operator">:</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ€»ç»“ï¼š**</strong>æ¯ä¸ª node å·¦å­æ ‘çš„ next , å°±æ˜¯ node çš„å³å­æ ‘ã€æ¯ä¸ª node å³å­æ ‘çš„ next, å°±æ˜¯ node next çš„ å·¦å­æ ‘**</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h3 id="2-6-å˜é¢˜-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆII"><a href="#2-6-å˜é¢˜-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆII" class="headerlink" title="2.6 (å˜é¢˜) å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆII"></a>2.6 (å˜é¢˜) <a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node-ii/" target="_blank" rel="noopener">å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆII</a></h3><p>è¯¥é¢˜æ˜¯leetcode117é¢˜ï¼Œmediuméš¾åº¦ï¼Œä¸€å¥è¯é¢˜å¹²æè¿°ï¼šä½¿å¾—æ¯ä¸ªèŠ‚ç‚¹çš„nextæŒ‡é’ˆæŒ‡å‘å®ƒå³ä¾§çš„èŠ‚ç‚¹<strong>(éå®Œå…¨äºŒå‰æ ‘)</strong></p><p>æ€»ä½“æ€è·¯ï¼šå’Œä¸Šä¸€é¢˜ä¸€æ ·çš„æ€è·¯</p><p><strong>è§£å†³æ–¹æ¡ˆ1(åŸºç¡€ç‰ˆ)ï¼š</strong>ä½¿ç”¨é˜Ÿåˆ—<strong>ï¼Œ</strong>ç›´æ¥æŠŠå±‚åºéå†çš„ä»£ç æ”¹ä¸€æ”¹ï¼Œ æŠŠæ¯ä¸€å±‚çš„èŠ‚ç‚¹è¿æ¥èµ·æ¥,åŒä¸Šä¸€é¢˜ä»£ç ï¼Œç•¥ã€‚</p><p><strong>è§£å†³æ–¹æ¡ˆ2(ä¼˜åŒ–ç‰ˆ)ï¼š</strong>æ›´æ”¹ä¸Šä¸€é¢˜çš„ç›¸å…³ä»£ç ï¼Œå¢åŠ å“‘èŠ‚ç‚¹(æ‰¾åˆ°ä¸‹ä¸€å±‚çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹)ï¼Œæ­¤ä»£ç ä¹Ÿå¯ç”¨äºä¸Šé¢˜</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201128165537.png" alt="image"></p><pre class="line-numbers language-java"><code class="language-java">Node cur<span class="token operator">=</span>root<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å½“å‰èŠ‚ç‚¹çš„leftä¸ºç©ºåˆ™é€€å‡ºå¾ªç¯</span><span class="token keyword">while</span><span class="token punctuation">(</span>cur<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>    Node dummy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//preè¡¨ç¤ºè®¿ä¸‹ä¸€å±‚èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span>    Node pre <span class="token operator">=</span> dummy<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è¿™å±‚è¿æ¥å®Œæˆï¼Œåˆ™é€€å‡º</span>    <span class="token keyword">while</span><span class="token punctuation">(</span>cur<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//å¦‚æœå½“å‰èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œå°±è®©preèŠ‚ç‚¹çš„nextæŒ‡å‘ä»–ï¼Œä¹Ÿå°±æ˜¯æŠŠå®ƒä¸²èµ·æ¥</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>left<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>            pre<span class="token punctuation">.</span>next<span class="token operator">=</span>cur<span class="token punctuation">.</span>left<span class="token punctuation">;</span>            pre<span class="token operator">=</span>pre<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>cur<span class="token punctuation">.</span>right<span class="token operator">!=</span>null<span class="token punctuation">)</span><span class="token punctuation">{</span>            pre<span class="token punctuation">.</span>next<span class="token operator">=</span>cur<span class="token punctuation">.</span>right<span class="token punctuation">;</span>            pre<span class="token operator">=</span>pre<span class="token punctuation">.</span>next<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//ç»§ç»­è®¿é—®è¿™ä¸€è¡Œçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>        cur <span class="token operator">=</span> cur<span class="token punctuation">.</span>next<span class="token punctuation">;</span>    <span class="token punctuation">}</span>   <span class="token comment" spellcheck="true">//æŠŠä¸‹ä¸€å±‚ä¸²è”æˆä¸€ä¸ªé“¾è¡¨ä¹‹åï¼Œè®©ä»–èµ‹å€¼ç»™curï¼Œåç»­ç»§ç»­å¾ªç¯ï¼Œç›´åˆ°curä¸ºç©ºä¸ºæ­¢</span>   cur <span class="token operator">=</span> dummy<span class="token punctuation">.</span>next<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤å¤–ï¼Œé™¤äº†è¿™äº›é¢˜å¤–ï¼Œè¿˜æœ‰ä»¥ä¸‹é¢˜</p><p><a href="https://leetcode-cn.com/problems/average-of-levels-in-binary-tree/" target="_blank" rel="noopener">637.äºŒå‰æ ‘çš„å±‚å¹³å‡å€¼</a></p><p><a href="https://leetcode-cn.com/problems/n-ary-tree-level-order-traversal/" target="_blank" rel="noopener">429.Nå‰æ ‘çš„å‰åºéå†</a></p><p><a href="https://leetcode-cn.com/problems/find-largest-value-in-each-tree-row/" target="_blank" rel="noopener">515.åœ¨æ¯ä¸ªæ ‘è¡Œä¸­æ‰¾æœ€å¤§å€¼</a></p><p>å‚è€ƒèµ„æ–™ï¼šleetcodeé¢˜è§£ï¼Œæ„Ÿè°¢è¿™äº›å¤§ä½¬çš„é…å›¾ä»¥åŠæ˜“æ‡‚çš„è¯­è¨€ï¼ï¼</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> leetcode </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> åˆ·é¢˜ </tag>
            
            <tag> leetcode </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨LXDæ­å»ºå¤šäººå…±ç”¨GPU</title>
      <link href="/2020/11/26/lxd-gpu2.0/"/>
      <url>/2020/11/26/lxd-gpu2.0/</url>
      
        <content type="html"><![CDATA[<h2 id="1ã€-èƒŒæ™¯"><a href="#1ã€-èƒŒæ™¯" class="headerlink" title="1ã€ èƒŒæ™¯"></a>1ã€ èƒŒæ™¯</h2><p>å¯¹å®éªŒå®¤å¤šå°å·¥ä½œç«™çš„å¤šå—GPUè¿›è¡Œåˆç†çš„ç®¡ç†å’Œä½¿ç”¨åˆ†é…è§„åˆ’åŠç”³è¯·/æˆæƒ/ä½¿ç”¨è‡ªåŠ¨ç®¡ç†ï¼Œå¸Œæœ›å·¥ä½œç«™å¯ä»¥ä½œä¸ºæœåŠ¡å™¨ä½¿ç”¨ï¼Œèƒ½å¤Ÿå¤šäººåŒæ—¶ä½¿ç”¨ï¼Œäº’ä¸å½±å“ã€‚</p><h2 id="2ã€éœ€æ±‚"><a href="#2ã€éœ€æ±‚" class="headerlink" title="2ã€éœ€æ±‚"></a>2ã€éœ€æ±‚</h2><ul><li>ä¸åŒç”¨æˆ·ä¹‹é—´ä¸èƒ½ç›¸äº’å½±å“ä¸”å¯ä»¥åŒæ—¶ä½¿ç”¨</li><li>ç”¨æˆ·æ³¨å†Œç™»å½•ä½¿ç”¨éœ€è¦è¢«æˆæƒ</li><li>ç”¨æˆ·è¦èƒ½æ–¹ä¾¿åœ°è®¿é—®è‡ªå·±çš„â€œæœºå™¨â€</li><li>ç”¨æˆ·è¦æœ‰è¶³å¤Ÿå¤§çš„æƒé™ï¼Œèƒ½è‡ªç”±åœ°å®‰è£…ç¨‹åºï¼Œèƒ½è‡ªç”±åœ°è®¿é—®ç½‘ç»œ</li><li>ç”¨æˆ·ä¸è¢«å…è®¸ç›´æ¥æ“ä½œå®¿ä¸»æœº</li></ul><h2 id="3ã€å…·ä½“æ–¹æ¡ˆ"><a href="#3ã€å…·ä½“æ–¹æ¡ˆ" class="headerlink" title="3ã€å…·ä½“æ–¹æ¡ˆ"></a>3ã€å…·ä½“æ–¹æ¡ˆ</h2><h3 id="3-1ã€LXD-ZFS-å®‰è£…åŠé…ç½®"><a href="#3-1ã€LXD-ZFS-å®‰è£…åŠé…ç½®" class="headerlink" title="3.1ã€LXD/ZFS å®‰è£…åŠé…ç½®"></a>3.1ã€LXD/ZFS å®‰è£…åŠé…ç½®</h3><h4 id="LXD-è½¯ä»¶å®‰è£…s"><a href="#LXD-è½¯ä»¶å®‰è£…s" class="headerlink" title="LXD è½¯ä»¶å®‰è£…s"></a>LXD è½¯ä»¶å®‰è£…s</h4><p>LXDï¼šç”¨äºåˆ›å»ºå’Œç®¡ç†å®¹å™¨<br>ZFSï¼šç”¨äºç®¡ç†ç‰©ç†ç£ç›˜ï¼Œæ”¯æŒ LXD é«˜çº§åŠŸèƒ½ï¼Œè´Ÿè´£å®¹å™¨å­˜å‚¨ã€‚<br>Bridge-Utilsï¼šç”¨äºæ­å»ºç½‘æ¡¥ï¼Œè´Ÿè´£å®¹å™¨ä¸Šç½‘ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">sudo apt-get install lxd zfsutils-linux bridge-utils<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="åˆå§‹åŒ–-LXD"><a href="#åˆå§‹åŒ–-LXD" class="headerlink" title="åˆå§‹åŒ– LXD"></a>åˆå§‹åŒ– LXD</h4><p>è¿è¡Œ <code>sudo lxd init</code> è¿›è¡Œ LXD åˆå§‹åŒ–é…ç½®ï¼Œé€‰é¡¹å¦‚ä¸‹å›¾ï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/lxd.png" alt="lxd"></p><ul><li>LXD Clusteringï¼šä¸éœ€è¦</li><li>new storage poolï¼šéœ€è¦åˆ›å»ºä¸€ä¸ªå­˜å‚¨æ± </li><li>Name of storage poolï¼šç»™å­˜å‚¨æ± å‘½å</li><li>storage backendï¼šå­˜å‚¨åç«¯ï¼Œä½¿ç”¨ ZFS</li><li>Create a new ZFS poolï¼šéœ€è¦åˆ›å»ºä¸€ä¸ª ZFS æ± </li><li>use an existing block deviceï¼šYes</li><li>Path to block deviceï¼šä½¿ç”¨å·²æœ‰çš„ç£ç›˜åˆ†åŒºç”¨äº ZFS çš„å­˜å‚¨åç«¯ã€‚è¿™é‡Œç”¨çš„2Tç¡¬ç›˜</li><li>MAAS server?ï¼šä¸çŸ¥é“æ˜¯å•¥ï¼Œä¸éœ€è¦</li><li>new local network bridge?ï¼šéœ€è¦ï¼Œæˆ‘åªéœ€è¦ä½¿ç”¨ LXD é»˜è®¤çš„ç½‘æ¡¥å³å¯ã€‚</li><li>new bridge be calledï¼šç»™ç½‘æ¡¥å‘½å</li><li>iPv4ï¼šé»˜è®¤ auto</li><li>IPv6ï¼šé»˜è®¤ auto</li><li>LXD available over the networkï¼Ÿï¼šé»˜è®¤ no</li><li>stale cachedï¼Ÿï¼šé»˜è®¤ yes</li><li>YAML printedï¼Ÿï¼šé€‰æ‹©yesï¼ŒæŸ¥çœ‹å®¹å™¨é…ç½®ä¿¡æ¯</li></ul><h4 id="æ–°å»ºå®¹å™¨"><a href="#æ–°å»ºå®¹å™¨" class="headerlink" title="æ–°å»ºå®¹å™¨"></a>æ–°å»ºå®¹å™¨</h4><pre class="line-numbers language-shell"><code class="language-shell"># åˆ›å»ºä¸€ä¸ªremoteé“¾æ¥ï¼ŒæŒ‡å‘TUNAé•œåƒç«™ã€‚sudo lxc remote add tuna-images https://mirrors.tuna.tsinghua.edu.cn/lxc-images/ --protocol=simplestreams --public# æŸ¥çœ‹é•œåƒåˆ—è¡¨ï¼Œå¯»æ‰¾åˆé€‚çš„é•œåƒçš„FINGERPRINTï¼Œç”¨äºä¸‹è½½sudo lxc image list tuna-images: # ä¸¾ä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºtigerçš„å®¹å™¨ã€‚åœ¨lxcæ¸…åæºä¸­ä½¿ç”¨ubuntu/18.04sudo lxc launch tuna-images:ubuntu/18.04 tiger<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æŸ¥çœ‹å®¹å™¨"><a href="#æŸ¥çœ‹å®¹å™¨" class="headerlink" title="æŸ¥çœ‹å®¹å™¨"></a>æŸ¥çœ‹å®¹å™¨</h4><p>è¿è¡Œ <code>sudo lxc list</code> è¿›è¡Œå®¹å™¨åˆ—è¡¨æŸ¥çœ‹ã€‚</p><p>è¿è¡Œ <code>sudo lxc exec &lt;ContainerTemplateName&gt; bash</code>  å¯è¿›å…¥å®¹å™¨çš„ root ç”¨æˆ·ä¸‹ bashã€‚</p><p>å¯ä»¥ä½¿ç”¨ <code>su ubuntu</code> æˆ– <code>sudo su</code> è¿›è¡Œç”¨æˆ·åˆ‡æ¢ã€‚</p><pre class="line-numbers language-shell"><code class="language-shell">#ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ›´æ”¹å®¹å™¨ç³»ç»Ÿç”¨æˆ·å¯†ç passwd ubuntu passwd root#åé¢è¿œç¨‹ç™»é™†ä¼šç”¨åˆ°<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="è®¾ç½®å®¹å™¨"><a href="#è®¾ç½®å®¹å™¨" class="headerlink" title="è®¾ç½®å®¹å™¨"></a>è®¾ç½®å®¹å™¨</h4><pre class="line-numbers language-sh"><code class="language-sh">#æ¢æºï¼ŒåŠ é€Ÿapt-get insatllsudo vim /etc/apt/sources.list====deb http://mirrors.163.com/ubuntu/ bionic main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse===#åˆ·æ–°æºsudo apt update#å®‰è£…å¿…è¦å·¥å…·apt install make cmake openssh-server gcc g++ build-essential#å¯åŠ¨sshå‘½ä»¤ sudo service ssh start#ç«¯å£è½¬å‘60601æ˜¯æˆ‘ä»¬å®šçš„ç«¯å£å·ï¼Œé€šè¿‡å®¿ä¸»æœºçš„60601ç«¯å£å·ç›‘å¬å®¹å™¨ä¸­22ç«¯å£å·ï¼ˆSSHé»˜è®¤ç«¯å£å·ï¼‰sudo lxc config device add <container> proxy0 proxy listen=tcp:172.22.24.126:60601 connect=tcp:10.152.210.183:22 bind=host#æ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨æ ¡å›­ç½‘è®¿é—®ssh ubuntu@172.22.24.126 -p 60601<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-2ã€é…ç½®å…±äº«ç›®å½•å’Œ-GPU"><a href="#3-2ã€é…ç½®å…±äº«ç›®å½•å’Œ-GPU" class="headerlink" title="3.2ã€é…ç½®å…±äº«ç›®å½•å’Œ GPU"></a>3.2ã€é…ç½®å…±äº«ç›®å½•å’Œ GPU</h3><p>é…ç½®å…±äº«ç›®å½•</p><pre class="line-numbers language-sh"><code class="language-sh">sudo lxc config set <yourContainerName> security.privileged truesudo lxc config device add <yourContainerName> <shareName> disk source=path1 path=path2#ä¸¾ä¾‹sudo lxc config device add tiger father disk source=/home/gdz path=/father# path1ä¸ºå®¿ä¸»æœºè·¯å¾„ï¼Œpath2ä¸ºå®¹å™¨å†…è·¯å¾„<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é…ç½®GPU</p><pre class="line-numbers language-sh"><code class="language-sh">#ä¸ºå®¹å™¨æ·»åŠ æ‰€æœ‰GPU:sudo lxc config device add <yourContainerName> gpu gpu#æ·»åŠ æŒ‡å®šGPUï¼š sudo lxc config device add <yourContainerName> gpu0 gpu id=0# å®‰è£…é©±åŠ¨ï¼šåœ¨å®¹å™¨ä¸­æ˜¾å¡é©±åŠ¨ä¸éœ€è¦å®‰è£…å†…æ ¸æ–‡ä»¶ï¼Œå®‰è£…å®¿ä¸»æœºæ˜¾å¡é©±åŠ¨çš„ç‰ˆæœ¬ï¼Œé€šè¿‡å…±äº«ç›®å½•ä¼ è‡³å®¹å™¨ä¸­sudo sh /NVIDIA-Linux-x86_64-xxx.xx.run --no-kernel-module <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŒ‚è½½ <code>nvidia-uvm</code></p><p>â‘ å¦‚æœå®¿ä¸»æœºæ²¡æœ‰<code>/dev/nvidia-uvm</code>è®¾å¤‡ï¼Œéœ€è¦é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŒ‚è½½è®¾å¤‡ï¼š</p><pre class="line-numbers language-sh"><code class="language-sh">/sbin/modprobe nvidia-uvmD=`grep nvidia-uvm /proc/devices | awk '{print $1}'`mknod -m 666 /dev/nvidia-uvm c $D 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>â‘¡æŒ‚è½½è®¾å¤‡åˆ°å®¹å™¨ï¼š</p><pre class="line-numbers language-sh"><code class="language-sh">sudo lxc config device add yourContainerName nvidia-uvm unix-char path=/dev/nvidia-uvm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-3ã€é…ç½®å›¾å½¢æ¡Œé¢"><a href="#3-3ã€é…ç½®å›¾å½¢æ¡Œé¢" class="headerlink" title="3.3ã€é…ç½®å›¾å½¢æ¡Œé¢"></a>3.3ã€é…ç½®å›¾å½¢æ¡Œé¢</h3><blockquote><p>Xrdp æ˜¯ Microsoft è¿œç¨‹æ¡Œé¢åè®® (RDP) çš„å¼€æºå®ç°ï¼Œå…è®¸ä»¥å›¾å½¢æ–¹å¼æ§åˆ¶è¿œç¨‹ç³»ç»Ÿã€‚ä½¿ç”¨ RDP å¯ä»¥ç™»å½•åˆ°è¿œç¨‹è®¡ç®—æœºå¹¶åˆ›å»ºä¸€ä¸ªçœŸå®çš„æ¡Œé¢ä¼šè¯ï¼Œå°±åƒæ‚¨å·²ç™»å½•åˆ°æœ¬åœ°è®¡ç®—æœºä¸€æ ·ã€‚</p><p>Ubuntu å­˜å‚¨åº“ä¸­æœ‰å¥½å‡ ä¸ªæ¡Œé¢ç¯å¢ƒï¼Œè¿™é‡Œæˆ‘ä»¬å°†å®‰è£… Xfce ã€‚å®ƒæ˜¯ä¸€ä¸ªå¿«é€Ÿï¼Œç¨³å®šå’Œè½»é‡çº§çš„æ¡Œé¢ç¯å¢ƒï¼Œéå¸¸é€‚åˆåœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šä½¿ç”¨</p></blockquote><p><strong>å®‰è£… Xrdp</strong></p><pre class="line-numbers language-sh"><code class="language-sh">sudo apt install xrdp# å®‰è£…å®Œæˆå Xrdp æœåŠ¡å°†è‡ªåŠ¨è¿è¡Œï¼Œæ‚¨å¯ä»¥é€šè¿‡é”®å…¥ä»¥ä¸‹æŒ‡ä»¤æ¥éªŒè¯ Xrdp æ˜¯å¦æ­£åœ¨è¿è¡Œsudo systemctl status xrdp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>é…ç½® Xrdp</strong></p><p>Xrdp çš„é…ç½®æ–‡ä»¶ä½äº /etc/xrdp ç›®å½•ã€‚å¯¹äº Xrdp çš„åŸºæœ¬è¿æ¥ï¼Œåªéœ€è¦é…ç½® Xrdp å³å¯ä½¿ç”¨ Xfce ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript">sudo vim <span class="token operator">/</span>etc<span class="token operator">/</span>xrdp<span class="token operator">/</span>xrdp<span class="token punctuation">.</span>ini<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹å¹¶ä¿å­˜ï¼š</p><p>exec startxfce4</p><p>æ­¤å¤–ï¼Œè¯¥æ–‡ä»¶ä¸­å¯é…ç½® xrdp è¿œç¨‹æ¡Œé¢æœåŠ¡çš„ç«¯å£å·ï¼ˆé»˜è®¤ç«¯å£ä¸º3389ï¼‰</p><pre class="line-numbers language-sh"><code class="language-sh"># é‡æ–°å¯åŠ¨ Xrdp æœåŠ¡ï¼šsudo systemctl restart xrdp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>ç«¯å£è½¬å‘</strong></p><pre><code># åœ¨å®‰è£…å¥½XRDPåï¼Œä¸ä¹‹å‰ä¸€æ ·ï¼Œå› ä¸ºæˆ‘ä»¬pingä¸é€šå®¹å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨å®¿ä¸»æœºçš„ç«¯å£å·ç›‘å¬å®¹å™¨çš„xrdpçš„ç«¯å£3389sudo lxc config device add &lt;container&gt; proxy1 proxy listen=tcp:172.22.24.126:60611 connect=tcp:10.152.210.183:3389 bind=host</code></pre><p>ç°åœ¨å¯ä»¥é€šè¿‡windowsçš„è¿œç¨‹è¿æ¥æˆ–è€…ubuntuçš„Remmina æ¥ä½¿ç”¨å®¹å™¨ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201126002245828.png" alt="1"></p><h3 id="3-4ã€åˆ›å»ºå®¹å™¨æ¨¡æ¿å¹¶åˆ†å‘"><a href="#3-4ã€åˆ›å»ºå®¹å™¨æ¨¡æ¿å¹¶åˆ†å‘" class="headerlink" title="3.4ã€åˆ›å»ºå®¹å™¨æ¨¡æ¿å¹¶åˆ†å‘"></a>3.4ã€åˆ›å»ºå®¹å™¨æ¨¡æ¿å¹¶åˆ†å‘</h3><p><strong>ä¸ºå®¹å™¨ä¿®æ”¹å‚æ•°é…ç½®</strong></p><pre class="line-numbers language-sh"><code class="language-sh">sudo lxc config edit YourContainerName<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸€èˆ¬ä½¿ç”¨ä»¥ä¸‹çš„é…ç½®å³å¯æ»¡è¶³</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1.png" alt="img"></p><p>é…ç½®é»˜è®¤å®¹å™¨å‚æ•°ï¼ˆæ–°å®¹å™¨çš„å‚æ•°ä¼šç»§æ‰¿defaulté…ç½®çš„å‚æ•°ï¼Œå®¹å™¨ä¼šä¼˜å…ˆä½¿ç”¨è‡ªå·±çš„å‚æ•°ï¼‰</p><pre><code>sudo lxc profile edit default</code></pre><p><strong>æˆ‘ä»¬æŠŠè¿™ä¸ªé…ç½®å¥½çš„å®¹å™¨å½“æˆæ¨¡æ¿ï¼Œä¿å­˜ä¸ºé•œåƒ</strong>ã€‚</p><p>åœæ­¢å®¹å™¨</p><pre><code> sudo lxc stop test</code></pre><p>å°†è¯¥å®¹å™¨å¤åˆ¶ä¸ºubuntudemoï¼Œä½œä¸ºä»¥åå®¹å™¨åˆ†å‘çš„æ¨¡æ¿</p><pre><code>sudo lxc copy tiger ubuntudemo</code></pre><p>å¹¶åˆ é™¤ç«¯å£è½¬å‘</p><pre><code>sudo lxc config device remove ubuntudemo proxy1</code></pre><p>ç°åœ¨ï¼Œå»ºç«‹ç¬¬äºŒä¸ªå®¹å™¨bigdogå§ï¼Œè®°å¾—æŠŠç«¯å£è½¬å‘è®¾ç½®ä¸‹ï¼Œå¹¶è®¾ç½®å®¹å™¨çš„åˆå§‹å¯†ç </p><pre class="line-numbers language-sh"><code class="language-sh">sudo lxc copy tiger ubuntudemosudo lxc config device add bigdog proxy1 proxy listen=tcp:xx.xx.xx.xx:60621 connect=tcp:10.176.88.68:3389 bind=host<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3-5ã€LXDUI-å¯è§†åŒ–ç®¡ç†ç•Œé¢"><a href="#3-5ã€LXDUI-å¯è§†åŒ–ç®¡ç†ç•Œé¢" class="headerlink" title="3.5ã€LXDUI å¯è§†åŒ–ç®¡ç†ç•Œé¢"></a>3.5ã€LXDUI å¯è§†åŒ–ç®¡ç†ç•Œé¢</h3><p>åœ¨å®¿ä¸»æœºä¸Šæ ¹æ®<a href="https://github.com/AdaptiveScale/lxdui" target="_blank" rel="noopener">AdaptiveScale/lxdui: LXDUI is a web UI for the native Linux container technology LXD/LXC (github.com)</a>é…ç½®å¯è§†åŒ–ç®¡ç†ç•Œé¢ï¼Œå¦‚ä¸‹ï¼Œæ–¹ä¾¿åœ°ç®¡ç†å®¹å™¨</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201126153135876.png" alt=""></p><h2 id="4ã€å®¿ä¸»æœºçš„è¿œç¨‹è®¿é—®"><a href="#4ã€å®¿ä¸»æœºçš„è¿œç¨‹è®¿é—®" class="headerlink" title="4ã€å®¿ä¸»æœºçš„è¿œç¨‹è®¿é—®"></a>4ã€å®¿ä¸»æœºçš„è¿œç¨‹è®¿é—®</h2><p>ä½¿ç”¨xdrpè®¿é—®å®¿ä¸»æœºé»˜è®¤æ¡Œé¢</p><h3 id="4-1ã€è®¾ç½®ubuntu"><a href="#4-1ã€è®¾ç½®ubuntu" class="headerlink" title="4.1ã€è®¾ç½®ubuntu"></a>4.1ã€è®¾ç½®ubuntu</h3><blockquote><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆè®¾ç½®Ubuntuçš„è¿œç¨‹æ§åˆ¶ï¼Œå°†å…¶è®¾ç½®ä¸ºå…è®¸è¢«è¿œç¨‹è¿æ¥ï¼Œè¿›å…¥ç³»ç»Ÿ-ã€‹é¦–é€‰é¡¹-ã€‹æ¡Œé¢å…±äº«ï¼Œæˆ–è€…ç›´æ¥æœç´¢æ¡Œé¢å…±äº«</p><p>å°†ã€å…è®¸å…¶ä»–äººæŸ¥çœ‹æ‚¨çš„æ¡Œé¢ã€‘è¿™ä¸€é¡¹å‹¾ä¸Šï¼Œç„¶ååœ¨å®‰å…¨é‚£é¡¹ï¼Œå‹¾é€‰ã€è¦æ±‚è¿œç¨‹ç”¨æˆ·è¾“å…¥æ­¤å¯†ç ã€‘ï¼Œå¹¶è®¾ç½®è¿œç¨‹å¯†ç ã€‚å¹¶ä¸”æˆ‘ä»¬å–æ¶ˆå‹¾é€‰ã€å¿…é¡»ä¸ºå¯¹æœ¬æœºå™¨çš„æ¯æ¬¡è®¿é—®è¿›è¡Œç¡®å®šã€‘ï¼ˆè¿™æ ·åšï¼Œæ˜¯ä¸ºäº†è¢«è¿œç¨‹çš„æ—¶å€™ä¸éœ€è¦å†ç¡®è®¤ï¼Œå¦åˆ™æ¯æ¬¡è¿œç¨‹éƒ½è¦äººä¸ºç¡®è®¤æ‰èƒ½è¢«è¿œç¨‹ï¼Œä¼šå¾ˆç¹çï¼‰å¦‚å›¾æ‰€ç¤ºï¼š</p></blockquote><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201126153209005.png" alt=""></p><h3 id="4-2ã€å®‰è£…xdrp-vnc"><a href="#4-2ã€å®‰è£…xdrp-vnc" class="headerlink" title="4.2ã€å®‰è£…xdrp+vnc"></a>4.2ã€å®‰è£…xdrp+vnc</h3><pre class="line-numbers language-sh"><code class="language-sh">#æ­¥éª¤ä¸€ã€å®‰è£…TigerVNC Serverè½¯ä»¶åŒ…sudo apt-get install tightvncserver ï¼ˆä½¿ç”¨åœ¨çº¿å®‰è£…ï¼‰#æ­¥éª¤äºŒã€å®‰è£…xrdpsudo apt-get install xrdp -y#æ­¥éª¤ä¸‰ã€ç¼–è¾‘é…ç½®ï¼šsudo vi /etc/xrdp/startwm.sh#æŠŠæœ€ä¸‹é¢çš„testå’Œexecä¸¤è¡Œæ³¨é‡Šæ‰ï¼Œæ·»åŠ ä¸€è¡Œunity<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-3ã€å®‰è£…dconf-editor-å–æ¶ˆæƒé™é™åˆ¶"><a href="#4-3ã€å®‰è£…dconf-editor-å–æ¶ˆæƒé™é™åˆ¶" class="headerlink" title="4.3ã€å®‰è£…dconf-editor(å–æ¶ˆæƒé™é™åˆ¶)"></a>4.3ã€å®‰è£…dconf-editor(å–æ¶ˆæƒé™é™åˆ¶)</h3><p>å†æ¬¡ï¼Œæˆ‘ä»¬éœ€è¦å–æ¶ˆæ‰è¯·æ±‚åŠ å¯†çš„åŠŸèƒ½ï¼Œå¦åˆ™ç¼ºå°‘è¿™ä¸€æ­¥æ˜¯æ— æ³•è¿œç¨‹ä¸Šçš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å®‰è£…dconf-editorå·¥å…·è¿›è¡Œé…ç½®ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><pre><code>sudo apt-get install dconf-editor</code></pre><p>å®‰è£…å®Œæˆä¹‹åï¼Œæˆ‘ä»¬éœ€è¦æ‰“å¼€dconf-editorå·¥å…·ï¼Œåœ¨æ¡Œé¢æœç´¢dconf-editoræ‰“å¼€ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201126153453473.png" alt=""></p><p>æ‰“å¼€ä¹‹åï¼Œä¾æ¬¡å±•å¼€org-&gt;gnome-&gt;desktop-&gt;remote-accessï¼Œç„¶åå–æ¶ˆ â€œrequlre-encryptionâ€çš„å‹¾é€‰å³å¯ã€‚å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201126153555644.png" alt=""></p><p>è‡³æ­¤ï¼Œå‰æœŸå‡†å¤‡å·¥ä½œå·²ç»å®Œæˆï¼Œåé¢ç›´æ¥é€šè¿‡VNCå·¥å…·æˆ–è€…Windowsè‡ªå¸¦çš„mstsc(è¿œç¨‹æ¡Œé¢æ§åˆ¶)è¿›è¡Œè®¿é—®å°±è¡Œã€‚</p><h2 id="5ã€æ€»ç»“"><a href="#5ã€æ€»ç»“" class="headerlink" title="5ã€æ€»ç»“"></a>5ã€æ€»ç»“</h2><p>ç°åœ¨å°±å¯ä»¥åœ¨å®¿èˆæˆ–å®¶é‡Œä½¿ç”¨æ ¡å›­ç½‘è®¿é—®å·¥ä½œç«™äº†ï¼Œä¸ç®¡æ˜¯å®¿ä¸»æœºè¿˜æ˜¯å®¹å™¨éƒ½å¯ä»¥è¿œç¨‹è®¿é—®æ¡Œé¢ã€‚å®¹å™¨å†…å·²å®‰è£…å¥½cudaå’Œæ˜¾å¡é©±åŠ¨ï¼Œä»¥åŠpycharmã€minicondaã€Chromeæµè§ˆå™¨ã€‚</p><p>é€šè¿‡æ­¤æ¬¡ç»ƒä¹ ä¸é…ç½®ï¼Œå¯¹Linuxç¯å¢ƒæ›´åŠ ç†Ÿæ‚‰äº†ï¼Œå‡†å¤‡æ•´ç†ä¸€ç¯‡Linuxå¸¸ç”¨å‘½ä»¤ä¾›è‡ªå·±æŸ¥é˜…ä½¿ç”¨ã€‚</p><p>å‚è€ƒé“¾æ¥ï¼š</p><p><a href="https://github.com/shenuiuin/LXD_GPU_SERVER" target="_blank" rel="noopener">shenuiuin/LXD_GPU_SERVER: å®éªŒå®¤GPUæœåŠ¡å™¨çš„LXDè™šæ‹ŸåŒ– (github.com)</a></p><p><a href="https://blog.csdn.net/wangke0809/article/details/80235989" target="_blank" rel="noopener">https://blog.csdn.net/wangke0809/article/details/80235989</a></p><p><a href="https://blog.yangl1996.com/post/gpu-passthrough-for-lxc/" target="_blank" rel="noopener">https://blog.yangl1996.com/post/gpu-passthrough-for-lxc/</a></p><p><a href="https://abcdabcd987.com/setup-shared-gpu-server-for-labs/" target="_blank" rel="noopener">https://abcdabcd987.com/setup-shared-gpu-server-for-labs/</a></p><p><a href="https://github.com/abcdabcd987/lxc-gpu" target="_blank" rel="noopener">https://github.com/abcdabcd987/lxc-gpu</a></p><p><a href="https://blog.csdn.net/weixin_42749767/article/details/83720831?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.pc_relevant_is_cache&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.pc_relevant_is_cache" target="_blank" rel="noopener">https://blog.csdn.net/weixin_42749767/article/details/83720831?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.pc_relevant_is_cache&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.pc_relevant_is_cache</a></p><p><a href="https://developer.aliyun.com/article/578196" target="_blank" rel="noopener">https://developer.aliyun.com/article/578196</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxå¸¸ç”¨å‘½ä»¤</title>
      <link href="/2020/11/26/linux-chang-yong-ming-ling/"/>
      <url>/2020/11/26/linux-chang-yong-ming-ling/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ã€æ–‡ä»¶-æ–‡ä»¶å¤¹ç®¡ç†"><a href="#ä¸€ã€æ–‡ä»¶-æ–‡ä»¶å¤¹ç®¡ç†" class="headerlink" title="ä¸€ã€æ–‡ä»¶/æ–‡ä»¶å¤¹ç®¡ç†"></a><strong>ä¸€ã€æ–‡ä»¶/æ–‡ä»¶å¤¹ç®¡ç†</strong></h2><pre class="line-numbers language-sh"><code class="language-sh">#åˆ—å‡ºå½“å‰ç›®å½•æ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬éšå«æ–‡ä»¶ï¼‰ ls #åˆ—å‡ºå½“å‰ç›®å½•æ–‡ä»¶ï¼ˆåŒ…æ‹¬éšå«æ–‡ä»¶ï¼‰ls -a  #åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯ ls -l #ç­›é€‰å‘½ä»¤ï¼Œæ¯”å¦‚æˆ‘æƒ³æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹çš„ markdown æ–‡ä»¶ls -lh | grep .md#å›å½“å‰ç”¨æˆ·çš„å®¿ä¸»ç›®å½• cd#å›å½“å‰ç›®å½•çš„ä¸Šä¸€çº§ç›®å½• cd .. #å›ä¸Šä¸€æ¬¡æ‰€åœ¨çš„ç›®å½• cd - #æ¥æŒ‡å‡ºå½“å‰æ‰€åœ¨çš„è·¯å¾„pwd#åˆ›å»ºä¸€ä¸ªç›®å½• mkdir ç›®å½•å #åˆ é™¤ä¸€ä¸ªç©ºç›®å½• rmdir ç©ºç›®å½•å #åˆ é™¤ä¸€ä¸ªæ–‡ä»¶æˆ–å¤šä¸ªæ–‡ä»¶ rm æ–‡ä»¶å æ–‡ä»¶å #åˆ é™¤ä¸€ä¸ªéç©ºç›®å½•ä¸‹çš„ä¸€åˆ‡ rm -rf éç©ºç›®å½•å #åˆ›å»ºç©ºæ–‡ä»¶touch æ–‡ä»¶å#åˆ é™¤æ–‡ä»¶rm -rf æ–‡ä»¶å#æŸ¥çœ‹æ–‡ä»¶cat æ–‡ä»¶åã€æ˜¾ç¤ºå…¨éƒ¨å†…å®¹ï¼Œæ–‡ä»¶å¤ªå¤§æ— æ³•å…¨éƒ¨æ˜¾ç¤ºã€‘cat -n æ–‡ä»¶å ã€æŸ¥çœ‹å†…å®¹ï¼Œå¹¶æ·»åŠ è¡Œå·ã€‘#æ‹·è´åˆ°ç›®æ ‡ä½ç½®ï¼Œæˆ–è€…æ–°ä½ç½®cpåŸæ–‡ä»¶åæˆ–ç›®å½•å ç›®æ ‡ä½ç½® mv åŸæ–‡ä»¶åæˆ–ç›®å½•å æ–°æ–‡ä»¶åæˆ–ç›®å½•<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="äºŒã€ç³»ç»Ÿä¿¡æ¯ç®¡ç†"><a href="#äºŒã€ç³»ç»Ÿä¿¡æ¯ç®¡ç†" class="headerlink" title="äºŒã€ç³»ç»Ÿä¿¡æ¯ç®¡ç†"></a><strong>äºŒã€ç³»ç»Ÿä¿¡æ¯ç®¡ç†</strong></h2><pre class="line-numbers language-sh"><code class="language-sh">#æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ uname -a #æŸ¥çœ‹ubuntuç‰ˆæœ¬ cat /etc/issue #æŸ¥çœ‹CPUä¿¡æ¯ cat /proc/cpuinfo #æŸ¥çœ‹usbè®¾å¤‡ lsusb #æŸ¥çœ‹PCIè®¾å¤‡ lspci#æŸ¥çœ‹ç½‘ç»œä¿¡æ¯ifconfig#æŸ¥çœ‹ç£ç›˜ä¿¡æ¯ sudo fdisk -l #æŸ¥çœ‹ç¡¬ç›˜å‰©ä½™ç©ºé—´df -h  #æŸ¥çœ‹å½“å‰çš„å†…å­˜ä½¿ç”¨æƒ…å†µ free -m#æŸ¥çœ‹å½“å‰æœ‰å“ªäº›è¿›ç¨‹ ps -A #(å°±æ˜¯ps -Aä¸­çš„ç¬¬ä¸€åˆ—çš„æ•°å­—)æˆ–è€… killall è¿›ç¨‹å( æ€æ­»ä¸€ä¸ªè¿›ç¨‹) kill è¿›ç¨‹å·#å¼ºåˆ¶æ€æ­»ä¸€ä¸ªè¿›ç¨‹kill -9 è¿›ç¨‹å·  #æ›´æ”¹ç³»ç»Ÿç”¨æˆ·å¯†ç sudo passwd root #è¿›å…¥rootæƒé™sudo su#ä»æœåŠ¡å™¨ä¸ŠåŒæ­¥æ—¶é—´ sudo ntpdate time.nist.gov sudo ntpdate time.windows.com <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä¸‰ã€å‹ç¼©æ–‡ä»¶å¤„ç†"><a href="#ä¸‰ã€å‹ç¼©æ–‡ä»¶å¤„ç†" class="headerlink" title="ä¸‰ã€å‹ç¼©æ–‡ä»¶å¤„ç†"></a><strong>ä¸‰ã€å‹ç¼©æ–‡ä»¶å¤„ç†</strong></h2><pre class="line-numbers language-sh"><code class="language-sh">#è§£å‹ç¼© xxx.tar.gz tar -zxvf xxx.tar.gz #è§£å‹ç¼© xxx.tar.bz2 tar -jxvf xxx.tar.bz2 #å‹ç¼©aaa bbbç›®å½•ä¸ºxxx.tar.gz tar -zcvf xxx.tar.gz aaa bbb #å‹ç¼©aaa bbbç›®å½•ä¸ºxxx.tar.bz2 tar -jcvf xxx.tar.bz2 aaa bbb #è§£å‹ç¼© RAR æ–‡ä»¶ #1) å…ˆå®‰è£… sudo apt-get install rar unrar sudo ln -f /usr/bin/rar /usr/bin/unrar #2) è§£å‹ unrar x aaaa.rar #å®‰è£…debæ–‡ä»¶sudo dpkg -i xxx.deb <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å››ã€æ¢å›½å†…æº"><a href="#å››ã€æ¢å›½å†…æº" class="headerlink" title="å››ã€æ¢å›½å†…æº"></a><strong>å››ã€æ¢å›½å†…æº</strong></h2><h3 id="aptæ¢æº"><a href="#aptæ¢æº" class="headerlink" title="aptæ¢æº"></a>aptæ¢æº</h3><pre class="line-numbers language-sh"><code class="language-sh">sudo vim /etc/apt/sources.list----deb http://mirrors.163.com/ubuntu/ bionic main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiversedeb http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiversedeb-src http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse--#åˆ·æ–°æºsudo apt update<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="condaæ¢æº"><a href="#condaæ¢æº" class="headerlink" title="condaæ¢æº"></a>condaæ¢æº</h3><pre class="line-numbers language-sh"><code class="language-sh">#æŸ¥çœ‹å½“å‰çš„ä¸‹è½½æºconda config --showconda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/#è®¾ç½®æœç´¢æ—¶æ˜¾ç¤ºé€šé“åœ°å€ ä»channelä¸­å®‰è£…åŒ…æ—¶æ˜¾ç¤ºchannelçš„urlï¼Œè¿™æ ·å°±å¯ä»¥çŸ¥é“åŒ…çš„å®‰è£…æ¥æºconda config --set show_channel_urls yes#æŸ¥çœ‹ç°åœ¨çš„ä¸‹è½½æºconda config --show<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="condaå‘½ä»¤"><a href="#condaå‘½ä»¤" class="headerlink" title="condaå‘½ä»¤"></a>condaå‘½ä»¤</h3><pre class="line-numbers language-sh"><code class="language-sh">#åˆ›å»ºä¸€ä¸ªåä¸ºpython34çš„ç¯å¢ƒï¼ŒæŒ‡å®šPythonç‰ˆæœ¬æ˜¯3.4conda create --name python34 python=3.4#ä½¿ç”¨activateæ¿€æ´»æŸä¸ªç¯å¢ƒsource activate python34 # for Linux & Mac# ç¦»å¼€ç¯å¢ƒsource deactivate#åˆ é™¤ä¸€ä¸ªå·²æœ‰çš„ç¯å¢ƒconda remove --name python34 --all#å…‹éš†ç¯å¢ƒconda create --name newname --clone oldname #åˆ—å‡ºæ‰€æœ‰ç¯å¢ƒconda info -e# æŸ¥çœ‹å·²ç»å®‰è£…çš„packagesconda list# æŸ¥çœ‹æŸä¸ªæŒ‡å®šç¯å¢ƒçš„å·²å®‰è£…åŒ…conda list -n python34# pipå®‰è£…åŠ ä¸Šå›½å†…æºpip install <name> -i https://pypi.tuna.tsinghua.edu.cn/simplepip install <name> -i http://mirrors.aliyun.com/pypi/simple/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="äº”ã€aptå‘½ä»¤"><a href="#äº”ã€aptå‘½ä»¤" class="headerlink" title="äº”ã€aptå‘½ä»¤"></a><strong>äº”ã€aptå‘½ä»¤</strong></h2><pre class="line-numbers language-sh"><code class="language-sh">sudo apt-get install package å®‰è£…åŒ… sudo apt-get install package - - reinstall é‡æ–°å®‰è£…åŒ… sudo apt-get -f install ä¿®å¤å®‰è£…â€-f = â€“fix-missingâ€ sudo apt-get remove package åˆ é™¤åŒ… sudo apt-get remove package - - purge åˆ é™¤åŒ…ï¼ŒåŒ…æ‹¬åˆ é™¤é…ç½®æ–‡ä»¶ç­‰ sudo apt-get update æ›´æ–°æº sudo apt-get upgrade æ›´æ–°å·²å®‰è£…çš„åŒ… sudo apt-get clean æ¸…ç†æ‰€æœ‰è½¯ä»¶ç¼“å­˜ï¼ˆå³ç¼“å­˜åœ¨/var/cache/apt/archivesç›®å½•é‡Œçš„debåŒ…ï¼‰sudo apt-get autoclean æ¸…ç†æ—§ç‰ˆæœ¬çš„è½¯ä»¶ç¼“å­˜ sudo apt-get autoremove  åˆ é™¤ç³»ç»Ÿä¸å†ä½¿ç”¨çš„å­¤ç«‹è½¯ä»¶<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å…­ã€å…¶ä»–"><a href="#å…­ã€å…¶ä»–" class="headerlink" title="å…­ã€å…¶ä»–"></a><strong>å…­ã€å…¶ä»–</strong></h2><pre class="line-numbers language-sh"><code class="language-sh"># ç»™è¿è¡Œæƒé™chmod +x  *.sh# ç»™æ‰€æœ‰æƒé™chmod 777  *.sh# æ¯10sæ˜¾å¡æƒ…å†µwatch -n 10 nvidia-smi# æŸ¥çœ‹cudaç‰ˆæœ¬nvcc -V<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> å¤‡å¿˜å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSMæ¡†æ¶æ•´åˆ</title>
      <link href="/2020/10/21/ssm-kuang-jia-zheng-he/"/>
      <url>/2020/10/21/ssm-kuang-jia-zheng-he/</url>
      
        <content type="html"><![CDATA[<h3 id="1-ç¯å¢ƒé…ç½®"><a href="#1-ç¯å¢ƒé…ç½®" class="headerlink" title="1. ç¯å¢ƒé…ç½®"></a>1. ç¯å¢ƒé…ç½®</h3><h4 id="1-1-æ–°å»ºä¸€Mavené¡¹ç›®ï¼ssmbuild-ï¼Œ-æ·»åŠ webçš„æ”¯æŒ"><a href="#1-1-æ–°å»ºä¸€Mavené¡¹ç›®ï¼ssmbuild-ï¼Œ-æ·»åŠ webçš„æ”¯æŒ" class="headerlink" title="1.1 æ–°å»ºä¸€Mavené¡¹ç›®ï¼ssmbuild ï¼Œ æ·»åŠ webçš„æ”¯æŒ"></a>1.1 æ–°å»ºä¸€Mavené¡¹ç›®ï¼ssmbuild ï¼Œ æ·»åŠ webçš„æ”¯æŒ</h4><h4 id="1-2-å¯¼å…¥ç›¸å…³çš„pomä¾èµ–ï¼"><a href="#1-2-å¯¼å…¥ç›¸å…³çš„pomä¾èµ–ï¼" class="headerlink" title="1.2 å¯¼å…¥ç›¸å…³çš„pomä¾èµ–ï¼"></a>1.2 å¯¼å…¥ç›¸å…³çš„pomä¾èµ–ï¼</h4><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!--Junit--></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>4.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!--æ•°æ®åº“é©±åŠ¨--></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.1.47<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!-- æ•°æ®åº“è¿æ¥æ±  --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.mchange<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>c3p0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>0.9.5.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!--Servlet - JSP --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>servlet-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jsp-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>javax.servlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jstl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!--Mybatis--></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>3.5.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.mybatis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!--Spring--></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-webmvc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.1.9.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-jdbc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>5.1.9.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.16.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-3-Mavenèµ„æºè¿‡æ»¤è®¾ç½®"><a href="#1-3-Mavenèµ„æºè¿‡æ»¤è®¾ç½®" class="headerlink" title="1.3 Mavenèµ„æºè¿‡æ»¤è®¾ç½®"></a>1.3 Mavenèµ„æºè¿‡æ»¤è®¾ç½®</h4><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resources</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.properties<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resource</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>directory</span><span class="token punctuation">></span></span>src/main/resources<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>directory</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>includes</span><span class="token punctuation">></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.properties<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span><span class="token punctuation">></span></span>**/*.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>include</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>includes</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filtering</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filtering</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resource</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resources</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-4-å»ºç«‹åŸºæœ¬ç»“æ„å’Œé…ç½®æ¡†æ¶ï¼"><a href="#1-4-å»ºç«‹åŸºæœ¬ç»“æ„å’Œé…ç½®æ¡†æ¶ï¼" class="headerlink" title="1.4 å»ºç«‹åŸºæœ¬ç»“æ„å’Œé…ç½®æ¡†æ¶ï¼"></a>1.4 å»ºç«‹åŸºæœ¬ç»“æ„å’Œé…ç½®æ¡†æ¶ï¼</h4><p>com.gdz.pojo<br>com.gdz.dao<br>com.gdz.service<br>com.gdz.controller<br><strong>mybatis-config.xml</strong></p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span><span class="token doctype">&lt;!DOCTYPE configuration       PUBLIC "-//mybatis.org//DTD Config 3.0//EN"       "http://mybatis.org/dtd/mybatis-3-config.dtd"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>applicationContext.xml</strong></p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans       http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-Mybatiså±‚ç¼–å†™"><a href="#2-Mybatiså±‚ç¼–å†™" class="headerlink" title="2. Mybatiså±‚ç¼–å†™"></a>2. Mybatiså±‚ç¼–å†™</h4><h4 id="2-1-æ•°æ®åº“é…ç½®æ–‡ä»¶-database-properties"><a href="#2-1-æ•°æ®åº“é…ç½®æ–‡ä»¶-database-properties" class="headerlink" title="2.1 æ•°æ®åº“é…ç½®æ–‡ä»¶ database.properties"></a>2.1 æ•°æ®åº“é…ç½®æ–‡ä»¶ database.properties</h4><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">jdbc.driver</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.jdbc.Driver</span><span class="token attr-name">jdbc.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/ssmbuild?useSSL=false&amp;useUnicode=true&amp;characterEncoding=utf8</span><span class="token attr-name">jdbc.username</span><span class="token punctuation">=</span><span class="token attr-value">root</span><span class="token attr-name">jdbc.password</span><span class="token punctuation">=</span><span class="token attr-value">gudongzhou678</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2-IDEAå…³è”æ•°æ®åº“"><a href="#2-2-IDEAå…³è”æ•°æ®åº“" class="headerlink" title="2.2 IDEAå…³è”æ•°æ®åº“"></a>2.2 IDEAå…³è”æ•°æ®åº“</h4><h4 id="2-3-ç¼–å†™MyBatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#2-3-ç¼–å†™MyBatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="2.3 ç¼–å†™MyBatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>2.3 ç¼–å†™MyBatisçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶</h4><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span><span class="token doctype">&lt;!DOCTYPE configuration       PUBLIC "-//mybatis.org//DTD Config 3.0//EN"       "http://mybatis.org/dtd/mybatis-3-config.dtd"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>typeAliases</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>package</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.gdz.pojo<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>typeAliases</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mappers</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com/gdz/dao/BookMapper.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mappers</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-4-ç¼–å†™æ•°æ®åº“å¯¹åº”çš„å®ä½“ç±»"><a href="#2-4-ç¼–å†™æ•°æ®åº“å¯¹åº”çš„å®ä½“ç±»" class="headerlink" title="2.4 ç¼–å†™æ•°æ®åº“å¯¹åº”çš„å®ä½“ç±»"></a>2.4 ç¼–å†™æ•°æ®åº“å¯¹åº”çš„å®ä½“ç±»</h4><p>com.gdz.pojo.Books<br>ä½¿ç”¨lombokæ’ä»¶ï¼</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>gdz<span class="token punctuation">.</span>pojo<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>AllArgsConstructor<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>Data<span class="token punctuation">;</span><span class="token keyword">import</span> lombok<span class="token punctuation">.</span>NoArgsConstructor<span class="token punctuation">;</span><span class="token annotation punctuation">@Data</span><span class="token annotation punctuation">@AllArgsConstructor</span><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Books</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> bookID<span class="token punctuation">;</span>    <span class="token keyword">private</span> String bookName<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> bookCounts<span class="token punctuation">;</span>    <span class="token keyword">private</span> String detail<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-5-ç¼–å†™Daoå±‚çš„-Mapperæ¥å£ï¼"><a href="#2-5-ç¼–å†™Daoå±‚çš„-Mapperæ¥å£ï¼" class="headerlink" title="2.5 ç¼–å†™Daoå±‚çš„ Mapperæ¥å£ï¼"></a>2.5 ç¼–å†™Daoå±‚çš„ Mapperæ¥å£ï¼</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>gdz<span class="token punctuation">.</span>dao<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>gdz<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span>Books<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BookMapper</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//å¢åŠ ä¸€ä¸ªBook</span>    <span class="token keyword">int</span> <span class="token function">addBook</span><span class="token punctuation">(</span>Books book<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ ¹æ®idåˆ é™¤ä¸€ä¸ªBook</span>    <span class="token keyword">int</span> <span class="token function">deleteBookById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ›´æ–°Book</span>    <span class="token keyword">int</span> <span class="token function">updateBook</span><span class="token punctuation">(</span>Books books<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ ¹æ®idæŸ¥è¯¢,è¿”å›ä¸€ä¸ªBook</span>    Books <span class="token function">queryBookById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æŸ¥è¯¢å…¨éƒ¨Book,è¿”å›listé›†åˆ</span>    List<span class="token operator">&lt;</span>Books<span class="token operator">></span> <span class="token function">queryAllBook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-6-ç¼–å†™æ¥å£å¯¹åº”çš„-Mapper-xml-æ–‡ä»¶"><a href="#2-6-ç¼–å†™æ¥å£å¯¹åº”çš„-Mapper-xml-æ–‡ä»¶" class="headerlink" title="2.6 ç¼–å†™æ¥å£å¯¹åº”çš„ Mapper.xml æ–‡ä»¶"></a>2.6 ç¼–å†™æ¥å£å¯¹åº”çš„ Mapper.xml æ–‡ä»¶</h4><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span><span class="token doctype">&lt;!DOCTYPE mapper        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"        "http://mybatis.org/dtd/mybatis-3-mapper.dtd"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.gdz.dao.BookMapper<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--å¢åŠ ä¸€ä¸ªBook--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>addBook<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Books<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        insert into ssmbuild.books(bookName, bookCounts, detail)        values (#{bookName}, #{bookCounts}, #{detail})    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--æ ¹æ®idåˆ é™¤ä¸€ä¸ªBook--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>delete</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>deleteBookById<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>int<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        delete        from ssmbuild.books        where bookID = #{bookID}    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>delete</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--æ›´æ–°Book--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>updateBook<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Books<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        update ssmbuild.books        set bookName   = #{bookName},            bookCounts = #{bookCounts},            detail     = #{detail}        where bookID = #{bookID}    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--æ ¹æ®idæŸ¥è¯¢,è¿”å›ä¸€ä¸ªBook--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>queryBookById<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Books<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        select *        from ssmbuild.books        where bookID = #{bookID}    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--æŸ¥è¯¢å…¨éƒ¨Book--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>queryAllBook<span class="token punctuation">"</span></span> <span class="token attr-name">resultType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Books<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        SELECT *        from ssmbuild.books    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-7-ç¼–å†™Serviceå±‚çš„æ¥å£å’Œå®ç°ç±»"><a href="#2-7-ç¼–å†™Serviceå±‚çš„æ¥å£å’Œå®ç°ç±»" class="headerlink" title="2.7 ç¼–å†™Serviceå±‚çš„æ¥å£å’Œå®ç°ç±»"></a>2.7 ç¼–å†™Serviceå±‚çš„æ¥å£å’Œå®ç°ç±»</h4><p>æ¥å£ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>gdz<span class="token punctuation">.</span>service<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>gdz<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span>Books<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BookService</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//å¢åŠ ä¸€ä¸ªBook</span>    <span class="token keyword">int</span> <span class="token function">addBook</span><span class="token punctuation">(</span>Books book<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ ¹æ®idåˆ é™¤ä¸€ä¸ªBook</span>    <span class="token keyword">int</span> <span class="token function">deleteBookById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ›´æ–°Book</span>    <span class="token keyword">int</span> <span class="token function">updateBook</span><span class="token punctuation">(</span>Books books<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æ ¹æ®idæŸ¥è¯¢,è¿”å›ä¸€ä¸ªBook</span>    Books <span class="token function">queryBookById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æŸ¥è¯¢å…¨éƒ¨Book,è¿”å›listé›†åˆ</span>    List<span class="token operator">&lt;</span>Books<span class="token operator">></span> <span class="token function">queryAllBook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ç°ç±»ï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>gdz<span class="token punctuation">.</span>service<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>gdz<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>BookMapper<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>gdz<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span>Books<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">BookService</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//è°ƒç”¨daoå±‚çš„æ“ä½œï¼Œè®¾ç½®ä¸€ä¸ªsetæ¥å£ï¼Œæ–¹ä¾¿Springç®¡ç†</span>    <span class="token keyword">private</span> BookMapper bookMapper<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBookMapper</span><span class="token punctuation">(</span>BookMapper bookMapper<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>bookMapper <span class="token operator">=</span> bookMapper<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">addBook</span><span class="token punctuation">(</span>Books book<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> bookMapper<span class="token punctuation">.</span><span class="token function">addBook</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deleteBookById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> bookMapper<span class="token punctuation">.</span><span class="token function">deleteBookById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">updateBook</span><span class="token punctuation">(</span>Books books<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> bookMapper<span class="token punctuation">.</span><span class="token function">updateBook</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> Books <span class="token function">queryBookById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> bookMapper<span class="token punctuation">.</span><span class="token function">queryBookById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>Books<span class="token operator">></span> <span class="token function">queryAllBook</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> bookMapper<span class="token punctuation">.</span><span class="token function">queryAllBook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>OKï¼Œåˆ°æ­¤ï¼Œåº•å±‚éœ€æ±‚æ“ä½œç¼–å†™å®Œæ¯•ï¼</strong></p><hr><h3 id="3-Springå±‚"><a href="#3-Springå±‚" class="headerlink" title="3. Springå±‚"></a>3. Springå±‚</h3><h4 id="3-1-ç¼–å†™Springæ•´åˆMybatisçš„é…ç½®æ–‡ä»¶"><a href="#3-1-ç¼–å†™Springæ•´åˆMybatisçš„é…ç½®æ–‡ä»¶" class="headerlink" title="3.1 ç¼–å†™Springæ•´åˆMybatisçš„é…ç½®æ–‡ä»¶"></a>3.1 ç¼–å†™Springæ•´åˆMybatisçš„é…ç½®æ–‡ä»¶</h4><blockquote><p>spring-dao.xml</p></blockquote><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans       http://www.springframework.org/schema/beans/spring-beans.xsd       http://www.springframework.org/schema/context       https://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!-- é…ç½®æ•´åˆmybatis --></span>   <span class="token comment" spellcheck="true">&lt;!-- 1.å…³è”æ•°æ®åº“æ–‡ä»¶ --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span> <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>classpath:database.properties<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   <span class="token comment" spellcheck="true">&lt;!-- 2.æ•°æ®åº“è¿æ¥æ±  --></span>   <span class="token comment" spellcheck="true">&lt;!--æ•°æ®åº“è¿æ¥æ±        dbcp åŠè‡ªåŠ¨åŒ–æ“ä½œ ä¸èƒ½è‡ªåŠ¨è¿æ¥       c3p0 è‡ªåŠ¨åŒ–æ“ä½œï¼ˆè‡ªåŠ¨çš„åŠ è½½é…ç½®æ–‡ä»¶ å¹¶ä¸”è®¾ç½®åˆ°å¯¹è±¡é‡Œé¢ï¼‰   --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.mchange.v2.c3p0.ComboPooledDataSource<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>       <span class="token comment" spellcheck="true">&lt;!-- é…ç½®è¿æ¥æ± å±æ€§ --></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>driverClass<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.driver}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbcUrl<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.url}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.username}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>${jdbc.password}<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>       <span class="token comment" spellcheck="true">&lt;!-- c3p0è¿æ¥æ± çš„ç§æœ‰å±æ€§ --></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>minPoolSize<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>       <span class="token comment" spellcheck="true">&lt;!-- å…³é—­è¿æ¥åä¸è‡ªåŠ¨commit --></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>autoCommitOnClose<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>       <span class="token comment" spellcheck="true">&lt;!-- è·å–è¿æ¥è¶…æ—¶æ—¶é—´ --></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkoutTimeout<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10000<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>       <span class="token comment" spellcheck="true">&lt;!-- å½“è·å–è¿æ¥å¤±è´¥é‡è¯•æ¬¡æ•° --></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>acquireRetryAttempts<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!-- 3.é…ç½®SqlSessionFactoryå¯¹è±¡ --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sqlSessionFactory<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.mybatis.spring.SqlSessionFactoryBean<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>       <span class="token comment" spellcheck="true">&lt;!-- æ³¨å…¥æ•°æ®åº“è¿æ¥æ±  --></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>       <span class="token comment" spellcheck="true">&lt;!-- é…ç½®MyBatieså…¨å±€é…ç½®æ–‡ä»¶:mybatis-config.xml --></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>configLocation<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>classpath:mybatis-config.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!-- 4.é…ç½®æ‰«æDaoæ¥å£åŒ…ï¼ŒåŠ¨æ€å®ç°Daoæ¥å£æ³¨å…¥åˆ°springå®¹å™¨ä¸­ --></span>   <span class="token comment" spellcheck="true">&lt;!--è§£é‡Š ï¼šhttps://www.cnblogs.com/jpfss/p/7799806.html--></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.mybatis.spring.mapper.MapperScannerConfigurer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>       <span class="token comment" spellcheck="true">&lt;!-- æ³¨å…¥sqlSessionFactory --></span>       &lt;propertyname="sqlSessionFactoryBeanName"value="sqlSessionFactory"/>       <span class="token comment" spellcheck="true">&lt;!-- ç»™å‡ºéœ€è¦æ‰«æDaoæ¥å£åŒ… --></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>basePackage<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.gdz.dao<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬è¿™é‡Œæ•°æ®æºä½¿ç”¨c3p0è¿æ¥æ± ï¼›</p><h4 id="3-2-Springæ•´åˆserviceå±‚"><a href="#3-2-Springæ•´åˆserviceå±‚" class="headerlink" title="3.2 Springæ•´åˆserviceå±‚"></a>3.2 Springæ•´åˆserviceå±‚</h4><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- æ‰«æserviceç›¸å…³çš„bean --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.gdz.service<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token comment" spellcheck="true">&lt;!--BookServiceImplæ³¨å…¥åˆ°IOCå®¹å™¨ä¸­--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>BookServiceImpl<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.gdz.service.BookServiceImpl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bookMapper<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bookMapper<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>transactionManager<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.springframework.jdbc.datasource.DataSourceTransactionManager<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æ³¨å…¥æ•°æ®åº“è¿æ¥æ±  --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dataSource<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Springå±‚æå®šï¼å†æ¬¡ç†è§£ä¸€ä¸‹ï¼ŒSpringå°±æ˜¯ä¸€ä¸ªå¤§æ‚çƒ©ï¼Œä¸€ä¸ªå®¹å™¨ï¼å¯¹å§ï¼</strong></p><h3 id="4-SpringMVCå±‚"><a href="#4-SpringMVCå±‚" class="headerlink" title="4. SpringMVCå±‚"></a>4. SpringMVCå±‚</h3><h4 id="4-1-é…ç½®æ–‡ä»¶"><a href="#4-1-é…ç½®æ–‡ä»¶" class="headerlink" title="4.1 é…ç½®æ–‡ä»¶"></a>4.1 é…ç½®æ–‡ä»¶</h4><h5 id="web-xml"><a href="#web-xml" class="headerlink" title="web.xml"></a>web.xml</h5><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://xmlns.jcp.org/xml/ns/javaee<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>        <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd<span class="token punctuation">"</span></span>        <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!--DispatcherServlet--></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>DispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>org.springframework.web.servlet.DispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>contextConfigLocation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>           <span class="token comment" spellcheck="true">&lt;!--ä¸€å®šè¦æ³¨æ„:æˆ‘ä»¬è¿™é‡ŒåŠ è½½çš„æ˜¯æ€»çš„é…ç½®æ–‡ä»¶ï¼Œä¹‹å‰è¢«è¿™é‡Œå‘äº†ï¼--></span>             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>classpath:applicationContext.xml<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>load-on-startup</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>load-on-startup</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>DispatcherServlet<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!--encodingFilter--></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>encodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-class</span><span class="token punctuation">></span></span>          org.springframework.web.filter.CharacterEncodingFilter       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-class</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>encoding<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-mapping</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter-name</span><span class="token punctuation">></span></span>encodingFilter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-name</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/*<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter-mapping</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!--Sessionè¿‡æœŸæ—¶é—´--></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>session-config</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>session-timeout</span><span class="token punctuation">></span></span>15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>session-timeout</span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>session-config</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="spring-mvc-xml"><a href="#spring-mvc-xml" class="headerlink" title="spring-mvc.xml"></a>spring-mvc.xml</h5><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/context<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>mvc</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/mvc<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans   http://www.springframework.org/schema/beans/spring-beans.xsd   http://www.springframework.org/schema/context   http://www.springframework.org/schema/context/spring-context.xsd   http://www.springframework.org/schema/mvc   https://www.springframework.org/schema/mvc/spring-mvc.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!-- é…ç½®SpringMVC --></span>   <span class="token comment" spellcheck="true">&lt;!-- 1.å¼€å¯SpringMVCæ³¨è§£é©±åŠ¨ --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>annotation-driven</span> <span class="token punctuation">/></span></span>   <span class="token comment" spellcheck="true">&lt;!-- 2.é™æ€èµ„æºé»˜è®¤servleté…ç½®--></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mvc:</span>default-servlet-handler</span><span class="token punctuation">/></span></span>   <span class="token comment" spellcheck="true">&lt;!-- 3.é…ç½®jsp æ˜¾ç¤ºViewResolverè§†å›¾è§£æå™¨ --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.springframework.web.servlet.view.InternalResourceViewResolver<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewClass<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>org.springframework.web.servlet.view.JstlView<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>prefix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/WEB-INF/jsp/<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>suffix<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.jsp<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>   <span class="token comment" spellcheck="true">&lt;!-- 4.æ‰«æwebç›¸å…³çš„bean --></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>component-scan</span> <span class="token attr-name">base-package</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>com.kuang.controller<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> é…ç½®æ–‡ä»¶ï¼Œæš‚æ—¶ç»“æŸï¼</p><h5 id="Springé…ç½®æ•´åˆæ–‡ä»¶ï¼ŒapplicationContext-xml"><a href="#Springé…ç½®æ•´åˆæ–‡ä»¶ï¼ŒapplicationContext-xml" class="headerlink" title="Springé…ç½®æ•´åˆæ–‡ä»¶ï¼ŒapplicationContext.xml"></a>Springé…ç½®æ•´åˆæ–‡ä»¶ï¼ŒapplicationContext.xml</h5><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans       http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring-dao.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring-service.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spring-mvc.xml<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-2-Controller-å’Œ-è§†å›¾å±‚ç¼–å†™"><a href="#4-2-Controller-å’Œ-è§†å›¾å±‚ç¼–å†™" class="headerlink" title="4.2 Controller å’Œ è§†å›¾å±‚ç¼–å†™"></a>4.2 Controller å’Œ è§†å›¾å±‚ç¼–å†™</h4><h5 id="BookController-ç±»ç¼–å†™-ï¼Œ-æ–¹æ³•ä¸€ï¼šæŸ¥è¯¢å…¨éƒ¨ä¹¦ç±"><a href="#BookController-ç±»ç¼–å†™-ï¼Œ-æ–¹æ³•ä¸€ï¼šæŸ¥è¯¢å…¨éƒ¨ä¹¦ç±" class="headerlink" title="BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•ä¸€ï¼šæŸ¥è¯¢å…¨éƒ¨ä¹¦ç±"></a>BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•ä¸€ï¼šæŸ¥è¯¢å…¨éƒ¨ä¹¦ç±</h5><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@Controller</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/book"</span><span class="token punctuation">)</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookController</span> <span class="token punctuation">{</span>   <span class="token annotation punctuation">@Autowired</span>   <span class="token annotation punctuation">@Qualifier</span><span class="token punctuation">(</span><span class="token string">"BookServiceImpl"</span><span class="token punctuation">)</span>   <span class="token keyword">private</span> BookService bookService<span class="token punctuation">;</span>   <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/allBook"</span><span class="token punctuation">)</span>   <span class="token keyword">public</span> String <span class="token function">list</span><span class="token punctuation">(</span>Model model<span class="token punctuation">)</span> <span class="token punctuation">{</span>       List<span class="token operator">&lt;</span>Books<span class="token operator">></span> list <span class="token operator">=</span> bookService<span class="token punctuation">.</span><span class="token function">queryAllBook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"list"</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">return</span> <span class="token string">"allBook"</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ç¼–å†™é¦–é¡µ-index-jsp"><a href="#ç¼–å†™é¦–é¡µ-index-jsp" class="headerlink" title="ç¼–å†™é¦–é¡µ index.jsp"></a>ç¼–å†™é¦–é¡µ index.jsp</h5><pre class="line-numbers language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">%</span>@ page language<span class="token operator">=</span><span class="token string">"java"</span> contentType<span class="token operator">=</span><span class="token string">"text/html; charset=UTF-8"</span> pageEncoding<span class="token operator">=</span><span class="token string">"UTF-8"</span> <span class="token operator">%</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE HTML<span class="token operator">></span><span class="token operator">&lt;</span>html<span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span>   <span class="token operator">&lt;</span>title<span class="token operator">></span>é¦–é¡µ<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>   <span class="token operator">&lt;</span>style type<span class="token operator">=</span><span class="token string">"text/css"</span><span class="token operator">></span>       a <span class="token punctuation">{</span>           text<span class="token operator">-</span>decoration<span class="token operator">:</span> none<span class="token punctuation">;</span>           color<span class="token operator">:</span> black<span class="token punctuation">;</span>           font<span class="token operator">-</span>size<span class="token operator">:</span> 18px<span class="token punctuation">;</span>      <span class="token punctuation">}</span>       h3 <span class="token punctuation">{</span>           width<span class="token operator">:</span> 180px<span class="token punctuation">;</span>           height<span class="token operator">:</span> 38px<span class="token punctuation">;</span>           margin<span class="token operator">:</span> 100px auto<span class="token punctuation">;</span>           text<span class="token operator">-</span>align<span class="token operator">:</span> center<span class="token punctuation">;</span>           line<span class="token operator">-</span>height<span class="token operator">:</span> 38px<span class="token punctuation">;</span>           background<span class="token operator">:</span> deepskyblue<span class="token punctuation">;</span>           border<span class="token operator">-</span>radius<span class="token operator">:</span> 4px<span class="token punctuation">;</span>      <span class="token punctuation">}</span>   <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token operator">&lt;</span>h3<span class="token operator">></span>   <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"${pageContext.request.contextPath}/book/allBook"</span><span class="token operator">></span>ç‚¹å‡»è¿›å…¥åˆ—è¡¨é¡µ<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ä¹¦ç±åˆ—è¡¨é¡µé¢-allbook-jsp"><a href="#ä¹¦ç±åˆ—è¡¨é¡µé¢-allbook-jsp" class="headerlink" title="ä¹¦ç±åˆ—è¡¨é¡µé¢ allbook.jsp"></a>ä¹¦ç±åˆ—è¡¨é¡µé¢ allbook.jsp</h5><pre class="line-numbers language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">%</span>@ taglib prefix<span class="token operator">=</span><span class="token string">"c"</span> uri<span class="token operator">=</span><span class="token string">"http://java.sun.com/jsp/jstl/core"</span> <span class="token operator">%</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">%</span>@ page contentType<span class="token operator">=</span><span class="token string">"text/html;charset=UTF-8"</span> language<span class="token operator">=</span><span class="token string">"java"</span> <span class="token operator">%</span><span class="token operator">></span><span class="token operator">&lt;</span>html<span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span>    <span class="token operator">&lt;</span>title<span class="token operator">></span>ä¹¦ç±å±•ç¤º<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> å¼•å…¥ Bootstrap <span class="token operator">--</span><span class="token operator">></span>    <span class="token operator">&lt;</span>link href<span class="token operator">=</span><span class="token string">"https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"</span> rel<span class="token operator">=</span><span class="token string">"stylesheet"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"container"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"row clearfix"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"col-md-12 column"</span><span class="token operator">></span>            <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"page-header"</span><span class="token operator">></span>                <span class="token operator">&lt;</span>h1<span class="token operator">></span>                    <span class="token operator">&lt;</span>small<span class="token operator">></span>ä¹¦ç±åˆ—è¡¨ <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span> æ˜¾ç¤ºæ‰€æœ‰ä¹¦ç±<span class="token operator">&lt;</span><span class="token operator">/</span>small<span class="token operator">></span>                <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"row"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"col-md-4 column"</span><span class="token operator">></span>            <span class="token operator">&lt;</span>a <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"btn btn-primary"</span> href<span class="token operator">=</span><span class="token string">"${pageContext.request.contextPath}/book/toAddBook"</span><span class="token operator">></span>æ–°å¢ä¹¦ç±<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"row clearfix"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"col-mid-12 column"</span><span class="token operator">></span>            <span class="token operator">&lt;</span>table <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"table table-hover table-striped"</span><span class="token operator">></span>                <span class="token operator">&lt;</span>thead<span class="token operator">></span>                    <span class="token operator">&lt;</span>tr<span class="token operator">></span>                        <span class="token operator">&lt;</span>th<span class="token operator">></span>ä¹¦ç±ç¼–å·<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">></span>                        <span class="token operator">&lt;</span>th<span class="token operator">></span>ä¹¦ç±åç§°<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">></span>                        <span class="token operator">&lt;</span>th<span class="token operator">></span>ä¹¦ç±æ•°é‡<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">></span>                        <span class="token operator">&lt;</span>th<span class="token operator">></span>ä¹¦ç±è¯¦æƒ…<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">></span>                        <span class="token operator">&lt;</span>th<span class="token operator">></span>æ“ä½œ<span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">></span>                    <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span>                <span class="token operator">&lt;</span><span class="token operator">/</span>thead<span class="token operator">></span>                <span class="token operator">&lt;</span>tbody<span class="token operator">></span>                    <span class="token operator">&lt;</span>c<span class="token operator">:</span>forEach var<span class="token operator">=</span><span class="token string">"book"</span> items<span class="token operator">=</span><span class="token string">"${list}"</span><span class="token operator">></span>                        <span class="token operator">&lt;</span>tr<span class="token operator">></span>                            <span class="token operator">&lt;</span>td<span class="token operator">></span>$<span class="token punctuation">{</span>book<span class="token punctuation">.</span>bookID<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span>                            <span class="token operator">&lt;</span>td<span class="token operator">></span>$<span class="token punctuation">{</span>book<span class="token punctuation">.</span>bookName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span>                            <span class="token operator">&lt;</span>td<span class="token operator">></span>$<span class="token punctuation">{</span>book<span class="token punctuation">.</span>bookCounts<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span>                            <span class="token operator">&lt;</span>td<span class="token operator">></span>$<span class="token punctuation">{</span>book<span class="token punctuation">.</span>detail<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span>                            <span class="token operator">&lt;</span>th<span class="token operator">></span>                                <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"${pageContext.request.contextPath}/book/toUpdate?id=${book.bookID}"</span><span class="token operator">></span>ä¿®æ”¹<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>                                <span class="token operator">&amp;</span>nbsp <span class="token operator">|</span> <span class="token operator">&amp;</span>nbsp                                <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#"</span><span class="token operator">></span>åˆ é™¤<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>                            <span class="token operator">&lt;</span><span class="token operator">/</span>th<span class="token operator">></span>                        <span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span>                    <span class="token operator">&lt;</span><span class="token operator">/</span>c<span class="token operator">:</span>forEach<span class="token operator">></span>                <span class="token operator">&lt;</span><span class="token operator">/</span>tbody<span class="token operator">></span>            <span class="token operator">&lt;</span><span class="token operator">/</span>table<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="BookController-ç±»ç¼–å†™-ï¼Œ-æ–¹æ³•äºŒï¼šæ·»åŠ ä¹¦ç±"><a href="#BookController-ç±»ç¼–å†™-ï¼Œ-æ–¹æ³•äºŒï¼šæ·»åŠ ä¹¦ç±" class="headerlink" title="BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•äºŒï¼šæ·»åŠ ä¹¦ç±"></a>BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•äºŒï¼šæ·»åŠ ä¹¦ç±</h5><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/toAddBook"</span><span class="token punctuation">)</span><span class="token keyword">public</span> String <span class="token function">toAddPaper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token keyword">return</span> <span class="token string">"addBook"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/addBook"</span><span class="token punctuation">)</span><span class="token keyword">public</span> String <span class="token function">addPaper</span><span class="token punctuation">(</span>Books books<span class="token punctuation">)</span> <span class="token punctuation">{</span>   System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span><span class="token punctuation">;</span>   bookService<span class="token punctuation">.</span><span class="token function">addBook</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token string">"redirect:/book/allBook"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="æ·»åŠ ä¹¦ç±é¡µé¢ï¼šaddBook-jsp"><a href="#æ·»åŠ ä¹¦ç±é¡µé¢ï¼šaddBook-jsp" class="headerlink" title="æ·»åŠ ä¹¦ç±é¡µé¢ï¼šaddBook.jsp"></a>æ·»åŠ ä¹¦ç±é¡µé¢ï¼šaddBook.jsp</h5><pre class="line-numbers language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">%</span>@ taglib prefix<span class="token operator">=</span><span class="token string">"c"</span> uri<span class="token operator">=</span><span class="token string">"http://java.sun.com/jsp/jstl/core"</span> <span class="token operator">%</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">%</span>@ page contentType<span class="token operator">=</span><span class="token string">"text/html;charset=UTF-8"</span> language<span class="token operator">=</span><span class="token string">"java"</span> <span class="token operator">%</span><span class="token operator">></span><span class="token operator">&lt;</span>html<span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span>   <span class="token operator">&lt;</span>title<span class="token operator">></span>æ–°å¢ä¹¦ç±<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>   <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> å¼•å…¥ Bootstrap <span class="token operator">--</span><span class="token operator">></span>   <span class="token operator">&lt;</span>link href<span class="token operator">=</span><span class="token string">"https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"</span> rel<span class="token operator">=</span><span class="token string">"stylesheet"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"container"</span><span class="token operator">></span>   <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"row clearfix"</span><span class="token operator">></span>       <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"col-md-12 column"</span><span class="token operator">></span>           <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"page-header"</span><span class="token operator">></span>               <span class="token operator">&lt;</span>h1<span class="token operator">></span>                   <span class="token operator">&lt;</span>small<span class="token operator">></span>æ–°å¢ä¹¦ç±<span class="token operator">&lt;</span><span class="token operator">/</span>small<span class="token operator">></span>               <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>           <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>   <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>   <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">"${pageContext.request.contextPath}/book/addBook"</span> method<span class="token operator">=</span><span class="token string">"post"</span><span class="token operator">></span>       <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">></span>           <span class="token operator">&lt;</span>label<span class="token operator">></span>ä¹¦ç±åç§°ï¼š<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>           <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"bookName"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-control"</span> required<span class="token operator">></span>       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">></span>           <span class="token operator">&lt;</span>label<span class="token operator">></span>ä¹¦ç±æ•°é‡ï¼š<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>           <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"bookCounts"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-control"</span> required<span class="token operator">></span>       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">></span>           <span class="token operator">&lt;</span>label<span class="token operator">></span>ä¹¦ç±è¯¦æƒ…ï¼š<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>           <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"detail"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-control"</span> required<span class="token operator">></span>       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>       <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">></span>           <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"submit"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-control"</span> value<span class="token operator">=</span><span class="token string">"æ·»åŠ "</span><span class="token operator">></span>       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>   <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="BookController-ç±»ç¼–å†™-ï¼Œ-æ–¹æ³•ä¸‰ï¼šä¿®æ”¹ä¹¦ç±"><a href="#BookController-ç±»ç¼–å†™-ï¼Œ-æ–¹æ³•ä¸‰ï¼šä¿®æ”¹ä¹¦ç±" class="headerlink" title="BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•ä¸‰ï¼šä¿®æ”¹ä¹¦ç±"></a>BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•ä¸‰ï¼šä¿®æ”¹ä¹¦ç±</h5><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/toUpdate"</span><span class="token punctuation">)</span><span class="token keyword">public</span> String <span class="token function">toUpdatePaper</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span>Model model<span class="token punctuation">)</span><span class="token punctuation">{</span>        Books books <span class="token operator">=</span> bookService<span class="token punctuation">.</span><span class="token function">queryBookById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"book"</span><span class="token punctuation">,</span>books<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">"updateBook"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/updateBook"</span><span class="token punctuation">)</span><span class="token keyword">public</span> String <span class="token function">updateBook</span><span class="token punctuation">(</span>Books books<span class="token punctuation">)</span><span class="token punctuation">{</span>        bookService<span class="token punctuation">.</span><span class="token function">updateBook</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">"redirect:/book/allBook"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ä¿®æ”¹ä¹¦ç±é¡µé¢-updateBook-jsp"><a href="#ä¿®æ”¹ä¹¦ç±é¡µé¢-updateBook-jsp" class="headerlink" title="ä¿®æ”¹ä¹¦ç±é¡µé¢  updateBook.jsp"></a>ä¿®æ”¹ä¹¦ç±é¡µé¢  updateBook.jsp</h5><pre class="line-numbers language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">%</span>@ taglib prefix<span class="token operator">=</span><span class="token string">"c"</span> uri<span class="token operator">=</span><span class="token string">"http://java.sun.com/jsp/jstl/core"</span> <span class="token operator">%</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">%</span>@ page contentType<span class="token operator">=</span><span class="token string">"text/html;charset=UTF-8"</span> language<span class="token operator">=</span><span class="token string">"java"</span> <span class="token operator">%</span><span class="token operator">></span><span class="token operator">&lt;</span>html<span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span>   <span class="token operator">&lt;</span>title<span class="token operator">></span>ä¿®æ”¹ä¹¦ç±<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>    <span class="token operator">&lt;</span>link href<span class="token operator">=</span><span class="token string">"https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css"</span> rel<span class="token operator">=</span><span class="token string">"stylesheet"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"container"</span><span class="token operator">></span>   <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"row clearfix"</span><span class="token operator">></span>       <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"col-md-12 column"</span><span class="token operator">></span>           <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"page-header"</span><span class="token operator">></span>               <span class="token operator">&lt;</span>h1<span class="token operator">></span>                   <span class="token operator">&lt;</span>small<span class="token operator">></span>ä¿®æ”¹ä¹¦ç±<span class="token operator">&lt;</span><span class="token operator">/</span>small<span class="token operator">></span>               <span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>           <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>   <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>   <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">"${pageContext.request.contextPath}/book/updateBook"</span> method<span class="token operator">=</span><span class="token string">"post"</span><span class="token operator">></span>       <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"hidden"</span> name<span class="token operator">=</span><span class="token string">"bookID"</span> value<span class="token operator">=</span><span class="token string">"${book.bookID}"</span><span class="token operator">></span>       <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">></span>           <span class="token operator">&lt;</span>label<span class="token operator">></span>ä¹¦ç±åç§°ï¼š<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>           <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"bookName"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-control"</span> value<span class="token operator">=</span><span class="token string">"${book.bookName}"</span> required<span class="token operator">></span>       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">></span>           <span class="token operator">&lt;</span>label<span class="token operator">></span>ä¹¦ç±æ•°é‡ï¼š<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>           <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"bookCounts"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-control"</span> value<span class="token operator">=</span><span class="token string">"${book.bookCounts}"</span>  required<span class="token operator">></span>       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">></span>           <span class="token operator">&lt;</span>label<span class="token operator">></span>ä¹¦ç±è¯¦æƒ…ï¼š<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>           <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"detail"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-control"</span> value<span class="token operator">=</span><span class="token string">"${book.detail}"</span> required<span class="token operator">></span>       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>       <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-group"</span><span class="token operator">></span>           <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"submit"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"form-control"</span> value<span class="token operator">=</span><span class="token string">"ä¿®æ”¹"</span><span class="token operator">></span>       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>   <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="BookController-ç±»ç¼–å†™-ï¼Œ-æ–¹æ³•å››ï¼šåˆ é™¤ä¹¦ç±"><a href="#BookController-ç±»ç¼–å†™-ï¼Œ-æ–¹æ³•å››ï¼šåˆ é™¤ä¹¦ç±" class="headerlink" title="BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•å››ï¼šåˆ é™¤ä¹¦ç±"></a>BookController ç±»ç¼–å†™ ï¼Œ æ–¹æ³•å››ï¼šåˆ é™¤ä¹¦ç±</h5><pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/del/{bookId}"</span><span class="token punctuation">)</span><span class="token keyword">public</span> String <span class="token function">deleteBook</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"bookId"</span><span class="token punctuation">)</span> <span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>   bookService<span class="token punctuation">.</span><span class="token function">deleteBookById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">return</span> <span class="token string">"redirect:/book/allBook"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-é¡¹ç›®ç»“æ„"><a href="#5-é¡¹ç›®ç»“æ„" class="headerlink" title="5 é¡¹ç›®ç»“æ„"></a>5 é¡¹ç›®ç»“æ„</h3><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/image-20201021150917335.png" alt="image-20201021150917335"></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaWeb </tag>
            
            <tag> Mybaties </tag>
            
            <tag> SpringMVC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLåŸºç¡€å…¥é—¨</title>
      <link href="/2020/10/08/mysql-ji-chu-ru-men/"/>
      <url>/2020/10/08/mysql-ji-chu-ru-men/</url>
      
        <content type="html"><![CDATA[<hr><p>ä¸‹é¢æ˜¯æ ¹æ®å¼€æºé¡¹ç›® <a href="https://github.com/jaywcjlove/mysql-tutorial/blob/master/21-minutes-MySQL-basic-entry.md" target="_blank" rel="noopener">21åˆ†é’ŸMySQLåŸºç¡€å…¥é—¨</a> åšçš„å­¦ä¹ ç¬”è®°</p><p><a href="https://www.w3school.com.cn/sql/sql_orderby.asp" target="_blank" rel="noopener">W3SCHOOL</a>ä¸Šçš„æ•™ç¨‹é“¾æ¥</p><hr><h2 id="å¼€å§‹ä½¿ç”¨"><a href="#å¼€å§‹ä½¿ç”¨" class="headerlink" title="å¼€å§‹ä½¿ç”¨"></a>å¼€å§‹ä½¿ç”¨</h2><p>MySQLç‰ˆæœ¬: Server version: 8.0.20 MySQL Community Server - GPL</p><p>MySQLä¸ºå…³ç³»å‹æ•°æ®åº“ï¼Œä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“æ˜¯ç”±ä¸€ä¸ªæˆ–æ•°ä¸ªè¡¨æ ¼ç»„æˆï¼Œå¦‚ä¸‹å›¾ï¼š<br><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/20201008103454.png" alt="">))</p><ul><li>è¡¨å¤´ï¼š æ¯ä¸€åˆ—çš„åç§°ï¼›</li><li>åˆ—ï¼ˆcolï¼‰: å…·æœ‰ç›¸åŒæ•°æ®ç±»å‹çš„æ•°æ®çš„é›†åˆ</li><li>è¡Œ(row) :  æ¯ä¸€è¡Œç”¨æ¥æè¿°æŸä¸ªäºº/ç‰©çš„å…·ä½“ä¿¡æ¯;</li><li>å€¼(value) : è¡Œçš„å…·ä½“ä¿¡æ¯, æ¯ä¸ªå€¼å¿…é¡»ä¸è¯¥åˆ—çš„æ•°æ®ç±»å‹ç›¸åŒ;</li><li>é”®(key) : è¡¨ä¸­ç”¨æ¥è¯†åˆ«æŸä¸ªç‰¹å®šçš„äºº\ç‰©çš„æ–¹æ³•, é”®çš„å€¼åœ¨å½“å‰åˆ—ä¸­å…·æœ‰å”¯ä¸€æ€§ã€‚</li></ul><h2 id="ç™»å½•MySQL"><a href="#ç™»å½•MySQL" class="headerlink" title="ç™»å½•MySQL"></a>ç™»å½•MySQL</h2><p>åœ¨cmdä¸­è¾“å…¥ï¼šmysql -h ä¸»æœºå -u ç”¨æˆ·å -p<br><u>å‚æ•°è¯´æ˜ï¼š</u></p><ul><li>-h : æŒ‡å®šå®¢æˆ·ç«¯æ‰€è¦ç™»å½•çš„ MySQL ä¸»æœºå, ç™»å½•æœ¬æœº(localhost æˆ– 127.0.0.1)è¯¥å‚æ•°å¯ä»¥çœç•¥ï¼›</li><li>-u : ç™»å½•çš„ç”¨æˆ·åï¼›</li><li>-p : å‘Šè¯‰æœåŠ¡å™¨å°†ä¼šä½¿ç”¨ä¸€ä¸ªå¯†ç æ¥ç™»å½•, å¦‚æœæ‰€è¦ç™»å½•çš„ç”¨æˆ·åå¯†ç ä¸ºç©º, å¯ä»¥å¿½ç•¥æ­¤é€‰é¡¹ã€‚ã€€ã€€</li><li><strong>å¦‚æœç™»å½•æœ¬æœºçš„MySQLæ•°æ®åº“ï¼Œåªéœ€è¦è¾“å…¥ï¼šmysql -u root -p</strong><pre class="line-numbers language-sql"><code class="language-sql">mysql <span class="token operator">-</span>h <span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span> <span class="token operator">-</span>u ç”¨æˆ·å <span class="token operator">-</span>pmysql <span class="token operator">-</span>D æ‰€é€‰æ‹©çš„æ•°æ®åº“å <span class="token operator">-</span>h ä¸»æœºå <span class="token operator">-</span>u ç”¨æˆ·å <span class="token operator">-</span>pmysql<span class="token operator">></span> <span class="token keyword">exit</span> <span class="token comment" spellcheck="true"># é€€å‡º ä½¿ç”¨ â€œquit;â€ æˆ– â€œ\q;â€ ä¸€æ ·çš„æ•ˆæœ</span>mysql<span class="token operator">></span> <span class="token keyword">status</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true"># æ˜¾ç¤ºå½“å‰mysqlçš„versionçš„å„ç§ä¿¡æ¯</span>mysql<span class="token operator">></span> <span class="token keyword">select</span> version<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"># æ˜¾ç¤ºå½“å‰mysqlçš„versionä¿¡æ¯</span>mysql<span class="token operator">></span> <span class="token keyword">show</span> <span class="token keyword">global</span> variables <span class="token operator">like</span> <span class="token string">'port'</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true"># æŸ¥çœ‹MySQLç«¯å£å·</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h2 id="åˆ›å»ºæ•°æ®åº“"><a href="#åˆ›å»ºæ•°æ®åº“" class="headerlink" title="åˆ›å»ºæ•°æ®åº“"></a>åˆ›å»ºæ•°æ®åº“</h2><p>å¯¹äºè¡¨çš„æ“ä½œéœ€è¦å…ˆè¿›å…¥æ•°æ®åº“  <u><strong>use åº“å ï¼›</strong></u></p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">--åˆ›å»ºä¸€ä¸ª åä¸ºsamp_db çš„æ•°æ®åº“ï¼Œæ•°æ®åº“å­—ç¬¦ç¼–ç æŒ‡å®šä¸º gbk</span><span class="token keyword">create</span> <span class="token keyword">database</span> samp_db <span class="token keyword">character set</span> gbk<span class="token punctuation">;</span><span class="token keyword">drop</span> <span class="token keyword">database</span> samp_db<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- åˆ é™¤åº“åä¸ºsamp_dbçš„åº“</span><span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">-- æ˜¾ç¤ºæ•°æ®åº“åˆ—è¡¨</span><span class="token keyword">use</span> samp_db<span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">-- é€‰æ‹©åˆ›å»ºçš„æ•°æ®åº“samp_db</span><span class="token keyword">show</span> <span class="token keyword">tables</span><span class="token punctuation">;</span>                  <span class="token comment" spellcheck="true">-- æ˜¾ç¤ºsamp_dbä¸‹é¢æ‰€æœ‰çš„è¡¨åå­—</span><span class="token keyword">describe</span> è¡¨åï¼›               <span class="token comment" spellcheck="true">-- æ˜¾ç¤ºæ•°æ®è¡¨çš„ç»“æ„</span><span class="token keyword">delete</span> <span class="token keyword">from</span> è¡¨åï¼›           <span class="token comment" spellcheck="true">-- æ¸…ç©ºè¡¨ä¸­è®°å½•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åˆ›å»ºæ•°æ®åº“è¡¨"><a href="#åˆ›å»ºæ•°æ®åº“è¡¨" class="headerlink" title="åˆ›å»ºæ•°æ®åº“è¡¨"></a>åˆ›å»ºæ•°æ®åº“è¡¨</h2><blockquote><p>ä½¿ç”¨create table è¯­å¥å¯å®Œæˆå¯¹è¡¨çš„åˆ›å»º</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">--å¦‚æœæ•°æ®åº“ä¸­å­˜åœ¨ user_accountsè¡¨ï¼Œå°±æŠŠå®ƒä»æ•°æ®åº“ä¸­dropæ‰</span><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> EXITS <span class="token string">'user_accounts'</span><span class="token punctuation">;</span><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token string">'user_accounts'</span><span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span>             <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> unsigned <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">primary</span> <span class="token keyword">key</span><span class="token punctuation">,</span>  <span class="token punctuation">`</span>password<span class="token punctuation">`</span>       <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>       <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'ç”¨æˆ·å¯†ç '</span><span class="token punctuation">,</span>  <span class="token punctuation">`</span>reset_password<span class="token punctuation">`</span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>       <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span> <span class="token keyword">COMMENT</span> <span class="token string">'ç”¨æˆ·ç±»å‹ï¼š0ï¼ä¸éœ€è¦é‡ç½®å¯†ç ï¼›1-éœ€è¦é‡ç½®å¯†ç '</span><span class="token punctuation">,</span>  <span class="token punctuation">`</span>mobile<span class="token punctuation">`</span>         <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>       <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'æ‰‹æœº'</span><span class="token punctuation">,</span>  <span class="token punctuation">`</span>create_at<span class="token punctuation">`</span>      <span class="token keyword">timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>      <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token punctuation">`</span>update_at<span class="token punctuation">`</span>      <span class="token keyword">timestamp</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>      <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CURRENT_TIMESTAMP</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">-- åˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼Œä¸å…è®¸é‡å¤</span>  <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> idx_user_mobile<span class="token punctuation">(</span><span class="token punctuation">`</span>mobile<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token keyword">COMMENT</span><span class="token operator">=</span><span class="token string">'ç”¨æˆ·è¡¨ä¿¡æ¯'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•°æ®ç±»å‹çš„å±æ€§è§£é‡Š</p><ul><li>NULLï¼šæ•°æ®åˆ—å¯åŒ…å«NULLå€¼ï¼›</li><li>NOT NULLï¼šæ•°æ®åˆ—ä¸å…è®¸åŒ…å«NULLå€¼ï¼›</li><li>DEFAULTï¼šé»˜è®¤å€¼ï¼›</li><li>PRIMARY KEYï¼šä¸»é”®ï¼›</li><li>AUTO_INCREMENTï¼šè‡ªåŠ¨é€’å¢ï¼Œé€‚ç”¨äºæ•´æ•°ç±»å‹ï¼›</li><li>UNSIGNEDï¼šæ˜¯æŒ‡æ•°å€¼ç±»å‹åªèƒ½ä¸ºæ­£æ•°ï¼›</li><li>CHARACTER SET nameï¼šæŒ‡å®šä¸€ä¸ªå­—ç¬¦é›†ï¼›</li><li>COMMENTï¼šå¯¹è¡¨æˆ–è€…å­—æ®µè¯´æ˜ï¼›</li></ul><h2 id="å¢åˆ æ”¹æŸ¥"><a href="#å¢åˆ æ”¹æŸ¥" class="headerlink" title="å¢åˆ æ”¹æŸ¥"></a>å¢åˆ æ”¹æŸ¥</h2><h3 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h3><blockquote><p>SELECT è¯­å¥ç”¨äºä»è¡¨ä¸­é€‰å–æ•°æ®ã€‚<br>è¯­æ³•ï¼šSELECT åˆ—åç§° FROM è¡¨åç§°<br>è¯­æ³•ï¼šSELECT * FROM è¡¨åç§°</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- è¡¨stationå–ä¸ªåˆ«åå«sï¼Œè¡¨stationä¸­ä¸åŒ…å« å­—æ®µid=13æˆ–è€…14 çš„ï¼Œå¹¶ä¸”idä¸ç­‰äº4çš„ æŸ¥è¯¢å‡ºæ¥ï¼Œåªæ˜¾ç¤ºid</span><span class="token keyword">SELECT</span> s<span class="token punctuation">.</span>id <span class="token keyword">from</span> station s <span class="token keyword">WHERE</span> id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">and</span> id <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- ä»è¡¨ Persons é€‰å– LastName åˆ—çš„æ•°æ®</span><span class="token keyword">SELECT</span> LastName <span class="token keyword">FROM</span> Persons<span class="token comment" spellcheck="true">-- ä»è¡¨ users é€‰å– id=3 çš„æ•°æ®ï¼Œå¹¶åªæ‹‰ä¸€æ¡æ•°æ®(æ®è¯´èƒ½ä¼˜åŒ–æ€§èƒ½)</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> users <span class="token keyword">where</span> id<span class="token operator">=</span><span class="token number">3</span> <span class="token keyword">limit</span> <span class="token number">1</span><span class="token comment" spellcheck="true">-- ç»“æœä¼šè‡ªåŠ¨å»é™¤companyåˆ—çš„é‡å¤æ•°æ®</span><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> Company <span class="token keyword">FROM</span> Orders <span class="token comment" spellcheck="true">-- è¡¨ Persons å­—æ®µ Id_P ç­‰äº Orders å­—æ®µ Id_P çš„å€¼ï¼Œ</span><span class="token comment" spellcheck="true">-- ç»“æœé›†æ˜¾ç¤º Personsè¡¨çš„ LastNameã€FirstNameå­—æ®µï¼ŒOrdersè¡¨çš„OrderNoå­—æ®µ</span><span class="token keyword">SELECT</span> p<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> p<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> o<span class="token punctuation">.</span>OrderNo <span class="token keyword">FROM</span> Persons p<span class="token punctuation">,</span> Orders o <span class="token keyword">WHERE</span> p<span class="token punctuation">.</span>Id_P <span class="token operator">=</span> o<span class="token punctuation">.</span>Id_P <span class="token comment" spellcheck="true">-- gbk å’Œ utf8 ä¸­è‹±æ–‡æ··åˆæ’åºæœ€ç®€å•çš„åŠæ³• </span><span class="token comment" spellcheck="true">-- ciæ˜¯ case insensitive, å³ â€œå¤§å°å†™ä¸æ•æ„Ÿâ€</span><span class="token keyword">SELECT</span> tag<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span> <span class="token keyword">from</span> news <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> tag <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">convert</span><span class="token punctuation">(</span>tag <span class="token keyword">using</span> gbk<span class="token punctuation">)</span> <span class="token keyword">collate</span> gbk_chinese_ci<span class="token punctuation">;</span><span class="token keyword">SELECT</span> tag<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span> <span class="token keyword">from</span> news <span class="token keyword">GROUP</span> <span class="token keyword">BY</span> tag <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">convert</span><span class="token punctuation">(</span>tag <span class="token keyword">using</span> utf8<span class="token punctuation">)</span> <span class="token keyword">collate</span> utf8_unicode_ci<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h3><blockquote><p>Update è¯­å¥ç”¨äºä¿®æ”¹è¡¨ä¸­çš„æ•°æ®ã€‚<br>è¯­æ³•ï¼šUPDATE è¡¨åç§° SET åˆ—åç§° = æ–°å€¼ WHERE åˆ—åç§° = æŸå€¼</p></blockquote><pre class="line-numbers language-SQL"><code class="language-SQL">-- updateè¯­å¥è®¾ç½®å­—æ®µå€¼ä¸ºå¦ä¸€ä¸ªç»“æœå–å‡ºæ¥çš„å­—æ®µupdate user set name = (select name from user1 where user1 .id = 1 )where id = (select id from user2 where user2 .name='å°è‹');-- æ›´æ–°è¡¨ orders ä¸­ id=1 çš„é‚£ä¸€è¡Œæ•°æ®æ›´æ–°å®ƒçš„ title å­—æ®µ UPDATE `orders` set title='è¿™é‡Œæ˜¯æ ‡é¢˜' WHERE id=1;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h3><blockquote><p>INSERT INTO è¯­å¥ç”¨äºå‘è¡¨æ ¼ä¸­æ’å…¥æ–°çš„è¡Œã€‚<br>è¯­æ³•ï¼šINSERT INTO è¡¨åç§° VALUES (å€¼1, å€¼2,â€¦.)<br>è¯­æ³•ï¼šINSERT INTO è¡¨åç§° (åˆ—1, åˆ—2,â€¦) VALUES (å€¼1, å€¼2,â€¦.)</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- å‘è¡¨ Persons æ’å…¥ä¸€æ¡å­—æ®µ LastName = JSLite å­—æ®µ Address = shanghai</span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> Persons <span class="token punctuation">(</span>LastName<span class="token punctuation">,</span> Address<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'JSLite'</span><span class="token punctuation">,</span> <span class="token string">'shanghai'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- å‘è¡¨ meeting æ’å…¥ å­—æ®µ a=1 å’Œå­—æ®µ b=2</span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> meeting <span class="token keyword">SET</span> <span class="token number">a</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">b</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- -- SQLå®ç°å°†ä¸€ä¸ªè¡¨çš„æ•°æ®æ’å…¥åˆ°å¦å¤–ä¸€ä¸ªè¡¨çš„ä»£ç </span><span class="token comment" spellcheck="true">-- å¦‚æœåªå¸Œæœ›å¯¼å…¥æŒ‡å®šå­—æ®µï¼Œå¯ä»¥ç”¨è¿™ç§æ–¹æ³•ï¼š</span><span class="token comment" spellcheck="true">-- INSERT INTO ç›®æ ‡è¡¨ (å­—æ®µ1, å­—æ®µ2, ...) SELECT å­—æ®µ1, å­—æ®µ2, ... FROM æ¥æºè¡¨;</span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orders <span class="token punctuation">(</span>user_account_id<span class="token punctuation">,</span> title<span class="token punctuation">)</span> <span class="token keyword">SELECT</span> m<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span> m<span class="token punctuation">.</span>title <span class="token keyword">FROM</span> meeting m <span class="token keyword">where</span> m<span class="token punctuation">.</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- å‘è¡¨ charger æ’å…¥ä¸€æ¡æ•°æ®ï¼Œå·²å­˜åœ¨å°±å¯¹è¡¨ charger æ›´æ–° `type`,`update_at` å­—æ®µï¼›</span><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>charger<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span><span class="token keyword">type</span><span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>create_at<span class="token punctuation">`</span><span class="token punctuation">,</span><span class="token punctuation">`</span>update_at<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'2017-05-18 11:06:17'</span><span class="token punctuation">,</span><span class="token string">'2017-05-18 11:06:17'</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DUPLICATE KEY</span> <span class="token keyword">UPDATE</span> <span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token operator">=</span><span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">`</span><span class="token keyword">type</span><span class="token punctuation">`</span><span class="token operator">=</span><span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token punctuation">`</span><span class="token keyword">type</span><span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>update_at<span class="token punctuation">`</span><span class="token operator">=</span><span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token punctuation">`</span>update_at<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><blockquote><p>DELETE è¯­å¥ç”¨äºåˆ é™¤è¡¨ä¸­çš„è¡Œã€‚<br>è¯­æ³•ï¼šDELETE FROM è¡¨åç§° WHERE åˆ—åç§° = å€¼</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- åœ¨ä¸åˆ é™¤table_nameè¡¨çš„æƒ…å†µä¸‹åˆ é™¤æ‰€æœ‰çš„è¡Œï¼Œæ¸…ç©ºè¡¨ã€‚</span><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> table_name<span class="token comment" spellcheck="true">-- æˆ–è€…</span><span class="token keyword">DELETE</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> table_name<span class="token comment" spellcheck="true">-- åˆ é™¤ Personè¡¨å­—æ®µ LastName = 'JSLite' </span><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> Person <span class="token keyword">WHERE</span> LastName <span class="token operator">=</span> <span class="token string">'JSLite'</span> <span class="token comment" spellcheck="true">-- åˆ é™¤ è¡¨meeting id ä¸º2å’Œ3çš„ä¸¤æ¡æ•°æ®</span><span class="token keyword">DELETE</span> <span class="token keyword">from</span> meeting <span class="token keyword">where</span> id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="WHERE"><a href="#WHERE" class="headerlink" title="WHERE"></a>WHERE</h2><blockquote><p>WHERE å­å¥ç”¨äºè§„å®šé€‰æ‹©çš„æ ‡å‡†ã€‚<br>è¯­æ³•ï¼š<code>SELECT åˆ—åç§° FROM è¡¨åç§° WHERE åˆ— è¿ç®—ç¬¦ å€¼</code>  </p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- ä»è¡¨ Persons ä¸­é€‰å‡º Year å­—æ®µå¤§äº 1965 çš„æ•°æ®</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> Year<span class="token operator">></span><span class="token number">1965</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="AND-å’Œ-OR"><a href="#AND-å’Œ-OR" class="headerlink" title="AND å’Œ OR"></a>AND å’Œ OR</h2><blockquote><p>AND - å¦‚æœç¬¬ä¸€ä¸ªæ¡ä»¶å’Œç¬¬äºŒä¸ªæ¡ä»¶éƒ½æˆç«‹ï¼›<br>OR - å¦‚æœç¬¬ä¸€ä¸ªæ¡ä»¶å’Œç¬¬äºŒä¸ªæ¡ä»¶ä¸­åªè¦æœ‰ä¸€ä¸ªæˆç«‹ï¼›  </p></blockquote><h3 id="AND"><a href="#AND" class="headerlink" title="AND"></a>AND</h3><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- åˆ é™¤ meeting è¡¨å­—æ®µ </span><span class="token comment" spellcheck="true">-- id=2 å¹¶ä¸” user_id=5 çš„æ•°æ®  å’Œ</span><span class="token comment" spellcheck="true">-- id=3 å¹¶ä¸” user_id=6 çš„æ•°æ® </span><span class="token keyword">DELETE</span> <span class="token keyword">from</span> meeting <span class="token keyword">where</span> id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">and</span> user_id <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- ä½¿ç”¨ AND æ¥æ˜¾ç¤ºæ‰€æœ‰å§“ä¸º "Carter" å¹¶ä¸”åä¸º "Thomas" çš„äººï¼š</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> FirstName<span class="token operator">=</span><span class="token string">'Thomas'</span> <span class="token operator">AND</span> LastName<span class="token operator">=</span><span class="token string">'Carter'</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="OR"><a href="#OR" class="headerlink" title="OR"></a>OR</h3><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- ä½¿ç”¨ OR æ¥æ˜¾ç¤ºæ‰€æœ‰å§“ä¸º "Carter" æˆ–è€…åä¸º "Thomas" çš„äººï¼š</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> firstname<span class="token operator">=</span><span class="token string">'Thomas'</span> <span class="token operator">OR</span> lastname<span class="token operator">=</span><span class="token string">'Carter'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="ORDER-BY"><a href="#ORDER-BY" class="headerlink" title="ORDER BY"></a>ORDER BY</h2><blockquote><p>è¯­å¥é»˜è®¤æŒ‰ç…§å‡åºå¯¹è®°å½•è¿›è¡Œæ’åºã€‚<br><code>ORDER BY</code> - è¯­å¥ç”¨äºæ ¹æ®æŒ‡å®šçš„åˆ—å¯¹ç»“æœé›†è¿›è¡Œæ’åºã€‚<br><code>DESC</code> - æŒ‰ç…§é™åºå¯¹è®°å½•è¿›è¡Œæ’åºã€‚<br><code>ASC</code> - æŒ‰ç…§é¡ºåºå¯¹è®°å½•è¿›è¡Œæ’åºã€‚  </p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- Companyåœ¨è¡¨Ordersä¸­ä¸ºå­—æ¯ï¼Œåˆ™ä¼šä»¥å­—æ¯é¡ºåºæ˜¾ç¤ºå…¬å¸åç§°</span><span class="token keyword">SELECT</span> Company<span class="token punctuation">,</span> OrderNumber <span class="token keyword">FROM</span> Orders <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Company<span class="token comment" spellcheck="true">-- åé¢è·Ÿä¸Š DESC åˆ™ä¸ºé™åºæ˜¾ç¤º</span><span class="token keyword">SELECT</span> Company<span class="token punctuation">,</span> OrderNumber <span class="token keyword">FROM</span> Orders <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Company <span class="token keyword">DESC</span><span class="token comment" spellcheck="true">-- Companyä»¥é™åºæ˜¾ç¤ºå…¬å¸åç§°ï¼Œå¹¶OrderNumberä»¥é¡ºåºæ˜¾ç¤º</span><span class="token keyword">SELECT</span> Company<span class="token punctuation">,</span> OrderNumber <span class="token keyword">FROM</span> Orders <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Company <span class="token keyword">DESC</span><span class="token punctuation">,</span> OrderNumber <span class="token keyword">ASC</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="IN"><a href="#IN" class="headerlink" title="IN"></a>IN</h2><blockquote><p>IN - æ“ä½œç¬¦å…è®¸æˆ‘ä»¬åœ¨ WHERE å­å¥ä¸­è§„å®šå¤šä¸ªå€¼ã€‚<br>IN - æ“ä½œç¬¦ç”¨æ¥æŒ‡å®šèŒƒå›´ï¼ŒèŒƒå›´ä¸­çš„æ¯ä¸€æ¡ï¼Œéƒ½è¿›è¡ŒåŒ¹é…ã€‚INå–å€¼è§„å¾‹ï¼Œç”±é€—å·åˆ†å‰²ï¼Œå…¨éƒ¨æ”¾ç½®æ‹¬å·ä¸­ã€‚<br>è¯­æ³•ï¼š<code>SELECT "å­—æ®µå"FROM "è¡¨æ ¼å"WHERE "å­—æ®µå" IN ('å€¼ä¸€', 'å€¼äºŒ', ...);</code></p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- ä»è¡¨ Persons é€‰å– å­—æ®µ LastName ç­‰äº Adamsã€Carter</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Persons <span class="token keyword">WHERE</span> LastName <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">'Adams'</span><span class="token punctuation">,</span><span class="token string">'Carter'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="NOT"><a href="#NOT" class="headerlink" title="NOT"></a>NOT</h2><blockquote><p>NOT - æ“ä½œç¬¦æ€»æ˜¯ä¸å…¶ä»–æ“ä½œç¬¦ä¸€èµ·ä½¿ç”¨ï¼Œç”¨åœ¨è¦è¿‡æ»¤çš„å‰é¢ã€‚</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> vend_id<span class="token punctuation">,</span> prod_name <span class="token keyword">FROM</span> Products <span class="token keyword">WHERE</span> <span class="token operator">NOT</span> vend_id <span class="token operator">=</span> <span class="token string">'DLL01'</span> <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> prod_name<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="UNION"><a href="#UNION" class="headerlink" title="UNION"></a>UNION</h2><blockquote><p>UNION - æ“ä½œç¬¦ç”¨äºåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ª SELECT è¯­å¥çš„ç»“æœé›†ã€‚</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- åˆ—å‡ºæ‰€æœ‰åœ¨ä¸­å›½è¡¨ï¼ˆEmployees_Chinaï¼‰å’Œç¾å›½ï¼ˆEmployees_USAï¼‰çš„ä¸åŒçš„é›‡å‘˜å</span><span class="token keyword">SELECT</span> E_Name <span class="token keyword">FROM</span> Employees_China <span class="token keyword">UNION</span> <span class="token keyword">SELECT</span> E_Name <span class="token keyword">FROM</span> Employees_USA<span class="token comment" spellcheck="true">-- åˆ—å‡º meeting è¡¨ä¸­çš„ pic_urlï¼Œ</span><span class="token comment" spellcheck="true">-- station è¡¨ä¸­çš„ number_station åˆ«åè®¾ç½®æˆ pic_url é¿å…å­—æ®µä¸ä¸€æ ·æŠ¥é”™</span><span class="token comment" spellcheck="true">-- æŒ‰æ›´æ–°æ—¶é—´æ’åº</span><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>pic_url <span class="token keyword">FROM</span> meeting <span class="token keyword">UNION</span> <span class="token keyword">ALL</span> <span class="token keyword">SELECT</span> id<span class="token punctuation">,</span>number_station <span class="token keyword">AS</span> pic_url <span class="token keyword">FROM</span> station  <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> update_at<span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- é€šè¿‡ UNION è¯­æ³•åŒæ—¶æŸ¥è¯¢äº† products è¡¨ å’Œ comments è¡¨çš„æ€»è®°å½•æ•°ï¼Œå¹¶ä¸”æŒ‰ç…§ count æ’åº</span><span class="token keyword">SELECT</span> <span class="token string">'product'</span> <span class="token keyword">AS</span> <span class="token keyword">type</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> count <span class="token keyword">FROM</span> <span class="token punctuation">`</span>products<span class="token punctuation">`</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token string">'comment'</span> <span class="token keyword">as</span> <span class="token keyword">type</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> count <span class="token keyword">FROM</span> <span class="token punctuation">`</span>comments<span class="token punctuation">`</span> <span class="token keyword">order</span> <span class="token keyword">by</span> count<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="AS"><a href="#AS" class="headerlink" title="AS"></a>AS</h2><blockquote><p>as - å¯ç†è§£ä¸ºï¼šç”¨ä½œã€å½“æˆï¼Œä½œä¸ºï¼›åˆ«å<br>ä¸€èˆ¬æ˜¯é‡å‘½ååˆ—åæˆ–è€…è¡¨åã€‚<br>è¯­æ³•ï¼š<code>select column_1 as åˆ—1,column_2 as åˆ—2 from table as è¡¨</code></p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> Employee <span class="token keyword">AS</span> emp<span class="token comment" spellcheck="true">-- è¿™å¥æ„æ€æ˜¯æŸ¥æ‰¾æ‰€æœ‰Employee è¡¨é‡Œé¢çš„æ•°æ®ï¼Œå¹¶æŠŠEmployeeè¡¨æ ¼å‘½åä¸º empã€‚</span><span class="token comment" spellcheck="true">-- å½“ä½ å‘½åä¸€ä¸ªè¡¨ä¹‹åï¼Œä½ å¯ä»¥åœ¨ä¸‹é¢ç”¨ emp ä»£æ›¿ Employee.</span><span class="token comment" spellcheck="true">-- ä¾‹å¦‚ SELECT * FROM emp.</span><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">AS</span> LargestOrderPrice <span class="token keyword">FROM</span> Orders<span class="token comment" spellcheck="true">-- åˆ—å‡ºè¡¨ Orders å­—æ®µ OrderPrice åˆ—æœ€å¤§å€¼ï¼Œ</span><span class="token comment" spellcheck="true">-- ç»“æœé›†åˆ—ä¸æ˜¾ç¤º OrderPrice æ˜¾ç¤º LargestOrderPrice</span><span class="token comment" spellcheck="true">-- æ˜¾ç¤ºè¡¨ users_profile ä¸­çš„ name åˆ—</span><span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>name <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">from</span> users_profile <span class="token number">a</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> t<span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- è¡¨ user_accounts å‘½ååˆ«å uaï¼Œè¡¨ users_profile å‘½ååˆ«å up</span><span class="token comment" spellcheck="true">-- æ»¡è¶³æ¡ä»¶ è¡¨ user_accounts å­—æ®µ id ç­‰äº è¡¨ users_profile å­—æ®µ user_id</span><span class="token comment" spellcheck="true">-- ç»“æœé›†åªæ˜¾ç¤ºmobileã€nameä¸¤åˆ—</span><span class="token keyword">SELECT</span> ua<span class="token punctuation">.</span>mobile<span class="token punctuation">,</span>up<span class="token punctuation">.</span>name <span class="token keyword">FROM</span> user_accounts <span class="token keyword">as</span> ua <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> users_profile <span class="token keyword">as</span> up <span class="token keyword">ON</span> ua<span class="token punctuation">.</span>id <span class="token operator">=</span> up<span class="token punctuation">.</span>user_id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="JOIN"><a href="#JOIN" class="headerlink" title="JOIN"></a>JOIN</h2><blockquote><p>ç”¨äºæ ¹æ®ä¸¤ä¸ªæˆ–å¤šä¸ªè¡¨ä¸­çš„åˆ—ä¹‹é—´çš„å…³ç³»ï¼Œä»è¿™äº›è¡¨ä¸­æŸ¥è¯¢æ•°æ®ã€‚  </p></blockquote><ul><li><code>JOIN</code>: å¦‚æœè¡¨ä¸­æœ‰è‡³å°‘ä¸€ä¸ªåŒ¹é…ï¼Œåˆ™è¿”å›è¡Œ</li><li><code>INNER JOIN</code>:åœ¨è¡¨ä¸­å­˜åœ¨è‡³å°‘ä¸€ä¸ªåŒ¹é…æ—¶ï¼ŒINNER JOIN å…³é”®å­—è¿”å›è¡Œã€‚</li><li><code>LEFT JOIN</code>: å³ä½¿å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œä¹Ÿä»å·¦è¡¨è¿”å›æ‰€æœ‰çš„è¡Œ</li><li><code>RIGHT JOIN</code>: å³ä½¿å·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œä¹Ÿä»å³è¡¨è¿”å›æ‰€æœ‰çš„è¡Œ</li><li><code>FULL JOIN</code>: åªè¦å…¶ä¸­ä¸€ä¸ªè¡¨ä¸­å­˜åœ¨åŒ¹é…ï¼Œå°±è¿”å›è¡Œ(MySQL æ˜¯ä¸æ”¯æŒçš„ï¼Œé€šè¿‡  <code>LEFT JOIN + UNION + RIGHT JOIN</code> çš„æ–¹å¼ æ¥å®ç°)</li></ul><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">SELECT</span> Persons<span class="token punctuation">.</span>LastName<span class="token punctuation">,</span> Persons<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> Orders<span class="token punctuation">.</span>OrderNo<span class="token keyword">FROM</span> Persons<span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> Orders<span class="token keyword">ON</span> Persons<span class="token punctuation">.</span>Id_P <span class="token operator">=</span> Orders<span class="token punctuation">.</span>Id_P<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> Persons<span class="token punctuation">.</span>LastName<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="SQL-å‡½æ•°"><a href="#SQL-å‡½æ•°" class="headerlink" title="SQL å‡½æ•°"></a>SQL å‡½æ•°</h2><h3 id="COUNT"><a href="#COUNT" class="headerlink" title="COUNT"></a>COUNT</h3><blockquote><p>COUNT è®©æˆ‘ä»¬èƒ½å¤Ÿæ•°å‡ºåœ¨è¡¨æ ¼ä¸­æœ‰å¤šå°‘ç¬”èµ„æ–™è¢«é€‰å‡ºæ¥ã€‚<br>è¯­æ³•ï¼š<code>SELECT COUNT("å­—æ®µå") FROM "è¡¨æ ¼å";</code></p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- è¡¨ Store_Information æœ‰å‡ ç¬” store_name æ ä¸æ˜¯ç©ºç™½çš„èµ„æ–™ã€‚</span><span class="token comment" spellcheck="true">-- "IS NOT NULL" æ˜¯ "è¿™ä¸ªæ ä½ä¸æ˜¯ç©ºç™½" çš„æ„æ€ã€‚</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span> <span class="token punctuation">(</span>Store_Name<span class="token punctuation">)</span> <span class="token keyword">FROM</span> Store_Information <span class="token keyword">WHERE</span> Store_Name <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- è·å– Persons è¡¨çš„æ€»æ•°</span><span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> totals <span class="token keyword">FROM</span> Persons<span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- è·å–è¡¨ station å­—æ®µ user_id ç›¸åŒçš„æ€»æ•°</span><span class="token keyword">select</span> user_id<span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">as</span> totals <span class="token keyword">from</span> station <span class="token keyword">group</span> <span class="token keyword">by</span> user_id<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="MAX"><a href="#MAX" class="headerlink" title="MAX"></a>MAX</h3><blockquote><p>MAX å‡½æ•°è¿”å›ä¸€åˆ—ä¸­çš„æœ€å¤§å€¼ã€‚NULL å€¼ä¸åŒ…æ‹¬åœ¨è®¡ç®—ä¸­ã€‚<br>è¯­æ³•ï¼š<code>SELECT MAX("å­—æ®µå") FROM "è¡¨æ ¼å"</code>  </p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- åˆ—å‡ºè¡¨ Orders å­—æ®µ OrderPrice åˆ—æœ€å¤§å€¼ï¼Œ</span><span class="token comment" spellcheck="true">-- ç»“æœé›†åˆ—ä¸æ˜¾ç¤º OrderPrice æ˜¾ç¤º LargestOrderPrice</span><span class="token keyword">SELECT</span> <span class="token function">MAX</span><span class="token punctuation">(</span>OrderPrice<span class="token punctuation">)</span> <span class="token keyword">AS</span> LargestOrderPrice <span class="token keyword">FROM</span> Orders<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="è§¦å‘å™¨"><a href="#è§¦å‘å™¨" class="headerlink" title="è§¦å‘å™¨"></a>è§¦å‘å™¨</h2><blockquote><p>è¯­æ³•ï¼š<br>create trigger &lt;è§¦å‘å™¨åç§°&gt;<br>{ before | after}             # ä¹‹å‰æˆ–è€…ä¹‹åå‡ºå‘<br>insert | update | delete      # æŒ‡æ˜äº†æ¿€æ´»è§¦å‘ç¨‹åºçš„è¯­å¥çš„ç±»å‹<br>on &lt;è¡¨å&gt;                     # æ“ä½œå“ªå¼ è¡¨<br>for each row                  # è§¦å‘å™¨çš„æ‰§è¡Œé—´éš”ï¼Œfor each row é€šçŸ¥è§¦å‘å™¨æ¯éš”ä¸€è¡Œæ‰§è¡Œä¸€æ¬¡åŠ¨ä½œï¼Œè€Œä¸æ˜¯å¯¹æ•´ä¸ªè¡¨æ‰§è¡Œä¸€æ¬¡ã€‚<br>&lt;è§¦å‘å™¨SQLè¯­å¥&gt;</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">delimiter</span> $<span class="token keyword">CREATE</span> <span class="token keyword">TRIGGER</span> set_userdate BEFORE <span class="token keyword">INSERT</span> <span class="token keyword">on</span> <span class="token punctuation">`</span>message<span class="token punctuation">`</span><span class="token keyword">for EACH ROW</span><span class="token keyword">BEGIN</span>  <span class="token keyword">set</span> <span class="token variable">@statu</span> <span class="token operator">=</span> new<span class="token punctuation">.</span><span class="token keyword">status</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- å£°æ˜å¤åˆ¶å˜é‡ statu</span>  <span class="token keyword">if</span> <span class="token variable">@statu</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">then</span>       <span class="token comment" spellcheck="true">-- åˆ¤æ–­ statu æ˜¯å¦ç­‰äº 0</span>    <span class="token keyword">UPDATE</span> <span class="token punctuation">`</span>user_accounts<span class="token punctuation">`</span> <span class="token keyword">SET</span> <span class="token keyword">status</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">WHERE</span> openid<span class="token operator">=</span>NEW<span class="token punctuation">.</span>openid<span class="token punctuation">;</span>  <span class="token keyword">end</span> <span class="token keyword">if</span><span class="token punctuation">;</span><span class="token keyword">END</span>$<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- æ¢å¤ç»“æŸç¬¦å·</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>OLDå’ŒNEWä¸åŒºåˆ†å¤§å°å†™</p><ul><li>NEW ç”¨NEW.col_nameï¼Œæ²¡æœ‰æ—§è¡Œã€‚åœ¨DELETEè§¦å‘ç¨‹åºä¸­ï¼Œä»…èƒ½ä½¿ç”¨OLD.col_nameï¼Œæ²¡æœ‰æ–°è¡Œã€‚</li><li>OLD ç”¨OLD.col_nameæ¥å¼•ç”¨æ›´æ–°å‰çš„æŸä¸€è¡Œçš„åˆ—</li></ul><h2 id="æ·»åŠ ç´¢å¼•"><a href="#æ·»åŠ ç´¢å¼•" class="headerlink" title="æ·»åŠ ç´¢å¼•"></a>æ·»åŠ ç´¢å¼•</h2><h3 id="æ™®é€šç´¢å¼•-INDEX"><a href="#æ™®é€šç´¢å¼•-INDEX" class="headerlink" title="æ™®é€šç´¢å¼•(INDEX)"></a>æ™®é€šç´¢å¼•(INDEX)</h3><blockquote><p>è¯­æ³•ï¼šALTER TABLE <code>è¡¨åå­—</code> ADD INDEX ç´¢å¼•åå­— ( <code>å­—æ®µåå­—</code> )</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- â€“ç›´æ¥åˆ›å»ºç´¢å¼•</span><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_user <span class="token keyword">ON</span> <span class="token keyword">user</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span><span class="token comment" spellcheck="true">-- â€“ä¿®æ”¹è¡¨ç»“æ„çš„æ–¹å¼æ·»åŠ ç´¢å¼•</span><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">ADD</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> <span class="token punctuation">(</span><span class="token keyword">column</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">-- ç»™ user è¡¨ä¸­çš„ name å­—æ®µ æ·»åŠ æ™®é€šç´¢å¼•(INDEX)</span><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">ADD</span> <span class="token keyword">INDEX</span> index_name <span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token comment" spellcheck="true">-- â€“åˆ›å»ºè¡¨çš„æ—¶å€™åŒæ—¶åˆ›å»ºç´¢å¼•</span><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token punctuation">(</span>    <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token punctuation">,</span>    <span class="token punctuation">`</span>title<span class="token punctuation">`</span> char<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>    <span class="token punctuation">`</span>content<span class="token punctuation">`</span> <span class="token keyword">text</span> <span class="token keyword">CHARACTER SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token boolean">NULL</span> <span class="token punctuation">,</span>    <span class="token punctuation">`</span>time<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token punctuation">,</span>    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token keyword">INDEX</span> index_name <span class="token punctuation">(</span>title<span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">-- â€“åˆ é™¤ç´¢å¼•</span><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name <span class="token keyword">ON</span> <span class="token keyword">table</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¸»é”®ç´¢å¼•-PRIMARY-key"><a href="#ä¸»é”®ç´¢å¼•-PRIMARY-key" class="headerlink" title="ä¸»é”®ç´¢å¼•(PRIMARY key)"></a>ä¸»é”®ç´¢å¼•(PRIMARY key)</h3><blockquote><p>è¯­æ³•ï¼šALTER TABLE <code>è¡¨åå­—</code> ADD PRIMARY KEY ( <code>å­—æ®µåå­—</code> )</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- ç»™ user è¡¨ä¸­çš„ idå­—æ®µ æ·»åŠ ä¸»é”®ç´¢å¼•(PRIMARY key)</span><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">ADD</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="å”¯ä¸€ç´¢å¼•-UNIQUE"><a href="#å”¯ä¸€ç´¢å¼•-UNIQUE" class="headerlink" title="å”¯ä¸€ç´¢å¼•(UNIQUE)"></a>å”¯ä¸€ç´¢å¼•(UNIQUE)</h3><blockquote><p>è¯­æ³•ï¼šALTER TABLE <code>è¡¨åå­—</code> ADD UNIQUE (<code>å­—æ®µåå­—</code>)</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- ç»™ user è¡¨ä¸­çš„ creattime å­—æ®µæ·»åŠ å”¯ä¸€ç´¢å¼•(UNIQUE)</span><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">ADD</span> <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>creattime<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="å…¨æ–‡ç´¢å¼•-FULLTEXT"><a href="#å…¨æ–‡ç´¢å¼•-FULLTEXT" class="headerlink" title="å…¨æ–‡ç´¢å¼•(FULLTEXT)"></a>å…¨æ–‡ç´¢å¼•(FULLTEXT)</h3><blockquote><p>è¯­æ³•ï¼šALTER TABLE <code>è¡¨åå­—</code> ADD FULLTEXT (<code>å­—æ®µåå­—</code>)</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- ç»™ user è¡¨ä¸­çš„ description å­—æ®µæ·»åŠ å…¨æ–‡ç´¢å¼•(FULLTEXT)</span><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">ADD</span> FULLTEXT <span class="token punctuation">(</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="æ·»åŠ å¤šåˆ—ç´¢å¼•"><a href="#æ·»åŠ å¤šåˆ—ç´¢å¼•" class="headerlink" title="æ·»åŠ å¤šåˆ—ç´¢å¼•"></a>æ·»åŠ å¤šåˆ—ç´¢å¼•</h3><blockquote><p>è¯­æ³•ï¼š<br>ALTER TABLE <code>table_name</code> ADD INDEX index_name ( <code>column1</code>, <code>column2</code>, <code>column3</code>)</p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- ç»™ user è¡¨ä¸­çš„ nameã€cityã€age å­—æ®µæ·»åŠ åå­—ä¸ºname_city_ageçš„æ™®é€šç´¢å¼•(INDEX)</span><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span> <span class="token keyword">ADD</span> <span class="token keyword">INDEX</span> name_city_age <span class="token punctuation">(</span>name<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>city<span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="å»ºç«‹ç´¢å¼•çš„æ—¶æœº"><a href="#å»ºç«‹ç´¢å¼•çš„æ—¶æœº" class="headerlink" title="å»ºç«‹ç´¢å¼•çš„æ—¶æœº"></a>å»ºç«‹ç´¢å¼•çš„æ—¶æœº</h3><p>åœ¨<code>WHERE</code>å’Œ<code>JOIN</code>ä¸­å‡ºç°çš„åˆ—éœ€è¦å»ºç«‹ç´¢å¼•ï¼Œä½†ä¹Ÿä¸å®Œå…¨å¦‚æ­¤ï¼š</p><ul><li>MySQLåªå¯¹<code>&lt;</code>ï¼Œ<code>&lt;=</code>ï¼Œ<code>=</code>ï¼Œ<code>&gt;</code>ï¼Œ<code>&gt;=</code>ï¼Œ<code>BETWEEN</code>ï¼Œ<code>IN</code>ä½¿ç”¨ç´¢å¼•</li><li>æŸäº›æ—¶å€™çš„<code>LIKE</code>ä¹Ÿä¼šä½¿ç”¨ç´¢å¼•ã€‚</li><li>åœ¨<code>LIKE</code>ä»¥é€šé…ç¬¦%å’Œ_å¼€å¤´ä½œæŸ¥è¯¢æ—¶ï¼ŒMySQLä¸ä¼šä½¿ç”¨ç´¢å¼•ã€‚</li></ul><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- æ­¤æ—¶å°±éœ€è¦å¯¹cityå’Œageå»ºç«‹ç´¢å¼•ï¼Œ</span><span class="token comment" spellcheck="true">-- ç”±äºmytableè¡¨çš„userameä¹Ÿå‡ºç°åœ¨äº†JOINå­å¥ä¸­ï¼Œä¹Ÿæœ‰å¯¹å®ƒå»ºç«‹ç´¢å¼•çš„å¿…è¦ã€‚</span><span class="token keyword">SELECT</span> t<span class="token punctuation">.</span>Name  <span class="token keyword">FROM</span> mytable t <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> mytable m <span class="token keyword">ON</span> t<span class="token punctuation">.</span>Name<span class="token operator">=</span>m<span class="token punctuation">.</span>username <span class="token keyword">WHERE</span> m<span class="token punctuation">.</span>age<span class="token operator">=</span><span class="token number">20</span> <span class="token operator">AND</span> m<span class="token punctuation">.</span>city<span class="token operator">=</span><span class="token string">'ä¸Šæµ·'</span><span class="token punctuation">;</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> mytable <span class="token keyword">WHERE</span> username <span class="token operator">like</span><span class="token string">'admin%'</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- è€Œä¸‹å¥å°±ä¸ä¼šä½¿ç”¨ï¼š</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> mytable <span class="token keyword">WHERE</span> Name <span class="token operator">like</span><span class="token string">'%admin'</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">-- å› æ­¤ï¼Œåœ¨ä½¿ç”¨LIKEæ—¶åº”æ³¨æ„ä»¥ä¸Šçš„åŒºåˆ«ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç´¢å¼•çš„æ³¨æ„äº‹é¡¹</p><ul><li>ç´¢å¼•ä¸ä¼šåŒ…å«æœ‰NULLå€¼çš„åˆ—</li><li>ä½¿ç”¨çŸ­ç´¢å¼•</li><li>ä¸è¦åœ¨åˆ—ä¸Šè¿›è¡Œè¿ç®— ç´¢å¼•ä¼šå¤±æ•ˆ</li></ul><h2 id="åˆ›å»ºåè¡¨çš„ä¿®æ”¹"><a href="#åˆ›å»ºåè¡¨çš„ä¿®æ”¹" class="headerlink" title="åˆ›å»ºåè¡¨çš„ä¿®æ”¹"></a>åˆ›å»ºåè¡¨çš„ä¿®æ”¹</h2><h3 id="æ·»åŠ åˆ—"><a href="#æ·»åŠ åˆ—" class="headerlink" title="æ·»åŠ åˆ—"></a>æ·»åŠ åˆ—</h3><blockquote><p>è¯­æ³•ï¼š<code>alter table è¡¨å add åˆ—å åˆ—æ•°æ®ç±»å‹ [after æ’å…¥ä½ç½®];</code></p></blockquote><p>ç¤ºä¾‹:</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- åœ¨è¡¨studentsçš„æœ€åè¿½åŠ åˆ— address: </span><span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">add</span> address char<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- åœ¨åä¸º age çš„åˆ—åæ’å…¥åˆ— birthday: </span><span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">add</span> birthday <span class="token keyword">date</span> <span class="token keyword">after</span> age<span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- åœ¨åä¸º number_people çš„åˆ—åæ’å…¥åˆ— weeks: </span><span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">add</span> <span class="token keyword">column</span> <span class="token punctuation">`</span>weeks<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">default</span> <span class="token string">""</span> <span class="token keyword">after</span> <span class="token punctuation">`</span>number_people<span class="token punctuation">`</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¿®æ”¹åˆ—"><a href="#ä¿®æ”¹åˆ—" class="headerlink" title="ä¿®æ”¹åˆ—"></a>ä¿®æ”¹åˆ—</h3><blockquote><p>è¯­æ³•ï¼š<code>alter table è¡¨å change åˆ—åç§° åˆ—æ–°åç§° æ–°æ•°æ®ç±»å‹;</code></p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- å°†è¡¨ tel åˆ—æ”¹åä¸º telphone: </span><span class="token keyword">alter</span> <span class="token keyword">table</span> students change tel telphone char<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">"-"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- å°† name åˆ—çš„æ•°æ®ç±»å‹æ”¹ä¸º char(16): </span><span class="token keyword">alter</span> <span class="token keyword">table</span> students change name name char<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">not</span> <span class="token boolean">null</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- ä¿®æ”¹ COMMENT å‰é¢å¿…é¡»å¾—æœ‰ç±»å‹å±æ€§</span><span class="token keyword">alter</span> <span class="token keyword">table</span> students change name name char<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token keyword">COMMENT</span> <span class="token string">'è¿™é‡Œæ˜¯åå­—'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- ä¿®æ”¹åˆ—å±æ€§çš„æ—¶å€™ å»ºè®®ä½¿ç”¨modify,ä¸éœ€è¦é‡å»ºè¡¨</span><span class="token comment" spellcheck="true">-- changeç”¨äºä¿®æ”¹åˆ—åå­—ï¼Œè¿™ä¸ªéœ€è¦é‡å»ºè¡¨</span><span class="token keyword">alter</span> <span class="token keyword">table</span> meeting <span class="token keyword">modify</span> <span class="token punctuation">`</span>weeks<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token string">''</span> <span class="token keyword">COMMENT</span> <span class="token string">'å¼€æ”¾æ—¥æœŸ å‘¨ä¸€åˆ°å‘¨æ—¥ï¼š0~6ï¼Œé—´éš”ç”¨è‹±æ–‡é€—å·éš”å¼€'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- `user`è¡¨çš„`id`åˆ—ï¼Œä¿®æ”¹æˆå­—ç¬¦ä¸²ç±»å‹é•¿åº¦50ï¼Œä¸èƒ½ä¸ºç©ºï¼Œ`FIRST`æ”¾åœ¨ç¬¬ä¸€åˆ—çš„ä½ç½®</span><span class="token keyword">alter</span> <span class="token keyword">table</span> <span class="token punctuation">`</span><span class="token keyword">user</span><span class="token punctuation">`</span> <span class="token keyword">modify</span> <span class="token keyword">COLUMN</span> <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">FIRST</span> <span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åˆ é™¤åˆ—"><a href="#åˆ é™¤åˆ—" class="headerlink" title="åˆ é™¤åˆ—"></a>åˆ é™¤åˆ—</h3><blockquote><p>è¯­æ³•ï¼š<code>alter table è¡¨å drop åˆ—åç§°;</code></p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- åˆ é™¤è¡¨studentsä¸­çš„ birthday åˆ—: </span><span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">drop</span> birthday<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="é‡å‘½åè¡¨"><a href="#é‡å‘½åè¡¨" class="headerlink" title="é‡å‘½åè¡¨"></a>é‡å‘½åè¡¨</h3><blockquote><p>è¯­æ³•ï¼š<code>alter table è¡¨å rename æ–°è¡¨å;</code></p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- é‡å‘½å students è¡¨ä¸º workmates: </span><span class="token keyword">alter</span> <span class="token keyword">table</span> students <span class="token keyword">rename</span> workmates<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="æ¸…ç©ºè¡¨æ•°æ®"><a href="#æ¸…ç©ºè¡¨æ•°æ®" class="headerlink" title="æ¸…ç©ºè¡¨æ•°æ®"></a>æ¸…ç©ºè¡¨æ•°æ®</h3><blockquote><p>æ–¹æ³•ä¸€ï¼š<code>delete from è¡¨å;</code><br>æ–¹æ³•äºŒï¼š<code>truncate table "è¡¨å";</code></p></blockquote><ul><li><code>DELETE:</code>1. DMLè¯­è¨€;2. å¯ä»¥å›é€€;3. å¯ä»¥æœ‰æ¡ä»¶çš„åˆ é™¤;</li><li><code>TRUNCATE:</code>1. DDLè¯­è¨€;2. æ— æ³•å›é€€;3. é»˜è®¤æ‰€æœ‰çš„è¡¨å†…å®¹éƒ½åˆ é™¤;4. åˆ é™¤é€Ÿåº¦æ¯”deleteå¿«ã€‚</li></ul><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- æ¸…ç©ºè¡¨ä¸º workmates é‡Œé¢çš„æ•°æ®ï¼Œä¸åˆ é™¤è¡¨ã€‚ </span><span class="token keyword">delete</span> <span class="token keyword">from</span> workmates<span class="token punctuation">;</span><span class="token comment" spellcheck="true">-- åˆ é™¤workmatesè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œä¸”æ— æ³•æ¢å¤</span><span class="token keyword">truncate</span> <span class="token keyword">table</span> workmates<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="åˆ é™¤æ•´å¼ è¡¨"><a href="#åˆ é™¤æ•´å¼ è¡¨" class="headerlink" title="åˆ é™¤æ•´å¼ è¡¨"></a>åˆ é™¤æ•´å¼ è¡¨</h3><blockquote><p>è¯­æ³•ï¼š<code>drop table è¡¨å;</code></p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- åˆ é™¤ workmates è¡¨: </span><span class="token keyword">drop</span> <span class="token keyword">table</span> workmates<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="åˆ é™¤æ•´ä¸ªæ•°æ®åº“"><a href="#åˆ é™¤æ•´ä¸ªæ•°æ®åº“" class="headerlink" title="åˆ é™¤æ•´ä¸ªæ•°æ®åº“"></a>åˆ é™¤æ•´ä¸ªæ•°æ®åº“</h3><blockquote><p>è¯­æ³•ï¼š<code>drop database æ•°æ®åº“å;</code></p></blockquote><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- åˆ é™¤ samp_db æ•°æ®åº“: </span><span class="token keyword">drop</span> <span class="token keyword">database</span> samp_db<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="å…¶å®ƒå®ä¾‹"><a href="#å…¶å®ƒå®ä¾‹" class="headerlink" title="å…¶å®ƒå®ä¾‹"></a>å…¶å®ƒå®ä¾‹</h2><h3 id="SQLåˆ é™¤é‡å¤è®°å½•"><a href="#SQLåˆ é™¤é‡å¤è®°å½•" class="headerlink" title="SQLåˆ é™¤é‡å¤è®°å½•"></a>SQLåˆ é™¤é‡å¤è®°å½•</h3><p><a href="http://www.xiangguo.li/sql_and_nosql/2015/01/01/sql" target="_blank" rel="noopener">è½¬è½½</a></p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">-- æŸ¥æ‰¾è¡¨ä¸­å¤šä½™çš„é‡å¤è®°å½•ï¼Œé‡å¤è®°å½•æ˜¯æ ¹æ®å•ä¸ªå­—æ®µï¼ˆpeopleIdï¼‰æ¥åˆ¤æ–­</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> people <span class="token keyword">where</span> peopleId <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> peopleId <span class="token keyword">from</span> people <span class="token keyword">group</span> <span class="token keyword">by</span> peopleId <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>peopleId<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">-- åˆ é™¤è¡¨ä¸­å¤šä½™çš„é‡å¤è®°å½•ï¼Œé‡å¤è®°å½•æ˜¯æ ¹æ®å•ä¸ªå­—æ®µï¼ˆpeopleIdï¼‰æ¥åˆ¤æ–­ï¼Œåªç•™æœ‰rowidæœ€å°çš„è®°å½•</span><span class="token keyword">delete</span> <span class="token keyword">from</span> people <span class="token keyword">where</span> peopleId <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> peopleId <span class="token keyword">from</span> people <span class="token keyword">group</span> <span class="token keyword">by</span> peopleId <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>peopleId<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">and</span> rowid <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>rowid<span class="token punctuation">)</span> <span class="token keyword">from</span> people <span class="token keyword">group</span> <span class="token keyword">by</span> peopleId <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span>peopleId <span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">-- æŸ¥æ‰¾è¡¨ä¸­å¤šä½™çš„é‡å¤è®°å½•ï¼ˆå¤šä¸ªå­—æ®µï¼‰</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> vitae <span class="token number">a</span><span class="token keyword">where</span> <span class="token punctuation">(</span><span class="token number">a</span><span class="token punctuation">.</span>peopleId<span class="token punctuation">,</span><span class="token number">a</span><span class="token punctuation">.</span>seq<span class="token punctuation">)</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> peopleId<span class="token punctuation">,</span>seq <span class="token keyword">from</span> vitae <span class="token keyword">group</span> <span class="token keyword">by</span> peopleId<span class="token punctuation">,</span>seq <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">-- åˆ é™¤è¡¨ä¸­å¤šä½™çš„é‡å¤è®°å½•ï¼ˆå¤šä¸ªå­—æ®µï¼‰ï¼Œåªç•™æœ‰rowidæœ€å°çš„è®°å½•</span><span class="token keyword">delete</span> <span class="token keyword">from</span> vitae <span class="token number">a</span><span class="token keyword">where</span> <span class="token punctuation">(</span><span class="token number">a</span><span class="token punctuation">.</span>peopleId<span class="token punctuation">,</span><span class="token number">a</span><span class="token punctuation">.</span>seq<span class="token punctuation">)</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> peopleId<span class="token punctuation">,</span>seq <span class="token keyword">from</span> vitae <span class="token keyword">group</span> <span class="token keyword">by</span> peopleId<span class="token punctuation">,</span>seq <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">and</span> rowid <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>rowid<span class="token punctuation">)</span> <span class="token keyword">from</span> vitae <span class="token keyword">group</span> <span class="token keyword">by</span> peopleId<span class="token punctuation">,</span>seq <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">-- æŸ¥æ‰¾è¡¨ä¸­å¤šä½™çš„é‡å¤è®°å½•ï¼ˆå¤šä¸ªå­—æ®µï¼‰ï¼Œä¸åŒ…å«rowidæœ€å°çš„è®°å½•</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> vitae <span class="token number">a</span><span class="token keyword">where</span> <span class="token punctuation">(</span><span class="token number">a</span><span class="token punctuation">.</span>peopleId<span class="token punctuation">,</span><span class="token number">a</span><span class="token punctuation">.</span>seq<span class="token punctuation">)</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> peopleId<span class="token punctuation">,</span>seq <span class="token keyword">from</span> vitae <span class="token keyword">group</span> <span class="token keyword">by</span> peopleId<span class="token punctuation">,</span>seq <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">and</span> rowid <span class="token operator">not</span> <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">min</span><span class="token punctuation">(</span>rowid<span class="token punctuation">)</span> <span class="token keyword">from</span> vitae <span class="token keyword">group</span> <span class="token keyword">by</span> peopleId<span class="token punctuation">,</span>seq <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å‚è€ƒæ‰‹å†Œ"><a href="#å‚è€ƒæ‰‹å†Œ" class="headerlink" title="å‚è€ƒæ‰‹å†Œ"></a>å‚è€ƒæ‰‹å†Œ</h2><ul><li><a href="http://www.w3school.com.cn/sql/index.asp" target="_blank" rel="noopener">http://www.w3school.com.cn/sql/index.asp</a></li><li><a href="http://www.1keydata.com/cn/sql/sql-count.php" target="_blank" rel="noopener">http://www.1keydata.com/cn/sql/sql-count.php</a></li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> JavaWeb </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> JDBC </tag>
            
            <tag> æ•°æ®åº“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JDBCæ ¸å¿ƒæŠ€æœ¯</title>
      <link href="/2020/10/08/jdbc-he-xin-ji-zhu/"/>
      <url>/2020/10/08/jdbc-he-xin-ji-zhu/</url>
      
        <content type="html"><![CDATA[<hr><blockquote><p>æ­¤ç¬”è®°æ˜¯è§‚çœ‹ <a href="https://www.bilibili.com/video/BV11J411c7sB?from=search&amp;seid=4044749892780872620" target="_blank" rel="noopener">æ­¤è§†é¢‘</a>  åšçš„ç¬”è®°ï¼Œä¾›å­¦ä¹ å‚è€ƒç”¨ã€‚</p></blockquote><hr><h2 id="ç¬¬1ç« ï¼šJDBCæ¦‚è¿°"><a href="#ç¬¬1ç« ï¼šJDBCæ¦‚è¿°" class="headerlink" title="ç¬¬1ç« ï¼šJDBCæ¦‚è¿°"></a>ç¬¬1ç« ï¼šJDBCæ¦‚è¿°</h2><h3 id="1-1-æ•°æ®çš„æŒä¹…åŒ–"><a href="#1-1-æ•°æ®çš„æŒä¹…åŒ–" class="headerlink" title="1.1 æ•°æ®çš„æŒä¹…åŒ–"></a>1.1 æ•°æ®çš„æŒä¹…åŒ–</h3><ul><li><p>æŒä¹…åŒ–(persistence)ï¼š<strong>æŠŠæ•°æ®ä¿å­˜åˆ°å¯æ‰ç”µå¼å­˜å‚¨è®¾å¤‡ä¸­ä»¥ä¾›ä¹‹åä½¿ç”¨</strong>ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç‰¹åˆ«æ˜¯ä¼ä¸šçº§åº”ç”¨ï¼Œ<strong>æ•°æ®æŒä¹…åŒ–æ„å‘³ç€å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜</strong>ä¸ŠåŠ ä»¥â€å›ºåŒ–â€<strong>ï¼Œè€ŒæŒä¹…åŒ–çš„å®ç°è¿‡ç¨‹å¤§å¤šé€šè¿‡å„ç§å…³ç³»æ•°æ®åº“æ¥å®Œæˆ</strong>ã€‚</p></li><li><p>æŒä¹…åŒ–çš„ä¸»è¦åº”ç”¨æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®å­˜å‚¨åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å­˜å‚¨åœ¨ç£ç›˜æ–‡ä»¶ã€XMLæ•°æ®æ–‡ä»¶ä¸­ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566741430592.png" alt="1566741430592"> </p></li></ul><h3 id="1-2-Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯"><a href="#1-2-Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯" class="headerlink" title="1.2 Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯"></a>1.2 Javaä¸­çš„æ•°æ®å­˜å‚¨æŠ€æœ¯</h3><ul><li><p>åœ¨Javaä¸­ï¼Œæ•°æ®åº“å­˜å–æŠ€æœ¯å¯åˆ†ä¸ºå¦‚ä¸‹å‡ ç±»ï¼š</p><ul><li><p><strong>JDBC</strong>ç›´æ¥è®¿é—®æ•°æ®åº“</p></li><li><p>JDO (Java Data Object )æŠ€æœ¯</p></li><li><p><strong>ç¬¬ä¸‰æ–¹O/Rå·¥å…·</strong>ï¼Œå¦‚Hibernate, Mybatis ç­‰</p></li></ul></li><li><p>JDBCæ˜¯javaè®¿é—®æ•°æ®åº“çš„åŸºçŸ³ï¼ŒJDOã€Hibernateã€MyBatisç­‰åªæ˜¯æ›´å¥½çš„å°è£…äº†JDBCã€‚</p></li></ul><h3 id="1-3-JDBCä»‹ç»"><a href="#1-3-JDBCä»‹ç»" class="headerlink" title="1.3 JDBCä»‹ç»"></a>1.3 JDBCä»‹ç»</h3><ul><li>JDBC(Java Database Connectivity)æ˜¯ä¸€ä¸ª<strong>ç‹¬ç«‹äºç‰¹å®šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€é€šç”¨çš„SQLæ•°æ®åº“å­˜å–å’Œæ“ä½œçš„å…¬å…±æ¥å£</strong>ï¼ˆä¸€ç»„APIï¼‰ï¼Œå®šä¹‰äº†ç”¨æ¥è®¿é—®æ•°æ®åº“çš„æ ‡å‡†Javaç±»åº“ï¼Œï¼ˆ<strong>java.sql,javax.sql</strong>ï¼‰ä½¿ç”¨è¿™äº›ç±»åº“å¯ä»¥ä»¥ä¸€ç§<strong>æ ‡å‡†</strong>çš„æ–¹æ³•ã€æ–¹ä¾¿åœ°è®¿é—®æ•°æ®åº“èµ„æºã€‚</li><li>JDBCä¸ºè®¿é—®ä¸åŒçš„æ•°æ®åº“æä¾›äº†ä¸€ç§<strong>ç»Ÿä¸€çš„é€”å¾„</strong>ï¼Œä¸ºå¼€å‘è€…å±è”½äº†ä¸€äº›ç»†èŠ‚é—®é¢˜ã€‚</li><li>JDBCçš„ç›®æ ‡æ˜¯ä½¿Javaç¨‹åºå‘˜ä½¿ç”¨JDBCå¯ä»¥è¿æ¥ä»»ä½•<strong>æä¾›äº†JDBCé©±åŠ¨ç¨‹åº</strong>çš„æ•°æ®åº“ç³»ç»Ÿï¼Œè¿™æ ·å°±ä½¿å¾—ç¨‹åºå‘˜æ— éœ€å¯¹ç‰¹å®šçš„æ•°æ®åº“ç³»ç»Ÿçš„ç‰¹ç‚¹æœ‰è¿‡å¤šçš„äº†è§£ï¼Œä»è€Œå¤§å¤§ç®€åŒ–å’ŒåŠ å¿«äº†å¼€å‘è¿‡ç¨‹ã€‚</li><li>å¦‚æœæ²¡æœ‰JDBCï¼Œé‚£ä¹ˆJavaç¨‹åºè®¿é—®æ•°æ®åº“æ—¶æ˜¯è¿™æ ·çš„ï¼š</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555575760234.png" alt="1555575760234"></p><hr><ul><li>æœ‰äº†JDBCï¼ŒJavaç¨‹åºè®¿é—®æ•°æ®åº“æ—¶æ˜¯è¿™æ ·çš„ï¼š</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555575981203.png" alt="1555575981203"></p><hr><ul><li>æ€»ç»“å¦‚ä¸‹ï¼š</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566741692804.png" alt="1566741692804"></p><h3 id="1-4-JDBCä½“ç³»ç»“æ„"><a href="#1-4-JDBCä½“ç³»ç»“æ„" class="headerlink" title="1.4 JDBCä½“ç³»ç»“æ„"></a>1.4 JDBCä½“ç³»ç»“æ„</h3><ul><li>JDBCæ¥å£ï¼ˆAPIï¼‰åŒ…æ‹¬ä¸¤ä¸ªå±‚æ¬¡ï¼š<ul><li><strong>é¢å‘åº”ç”¨çš„API</strong>ï¼šJava APIï¼ŒæŠ½è±¡æ¥å£ï¼Œä¾›åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ä½¿ç”¨ï¼ˆè¿æ¥æ•°æ®åº“ï¼Œæ‰§è¡ŒSQLè¯­å¥ï¼Œè·å¾—ç»“æœï¼‰ã€‚</li><li><strong>é¢å‘æ•°æ®åº“çš„API</strong>ï¼šJava Driver APIï¼Œä¾›å¼€å‘å•†å¼€å‘æ•°æ®åº“é©±åŠ¨ç¨‹åºç”¨ã€‚</li></ul></li></ul><blockquote><p><strong>JDBCæ˜¯sunå…¬å¸æä¾›ä¸€å¥—ç”¨äºæ•°æ®åº“æ“ä½œçš„æ¥å£ï¼Œjavaç¨‹åºå‘˜åªéœ€è¦é¢å‘è¿™å¥—æ¥å£ç¼–ç¨‹å³å¯ã€‚</strong></p><p><strong>ä¸åŒçš„æ•°æ®åº“å‚å•†ï¼Œéœ€è¦é’ˆå¯¹è¿™å¥—æ¥å£ï¼Œæä¾›ä¸åŒå®ç°ã€‚ä¸åŒçš„å®ç°çš„é›†åˆï¼Œå³ä¸ºä¸åŒæ•°æ®åº“çš„é©±åŠ¨ã€‚                                                                â€”â€”â€”â€”é¢å‘æ¥å£ç¼–ç¨‹</strong></p></blockquote><h3 id="1-5-JDBCç¨‹åºç¼–å†™æ­¥éª¤"><a href="#1-5-JDBCç¨‹åºç¼–å†™æ­¥éª¤" class="headerlink" title="1.5 JDBCç¨‹åºç¼–å†™æ­¥éª¤"></a>1.5 JDBCç¨‹åºç¼–å†™æ­¥éª¤</h3><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1565969323908.png" alt="1565969323908"></p><blockquote><p>è¡¥å……ï¼šODBC(<strong>Open Database Connectivity</strong>ï¼Œå¼€æ”¾å¼æ•°æ®åº“è¿æ¥)ï¼Œæ˜¯å¾®è½¯åœ¨Windowså¹³å°ä¸‹æ¨å‡ºçš„ã€‚ä½¿ç”¨è€…åœ¨ç¨‹åºä¸­åªéœ€è¦è°ƒç”¨ODBC APIï¼Œç”± ODBC é©±åŠ¨ç¨‹åºå°†è°ƒç”¨è½¬æ¢æˆä¸ºå¯¹ç‰¹å®šçš„æ•°æ®åº“çš„è°ƒç”¨è¯·æ±‚ã€‚</p></blockquote><h2 id="ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥"><a href="#ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥" class="headerlink" title="ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥"></a>ç¬¬2ç« ï¼šè·å–æ•°æ®åº“è¿æ¥</h2><h3 id="2-1-è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»"><a href="#2-1-è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»" class="headerlink" title="2.1 è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»"></a>2.1 è¦ç´ ä¸€ï¼šDriveræ¥å£å®ç°ç±»</h3><h4 id="2-1-1-Driveræ¥å£ä»‹ç»"><a href="#2-1-1-Driveræ¥å£ä»‹ç»" class="headerlink" title="2.1.1 Driveræ¥å£ä»‹ç»"></a>2.1.1 Driveræ¥å£ä»‹ç»</h4><ul><li><p>java.sql.Driver æ¥å£æ˜¯æ‰€æœ‰ JDBC é©±åŠ¨ç¨‹åºéœ€è¦å®ç°çš„æ¥å£ã€‚è¿™ä¸ªæ¥å£æ˜¯æä¾›ç»™æ•°æ®åº“å‚å•†ä½¿ç”¨çš„ï¼Œä¸åŒæ•°æ®åº“å‚å•†æä¾›ä¸åŒçš„å®ç°ã€‚</p></li><li><p>åœ¨ç¨‹åºä¸­ä¸éœ€è¦ç›´æ¥å»è®¿é—®å®ç°äº† Driver æ¥å£çš„ç±»ï¼Œè€Œæ˜¯ç”±é©±åŠ¨ç¨‹åºç®¡ç†å™¨ç±»(java.sql.DriverManager)å»è°ƒç”¨è¿™äº›Driverå®ç°ã€‚</p><ul><li>Oracleçš„é©±åŠ¨ï¼š<strong>oracle.jdbc.driver.OracleDriver</strong></li><li>mySqlçš„é©±åŠ¨ï¼š <strong>com.mysql.jdbc.Driver</strong></li></ul></li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555576157618.png" alt="1555576157618"></p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566134718955.png" alt="1555576170074"></p><ul><li><p>å°†ä¸Šè¿°jaråŒ…æ‹·è´åˆ°Javaå·¥ç¨‹çš„ä¸€ä¸ªç›®å½•ä¸­ï¼Œä¹ æƒ¯ä¸Šæ–°å»ºä¸€ä¸ªlibæ–‡ä»¶å¤¹ã€‚</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566134781682.png" alt="1566134718955"></p></li></ul><p>åœ¨é©±åŠ¨jarä¸Šå³é”®â€“&gt;Build Pathâ€“&gt;Add to Build Path</p><p> <img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566135290460.png" alt="1566134781682"></p><p>æ³¨æ„ï¼šå¦‚æœæ˜¯Dynamic Web Projectï¼ˆåŠ¨æ€çš„webé¡¹ç›®ï¼‰è¯ï¼Œåˆ™æ˜¯æŠŠé©±åŠ¨jaræ”¾åˆ°WebContentï¼ˆæœ‰çš„å¼€å‘å·¥å…·å«WebRootï¼‰ç›®å½•ä¸­çš„WEB-INFç›®å½•ä¸­çš„libç›®å½•ä¸‹å³å¯</p><p> <img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566136831283.png" alt="1566135290460"></p><h4 id="2-1-2-åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨"><a href="#2-1-2-åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨" class="headerlink" title="2.1.2 åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨"></a>2.1.2 åŠ è½½ä¸æ³¨å†ŒJDBCé©±åŠ¨</h4><ul><li><p>åŠ è½½é©±åŠ¨ï¼šåŠ è½½ JDBC é©±åŠ¨éœ€è°ƒç”¨ Class ç±»çš„é™æ€æ–¹æ³• forName()ï¼Œå‘å…¶ä¼ é€’è¦åŠ è½½çš„ JDBC é©±åŠ¨çš„ç±»å</p><ul><li><strong>Class.forName(â€œcom.mysql.jdbc.Driverâ€);</strong></li></ul></li><li><p>æ³¨å†Œé©±åŠ¨ï¼šDriverManager ç±»æ˜¯é©±åŠ¨ç¨‹åºç®¡ç†å™¨ç±»ï¼Œè´Ÿè´£ç®¡ç†é©±åŠ¨ç¨‹åº</p><ul><li><p><strong>ä½¿ç”¨DriverManager.registerDriver(com.mysql.jdbc.Driver)æ¥æ³¨å†Œé©±åŠ¨</strong></p></li><li><p>é€šå¸¸ä¸ç”¨æ˜¾å¼è°ƒç”¨ DriverManager ç±»çš„ registerDriver() æ–¹æ³•æ¥æ³¨å†Œé©±åŠ¨ç¨‹åºç±»çš„å®ä¾‹ï¼Œå› ä¸º Driver æ¥å£çš„é©±åŠ¨ç¨‹åºç±»<strong>éƒ½</strong>åŒ…å«äº†é™æ€ä»£ç å—ï¼Œåœ¨è¿™ä¸ªé™æ€ä»£ç å—ä¸­ï¼Œä¼šè°ƒç”¨ DriverManager.registerDriver() æ–¹æ³•æ¥æ³¨å†Œè‡ªèº«çš„ä¸€ä¸ªå®ä¾‹ã€‚ä¸‹å›¾æ˜¯MySQLçš„Driverå®ç°ç±»çš„æºç ï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555576170074.png" alt="1566136831283"></p></li></ul></li></ul><h3 id="2-2-è¦ç´ äºŒï¼šURL"><a href="#2-2-è¦ç´ äºŒï¼šURL" class="headerlink" title="2.2 è¦ç´ äºŒï¼šURL"></a>2.2 è¦ç´ äºŒï¼šURL</h3><ul><li><p>JDBC URL ç”¨äºæ ‡è¯†ä¸€ä¸ªè¢«æ³¨å†Œçš„é©±åŠ¨ç¨‹åºï¼Œé©±åŠ¨ç¨‹åºç®¡ç†å™¨é€šè¿‡è¿™ä¸ª URL é€‰æ‹©æ­£ç¡®çš„é©±åŠ¨ç¨‹åºï¼Œä»è€Œå»ºç«‹åˆ°æ•°æ®åº“çš„è¿æ¥ã€‚</p></li><li><p>JDBC URLçš„æ ‡å‡†ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå„éƒ¨åˆ†é—´ç”¨å†’å·åˆ†éš”ã€‚ </p><ul><li><strong>jdbc:å­åè®®:å­åç§°</strong></li><li><strong>åè®®</strong>ï¼šJDBC URLä¸­çš„åè®®æ€»æ˜¯jdbc </li><li><strong>å­åè®®</strong>ï¼šå­åè®®ç”¨äºæ ‡è¯†ä¸€ä¸ªæ•°æ®åº“é©±åŠ¨ç¨‹åº</li><li><strong>å­åç§°</strong>ï¼šä¸€ç§æ ‡è¯†æ•°æ®åº“çš„æ–¹æ³•ã€‚å­åç§°å¯ä»¥ä¾ä¸åŒçš„å­åè®®è€Œå˜åŒ–ï¼Œç”¨å­åç§°çš„ç›®çš„æ˜¯ä¸ºäº†<strong>å®šä½æ•°æ®åº“</strong>æä¾›è¶³å¤Ÿçš„ä¿¡æ¯ã€‚åŒ…å«<strong>ä¸»æœºå</strong>(å¯¹åº”æœåŠ¡ç«¯çš„ipåœ°å€)<strong>ï¼Œç«¯å£å·ï¼Œæ•°æ®åº“å</strong></li></ul></li><li><p>ä¸¾ä¾‹ï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555576477107.png" alt="1555576477107"></p></li><li><p><strong>å‡ ç§å¸¸ç”¨æ•°æ®åº“çš„ JDBC URL</strong></p><ul><li><p>MySQLçš„è¿æ¥URLç¼–å†™æ–¹å¼ï¼š</p><ul><li>jdbc:mysql://ä¸»æœºåç§°:mysqlæœåŠ¡ç«¯å£å·/æ•°æ®åº“åç§°?å‚æ•°=å€¼&amp;å‚æ•°=å€¼</li><li>jdbc:mysql://localhost:3306/atguigu</li><li>jdbc:mysql://localhost:3306/atguigu<strong>?useUnicode=true&amp;characterEncoding=utf8</strong>ï¼ˆå¦‚æœJDBCç¨‹åºä¸æœåŠ¡å™¨ç«¯çš„å­—ç¬¦é›†ä¸ä¸€è‡´ï¼Œä¼šå¯¼è‡´ä¹±ç ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡å‚æ•°æŒ‡å®šæœåŠ¡å™¨ç«¯çš„å­—ç¬¦é›†ï¼‰</li><li>jdbc:mysql://localhost:3306/atguigu?user=root&amp;password=123456</li></ul></li><li><p>Oracle 9içš„è¿æ¥URLç¼–å†™æ–¹å¼ï¼š</p><ul><li>jdbc:oracle:thin:@ä¸»æœºåç§°:oracleæœåŠ¡ç«¯å£å·:æ•°æ®åº“åç§°</li><li>jdbc:oracle:thin:@localhost:1521:atguigu</li></ul></li><li><p>SQLServerçš„è¿æ¥URLç¼–å†™æ–¹å¼ï¼š</p><ul><li><p>jdbc:sqlserver://ä¸»æœºåç§°:sqlserveræœåŠ¡ç«¯å£å·:DatabaseName=æ•°æ®åº“åç§°</p></li><li><p>jdbc:sqlserver://localhost:1433:DatabaseName=atguigu</p></li></ul></li></ul></li></ul><h3 id="2-3-è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç "><a href="#2-3-è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç " class="headerlink" title="2.3 è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç "></a>2.3 è¦ç´ ä¸‰ï¼šç”¨æˆ·åå’Œå¯†ç </h3><ul><li>user,passwordå¯ä»¥ç”¨â€œå±æ€§å=å±æ€§å€¼â€æ–¹å¼å‘Šè¯‰æ•°æ®åº“</li><li>å¯ä»¥è°ƒç”¨ DriverManager ç±»çš„ getConnection() æ–¹æ³•å»ºç«‹åˆ°æ•°æ®åº“çš„è¿æ¥</li></ul><h3 id="2-4-æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹"><a href="#2-4-æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹" class="headerlink" title="2.4 æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹"></a>2.4 æ•°æ®åº“è¿æ¥æ–¹å¼ä¸¾ä¾‹</h3><h4 id="2-4-1-è¿æ¥æ–¹å¼ä¸€"><a href="#2-4-1-è¿æ¥æ–¹å¼ä¸€" class="headerlink" title="2.4.1 è¿æ¥æ–¹å¼ä¸€"></a>2.4.1 è¿æ¥æ–¹å¼ä¸€</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConnection1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//1.æä¾›java.sql.Driveræ¥å£å®ç°ç±»çš„å¯¹è±¡</span>            Driver driver <span class="token operator">=</span> null<span class="token punctuation">;</span>            driver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//2.æä¾›urlï¼ŒæŒ‡æ˜å…·ä½“æ“ä½œçš„æ•°æ®</span>            String url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//3.æä¾›Propertiesçš„å¯¹è±¡ï¼ŒæŒ‡æ˜ç”¨æˆ·åå’Œå¯†ç </span>            Properties info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            info<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            info<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">,</span> <span class="token string">"abc123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//4.è°ƒç”¨driverçš„connect()ï¼Œè·å–è¿æ¥</span>            Connection conn <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¯´æ˜ï¼šä¸Šè¿°ä»£ç ä¸­æ˜¾å¼å‡ºç°äº†ç¬¬ä¸‰æ–¹æ•°æ®åº“çš„API</p></blockquote><h4 id="2-4-2-è¿æ¥æ–¹å¼äºŒ"><a href="#2-4-2-è¿æ¥æ–¹å¼äºŒ" class="headerlink" title="2.4.2 è¿æ¥æ–¹å¼äºŒ"></a>2.4.2 è¿æ¥æ–¹å¼äºŒ</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConnection2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//1.å®ä¾‹åŒ–Driver</span>            String className <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">;</span>            Class <span class="token class-name">clazz</span> <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>            Driver driver <span class="token operator">=</span> <span class="token punctuation">(</span>Driver<span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//2.æä¾›urlï¼ŒæŒ‡æ˜å…·ä½“æ“ä½œçš„æ•°æ®</span>            String url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//3.æä¾›Propertiesçš„å¯¹è±¡ï¼ŒæŒ‡æ˜ç”¨æˆ·åå’Œå¯†ç </span>            Properties info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            info<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            info<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">,</span> <span class="token string">"abc123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//4.è°ƒç”¨driverçš„connect()ï¼Œè·å–è¿æ¥</span>            Connection conn <span class="token operator">=</span> driver<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¯´æ˜ï¼šç›¸è¾ƒäºæ–¹å¼ä¸€ï¼Œè¿™é‡Œä½¿ç”¨åå°„å®ä¾‹åŒ–Driverï¼Œä¸åœ¨ä»£ç ä¸­ä½“ç°ç¬¬ä¸‰æ–¹æ•°æ®åº“çš„APIã€‚ä½“ç°äº†é¢å‘æ¥å£ç¼–ç¨‹æ€æƒ³ã€‚</p></blockquote><h4 id="2-4-3-è¿æ¥æ–¹å¼ä¸‰"><a href="#2-4-3-è¿æ¥æ–¹å¼ä¸‰" class="headerlink" title="2.4.3 è¿æ¥æ–¹å¼ä¸‰"></a>2.4.3 è¿æ¥æ–¹å¼ä¸‰</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//1.æ•°æ®åº“è¿æ¥çš„4ä¸ªåŸºæœ¬è¦ç´ ï¼š</span>            String url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">;</span>            String user <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">;</span>            String password <span class="token operator">=</span> <span class="token string">"abc123"</span><span class="token punctuation">;</span>            String driverName <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//2.å®ä¾‹åŒ–Driver</span>            Class <span class="token class-name">clazz</span> <span class="token operator">=</span> Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>            Driver driver <span class="token operator">=</span> <span class="token punctuation">(</span>Driver<span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//3.æ³¨å†Œé©±åŠ¨</span>            DriverManager<span class="token punctuation">.</span><span class="token function">registerDriver</span><span class="token punctuation">(</span>driver<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//4.è·å–è¿æ¥</span>            Connection conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¯´æ˜ï¼šä½¿ç”¨DriverManagerå®ç°æ•°æ®åº“çš„è¿æ¥ã€‚ä½“ä¼šè·å–è¿æ¥å¿…è¦çš„4ä¸ªåŸºæœ¬è¦ç´ ã€‚</p></blockquote><h4 id="2-4-4-è¿æ¥æ–¹å¼å››"><a href="#2-4-4-è¿æ¥æ–¹å¼å››" class="headerlink" title="2.4.4 è¿æ¥æ–¹å¼å››"></a>2.4.4 è¿æ¥æ–¹å¼å››</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testConnection4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//1.æ•°æ®åº“è¿æ¥çš„4ä¸ªåŸºæœ¬è¦ç´ ï¼š</span>            String url <span class="token operator">=</span> <span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">;</span>            String user <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">;</span>            String password <span class="token operator">=</span> <span class="token string">"abc123"</span><span class="token punctuation">;</span>            String driverName <span class="token operator">=</span> <span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//2.åŠ è½½é©±åŠ¨ ï¼ˆâ‘ å®ä¾‹åŒ–Driver â‘¡æ³¨å†Œé©±åŠ¨ï¼‰</span>            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverName<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//Driver driver = (Driver) clazz.newInstance();</span>            <span class="token comment" spellcheck="true">//3.æ³¨å†Œé©±åŠ¨</span>            <span class="token comment" spellcheck="true">//DriverManager.registerDriver(driver);</span>            <span class="token comment" spellcheck="true">/*            å¯ä»¥æ³¨é‡Šæ‰ä¸Šè¿°ä»£ç çš„åŸå› ï¼Œæ˜¯å› ä¸ºåœ¨mysqlçš„Driverç±»ä¸­å£°æ˜æœ‰ï¼š            static {                try {                    DriverManager.registerDriver(new Driver());                } catch (SQLException var1) {                    throw new RuntimeException("Can't register driver!");                }            }             */</span>            <span class="token comment" spellcheck="true">//3.è·å–è¿æ¥</span>            Connection conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¯´æ˜ï¼šä¸å¿…æ˜¾å¼çš„æ³¨å†Œé©±åŠ¨äº†ã€‚å› ä¸ºåœ¨DriverManagerçš„æºç ä¸­å·²ç»å­˜åœ¨é™æ€ä»£ç å—ï¼Œå®ç°äº†é©±åŠ¨çš„æ³¨å†Œã€‚</p></blockquote><h4 id="2-4-5-è¿æ¥æ–¹å¼äº”-æœ€ç»ˆç‰ˆ"><a href="#2-4-5-è¿æ¥æ–¹å¼äº”-æœ€ç»ˆç‰ˆ" class="headerlink" title="2.4.5 è¿æ¥æ–¹å¼äº”(æœ€ç»ˆç‰ˆ)"></a>2.4.5 è¿æ¥æ–¹å¼äº”(æœ€ç»ˆç‰ˆ)</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">testConnection5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//1.åŠ è½½é…ç½®æ–‡ä»¶</span>        InputStream is <span class="token operator">=</span> ConnectionTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"jdbc.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        Properties pros <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pros<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//2.è¯»å–é…ç½®ä¿¡æ¯</span>        String user <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String password <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String url <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String driverClass <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverClass"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//3.åŠ è½½é©±åŠ¨</span>        Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverClass<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//4.è·å–è¿æ¥</span>        Connection conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span>user<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œé…ç½®æ–‡ä»¶å£°æ˜åœ¨å·¥ç¨‹çš„srcç›®å½•ä¸‹ï¼šã€jdbc.propertiesã€‘</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">user</span><span class="token punctuation">=</span><span class="token attr-value">root</span><span class="token attr-name">password</span><span class="token punctuation">=</span><span class="token attr-value">abc123</span><span class="token attr-name">url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/test</span><span class="token attr-name">driverClass</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.jdbc.Driver</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¯´æ˜ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶çš„æ–¹å¼ä¿å­˜é…ç½®ä¿¡æ¯ï¼Œåœ¨ä»£ç ä¸­åŠ è½½é…ç½®æ–‡ä»¶</p><p><strong>ä½¿ç”¨é…ç½®æ–‡ä»¶çš„å¥½å¤„ï¼š</strong></p><p>â‘ å®ç°äº†ä»£ç å’Œæ•°æ®çš„åˆ†ç¦»ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹é…ç½®ä¿¡æ¯ï¼Œç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ï¼Œä¸éœ€è¦æ·±å…¥ä»£ç <br>â‘¡å¦‚æœä¿®æ”¹äº†é…ç½®ä¿¡æ¯ï¼Œçœå»é‡æ–°ç¼–è¯‘çš„è¿‡ç¨‹ã€‚</p></blockquote><h2 id="ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ"><a href="#ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ" class="headerlink" title="ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ"></a>ç¬¬3ç« ï¼šä½¿ç”¨PreparedStatementå®ç°CRUDæ“ä½œ</h2><h3 id="3-1-æ“ä½œå’Œè®¿é—®æ•°æ®åº“"><a href="#3-1-æ“ä½œå’Œè®¿é—®æ•°æ®åº“" class="headerlink" title="3.1 æ“ä½œå’Œè®¿é—®æ•°æ®åº“"></a>3.1 æ“ä½œå’Œè®¿é—®æ•°æ®åº“</h3><ul><li><p>æ•°æ®åº“è¿æ¥è¢«ç”¨äºå‘æ•°æ®åº“æœåŠ¡å™¨å‘é€å‘½ä»¤å’Œ SQL è¯­å¥ï¼Œå¹¶æ¥å—æ•°æ®åº“æœåŠ¡å™¨è¿”å›çš„ç»“æœã€‚å…¶å®ä¸€ä¸ªæ•°æ®åº“è¿æ¥å°±æ˜¯ä¸€ä¸ªSocketè¿æ¥ã€‚</p></li><li><p>åœ¨ java.sql åŒ…ä¸­æœ‰ 3 ä¸ªæ¥å£åˆ†åˆ«å®šä¹‰äº†å¯¹æ•°æ®åº“çš„è°ƒç”¨çš„ä¸åŒæ–¹å¼ï¼š</p><ul><li>Statementï¼šç”¨äºæ‰§è¡Œé™æ€ SQL è¯­å¥å¹¶è¿”å›å®ƒæ‰€ç”Ÿæˆç»“æœçš„å¯¹è±¡ã€‚ </li><li>PrepatedStatementï¼šSQL è¯­å¥è¢«é¢„ç¼–è¯‘å¹¶å­˜å‚¨åœ¨æ­¤å¯¹è±¡ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ­¤å¯¹è±¡å¤šæ¬¡é«˜æ•ˆåœ°æ‰§è¡Œè¯¥è¯­å¥ã€‚</li><li>CallableStatementï¼šç”¨äºæ‰§è¡Œ SQL å­˜å‚¨è¿‡ç¨‹</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566573842140.png" alt="1566573842140"></p></li></ul><h3 id="3-2-ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯"><a href="#3-2-ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯" class="headerlink" title="3.2 ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯"></a>3.2 ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨çš„å¼Šç«¯</h3><ul><li><p>é€šè¿‡è°ƒç”¨ Connection å¯¹è±¡çš„ createStatement() æ–¹æ³•åˆ›å»ºè¯¥å¯¹è±¡ã€‚è¯¥å¯¹è±¡ç”¨äºæ‰§è¡Œé™æ€çš„ SQL è¯­å¥ï¼Œå¹¶ä¸”è¿”å›æ‰§è¡Œç»“æœã€‚</p></li><li><p>Statement æ¥å£ä¸­å®šä¹‰äº†ä¸‹åˆ—æ–¹æ³•ç”¨äºæ‰§è¡Œ SQL è¯­å¥ï¼š</p><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">int</span> excuteUpdate<span class="token punctuation">(</span>String sql<span class="token punctuation">)</span>ï¼šæ‰§è¡Œæ›´æ–°æ“ä½œ<span class="token keyword">INSERT</span>ã€<span class="token keyword">UPDATE</span>ã€<span class="token keyword">DELETE</span>ResultSet executeQuery<span class="token punctuation">(</span>String sql<span class="token punctuation">)</span>ï¼šæ‰§è¡ŒæŸ¥è¯¢æ“ä½œ<span class="token keyword">SELECT</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p>ä½†æ˜¯ä½¿ç”¨Statementæ“ä½œæ•°æ®è¡¨å­˜åœ¨å¼Šç«¯ï¼š</p><ul><li><strong>é—®é¢˜ä¸€ï¼šå­˜åœ¨æ‹¼ä¸²æ“ä½œï¼Œç¹ç</strong></li><li><strong>é—®é¢˜äºŒï¼šå­˜åœ¨SQLæ³¨å…¥é—®é¢˜</strong></li></ul></li><li><p>SQL æ³¨å…¥æ˜¯åˆ©ç”¨æŸäº›ç³»ç»Ÿæ²¡æœ‰å¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œå……åˆ†çš„æ£€æŸ¥ï¼Œè€Œåœ¨ç”¨æˆ·è¾“å…¥æ•°æ®ä¸­æ³¨å…¥éæ³•çš„ SQL è¯­å¥æ®µæˆ–å‘½ä»¤(å¦‚ï¼šSELECT user, password FROM user_table WHERE user=â€™aâ€™ OR 1 = â€˜ AND password = â€˜ OR â€˜1â€™ = â€˜1â€™) ï¼Œä»è€Œåˆ©ç”¨ç³»ç»Ÿçš„ SQL å¼•æ“å®Œæˆæ¶æ„è¡Œä¸ºçš„åšæ³•ã€‚</p></li><li><p>å¯¹äº Java è€Œè¨€ï¼Œè¦é˜²èŒƒ SQL æ³¨å…¥ï¼Œåªè¦ç”¨ PreparedStatement(ä»Statementæ‰©å±•è€Œæ¥) å–ä»£ Statement å°±å¯ä»¥äº†ã€‚</p></li><li><p>ä»£ç æ¼”ç¤ºï¼š</p></li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StatementTest</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// ä½¿ç”¨Statementçš„å¼Šç«¯ï¼šéœ€è¦æ‹¼å†™sqlè¯­å¥ï¼Œå¹¶ä¸”å­˜åœ¨SQLæ³¨å…¥çš„é—®é¢˜</span>    <span class="token annotation punctuation">@Test</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        Scanner scan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·åï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String userName <span class="token operator">=</span> scan<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"å¯†   ç ï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        String password <span class="token operator">=</span> scan<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// SELECT user,password FROM user_table WHERE USER = '1' or ' AND PASSWORD = '='1' or '1' = '1';</span>        String sql <span class="token operator">=</span> <span class="token string">"SELECT user,password FROM user_table WHERE USER = '"</span> <span class="token operator">+</span> userName <span class="token operator">+</span> <span class="token string">"' AND PASSWORD = '"</span> <span class="token operator">+</span> password                <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">;</span>        User user <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span> User<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç™»é™†æˆåŠŸ!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// ä½¿ç”¨Statementå®ç°å¯¹æ•°æ®è¡¨çš„æŸ¥è¯¢æ“ä½œ</span>    <span class="token keyword">public</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> T <span class="token function">get</span><span class="token punctuation">(</span>String sql<span class="token punctuation">,</span> Class<span class="token operator">&lt;</span>T<span class="token operator">></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>        T t <span class="token operator">=</span> null<span class="token punctuation">;</span>        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>        Statement st <span class="token operator">=</span> null<span class="token punctuation">;</span>        ResultSet rs <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 1.åŠ è½½é…ç½®æ–‡ä»¶</span>            InputStream is <span class="token operator">=</span> StatementTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"jdbc.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            Properties pros <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            pros<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 2.è¯»å–é…ç½®ä¿¡æ¯</span>            String user <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            String password <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            String url <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            String driverClass <span class="token operator">=</span> pros<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driverClass"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 3.åŠ è½½é©±åŠ¨</span>            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>driverClass<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 4.è·å–è¿æ¥</span>            conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>            st <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            rs <span class="token operator">=</span> st<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// è·å–ç»“æœé›†çš„å…ƒæ•°æ®</span>            ResultSetMetaData rsmd <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// è·å–ç»“æœé›†çš„åˆ—æ•°</span>            <span class="token keyword">int</span> columnCount <span class="token operator">=</span> rsmd<span class="token punctuation">.</span><span class="token function">getColumnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                t <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> columnCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token comment" spellcheck="true">// //1. è·å–åˆ—çš„åç§°</span>                    <span class="token comment" spellcheck="true">// String columnName = rsmd.getColumnName(i+1);</span>                    <span class="token comment" spellcheck="true">// 1. è·å–åˆ—çš„åˆ«å</span>                    String columnName <span class="token operator">=</span> rsmd<span class="token punctuation">.</span><span class="token function">getColumnLabel</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">// 2. æ ¹æ®åˆ—åè·å–å¯¹åº”æ•°æ®è¡¨ä¸­çš„æ•°æ®</span>                    Object columnVal <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">// 3. å°†æ•°æ®è¡¨ä¸­å¾—åˆ°çš„æ•°æ®ï¼Œå°è£…è¿›å¯¹è±¡</span>                    Field field <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">;</span>                    field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> columnVal<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">return</span> t<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// å…³é—­èµ„æº</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>rs <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">try</span> <span class="token punctuation">{</span>                    rs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>st <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">try</span> <span class="token punctuation">{</span>                    st<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>conn <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">try</span> <span class="token punctuation">{</span>                    conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»¼ä¸Šï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566569819744.png" alt="1566569819744"></p><h3 id="3-3-PreparedStatementçš„ä½¿ç”¨"><a href="#3-3-PreparedStatementçš„ä½¿ç”¨" class="headerlink" title="3.3 PreparedStatementçš„ä½¿ç”¨"></a>3.3 PreparedStatementçš„ä½¿ç”¨</h3><h4 id="3-3-1-PreparedStatementä»‹ç»"><a href="#3-3-1-PreparedStatementä»‹ç»" class="headerlink" title="3.3.1 PreparedStatementä»‹ç»"></a>3.3.1 PreparedStatementä»‹ç»</h4><ul><li><p>å¯ä»¥é€šè¿‡è°ƒç”¨ Connection å¯¹è±¡çš„ <strong>preparedStatement(String sql)</strong> æ–¹æ³•è·å– PreparedStatement å¯¹è±¡</p></li><li><p><strong>PreparedStatement æ¥å£æ˜¯ Statement çš„å­æ¥å£ï¼Œå®ƒè¡¨ç¤ºä¸€æ¡é¢„ç¼–è¯‘è¿‡çš„ SQL è¯­å¥</strong></p></li><li><p>PreparedStatement å¯¹è±¡æ‰€ä»£è¡¨çš„ SQL è¯­å¥ä¸­çš„å‚æ•°ç”¨é—®å·(?)æ¥è¡¨ç¤ºï¼Œè°ƒç”¨ PreparedStatement å¯¹è±¡çš„ setXxx() æ–¹æ³•æ¥è®¾ç½®è¿™äº›å‚æ•°. setXxx() æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è®¾ç½®çš„ SQL è¯­å¥ä¸­çš„å‚æ•°çš„ç´¢å¼•(ä» 1 å¼€å§‹)ï¼Œç¬¬äºŒä¸ªæ˜¯è®¾ç½®çš„ SQL è¯­å¥ä¸­çš„å‚æ•°çš„å€¼</p></li></ul><h4 id="3-3-2-PreparedStatement-vs-Statement"><a href="#3-3-2-PreparedStatement-vs-Statement" class="headerlink" title="3.3.2 PreparedStatement vs Statement"></a>3.3.2 PreparedStatement vs Statement</h4><ul><li><p>ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p></li><li><p><strong>PreparedStatement èƒ½æœ€å¤§å¯èƒ½æé«˜æ€§èƒ½ï¼š</strong></p><ul><li>DBServerä¼šå¯¹<strong>é¢„ç¼–è¯‘</strong>è¯­å¥æä¾›æ€§èƒ½ä¼˜åŒ–ã€‚å› ä¸ºé¢„ç¼–è¯‘è¯­å¥æœ‰å¯èƒ½è¢«é‡å¤è°ƒç”¨ï¼Œæ‰€ä»¥<u>è¯­å¥åœ¨è¢«DBServerçš„ç¼–è¯‘å™¨ç¼–è¯‘åçš„æ‰§è¡Œä»£ç è¢«ç¼“å­˜ä¸‹æ¥ï¼Œé‚£ä¹ˆä¸‹æ¬¡è°ƒç”¨æ—¶åªè¦æ˜¯ç›¸åŒçš„é¢„ç¼–è¯‘è¯­å¥å°±ä¸éœ€è¦ç¼–è¯‘ï¼Œåªè¦å°†å‚æ•°ç›´æ¥ä¼ å…¥ç¼–è¯‘è¿‡çš„è¯­å¥æ‰§è¡Œä»£ç ä¸­å°±ä¼šå¾—åˆ°æ‰§è¡Œã€‚</u></li><li>åœ¨statementè¯­å¥ä¸­,å³ä½¿æ˜¯ç›¸åŒæ“ä½œä½†å› ä¸ºæ•°æ®å†…å®¹ä¸ä¸€æ ·,æ‰€ä»¥æ•´ä¸ªè¯­å¥æœ¬èº«ä¸èƒ½åŒ¹é…,æ²¡æœ‰ç¼“å­˜è¯­å¥çš„æ„ä¹‰.äº‹å®æ˜¯æ²¡æœ‰æ•°æ®åº“ä¼šå¯¹æ™®é€šè¯­å¥ç¼–è¯‘åçš„æ‰§è¡Œä»£ç ç¼“å­˜ã€‚è¿™æ ·<u>æ¯æ‰§è¡Œä¸€æ¬¡éƒ½è¦å¯¹ä¼ å…¥çš„è¯­å¥ç¼–è¯‘ä¸€æ¬¡ã€‚</u></li><li>(è¯­æ³•æ£€æŸ¥ï¼Œè¯­ä¹‰æ£€æŸ¥ï¼Œç¿»è¯‘æˆäºŒè¿›åˆ¶å‘½ä»¤ï¼Œç¼“å­˜)</li></ul></li><li><p>PreparedStatement å¯ä»¥é˜²æ­¢ SQL æ³¨å…¥ </p></li></ul><h4 id="3-3-3-Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨"><a href="#3-3-3-Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨" class="headerlink" title="3.3.3 Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨"></a>3.3.3 Javaä¸SQLå¯¹åº”æ•°æ®ç±»å‹è½¬æ¢è¡¨</h4><table><thead><tr><th>Javaç±»å‹</th><th>SQLç±»å‹</th></tr></thead><tbody><tr><td>boolean</td><td>BIT</td></tr><tr><td>byte</td><td>TINYINT</td></tr><tr><td>short</td><td>SMALLINT</td></tr><tr><td>int</td><td>INTEGER</td></tr><tr><td>long</td><td>BIGINT</td></tr><tr><td>String</td><td>CHAR,VARCHAR,LONGVARCHAR</td></tr><tr><td>byte   array</td><td>BINARY  ,    VAR BINARY</td></tr><tr><td>java.sql.Date</td><td>DATE</td></tr><tr><td>java.sql.Time</td><td>TIME</td></tr><tr><td>java.sql.Timestamp</td><td>TIMESTAMP</td></tr></tbody></table><h4 id="3-3-4-ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ"><a href="#3-3-4-ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ" class="headerlink" title="3.3.4 ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ"></a>3.3.4 ä½¿ç”¨PreparedStatementå®ç°å¢ã€åˆ ã€æ”¹æ“ä½œ</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token comment" spellcheck="true">//é€šç”¨çš„å¢ã€åˆ ã€æ”¹æ“ä½œï¼ˆä½“ç°ä¸€ï¼šå¢ã€åˆ ã€æ”¹ ï¼› ä½“ç°äºŒï¼šé’ˆå¯¹äºä¸åŒçš„è¡¨ï¼‰</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>String sql<span class="token punctuation">,</span>Object <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>        PreparedStatement ps <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//1.è·å–æ•°æ®åº“çš„è¿æ¥</span>            conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//2.è·å–PreparedStatementçš„å®ä¾‹ (æˆ–ï¼šé¢„ç¼–è¯‘sqlè¯­å¥)</span>            ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//3.å¡«å……å ä½ç¬¦</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                ps<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true">//4.æ‰§è¡Œsqlè¯­å¥</span>            ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//5.å…³é—­èµ„æº</span>            JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-3-5-ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ"><a href="#3-3-5-ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ" class="headerlink" title="3.3.5 ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ"></a>3.3.5 ä½¿ç”¨PreparedStatementå®ç°æŸ¥è¯¢æ“ä½œ</h4><pre class="line-numbers language-java"><code class="language-java">    <span class="token comment" spellcheck="true">// é€šç”¨çš„é’ˆå¯¹äºä¸åŒè¡¨çš„æŸ¥è¯¢:è¿”å›ä¸€ä¸ªå¯¹è±¡ (version 1.0)</span>    <span class="token keyword">public</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> T <span class="token function">getInstance</span><span class="token punctuation">(</span>Class<span class="token operator">&lt;</span>T<span class="token operator">></span> clazz<span class="token punctuation">,</span> String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>        PreparedStatement ps <span class="token operator">=</span> null<span class="token punctuation">;</span>        ResultSet rs <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 1.è·å–æ•°æ®åº“è¿æ¥</span>            conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 2.é¢„ç¼–è¯‘sqlè¯­å¥ï¼Œå¾—åˆ°PreparedStatementå¯¹è±¡</span>            ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 3.å¡«å……å ä½ç¬¦</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                ps<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true">// 4.æ‰§è¡ŒexecuteQuery(),å¾—åˆ°ç»“æœé›†ï¼šResultSet</span>            rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 5.å¾—åˆ°ç»“æœé›†çš„å…ƒæ•°æ®ï¼šResultSetMetaData</span>            ResultSetMetaData rsmd <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 6.1é€šè¿‡ResultSetMetaDataå¾—åˆ°columnCount,columnLabelï¼›é€šè¿‡ResultSetå¾—åˆ°åˆ—å€¼</span>            <span class="token keyword">int</span> columnCount <span class="token operator">=</span> rsmd<span class="token punctuation">.</span><span class="token function">getColumnCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                T t <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> columnCount<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">// éå†æ¯ä¸€ä¸ªåˆ—</span>                    <span class="token comment" spellcheck="true">// è·å–åˆ—å€¼</span>                    Object columnVal <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">// è·å–åˆ—çš„åˆ«å:åˆ—çš„åˆ«åï¼Œä½¿ç”¨ç±»çš„å±æ€§åå……å½“</span>                    String columnLabel <span class="token operator">=</span> rsmd<span class="token punctuation">.</span><span class="token function">getColumnLabel</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment" spellcheck="true">// 6.2ä½¿ç”¨åå°„ï¼Œç»™å¯¹è±¡çš„ç›¸åº”å±æ€§èµ‹å€¼</span>                    Field field <span class="token operator">=</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span>columnLabel<span class="token punctuation">)</span><span class="token punctuation">;</span>                    field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> columnVal<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">return</span> t<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// 7.å…³é—­èµ„æº</span>            JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">,</span> rs<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>è¯´æ˜ï¼šä½¿ç”¨PreparedStatementå®ç°çš„æŸ¥è¯¢æ“ä½œå¯ä»¥æ›¿æ¢Statementå®ç°çš„æŸ¥è¯¢æ“ä½œï¼Œè§£å†³Statementæ‹¼ä¸²å’ŒSQLæ³¨å…¥é—®é¢˜ã€‚</p></blockquote><h3 id="3-4-ResultSetä¸ResultSetMetaData"><a href="#3-4-ResultSetä¸ResultSetMetaData" class="headerlink" title="3.4 ResultSetä¸ResultSetMetaData"></a>3.4 ResultSetä¸ResultSetMetaData</h3><h4 id="3-4-1-ResultSet"><a href="#3-4-1-ResultSet" class="headerlink" title="3.4.1 ResultSet"></a>3.4.1 ResultSet</h4><ul><li><p>æŸ¥è¯¢éœ€è¦è°ƒç”¨PreparedStatement çš„ executeQuery() æ–¹æ³•ï¼ŒæŸ¥è¯¢ç»“æœæ˜¯ä¸€ä¸ªResultSet å¯¹è±¡</p></li><li><p>ResultSet å¯¹è±¡ä»¥é€»è¾‘è¡¨æ ¼çš„å½¢å¼å°è£…äº†æ‰§è¡Œæ•°æ®åº“æ“ä½œçš„ç»“æœé›†ï¼ŒResultSet æ¥å£ç”±æ•°æ®åº“å‚å•†æä¾›å®ç°</p></li><li><p>ResultSet è¿”å›çš„å®é™…ä¸Šå°±æ˜¯ä¸€å¼ æ•°æ®è¡¨ã€‚æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æ•°æ®è¡¨çš„ç¬¬ä¸€æ¡è®°å½•çš„å‰é¢ã€‚</p></li><li><p>ResultSet å¯¹è±¡ç»´æŠ¤äº†ä¸€ä¸ªæŒ‡å‘å½“å‰æ•°æ®è¡Œçš„<strong>æ¸¸æ ‡</strong>ï¼Œåˆå§‹çš„æ—¶å€™ï¼Œæ¸¸æ ‡åœ¨ç¬¬ä¸€è¡Œä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡ ResultSet å¯¹è±¡çš„ next() æ–¹æ³•ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œã€‚è°ƒç”¨ next()æ–¹æ³•æ£€æµ‹ä¸‹ä¸€è¡Œæ˜¯å¦æœ‰æ•ˆã€‚è‹¥æœ‰æ•ˆï¼Œè¯¥æ–¹æ³•è¿”å› trueï¼Œä¸”æŒ‡é’ˆä¸‹ç§»ã€‚ç›¸å½“äºIteratorå¯¹è±¡çš„ hasNext() å’Œ next() æ–¹æ³•çš„ç»“åˆä½“ã€‚</p></li><li><p>å½“æŒ‡é’ˆæŒ‡å‘ä¸€è¡Œæ—¶, å¯ä»¥é€šè¿‡è°ƒç”¨ getXxx(int index) æˆ– getXxx(int columnName) è·å–æ¯ä¸€åˆ—çš„å€¼ã€‚</p><ul><li>ä¾‹å¦‚: getInt(1), getString(â€œnameâ€)</li><li><strong>æ³¨æ„ï¼šJavaä¸æ•°æ®åº“äº¤äº’æ¶‰åŠåˆ°çš„ç›¸å…³Java APIä¸­çš„ç´¢å¼•éƒ½ä»1å¼€å§‹ã€‚</strong></li></ul></li><li><p>ResultSet æ¥å£çš„å¸¸ç”¨æ–¹æ³•ï¼š</p><ul><li><p>boolean next()</p></li><li><p>getString()</p></li><li><p>â€¦</p></li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580152530.png" alt="1555580152530"></p></li></ul><h4 id="3-4-2-ResultSetMetaData"><a href="#3-4-2-ResultSetMetaData" class="headerlink" title="3.4.2 ResultSetMetaData"></a>3.4.2 ResultSetMetaData</h4><ul><li><p>å¯ç”¨äºè·å–å…³äº ResultSet å¯¹è±¡ä¸­åˆ—çš„ç±»å‹å’Œå±æ€§ä¿¡æ¯çš„å¯¹è±¡</p></li><li><p>ResultSetMetaData meta = rs.getMetaData();</p><ul><li><p><strong>getColumnName</strong>(int column)ï¼šè·å–æŒ‡å®šåˆ—çš„åç§°</p></li><li><p><strong>getColumnLabel</strong>(int column)ï¼šè·å–æŒ‡å®šåˆ—çš„åˆ«å</p></li><li><p><strong>getColumnCount</strong>()ï¼šè¿”å›å½“å‰ ResultSet å¯¹è±¡ä¸­çš„åˆ—æ•°ã€‚ </p></li><li><p>getColumnTypeName(int column)ï¼šæ£€ç´¢æŒ‡å®šåˆ—çš„æ•°æ®åº“ç‰¹å®šçš„ç±»å‹åç§°ã€‚ </p></li><li><p>getColumnDisplaySize(int column)ï¼šæŒ‡ç¤ºæŒ‡å®šåˆ—çš„æœ€å¤§æ ‡å‡†å®½åº¦ï¼Œä»¥å­—ç¬¦ä¸ºå•ä½ã€‚ </p></li><li><p><strong>isNullable</strong>(int column)ï¼šæŒ‡ç¤ºæŒ‡å®šåˆ—ä¸­çš„å€¼æ˜¯å¦å¯ä»¥ä¸º nullã€‚ </p></li><li><p>isAutoIncrement(int column)ï¼šæŒ‡ç¤ºæ˜¯å¦è‡ªåŠ¨ä¸ºæŒ‡å®šåˆ—è¿›è¡Œç¼–å·ï¼Œè¿™æ ·è¿™äº›åˆ—ä»ç„¶æ˜¯åªè¯»çš„ã€‚ </p></li></ul></li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555579494691.png" alt="1555579494691"></p><p><strong>é—®é¢˜1ï¼šå¾—åˆ°ç»“æœé›†å, å¦‚ä½•çŸ¥é“è¯¥ç»“æœé›†ä¸­æœ‰å“ªäº›åˆ— ï¼Ÿ åˆ—åæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><p>â€‹     éœ€è¦ä½¿ç”¨ä¸€ä¸ªæè¿° ResultSet çš„å¯¹è±¡ï¼Œ å³ ResultSetMetaData</p><p><strong>é—®é¢˜2ï¼šå…³äºResultSetMetaData</strong></p><ol><li><strong>å¦‚ä½•è·å– ResultSetMetaData</strong>ï¼š è°ƒç”¨ ResultSet çš„ getMetaData() æ–¹æ³•å³å¯</li><li><strong>è·å– ResultSet ä¸­æœ‰å¤šå°‘åˆ—</strong>ï¼šè°ƒç”¨ ResultSetMetaData çš„ getColumnCount() æ–¹æ³•</li><li><strong>è·å– ResultSet æ¯ä¸€åˆ—çš„åˆ—çš„åˆ«åæ˜¯ä»€ä¹ˆ</strong>ï¼šè°ƒç”¨ ResultSetMetaData çš„getColumnLabel() æ–¹æ³•</li></ol><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555579816884.png" alt="1555579816884"></p><h3 id="3-5-èµ„æºçš„é‡Šæ”¾"><a href="#3-5-èµ„æºçš„é‡Šæ”¾" class="headerlink" title="3.5 èµ„æºçš„é‡Šæ”¾"></a>3.5 èµ„æºçš„é‡Šæ”¾</h3><ul><li>é‡Šæ”¾ResultSet, Statement,Connectionã€‚</li><li>æ•°æ®åº“è¿æ¥ï¼ˆConnectionï¼‰æ˜¯éå¸¸ç¨€æœ‰çš„èµ„æºï¼Œç”¨å®Œåå¿…é¡»é©¬ä¸Šé‡Šæ”¾ï¼Œå¦‚æœConnectionä¸èƒ½åŠæ—¶æ­£ç¡®çš„å…³é—­å°†å¯¼è‡´ç³»ç»Ÿå®•æœºã€‚Connectionçš„ä½¿ç”¨åŸåˆ™æ˜¯<strong>å°½é‡æ™šåˆ›å»ºï¼Œå°½é‡æ—©çš„é‡Šæ”¾ã€‚</strong></li><li>å¯ä»¥åœ¨finallyä¸­å…³é—­ï¼Œä¿è¯åŠæ—¶å…¶ä»–ä»£ç å‡ºç°å¼‚å¸¸ï¼Œèµ„æºä¹Ÿä¸€å®šèƒ½è¢«å…³é—­ã€‚</li></ul><h3 id="3-6-JDBC-APIå°ç»“"><a href="#3-6-JDBC-APIå°ç»“" class="headerlink" title="3.6 JDBC APIå°ç»“"></a>3.6 JDBC APIå°ç»“</h3><ul><li><p>ä¸¤ç§æ€æƒ³</p><ul><li><p>é¢å‘æ¥å£ç¼–ç¨‹çš„æ€æƒ³</p></li><li><p>ORMæ€æƒ³(object relational mapping)</p><ul><li>ä¸€ä¸ªæ•°æ®è¡¨å¯¹åº”ä¸€ä¸ªjavaç±»</li><li>è¡¨ä¸­çš„ä¸€æ¡è®°å½•å¯¹åº”javaç±»çš„ä¸€ä¸ªå¯¹è±¡</li><li>è¡¨ä¸­çš„ä¸€ä¸ªå­—æ®µå¯¹åº”javaç±»çš„ä¸€ä¸ªå±æ€§</li></ul></li></ul><blockquote><p>sqlæ˜¯éœ€è¦ç»“åˆåˆ—åå’Œè¡¨çš„å±æ€§åæ¥å†™ã€‚æ³¨æ„èµ·åˆ«åã€‚</p></blockquote></li><li><p>ä¸¤ç§æŠ€æœ¯</p><ul><li>JDBCç»“æœé›†çš„å…ƒæ•°æ®ï¼šResultSetMetaData<ul><li>è·å–åˆ—æ•°ï¼šgetColumnCount()</li><li>è·å–åˆ—çš„åˆ«åï¼šgetColumnLabel()</li></ul></li><li>é€šè¿‡åå°„ï¼Œåˆ›å»ºæŒ‡å®šç±»çš„å¯¹è±¡ï¼Œè·å–æŒ‡å®šçš„å±æ€§å¹¶èµ‹å€¼</li></ul></li></ul><hr><h2 id="ç« èŠ‚ç»ƒä¹ "><a href="#ç« èŠ‚ç»ƒä¹ " class="headerlink" title="ç« èŠ‚ç»ƒä¹ "></a>ç« èŠ‚ç»ƒä¹ </h2><p><strong>ç»ƒä¹ é¢˜1ï¼šä»æ§åˆ¶å°å‘æ•°æ®åº“çš„è¡¨customersä¸­æ’å…¥ä¸€æ¡æ•°æ®ï¼Œè¡¨ç»“æ„å¦‚ä¸‹ï¼š</strong></p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580735377.png" alt="1555580275036"></p><p><strong>ç»ƒä¹ é¢˜2ï¼šåˆ›ç«‹æ•°æ®åº“è¡¨ examstudentï¼Œè¡¨ç»“æ„å¦‚ä¸‹ï¼š</strong></p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580763636.png" alt="1555580735377"></p><p>å‘æ•°æ®è¡¨ä¸­æ·»åŠ å¦‚ä¸‹æ•°æ®ï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580275036.png" alt="1555580763636"></p><p><strong>ä»£ç å®ç°1ï¼šæ’å…¥ä¸€ä¸ªæ–°çš„student ä¿¡æ¯</strong></p><p>è¯·è¾“å…¥è€ƒç”Ÿçš„è¯¦ç»†ä¿¡æ¯</p><p>Type:<br>IDCard:<br>ExamCard:<br>StudentName:<br>Location:<br>Grade:</p><p>ä¿¡æ¯å½•å…¥æˆåŠŸ!</p><p><strong>ä»£ç å®ç°2ï¼šåœ¨ eclipseä¸­å»ºç«‹ java ç¨‹åºï¼šè¾“å…¥èº«ä»½è¯å·æˆ–å‡†è€ƒè¯å·å¯ä»¥æŸ¥è¯¢åˆ°å­¦ç”Ÿçš„åŸºæœ¬ä¿¡æ¯ã€‚ç»“æœå¦‚ä¸‹ï¼š</strong></p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580965019.png" alt="1555580937490"></p><p><strong>ä»£ç å®ç°3ï¼šå®Œæˆå­¦ç”Ÿä¿¡æ¯çš„åˆ é™¤åŠŸèƒ½</strong></p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555580937490.png" alt="1555580965019"></p><hr><h2 id="ç¬¬4ç« -æ“ä½œBLOBç±»å‹å­—æ®µ"><a href="#ç¬¬4ç« -æ“ä½œBLOBç±»å‹å­—æ®µ" class="headerlink" title="ç¬¬4ç«  æ“ä½œBLOBç±»å‹å­—æ®µ"></a>ç¬¬4ç«  æ“ä½œBLOBç±»å‹å­—æ®µ</h2><h3 id="4-1-MySQL-BLOBç±»å‹"><a href="#4-1-MySQL-BLOBç±»å‹" class="headerlink" title="4.1 MySQL BLOBç±»å‹"></a>4.1 MySQL BLOBç±»å‹</h3><ul><li><p>MySQLä¸­ï¼ŒBLOBæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å¤§å‹å¯¹è±¡ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥å­˜å‚¨å¤§é‡æ•°æ®çš„å®¹å™¨ï¼Œå®ƒèƒ½å®¹çº³ä¸åŒå¤§å°çš„æ•°æ®ã€‚</p></li><li><p>æ’å…¥BLOBç±»å‹çš„æ•°æ®å¿…é¡»ä½¿ç”¨PreparedStatementï¼Œå› ä¸ºBLOBç±»å‹çš„æ•°æ®æ— æ³•ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥å†™çš„ã€‚</p></li><li><p>MySQLçš„å››ç§BLOBç±»å‹(é™¤äº†åœ¨å­˜å‚¨çš„æœ€å¤§ä¿¡æ¯é‡ä¸Šä¸åŒå¤–ï¼Œä»–ä»¬æ˜¯ç­‰åŒçš„)</p></li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555581069798.png" alt="1555581069798"></p><ul><li>å®é™…ä½¿ç”¨ä¸­æ ¹æ®éœ€è¦å­˜å…¥çš„æ•°æ®å¤§å°å®šä¹‰ä¸åŒçš„BLOBç±»å‹ã€‚</li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœå­˜å‚¨çš„æ–‡ä»¶è¿‡å¤§ï¼Œæ•°æ®åº“çš„æ€§èƒ½ä¼šä¸‹é™ã€‚</li><li>å¦‚æœåœ¨æŒ‡å®šäº†ç›¸å…³çš„Blobç±»å‹ä»¥åï¼Œè¿˜æŠ¥é”™ï¼šxxx too largeï¼Œé‚£ä¹ˆåœ¨mysqlçš„å®‰è£…ç›®å½•ä¸‹ï¼Œæ‰¾my.iniæ–‡ä»¶åŠ ä¸Šå¦‚ä¸‹çš„é…ç½®å‚æ•°ï¼š <strong>max_allowed_packet=16M</strong>ã€‚åŒæ—¶æ³¨æ„ï¼šä¿®æ”¹äº†my.iniæ–‡ä»¶ä¹‹åï¼Œéœ€è¦é‡æ–°å¯åŠ¨mysqlæœåŠ¡ã€‚</li></ul><h3 id="4-2-å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹"><a href="#4-2-å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹" class="headerlink" title="4.2 å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹"></a>4.2 å‘æ•°æ®è¡¨ä¸­æ’å…¥å¤§æ•°æ®ç±»å‹</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//è·å–è¿æ¥</span>Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>String sql <span class="token operator">=</span> <span class="token string">"insert into customers(name,email,birth,photo)values(?,?,?,?)"</span><span class="token punctuation">;</span>PreparedStatement ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¡«å……å ä½ç¬¦</span>ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"å¾æµ·å¼º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"xhq@126.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ps<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ“ä½œBlobç±»å‹çš„å˜é‡</span>FileInputStream fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"xhq.png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ps<span class="token punctuation">.</span><span class="token function">setBlob</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> fis<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ‰§è¡Œ</span>ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-3-ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ"><a href="#4-3-ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ" class="headerlink" title="4.3 ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ"></a>4.3 ä¿®æ”¹æ•°æ®è¡¨ä¸­çš„Blobç±»å‹å­—æ®µ</h3><pre class="line-numbers language-java"><code class="language-java">Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>String sql <span class="token operator">=</span> <span class="token string">"update customers set photo = ? where id = ?"</span><span class="token punctuation">;</span>PreparedStatement ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¡«å……å ä½ç¬¦</span><span class="token comment" spellcheck="true">// æ“ä½œBlobç±»å‹çš„å˜é‡</span>FileInputStream fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"coffee.png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ps<span class="token punctuation">.</span><span class="token function">setBlob</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> fis<span class="token punctuation">)</span><span class="token punctuation">;</span>ps<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-4-ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹"><a href="#4-4-ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹" class="headerlink" title="4.4 ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹"></a>4.4 ä»æ•°æ®è¡¨ä¸­è¯»å–å¤§æ•°æ®ç±»å‹</h3><pre class="line-numbers language-java"><code class="language-java">String sql <span class="token operator">=</span> <span class="token string">"SELECT id, name, email, birth, photo FROM customer WHERE id = ?"</span><span class="token punctuation">;</span>conn <span class="token operator">=</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>ps<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>rs <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    Integer id <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String name <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String email <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Date birth <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Customer cust <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> email<span class="token punctuation">,</span> birth<span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cust<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//è¯»å–Blobç±»å‹çš„å­—æ®µ</span>    Blob photo <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getBlob</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    InputStream is <span class="token operator">=</span> photo<span class="token punctuation">.</span><span class="token function">getBinaryStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    OutputStream os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"c.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">byte</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>len <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>buffer<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        os<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">,</span> rs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>is <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">{</span>        is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>os <span class="token operator">!=</span>  null<span class="token punctuation">)</span><span class="token punctuation">{</span>        os<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¬¬5ç« -æ‰¹é‡æ’å…¥"><a href="#ç¬¬5ç« -æ‰¹é‡æ’å…¥" class="headerlink" title="ç¬¬5ç«  æ‰¹é‡æ’å…¥"></a>ç¬¬5ç«  æ‰¹é‡æ’å…¥</h2><h3 id="5-1-æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥"><a href="#5-1-æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥" class="headerlink" title="5.1 æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥"></a>5.1 æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥</h3><p>å½“éœ€è¦æˆæ‰¹æ’å…¥æˆ–è€…æ›´æ–°è®°å½•æ—¶ï¼Œå¯ä»¥é‡‡ç”¨Javaçš„æ‰¹é‡<strong>æ›´æ–°</strong>æœºåˆ¶ï¼Œè¿™ä¸€æœºåˆ¶å…è®¸å¤šæ¡è¯­å¥ä¸€æ¬¡æ€§æäº¤ç»™æ•°æ®åº“æ‰¹é‡å¤„ç†ã€‚é€šå¸¸æƒ…å†µä¸‹æ¯”å•ç‹¬æäº¤å¤„ç†æ›´æœ‰æ•ˆç‡</p><p>JDBCçš„æ‰¹é‡å¤„ç†è¯­å¥åŒ…æ‹¬ä¸‹é¢ä¸‰ä¸ªæ–¹æ³•ï¼š</p><ul><li><strong>addBatch(String)ï¼šæ·»åŠ éœ€è¦æ‰¹é‡å¤„ç†çš„SQLè¯­å¥æˆ–æ˜¯å‚æ•°ï¼›</strong></li><li><strong>executeBatch()ï¼šæ‰§è¡Œæ‰¹é‡å¤„ç†è¯­å¥ï¼›</strong></li><li><strong>clearBatch():æ¸…ç©ºç¼“å­˜çš„æ•°æ®</strong></li></ul><p>é€šå¸¸æˆ‘ä»¬ä¼šé‡åˆ°ä¸¤ç§æ‰¹é‡æ‰§è¡ŒSQLè¯­å¥çš„æƒ…å†µï¼š</p><ul><li>å¤šæ¡SQLè¯­å¥çš„æ‰¹é‡å¤„ç†ï¼›</li><li>ä¸€ä¸ªSQLè¯­å¥çš„æ‰¹é‡ä¼ å‚ï¼›</li></ul><h3 id="5-2-é«˜æ•ˆçš„æ‰¹é‡æ’å…¥"><a href="#5-2-é«˜æ•ˆçš„æ‰¹é‡æ’å…¥" class="headerlink" title="5.2 é«˜æ•ˆçš„æ‰¹é‡æ’å…¥"></a>5.2 é«˜æ•ˆçš„æ‰¹é‡æ’å…¥</h3><p>ä¸¾ä¾‹ï¼šå‘æ•°æ®è¡¨ä¸­æ’å…¥20000æ¡æ•°æ®</p><ul><li>æ•°æ®åº“ä¸­æä¾›ä¸€ä¸ªgoodsè¡¨ã€‚åˆ›å»ºå¦‚ä¸‹ï¼š</li></ul><pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> goods<span class="token punctuation">(</span>id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>NAME <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-2-1-å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement"><a href="#5-2-1-å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement" class="headerlink" title="5.2.1 å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement"></a>5.2.1 å®ç°å±‚æ¬¡ä¸€ï¼šä½¿ç”¨Statement</h4><pre class="line-numbers language-java"><code class="language-java">Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Statement st <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> <span class="token number">20000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    String sql <span class="token operator">=</span> <span class="token string">"insert into goods(name) values('name_' + "</span><span class="token operator">+</span> i <span class="token operator">+</span><span class="token string">")"</span><span class="token punctuation">;</span>    st<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-2-2-å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement"><a href="#5-2-2-å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement" class="headerlink" title="5.2.2 å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement"></a>5.2.2 å®ç°å±‚æ¬¡äºŒï¼šä½¿ç”¨PreparedStatement</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>String sql <span class="token operator">=</span> <span class="token string">"insert into goods(name)values(?)"</span><span class="token punctuation">;</span>PreparedStatement ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> <span class="token number">20000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"name_"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    ps<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">long</span> end <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//82340</span>JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-2-3-å®ç°å±‚æ¬¡ä¸‰"><a href="#5-2-3-å®ç°å±‚æ¬¡ä¸‰" class="headerlink" title="5.2.3 å®ç°å±‚æ¬¡ä¸‰"></a>5.2.3 å®ç°å±‚æ¬¡ä¸‰</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/* * ä¿®æ”¹1ï¼š ä½¿ç”¨ addBatch() / executeBatch() / clearBatch() * ä¿®æ”¹2ï¼šmysqlæœåŠ¡å™¨é»˜è®¤æ˜¯å…³é—­æ‰¹å¤„ç†çš„ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€ä¸ªå‚æ•°ï¼Œè®©mysqlå¼€å¯æ‰¹å¤„ç†çš„æ”¯æŒã€‚ *          ?rewriteBatchedStatements=true å†™åœ¨é…ç½®æ–‡ä»¶çš„urlåé¢ * ä¿®æ”¹3ï¼šä½¿ç”¨æ›´æ–°çš„mysql é©±åŠ¨ï¼šmysql-connector-java-5.1.37-bin.jar *  */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testInsert1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    <span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"insert into goods(name)values(?)"</span><span class="token punctuation">;</span>    PreparedStatement ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> <span class="token number">1000000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"name_"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//1.â€œæ”’â€sql</span>        ps<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">500</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//2.æ‰§è¡Œ</span>            ps<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//3.æ¸…ç©º</span>            ps<span class="token punctuation">.</span><span class="token function">clearBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">long</span> end <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//20000æ¡ï¼š625                                                                         //1000000æ¡:14733  </span>    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-2-4-å®ç°å±‚æ¬¡å››"><a href="#5-2-4-å®ç°å±‚æ¬¡å››" class="headerlink" title="5.2.4 å®ç°å±‚æ¬¡å››"></a>5.2.4 å®ç°å±‚æ¬¡å››</h4><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/** å±‚æ¬¡å››ï¼šåœ¨å±‚æ¬¡ä¸‰çš„åŸºç¡€ä¸Šæ“ä½œ* ä½¿ç”¨Connection çš„ setAutoCommit(false)  /  commit()*/</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testInsert2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    <span class="token keyword">long</span> start <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//1.è®¾ç½®ä¸ºä¸è‡ªåŠ¨æäº¤æ•°æ®</span>    conn<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"insert into goods(name)values(?)"</span><span class="token punctuation">;</span>    PreparedStatement ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> <span class="token number">1000000</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        ps<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"name_"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//1.â€œæ”’â€sql</span>        ps<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">%</span> <span class="token number">500</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//2.æ‰§è¡Œ</span>            ps<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">//3.æ¸…ç©º</span>            ps<span class="token punctuation">.</span><span class="token function">clearBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//2.æäº¤æ•°æ®</span>    conn<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">long</span> end <span class="token operator">=</span> System<span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"èŠ±è´¹çš„æ—¶é—´ä¸ºï¼š"</span> <span class="token operator">+</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//1000000æ¡:4978 </span>    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¬¬6ç« ï¼š-æ•°æ®åº“äº‹åŠ¡"><a href="#ç¬¬6ç« ï¼š-æ•°æ®åº“äº‹åŠ¡" class="headerlink" title="ç¬¬6ç« ï¼š æ•°æ®åº“äº‹åŠ¡"></a>ç¬¬6ç« ï¼š æ•°æ®åº“äº‹åŠ¡</h2><h3 id="6-1-æ•°æ®åº“äº‹åŠ¡ä»‹ç»"><a href="#6-1-æ•°æ®åº“äº‹åŠ¡ä»‹ç»" class="headerlink" title="6.1 æ•°æ®åº“äº‹åŠ¡ä»‹ç»"></a>6.1 æ•°æ®åº“äº‹åŠ¡ä»‹ç»</h3><ul><li><p><strong>äº‹åŠ¡ï¼šä¸€ç»„é€»è¾‘æ“ä½œå•å…ƒ,ä½¿æ•°æ®ä»ä¸€ç§çŠ¶æ€å˜æ¢åˆ°å¦ä¸€ç§çŠ¶æ€ã€‚</strong></p></li><li><p><strong>äº‹åŠ¡å¤„ç†ï¼ˆäº‹åŠ¡æ“ä½œï¼‰ï¼š</strong>ä¿è¯æ‰€æœ‰äº‹åŠ¡éƒ½ä½œä¸ºä¸€ä¸ªå·¥ä½œå•å…ƒæ¥æ‰§è¡Œï¼Œå³ä½¿å‡ºç°äº†æ•…éšœï¼Œéƒ½ä¸èƒ½æ”¹å˜è¿™ç§æ‰§è¡Œæ–¹å¼ã€‚å½“åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œå¤šä¸ªæ“ä½œæ—¶ï¼Œè¦ä¹ˆæ‰€æœ‰çš„äº‹åŠ¡éƒ½<strong>è¢«æäº¤(commit)</strong>ï¼Œé‚£ä¹ˆè¿™äº›ä¿®æ”¹å°±æ°¸ä¹…åœ°ä¿å­˜ä¸‹æ¥ï¼›è¦ä¹ˆæ•°æ®åº“ç®¡ç†ç³»ç»Ÿå°†æ”¾å¼ƒæ‰€ä½œçš„æ‰€æœ‰ä¿®æ”¹ï¼Œæ•´ä¸ªäº‹åŠ¡<strong>å›æ»š(rollback)</strong>åˆ°æœ€åˆçŠ¶æ€ã€‚</p></li><li><p>ä¸ºç¡®ä¿æ•°æ®åº“ä¸­æ•°æ®çš„<strong>ä¸€è‡´æ€§</strong>ï¼Œæ•°æ®çš„æ“çºµåº”å½“æ˜¯ç¦»æ•£çš„æˆç»„çš„é€»è¾‘å•å…ƒï¼šå½“å®ƒå…¨éƒ¨å®Œæˆæ—¶ï¼Œæ•°æ®çš„ä¸€è‡´æ€§å¯ä»¥ä¿æŒï¼Œè€Œå½“è¿™ä¸ªå•å…ƒä¸­çš„ä¸€éƒ¨åˆ†æ“ä½œå¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡åº”å…¨éƒ¨è§†ä¸ºé”™è¯¯ï¼Œæ‰€æœ‰ä»èµ·å§‹ç‚¹ä»¥åçš„æ“ä½œåº”å…¨éƒ¨å›é€€åˆ°å¼€å§‹çŠ¶æ€ã€‚ </p></li></ul><h3 id="6-2-JDBCäº‹åŠ¡å¤„ç†"><a href="#6-2-JDBCäº‹åŠ¡å¤„ç†" class="headerlink" title="6.2 JDBCäº‹åŠ¡å¤„ç†"></a>6.2 JDBCäº‹åŠ¡å¤„ç†</h3><ul><li><p>æ•°æ®ä¸€æ—¦æäº¤ï¼Œå°±ä¸å¯å›æ»šã€‚</p></li><li><p>æ•°æ®ä»€ä¹ˆæ—¶å€™æ„å‘³ç€æäº¤ï¼Ÿ</p><ul><li><strong>å½“ä¸€ä¸ªè¿æ¥å¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯è‡ªåŠ¨æäº¤äº‹åŠ¡</strong>ï¼šæ¯æ¬¡æ‰§è¡Œä¸€ä¸ª SQL è¯­å¥æ—¶ï¼Œå¦‚æœæ‰§è¡ŒæˆåŠŸï¼Œå°±ä¼šå‘æ•°æ®åº“è‡ªåŠ¨æäº¤ï¼Œè€Œä¸èƒ½å›æ»šã€‚</li><li><strong>å…³é—­æ•°æ®åº“è¿æ¥ï¼Œæ•°æ®å°±ä¼šè‡ªåŠ¨çš„æäº¤ã€‚</strong>å¦‚æœå¤šä¸ªæ“ä½œï¼Œæ¯ä¸ªæ“ä½œä½¿ç”¨çš„æ˜¯è‡ªå·±å•ç‹¬çš„è¿æ¥ï¼Œåˆ™æ— æ³•ä¿è¯äº‹åŠ¡ã€‚å³åŒä¸€ä¸ªäº‹åŠ¡çš„å¤šä¸ªæ“ä½œå¿…é¡»åœ¨åŒä¸€ä¸ªè¿æ¥ä¸‹ã€‚</li></ul></li><li><p><strong>JDBCç¨‹åºä¸­ä¸ºäº†è®©å¤šä¸ª SQL è¯­å¥ä½œä¸ºä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œï¼š</strong></p><ul><li>è°ƒç”¨ Connection å¯¹è±¡çš„ <strong>setAutoCommit(false);</strong> ä»¥å–æ¶ˆè‡ªåŠ¨æäº¤äº‹åŠ¡</li><li>åœ¨æ‰€æœ‰çš„ SQL è¯­å¥éƒ½æˆåŠŸæ‰§è¡Œåï¼Œè°ƒç”¨ <strong>commit();</strong> æ–¹æ³•æäº¤äº‹åŠ¡</li><li>åœ¨å‡ºç°å¼‚å¸¸æ—¶ï¼Œè°ƒç”¨ <strong>rollback();</strong> æ–¹æ³•å›æ»šäº‹åŠ¡</li></ul><blockquote><p>è‹¥æ­¤æ—¶ Connection æ²¡æœ‰è¢«å…³é—­ï¼Œè¿˜å¯èƒ½è¢«é‡å¤ä½¿ç”¨ï¼Œåˆ™éœ€è¦æ¢å¤å…¶è‡ªåŠ¨æäº¤çŠ¶æ€ setAutoCommit(true)ã€‚å°¤å…¶æ˜¯åœ¨ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯æ—¶ï¼Œæ‰§è¡Œclose()æ–¹æ³•å‰ï¼Œå»ºè®®æ¢å¤è‡ªåŠ¨æäº¤çŠ¶æ€ã€‚</p></blockquote></li></ul><p>ã€æ¡ˆä¾‹ï¼šç”¨æˆ·AAå‘ç”¨æˆ·BBè½¬è´¦100ã€‘</p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testJDBCTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 1.è·å–æ•°æ®åº“è¿æ¥</span>        conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 2.å¼€å¯äº‹åŠ¡</span>        conn<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 3.è¿›è¡Œæ•°æ®åº“æ“ä½œ</span>        String sql1 <span class="token operator">=</span> <span class="token string">"update user_table set balance = balance - 100 where user = ?"</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql1<span class="token punctuation">,</span> <span class="token string">"AA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// æ¨¡æ‹Ÿç½‘ç»œå¼‚å¸¸</span>        <span class="token comment" spellcheck="true">//System.out.println(10 / 0);</span>        String sql2 <span class="token operator">=</span> <span class="token string">"update user_table set balance = balance + 100 where user = ?"</span><span class="token punctuation">;</span>        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql2<span class="token punctuation">,</span> <span class="token string">"BB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 4.è‹¥æ²¡æœ‰å¼‚å¸¸ï¼Œåˆ™æäº¤äº‹åŠ¡</span>        conn<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 5.è‹¥æœ‰å¼‚å¸¸ï¼Œåˆ™å›æ»šäº‹åŠ¡</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            conn<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//6.æ¢å¤æ¯æ¬¡DMLæ“ä½œçš„è‡ªåŠ¨æäº¤åŠŸèƒ½</span>            conn<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">//7.å…³é—­è¿æ¥</span>        JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œå¯¹æ•°æ®åº“æ“ä½œçš„æ–¹æ³•ä¸ºï¼š</p><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ä½¿ç”¨äº‹åŠ¡ä»¥åçš„é€šç”¨çš„å¢åˆ æ”¹æ“ä½œï¼ˆversion 2.0ï¼‰</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span>Connection conn <span class="token punctuation">,</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>    PreparedStatement ps <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 1.è·å–PreparedStatementçš„å®ä¾‹ (æˆ–ï¼šé¢„ç¼–è¯‘sqlè¯­å¥)</span>        ps <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// 2.å¡«å……å ä½ç¬¦</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            ps<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// 3.æ‰§è¡Œsqlè¯­å¥</span>        ps<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// 4.å…³é—­èµ„æº</span>        JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>null<span class="token punctuation">,</span> ps<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-3-äº‹åŠ¡çš„ACIDå±æ€§"><a href="#6-3-äº‹åŠ¡çš„ACIDå±æ€§" class="headerlink" title="6.3 äº‹åŠ¡çš„ACIDå±æ€§"></a>6.3 äº‹åŠ¡çš„ACIDå±æ€§</h3><ol><li><p><strong>åŸå­æ€§ï¼ˆAtomicityï¼‰</strong><br>åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚ </p></li><li><p><strong>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</strong><br>äº‹åŠ¡å¿…é¡»ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜æ¢åˆ°å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚</p></li><li><p><strong>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</strong><br>äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ï¼Œå³ä¸€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„æ•°æ®å¯¹å¹¶å‘çš„å…¶ä»–äº‹åŠ¡æ˜¯éš”ç¦»çš„ï¼Œå¹¶å‘æ‰§è¡Œçš„å„ä¸ªäº‹åŠ¡ä¹‹é—´ä¸èƒ½äº’ç›¸å¹²æ‰°ã€‚</p></li><li><p><strong>æŒä¹…æ€§ï¼ˆDurabilityï¼‰</strong><br>æŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œæ¥ä¸‹æ¥çš„å…¶ä»–æ“ä½œå’Œæ•°æ®åº“æ•…éšœä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“ã€‚</p></li></ol><h4 id="6-3-1-æ•°æ®åº“çš„å¹¶å‘é—®é¢˜"><a href="#6-3-1-æ•°æ®åº“çš„å¹¶å‘é—®é¢˜" class="headerlink" title="6.3.1 æ•°æ®åº“çš„å¹¶å‘é—®é¢˜"></a>6.3.1 æ•°æ®åº“çš„å¹¶å‘é—®é¢˜</h4><ul><li><p>å¯¹äºåŒæ—¶è¿è¡Œçš„å¤šä¸ªäº‹åŠ¡, å½“è¿™äº›äº‹åŠ¡è®¿é—®æ•°æ®åº“ä¸­ç›¸åŒçš„æ•°æ®æ—¶, å¦‚æœæ²¡æœ‰é‡‡å–å¿…è¦çš„éš”ç¦»æœºåˆ¶, å°±ä¼šå¯¼è‡´å„ç§å¹¶å‘é—®é¢˜:</p><ul><li><strong>è„è¯»</strong>: å¯¹äºä¸¤ä¸ªäº‹åŠ¡ T1, T2, T1 è¯»å–äº†å·²ç»è¢« T2 æ›´æ–°ä½†è¿˜<strong>æ²¡æœ‰è¢«æäº¤</strong>çš„å­—æ®µã€‚ä¹‹å, è‹¥ T2 å›æ»š, T1è¯»å–çš„å†…å®¹å°±æ˜¯ä¸´æ—¶ä¸”æ— æ•ˆçš„ã€‚</li><li><strong>ä¸å¯é‡å¤è¯»</strong>: å¯¹äºä¸¤ä¸ªäº‹åŠ¡T1, T2, T1 è¯»å–äº†ä¸€ä¸ªå­—æ®µ, ç„¶å T2 <strong>æ›´æ–°</strong>äº†è¯¥å­—æ®µã€‚ä¹‹å, T1å†æ¬¡è¯»å–åŒä¸€ä¸ªå­—æ®µ, å€¼å°±ä¸åŒäº†ã€‚</li><li><strong>å¹»è¯»</strong>: å¯¹äºä¸¤ä¸ªäº‹åŠ¡T1, T2, T1 ä»ä¸€ä¸ªè¡¨ä¸­è¯»å–äº†ä¸€ä¸ªå­—æ®µ, ç„¶å T2 åœ¨è¯¥è¡¨ä¸­<strong>æ’å…¥</strong>äº†ä¸€äº›æ–°çš„è¡Œã€‚ä¹‹å, å¦‚æœ T1 å†æ¬¡è¯»å–åŒä¸€ä¸ªè¡¨, å°±ä¼šå¤šå‡ºå‡ è¡Œã€‚</li></ul></li><li><p><strong>æ•°æ®åº“äº‹åŠ¡çš„éš”ç¦»æ€§</strong>: æ•°æ®åº“ç³»ç»Ÿå¿…é¡»å…·æœ‰éš”ç¦»å¹¶å‘è¿è¡Œå„ä¸ªäº‹åŠ¡çš„èƒ½åŠ›, ä½¿å®ƒä»¬ä¸ä¼šç›¸äº’å½±å“, é¿å…å„ç§å¹¶å‘é—®é¢˜ã€‚</p></li><li><p>ä¸€ä¸ªäº‹åŠ¡ä¸å…¶ä»–äº‹åŠ¡éš”ç¦»çš„ç¨‹åº¦ç§°ä¸ºéš”ç¦»çº§åˆ«ã€‚æ•°æ®åº“è§„å®šäº†å¤šç§äº‹åŠ¡éš”ç¦»çº§åˆ«, ä¸åŒéš”ç¦»çº§åˆ«å¯¹åº”ä¸åŒçš„å¹²æ‰°ç¨‹åº¦, <strong>éš”ç¦»çº§åˆ«è¶Šé«˜, æ•°æ®ä¸€è‡´æ€§å°±è¶Šå¥½, ä½†å¹¶å‘æ€§è¶Šå¼±ã€‚</strong></p></li></ul><h4 id="6-3-2-å››ç§éš”ç¦»çº§åˆ«"><a href="#6-3-2-å››ç§éš”ç¦»çº§åˆ«" class="headerlink" title="6.3.2 å››ç§éš”ç¦»çº§åˆ«"></a>6.3.2 å››ç§éš”ç¦»çº§åˆ«</h4><ul><li><p>æ•°æ®åº“æä¾›çš„4ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š</p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555586275271.png" alt="1555586275271"></p></li><li><p>Oracle æ”¯æŒçš„ 2 ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š<strong>READ COMMITED</strong>, SERIALIZABLEã€‚ Oracle é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º: <strong>READ COMMITED</strong> ã€‚</p></li></ul><ul><li>Mysql æ”¯æŒ 4 ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚Mysql é»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸º: <strong>REPEATABLE READã€‚</strong></li></ul><h4 id="6-3-3-åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«"><a href="#6-3-3-åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«" class="headerlink" title="6.3.3 åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«"></a>6.3.3 åœ¨MySqlä¸­è®¾ç½®éš”ç¦»çº§åˆ«</h4><ul><li><p>æ¯å¯åŠ¨ä¸€ä¸ª mysql ç¨‹åº, å°±ä¼šè·å¾—ä¸€ä¸ªå•ç‹¬çš„æ•°æ®åº“è¿æ¥. æ¯ä¸ªæ•°æ®åº“è¿æ¥éƒ½æœ‰ä¸€ä¸ªå…¨å±€å˜é‡ @@tx_isolation, è¡¨ç¤ºå½“å‰çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚</p></li><li><p>æŸ¥çœ‹å½“å‰çš„éš”ç¦»çº§åˆ«: </p><pre class="line-numbers language-mysql"><code class="language-mysql">SELECT @@tx_isolation;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>è®¾ç½®å½“å‰ mySQL è¿æ¥çš„éš”ç¦»çº§åˆ«:  </p><pre class="line-numbers language-mysql"><code class="language-mysql">set  transaction isolation level read committed;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>è®¾ç½®æ•°æ®åº“ç³»ç»Ÿçš„å…¨å±€çš„éš”ç¦»çº§åˆ«:</p><pre class="line-numbers language-mysql"><code class="language-mysql">set global transaction isolation level read committed;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>è¡¥å……æ“ä½œï¼š</p><ul><li><p>åˆ›å»ºmysqlæ•°æ®åº“ç”¨æˆ·ï¼š</p><pre class="line-numbers language-mysql"><code class="language-mysql">create user tom identified by 'abc123';<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>æˆäºˆæƒé™</p><pre class="line-numbers language-mysql"><code class="language-mysql">#æˆäºˆé€šè¿‡ç½‘ç»œæ–¹å¼ç™»å½•çš„tomç”¨æˆ·ï¼Œå¯¹æ‰€æœ‰åº“æ‰€æœ‰è¡¨çš„å…¨éƒ¨æƒé™ï¼Œå¯†ç è®¾ä¸ºabc123.grant all privileges on *.* to tom@'%'  identified by 'abc123';  #ç»™tomç”¨æˆ·ä½¿ç”¨æœ¬åœ°å‘½ä»¤è¡Œæ–¹å¼ï¼Œæˆäºˆatguigudbè¿™ä¸ªåº“ä¸‹çš„æ‰€æœ‰è¡¨çš„æ’åˆ æ”¹æŸ¥çš„æƒé™ã€‚grant select,insert,delete,update on atguigudb.* to tom@localhost identified by 'abc123'; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li></ul><h2 id="ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»"><a href="#ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»" class="headerlink" title="ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»"></a>ç¬¬7ç« ï¼šDAOåŠç›¸å…³å®ç°ç±»</h2><ul><li>DAOï¼šData Access Objectè®¿é—®æ•°æ®ä¿¡æ¯çš„ç±»å’Œæ¥å£ï¼ŒåŒ…æ‹¬äº†å¯¹æ•°æ®çš„CRUDï¼ˆCreateã€Retrivalã€Updateã€Deleteï¼‰ï¼Œè€Œä¸åŒ…å«ä»»ä½•ä¸šåŠ¡ç›¸å…³çš„ä¿¡æ¯ã€‚æœ‰æ—¶ä¹Ÿç§°ä½œï¼šBaseDAO</li><li>ä½œç”¨ï¼šä¸ºäº†å®ç°åŠŸèƒ½çš„æ¨¡å—åŒ–ï¼Œæ›´æœ‰åˆ©äºä»£ç çš„ç»´æŠ¤å’Œå‡çº§ã€‚</li><li>ä¸‹é¢æ˜¯å°šç¡…è°·JavaWebé˜¶æ®µä¹¦åŸé¡¹ç›®ä¸­DAOä½¿ç”¨çš„ä½“ç°ï¼š</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566726681515.png" alt="1566726681515"></p><ul><li>å±‚æ¬¡ç»“æ„ï¼š</li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555593598606.png" alt="1566745811244"></p><h3 id="ã€BaseDAO-javaã€‘"><a href="#ã€BaseDAO-javaã€‘" class="headerlink" title="ã€BaseDAO.javaã€‘"></a>ã€BaseDAO.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>ParameterizedType<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span>Type<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>SQLException<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>dbutils<span class="token punctuation">.</span>QueryRunner<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>dbutils<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span>BeanHandler<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>dbutils<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span>BeanListHandler<span class="token punctuation">;</span><span class="token keyword">import</span> org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>dbutils<span class="token punctuation">.</span>handlers<span class="token punctuation">.</span>ScalarHandler<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * å®šä¹‰ä¸€ä¸ªç”¨æ¥è¢«ç»§æ‰¿çš„å¯¹æ•°æ®åº“è¿›è¡ŒåŸºæœ¬æ“ä½œçš„Dao *  * @author HanYanBing * * @param &lt;T> */</span><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">BaseDao</span><span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> QueryRunner queryRunner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å®šä¹‰ä¸€ä¸ªå˜é‡æ¥æ¥æ”¶æ³›å‹çš„ç±»å‹</span>    <span class="token keyword">private</span> Class<span class="token operator">&lt;</span>T<span class="token operator">></span> type<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è·å–Tçš„Classå¯¹è±¡ï¼Œè·å–æ³›å‹çš„ç±»å‹ï¼Œæ³›å‹æ˜¯åœ¨è¢«å­ç±»ç»§æ‰¿æ—¶æ‰ç¡®å®š</span>    <span class="token keyword">public</span> <span class="token function">BaseDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è·å–å­ç±»çš„ç±»å‹</span>        Class <span class="token class-name">clazz</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è·å–çˆ¶ç±»çš„ç±»å‹</span>        <span class="token comment" spellcheck="true">// getGenericSuperclass()ç”¨æ¥è·å–å½“å‰ç±»çš„çˆ¶ç±»çš„ç±»å‹</span>        <span class="token comment" spellcheck="true">// ParameterizedTypeè¡¨ç¤ºçš„æ˜¯å¸¦æ³›å‹çš„ç±»å‹</span>        ParameterizedType parameterizedType <span class="token operator">=</span> <span class="token punctuation">(</span>ParameterizedType<span class="token punctuation">)</span> clazz<span class="token punctuation">.</span><span class="token function">getGenericSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è·å–å…·ä½“çš„æ³›å‹ç±»å‹ getActualTypeArgumentsè·å–å…·ä½“çš„æ³›å‹çš„ç±»å‹</span>        <span class="token comment" spellcheck="true">// è¿™ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªTypeçš„æ•°ç»„</span>        Type<span class="token punctuation">[</span><span class="token punctuation">]</span> types <span class="token operator">=</span> parameterizedType<span class="token punctuation">.</span><span class="token function">getActualTypeArguments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è·å–å…·ä½“çš„æ³›å‹çš„ç±»å‹Â·</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token punctuation">(</span>Class<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">)</span> types<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * é€šç”¨çš„å¢åˆ æ”¹æ“ä½œ     *      * @param sql     * @param params     * @return     */</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            count <span class="token operator">=</span> queryRunner<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>         <span class="token keyword">return</span> count<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * è·å–ä¸€ä¸ªå¯¹è±¡     *      * @param sql     * @param params     * @return     */</span>    <span class="token keyword">public</span> T <span class="token function">getBean</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>        T t <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            t <span class="token operator">=</span> queryRunner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BeanHandler</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>         <span class="token keyword">return</span> t<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * è·å–æ‰€æœ‰å¯¹è±¡     *      * @param sql     * @param params     * @return     */</span>    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">getBeanList</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>        List<span class="token operator">&lt;</span>T<span class="token operator">></span> list <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            list <span class="token operator">=</span> queryRunner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">BeanListHandler</span><span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>         <span class="token keyword">return</span> list<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">/**     * è·å–ä¸€ä¸ªä½†ä¸€å€¼å¾—æ–¹æ³•ï¼Œä¸“é—¨ç”¨æ¥æ‰§è¡Œåƒ select count(*)...è¿™æ ·çš„sqlè¯­å¥     *      * @param sql     * @param params     * @return     */</span>    <span class="token keyword">public</span> Object <span class="token function">getValue</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String sql<span class="token punctuation">,</span> Object<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>        Object count <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// è°ƒç”¨queryRunnerçš„queryæ–¹æ³•è·å–ä¸€ä¸ªå•ä¸€çš„å€¼</span>            count <span class="token operator">=</span> queryRunner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ScalarHandler</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>         <span class="token keyword">return</span> count<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ã€BookDAO-javaã€‘"><a href="#ã€BookDAO-javaã€‘" class="headerlink" title="ã€BookDAO.javaã€‘"></a>ã€BookDAO.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>Book<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>Page<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BookDao</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**     * ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºæ‰€æœ‰çš„è®°å½•     *      * @return     */</span>    List<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getBooks</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * å‘æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•     *      * @param book     */</span>    <span class="token keyword">void</span> <span class="token function">saveBook</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Book book<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * ä»æ•°æ®åº“ä¸­æ ¹æ®å›¾ä¹¦çš„idåˆ é™¤ä¸€æ¡è®°å½•     *      * @param bookId     */</span>    <span class="token keyword">void</span> <span class="token function">deleteBookById</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * æ ¹æ®å›¾ä¹¦çš„idä»æ•°æ®åº“ä¸­æŸ¥è¯¢å‡ºä¸€æ¡è®°å½•     *      * @param bookId     * @return     */</span>    Book <span class="token function">getBookById</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * æ ¹æ®å›¾ä¹¦çš„idä»æ•°æ®åº“ä¸­æ›´æ–°ä¸€æ¡è®°å½•     *      * @param book     */</span>    <span class="token keyword">void</span> <span class="token function">updateBook</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Book book<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * è·å–å¸¦åˆ†é¡µçš„å›¾ä¹¦ä¿¡æ¯     *      * @param pageï¼šæ˜¯åªåŒ…å«äº†ç”¨æˆ·è¾“å…¥çš„pageNoå±æ€§çš„pageå¯¹è±¡     * @return è¿”å›çš„Pageå¯¹è±¡æ˜¯åŒ…å«äº†æ‰€æœ‰å±æ€§çš„Pageå¯¹è±¡     */</span>    Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getPageBooks</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> page<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * è·å–å¸¦åˆ†é¡µå’Œä»·æ ¼èŒƒå›´çš„å›¾ä¹¦ä¿¡æ¯     *      * @param pageï¼šæ˜¯åªåŒ…å«äº†ç”¨æˆ·è¾“å…¥çš„pageNoå±æ€§çš„pageå¯¹è±¡     * @return è¿”å›çš„Pageå¯¹è±¡æ˜¯åŒ…å«äº†æ‰€æœ‰å±æ€§çš„Pageå¯¹è±¡     */</span>    Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getPageBooksByPrice</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> page<span class="token punctuation">,</span> <span class="token keyword">double</span> minPrice<span class="token punctuation">,</span> <span class="token keyword">double</span> maxPrice<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ã€UserDAO-javaã€‘"><a href="#ã€UserDAO-javaã€‘" class="headerlink" title="ã€UserDAO.javaã€‘"></a>ã€UserDAO.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>User<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/**     * æ ¹æ®Userå¯¹è±¡ä¸­çš„ç”¨æˆ·åå’Œå¯†ç ä»æ•°æ®åº“ä¸­è·å–ä¸€æ¡è®°å½•     *      * @param user     * @return User æ•°æ®åº“ä¸­æœ‰è®°å½• null æ•°æ®åº“ä¸­æ— æ­¤è®°å½•     */</span>    User <span class="token function">getUser</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * æ ¹æ®Userå¯¹è±¡ä¸­çš„ç”¨æˆ·åä»æ•°æ®åº“ä¸­è·å–ä¸€æ¡è®°å½•     *      * @param user     * @return true æ•°æ®åº“ä¸­æœ‰è®°å½• false æ•°æ®åº“ä¸­æ— æ­¤è®°å½•     */</span>    <span class="token keyword">boolean</span> <span class="token function">checkUsername</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/**     * å‘æ•°æ®åº“ä¸­æ’å…¥Userå¯¹è±¡     *      * @param user     */</span>    <span class="token keyword">void</span> <span class="token function">saveUser</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ã€BookDaoImpl-javaã€‘"><a href="#ã€BookDaoImpl-javaã€‘" class="headerlink" title="ã€BookDaoImpl.javaã€‘"></a>ã€BookDaoImpl.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>impl<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>Book<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>Page<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>BaseDao<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>BookDao<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookDaoImpl</span> <span class="token keyword">extends</span> <span class="token class-name">BaseDao</span><span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">BookDao</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getBooks</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­å¾—åˆ°ä¸€ä¸ªListçš„æ–¹æ³•</span>        List<span class="token operator">&lt;</span>Book<span class="token operator">></span> beanList <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>        String sql <span class="token operator">=</span> <span class="token string">"select id,title,author,price,sales,stock,img_path imgPath from books"</span><span class="token punctuation">;</span>        beanList <span class="token operator">=</span> <span class="token function">getBeanList</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> beanList<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveBook</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Book book<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>        String sql <span class="token operator">=</span> <span class="token string">"insert into books(title,author,price,sales,stock,img_path) values(?,?,?,?,?,?)"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­é€šç”¨çš„å¢åˆ æ”¹çš„æ–¹æ³•</span>        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getAuthor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getSales</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getStock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>book<span class="token punctuation">.</span><span class="token function">getImgPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteBookById</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String bookId<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>        String sql <span class="token operator">=</span> <span class="token string">"DELETE FROM books WHERE id = ?"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­é€šç”¨å¢åˆ æ”¹çš„æ–¹æ³•</span>        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> Book <span class="token function">getBookById</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>String bookId<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</span>        Book book <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>        String sql <span class="token operator">=</span> <span class="token string">"select id,title,author,price,sales,stock,img_path imgPath from books where id = ?"</span><span class="token punctuation">;</span>        book <span class="token operator">=</span> <span class="token function">getBean</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> bookId<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> book<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateBook</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Book book<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>        String sql <span class="token operator">=</span> <span class="token string">"update books set title = ? , author = ? , price = ? , sales = ? , stock = ? where id = ?"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­é€šç”¨çš„å¢åˆ æ”¹çš„æ–¹æ³•</span>        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getAuthor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getSales</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getStock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> book<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getPageBooks</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> page<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è·å–æ•°æ®åº“ä¸­å›¾ä¹¦çš„æ€»è®°å½•æ•°</span>        String sql <span class="token operator">=</span> <span class="token string">"select count(*) from books"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå•ä¸€å€¼çš„æ–¹æ³•</span>        <span class="token keyword">long</span> totalRecord <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token function">getValue</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å°†æ€»è®°å½•æ•°è®¾ç½®éƒ½pageå¯¹è±¡ä¸­</span>        page<span class="token punctuation">.</span><span class="token function">setTotalRecord</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> totalRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è·å–å½“å‰é¡µä¸­çš„è®°å½•å­˜æ”¾çš„List</span>        String sql2 <span class="token operator">=</span> <span class="token string">"select id,title,author,price,sales,stock,img_path imgPath from books limit ?,?"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªé›†åˆçš„æ–¹æ³•</span>        List<span class="token operator">&lt;</span>Book<span class="token operator">></span> beanList <span class="token operator">=</span> <span class="token function">getBeanList</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql2<span class="token punctuation">,</span> <span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">getPageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> Page<span class="token punctuation">.</span>PAGE_SIZE<span class="token punctuation">,</span> Page<span class="token punctuation">.</span>PAGE_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å°†è¿™ä¸ªListè®¾ç½®åˆ°pageå¯¹è±¡ä¸­</span>        page<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>beanList<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> page<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> <span class="token function">getPageBooksByPrice</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>Page<span class="token operator">&lt;</span>Book<span class="token operator">></span> page<span class="token punctuation">,</span> <span class="token keyword">double</span> minPrice<span class="token punctuation">,</span> <span class="token keyword">double</span> maxPrice<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è·å–æ•°æ®åº“ä¸­å›¾ä¹¦çš„æ€»è®°å½•æ•°</span>        String sql <span class="token operator">=</span> <span class="token string">"select count(*) from books where price between ? and ?"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå•ä¸€å€¼çš„æ–¹æ³•</span>        <span class="token keyword">long</span> totalRecord <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> <span class="token function">getValue</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span>minPrice<span class="token punctuation">,</span>maxPrice<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å°†æ€»è®°å½•æ•°è®¾ç½®éƒ½pageå¯¹è±¡ä¸­</span>        page<span class="token punctuation">.</span><span class="token function">setTotalRecord</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> totalRecord<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è·å–å½“å‰é¡µä¸­çš„è®°å½•å­˜æ”¾çš„List</span>        String sql2 <span class="token operator">=</span> <span class="token string">"select id,title,author,price,sales,stock,img_path imgPath from books where price between ? and ? limit ?,?"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªé›†åˆçš„æ–¹æ³•</span>        List<span class="token operator">&lt;</span>Book<span class="token operator">></span> beanList <span class="token operator">=</span> <span class="token function">getBeanList</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql2<span class="token punctuation">,</span> minPrice <span class="token punctuation">,</span> maxPrice <span class="token punctuation">,</span> <span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">getPageNo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> Page<span class="token punctuation">.</span>PAGE_SIZE<span class="token punctuation">,</span> Page<span class="token punctuation">.</span>PAGE_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å°†è¿™ä¸ªListè®¾ç½®åˆ°pageå¯¹è±¡ä¸­</span>        page<span class="token punctuation">.</span><span class="token function">setList</span><span class="token punctuation">(</span>beanList<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> page<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ã€UserDaoImpl-javaã€‘"><a href="#ã€UserDaoImpl-javaã€‘" class="headerlink" title="ã€UserDaoImpl.javaã€‘"></a>ã€UserDaoImpl.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>impl<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>User<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>BaseDao<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>UserDao<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDaoImpl</span> <span class="token keyword">extends</span> <span class="token class-name">BaseDao</span><span class="token operator">&lt;</span>User<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">UserDao</span> <span class="token punctuation">{</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> User <span class="token function">getUser</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</span>        User bean <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>        String sql <span class="token operator">=</span> <span class="token string">"select id,username,password,email from users where username = ? and password = ?"</span><span class="token punctuation">;</span>        bean <span class="token operator">=</span> <span class="token function">getBean</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> bean<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">checkUsername</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// è°ƒç”¨BaseDaoä¸­è·å–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</span>        User bean <span class="token operator">=</span> null<span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å†™sqlè¯­å¥</span>        String sql <span class="token operator">=</span> <span class="token string">"select id,username,password,email from users where username = ?"</span><span class="token punctuation">;</span>        bean <span class="token operator">=</span> <span class="token function">getBean</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> bean <span class="token operator">!=</span> null<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveUser</span><span class="token punctuation">(</span>Connection conn<span class="token punctuation">,</span>User user<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//å†™sqlè¯­å¥</span>        String sql <span class="token operator">=</span> <span class="token string">"insert into users(username,password,email) values(?,?,?)"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//è°ƒç”¨BaseDaoä¸­é€šç”¨çš„å¢åˆ æ”¹çš„æ–¹æ³•</span>        <span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span>sql<span class="token punctuation">,</span> user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>user<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ã€Book-javaã€‘"><a href="#ã€Book-javaã€‘" class="headerlink" title="ã€Book.javaã€‘"></a>ã€Book.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * å›¾ä¹¦ç±» * @author songhongkang * */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> Integer id<span class="token punctuation">;</span>    <span class="token keyword">private</span> String title<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ä¹¦å</span>    <span class="token keyword">private</span> String author<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ä½œè€…</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> price<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ä»·æ ¼</span>    <span class="token keyword">private</span> Integer sales<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// é”€é‡</span>    <span class="token keyword">private</span> Integer stock<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// åº“å­˜</span>    <span class="token keyword">private</span> String imgPath <span class="token operator">=</span> <span class="token string">"static/img/default.jpg"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å°é¢å›¾ç‰‡çš„è·¯å¾„</span>    <span class="token comment" spellcheck="true">//æ„é€ å™¨ï¼Œget()ï¼Œset()ï¼ŒtoString()æ–¹æ³•ç•¥</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ã€Page-javaã€‘"><a href="#ã€Page-javaã€‘" class="headerlink" title="ã€Page.javaã€‘"></a>ã€Page.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * é¡µç ç±» * @author songhongkang * */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Page</span><span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> List<span class="token operator">&lt;</span>T<span class="token operator">></span> list<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ¯é¡µæŸ¥åˆ°çš„è®°å½•å­˜æ”¾çš„é›†åˆ</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> PAGE_SIZE <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ¯é¡µæ˜¾ç¤ºçš„è®°å½•æ•°</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> pageNo<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å½“å‰é¡µ</span><span class="token comment" spellcheck="true">//    private int totalPageNo; // æ€»é¡µæ•°ï¼Œé€šè¿‡è®¡ç®—å¾—åˆ°</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> totalRecord<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ€»è®°å½•æ•°ï¼Œé€šè¿‡æŸ¥è¯¢æ•°æ®åº“å¾—åˆ°</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ã€User-javaã€‘"><a href="#ã€User-javaã€‘" class="headerlink" title="ã€User.javaã€‘"></a>ã€User.javaã€‘</h3><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>bookstore<span class="token punctuation">.</span>beans<span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** * ç”¨æˆ·ç±» * @author songhongkang * */</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>    <span class="token keyword">private</span> Integer id<span class="token punctuation">;</span>    <span class="token keyword">private</span> String username<span class="token punctuation">;</span>    <span class="token keyword">private</span> String password<span class="token punctuation">;</span>    <span class="token keyword">private</span> String email<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± "><a href="#ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± " class="headerlink" title="ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± "></a>ç¬¬8ç« ï¼šæ•°æ®åº“è¿æ¥æ± </h2><h3 id="8-1-JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§"><a href="#8-1-JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§" class="headerlink" title="8.1 JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§"></a>8.1 JDBCæ•°æ®åº“è¿æ¥æ± çš„å¿…è¦æ€§</h3><ul><li><p>åœ¨ä½¿ç”¨å¼€å‘åŸºäºæ•°æ®åº“çš„webç¨‹åºæ—¶ï¼Œä¼ ç»Ÿçš„æ¨¡å¼åŸºæœ¬æ˜¯æŒ‰ä»¥ä¸‹æ­¥éª¤ï¼šã€€ã€€</p><ul><li><strong>åœ¨ä¸»ç¨‹åºï¼ˆå¦‚servletã€beansï¼‰ä¸­å»ºç«‹æ•°æ®åº“è¿æ¥</strong></li><li><strong>è¿›è¡Œsqlæ“ä½œ</strong></li><li><strong>æ–­å¼€æ•°æ®åº“è¿æ¥</strong></li></ul></li><li><p>è¿™ç§æ¨¡å¼å¼€å‘ï¼Œå­˜åœ¨çš„é—®é¢˜:</p><ul><li>æ™®é€šçš„JDBCæ•°æ®åº“è¿æ¥ä½¿ç”¨ DriverManager æ¥è·å–ï¼Œæ¯æ¬¡å‘æ•°æ®åº“å»ºç«‹è¿æ¥çš„æ—¶å€™éƒ½è¦å°† Connection åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå†éªŒè¯ç”¨æˆ·åå’Œå¯†ç (å¾—èŠ±è´¹0.05sï½1sçš„æ—¶é—´)ã€‚éœ€è¦æ•°æ®åº“è¿æ¥çš„æ—¶å€™ï¼Œå°±å‘æ•°æ®åº“è¦æ±‚ä¸€ä¸ªï¼Œæ‰§è¡Œå®Œæˆåå†æ–­å¼€è¿æ¥ã€‚è¿™æ ·çš„æ–¹å¼å°†ä¼šæ¶ˆè€—å¤§é‡çš„èµ„æºå’Œæ—¶é—´ã€‚<strong>æ•°æ®åº“çš„è¿æ¥èµ„æºå¹¶æ²¡æœ‰å¾—åˆ°å¾ˆå¥½çš„é‡å¤åˆ©ç”¨ã€‚</strong>è‹¥åŒæ—¶æœ‰å‡ ç™¾äººç”šè‡³å‡ åƒäººåœ¨çº¿ï¼Œé¢‘ç¹çš„è¿›è¡Œæ•°æ®åº“è¿æ¥æ“ä½œå°†å ç”¨å¾ˆå¤šçš„ç³»ç»Ÿèµ„æºï¼Œä¸¥é‡çš„ç”šè‡³ä¼šé€ æˆæœåŠ¡å™¨çš„å´©æºƒã€‚</li><li><strong>å¯¹äºæ¯ä¸€æ¬¡æ•°æ®åº“è¿æ¥ï¼Œä½¿ç”¨å®Œåéƒ½å¾—æ–­å¼€ã€‚</strong>å¦åˆ™ï¼Œå¦‚æœç¨‹åºå‡ºç°å¼‚å¸¸è€Œæœªèƒ½å…³é—­ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®åº“ç³»ç»Ÿä¸­çš„å†…å­˜æ³„æ¼ï¼Œæœ€ç»ˆå°†å¯¼è‡´é‡å¯æ•°æ®åº“ã€‚ï¼ˆå›å¿†ï¼šä½•ä¸ºJavaçš„å†…å­˜æ³„æ¼ï¼Ÿï¼‰</li><li><strong>è¿™ç§å¼€å‘ä¸èƒ½æ§åˆ¶è¢«åˆ›å»ºçš„è¿æ¥å¯¹è±¡æ•°</strong>ï¼Œç³»ç»Ÿèµ„æºä¼šè¢«æ¯«æ— é¡¾åŠçš„åˆ†é…å‡ºå»ï¼Œå¦‚è¿æ¥è¿‡å¤šï¼Œä¹Ÿå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼ï¼ŒæœåŠ¡å™¨å´©æºƒã€‚ </li></ul></li></ul><h3 id="8-2-æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯"><a href="#8-2-æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯" class="headerlink" title="8.2 æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯"></a>8.2 æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯</h3><ul><li><p>ä¸ºè§£å†³ä¼ ç»Ÿå¼€å‘ä¸­çš„æ•°æ®åº“è¿æ¥é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯ã€‚</p></li><li><p><strong>æ•°æ®åº“è¿æ¥æ± çš„åŸºæœ¬æ€æƒ³</strong>ï¼šå°±æ˜¯ä¸ºæ•°æ®åº“è¿æ¥å»ºç«‹ä¸€ä¸ªâ€œç¼“å†²æ± â€ã€‚é¢„å…ˆåœ¨ç¼“å†²æ± ä¸­æ”¾å…¥ä¸€å®šæ•°é‡çš„è¿æ¥ï¼Œå½“éœ€è¦å»ºç«‹æ•°æ®åº“è¿æ¥æ—¶ï¼Œåªéœ€ä»â€œç¼“å†²æ± â€ä¸­å–å‡ºä¸€ä¸ªï¼Œä½¿ç”¨å®Œæ¯•ä¹‹åå†æ”¾å›å»ã€‚</p></li><li><p><strong>æ•°æ®åº“è¿æ¥æ± </strong>è´Ÿè´£åˆ†é…ã€ç®¡ç†å’Œé‡Šæ”¾æ•°æ®åº“è¿æ¥ï¼Œå®ƒ<strong>å…è®¸åº”ç”¨ç¨‹åºé‡å¤ä½¿ç”¨ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥ï¼Œè€Œä¸æ˜¯é‡æ–°å»ºç«‹ä¸€ä¸ª</strong>ã€‚</p></li><li><p>æ•°æ®åº“è¿æ¥æ± åœ¨åˆå§‹åŒ–æ—¶å°†åˆ›å»ºä¸€å®šæ•°é‡çš„æ•°æ®åº“è¿æ¥æ”¾åˆ°è¿æ¥æ± ä¸­ï¼Œè¿™äº›æ•°æ®åº“è¿æ¥çš„æ•°é‡æ˜¯ç”±<strong>æœ€å°æ•°æ®åº“è¿æ¥æ•°æ¥è®¾å®š</strong>çš„ã€‚æ— è®ºè¿™äº›æ•°æ®åº“è¿æ¥æ˜¯å¦è¢«ä½¿ç”¨ï¼Œè¿æ¥æ± éƒ½å°†ä¸€ç›´ä¿è¯è‡³å°‘æ‹¥æœ‰è¿™ä¹ˆå¤šçš„è¿æ¥æ•°é‡ã€‚è¿æ¥æ± çš„<strong>æœ€å¤§æ•°æ®åº“è¿æ¥æ•°é‡</strong>é™å®šäº†è¿™ä¸ªè¿æ¥æ± èƒ½å æœ‰çš„æœ€å¤§è¿æ¥æ•°ï¼Œå½“åº”ç”¨ç¨‹åºå‘è¿æ¥æ± è¯·æ±‚çš„è¿æ¥æ•°è¶…è¿‡æœ€å¤§è¿æ¥æ•°é‡æ—¶ï¼Œè¿™äº›è¯·æ±‚å°†è¢«åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</p></li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555593464033.png" alt="1555593464033"></p><ul><li><strong>å·¥ä½œåŸç†ï¼š</strong></li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1566745811244.png" alt="1555593598606"></p><ul><li><p><strong>æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯çš„ä¼˜ç‚¹</strong></p><p><strong>1. èµ„æºé‡ç”¨</strong></p><p>ç”±äºæ•°æ®åº“è¿æ¥å¾—ä»¥é‡ç”¨ï¼Œé¿å…äº†é¢‘ç¹åˆ›å»ºï¼Œé‡Šæ”¾è¿æ¥å¼•èµ·çš„å¤§é‡æ€§èƒ½å¼€é”€ã€‚åœ¨å‡å°‘ç³»ç»Ÿæ¶ˆè€—çš„åŸºç¡€ä¸Šï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¢åŠ äº†ç³»ç»Ÿè¿è¡Œç¯å¢ƒçš„å¹³ç¨³æ€§ã€‚</p><p><strong>2. æ›´å¿«çš„ç³»ç»Ÿååº”é€Ÿåº¦</strong></p><p>æ•°æ®åº“è¿æ¥æ± åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€å·²ç»åˆ›å»ºäº†è‹¥å¹²æ•°æ®åº“è¿æ¥ç½®äºè¿æ¥æ± ä¸­å¤‡ç”¨ã€‚æ­¤æ—¶è¿æ¥çš„åˆå§‹åŒ–å·¥ä½œå‡å·²å®Œæˆã€‚å¯¹äºä¸šåŠ¡è¯·æ±‚å¤„ç†è€Œè¨€ï¼Œç›´æ¥åˆ©ç”¨ç°æœ‰å¯ç”¨è¿æ¥ï¼Œé¿å…äº†æ•°æ®åº“è¿æ¥åˆå§‹åŒ–å’Œé‡Šæ”¾è¿‡ç¨‹çš„æ—¶é—´å¼€é”€ï¼Œä»è€Œå‡å°‘äº†ç³»ç»Ÿçš„å“åº”æ—¶é—´</p><p><strong>3. æ–°çš„èµ„æºåˆ†é…æ‰‹æ®µ</strong></p><p>å¯¹äºå¤šåº”ç”¨å…±äº«åŒä¸€æ•°æ®åº“çš„ç³»ç»Ÿè€Œè¨€ï¼Œå¯åœ¨åº”ç”¨å±‚é€šè¿‡æ•°æ®åº“è¿æ¥æ± çš„é…ç½®ï¼Œå®ç°æŸä¸€åº”ç”¨æœ€å¤§å¯ç”¨æ•°æ®åº“è¿æ¥æ•°çš„é™åˆ¶ï¼Œé¿å…æŸä¸€åº”ç”¨ç‹¬å æ‰€æœ‰çš„æ•°æ®åº“èµ„æº</p><p><strong>4. ç»Ÿä¸€çš„è¿æ¥ç®¡ç†ï¼Œé¿å…æ•°æ®åº“è¿æ¥æ³„æ¼</strong></p><p>åœ¨è¾ƒä¸ºå®Œå–„çš„æ•°æ®åº“è¿æ¥æ± å®ç°ä¸­ï¼Œå¯æ ¹æ®é¢„å…ˆçš„å ç”¨è¶…æ—¶è®¾å®šï¼Œå¼ºåˆ¶å›æ”¶è¢«å ç”¨è¿æ¥ï¼Œä»è€Œé¿å…äº†å¸¸è§„æ•°æ®åº“è¿æ¥æ“ä½œä¸­å¯èƒ½å‡ºç°çš„èµ„æºæ³„éœ²</p></li></ul><h3 id="8-3-å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± "><a href="#8-3-å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3 å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± "></a>8.3 å¤šç§å¼€æºçš„æ•°æ®åº“è¿æ¥æ± </h3><ul><li>JDBC çš„æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ javax.sql.DataSource æ¥è¡¨ç¤ºï¼ŒDataSource åªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£é€šå¸¸ç”±æœåŠ¡å™¨(Weblogic, WebSphere, Tomcat)æä¾›å®ç°ï¼Œä¹Ÿæœ‰ä¸€äº›å¼€æºç»„ç»‡æä¾›å®ç°ï¼š<ul><li><strong>DBCP</strong> æ˜¯Apacheæä¾›çš„æ•°æ®åº“è¿æ¥æ± ã€‚tomcat æœåŠ¡å™¨è‡ªå¸¦dbcpæ•°æ®åº“è¿æ¥æ± ã€‚<strong>é€Ÿåº¦ç›¸å¯¹c3p0è¾ƒå¿«</strong>ï¼Œä½†å› è‡ªèº«å­˜åœ¨BUGï¼ŒHibernate3å·²ä¸å†æä¾›æ”¯æŒã€‚</li><li><strong>C3P0</strong> æ˜¯ä¸€ä¸ªå¼€æºç»„ç»‡æä¾›çš„ä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± ï¼Œ<strong>é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œç¨³å®šæ€§è¿˜å¯ä»¥ã€‚</strong>hibernateå®˜æ–¹æ¨èä½¿ç”¨</li><li><strong>Proxool</strong> æ˜¯sourceforgeä¸‹çš„ä¸€ä¸ªå¼€æºé¡¹ç›®æ•°æ®åº“è¿æ¥æ± ï¼Œæœ‰ç›‘æ§è¿æ¥æ± çŠ¶æ€çš„åŠŸèƒ½ï¼Œ<strong>ç¨³å®šæ€§è¾ƒc3p0å·®ä¸€ç‚¹</strong></li><li><strong>BoneCP</strong> æ˜¯ä¸€ä¸ªå¼€æºç»„ç»‡æä¾›çš„æ•°æ®åº“è¿æ¥æ± ï¼Œé€Ÿåº¦å¿«</li><li><strong>Druid</strong> æ˜¯é˜¿é‡Œæä¾›çš„æ•°æ®åº“è¿æ¥æ± ï¼Œæ®è¯´æ˜¯é›†DBCP ã€C3P0 ã€Proxool ä¼˜ç‚¹äºä¸€èº«çš„æ•°æ®åº“è¿æ¥æ± ï¼Œä½†æ˜¯é€Ÿåº¦ä¸ç¡®å®šæ˜¯å¦æœ‰BoneCPå¿«</li></ul></li><li>DataSource é€šå¸¸è¢«ç§°ä¸ºæ•°æ®æºï¼Œå®ƒåŒ…å«è¿æ¥æ± å’Œè¿æ¥æ± ç®¡ç†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¹ æƒ¯ä¸Šä¹Ÿç»å¸¸æŠŠ DataSource ç§°ä¸ºè¿æ¥æ± </li><li><strong>DataSourceç”¨æ¥å–ä»£DriverManageræ¥è·å–Connectionï¼Œè·å–é€Ÿåº¦å¿«ï¼ŒåŒæ—¶å¯ä»¥å¤§å¹…åº¦æé«˜æ•°æ®åº“è®¿é—®é€Ÿåº¦ã€‚</strong></li><li>ç‰¹åˆ«æ³¨æ„ï¼š<ul><li>æ•°æ®æºå’Œæ•°æ®åº“è¿æ¥ä¸åŒï¼Œæ•°æ®æºæ— éœ€åˆ›å»ºå¤šä¸ªï¼Œå®ƒæ˜¯äº§ç”Ÿæ•°æ®åº“è¿æ¥çš„å·¥å‚ï¼Œå› æ­¤<strong>æ•´ä¸ªåº”ç”¨åªéœ€è¦ä¸€ä¸ªæ•°æ®æºå³å¯ã€‚</strong></li><li>å½“æ•°æ®åº“è®¿é—®ç»“æŸåï¼Œç¨‹åºè¿˜æ˜¯åƒä»¥å‰ä¸€æ ·å…³é—­æ•°æ®åº“è¿æ¥ï¼šconn.close(); ä½†conn.close()å¹¶æ²¡æœ‰å…³é—­æ•°æ®åº“çš„ç‰©ç†è¿æ¥ï¼Œå®ƒä»…ä»…æŠŠæ•°æ®åº“è¿æ¥é‡Šæ”¾ï¼Œå½’è¿˜ç»™äº†æ•°æ®åº“è¿æ¥æ± ã€‚</li></ul></li></ul><h4 id="8-3-1-C3P0æ•°æ®åº“è¿æ¥æ± "><a href="#8-3-1-C3P0æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3.1 C3P0æ•°æ®åº“è¿æ¥æ± "></a>8.3.1 C3P0æ•°æ®åº“è¿æ¥æ± </h4><ul><li>è·å–è¿æ¥æ–¹å¼ä¸€</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ä½¿ç”¨C3P0æ•°æ®åº“è¿æ¥æ± çš„æ–¹å¼ï¼Œè·å–æ•°æ®åº“çš„è¿æ¥ï¼šä¸æ¨è</span><span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    ComboPooledDataSource cpds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComboPooledDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cpds<span class="token punctuation">.</span><span class="token function">setDriverClass</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     cpds<span class="token punctuation">.</span><span class="token function">setJdbcUrl</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql://localhost:3306/test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cpds<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    cpds<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"abc123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//    cpds.setMaxPoolSize(100);</span>    Connection conn <span class="token operator">=</span> cpds<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> conn<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è·å–è¿æ¥æ–¹å¼äºŒ</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ä½¿ç”¨C3P0æ•°æ®åº“è¿æ¥æ± çš„é…ç½®æ–‡ä»¶æ–¹å¼ï¼Œè·å–æ•°æ®åº“çš„è¿æ¥ï¼šæ¨è</span><span class="token keyword">private</span> <span class="token keyword">static</span> DataSource cpds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComboPooledDataSource</span><span class="token punctuation">(</span><span class="token string">"helloc3p0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException<span class="token punctuation">{</span>    Connection conn <span class="token operator">=</span> cpds<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> conn<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œsrcä¸‹çš„é…ç½®æ–‡ä»¶ä¸ºï¼šã€c3p0-config.xmlã€‘</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>c3p0-config</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>named-config</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>helloc3p0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- è·å–è¿æ¥çš„4ä¸ªåŸºæœ¬ä¿¡æ¯ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>abc123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>jdbcUrl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>jdbc:mysql:///test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>driverClass<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>com.mysql.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æ¶‰åŠåˆ°æ•°æ®åº“è¿æ¥æ± çš„ç®¡ç†çš„ç›¸å…³å±æ€§çš„è®¾ç½® --></span>        <span class="token comment" spellcheck="true">&lt;!-- è‹¥æ•°æ®åº“ä¸­è¿æ¥æ•°ä¸è¶³æ—¶, ä¸€æ¬¡å‘æ•°æ®åº“æœåŠ¡å™¨ç”³è¯·å¤šå°‘ä¸ªè¿æ¥ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>acquireIncrement<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- åˆå§‹åŒ–æ•°æ®åº“è¿æ¥æ± æ—¶è¿æ¥çš„æ•°é‡ --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>initialPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æ•°æ®åº“è¿æ¥æ± ä¸­çš„æœ€å°çš„æ•°æ®åº“è¿æ¥æ•° --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>minPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æ•°æ®åº“è¿æ¥æ± ä¸­çš„æœ€å¤§çš„æ•°æ®åº“è¿æ¥æ•° --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxPoolSize<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- C3P0 æ•°æ®åº“è¿æ¥æ± å¯ä»¥ç»´æŠ¤çš„ Statement çš„ä¸ªæ•° --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxStatements<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>20<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>        <span class="token comment" spellcheck="true">&lt;!-- æ¯ä¸ªè¿æ¥åŒæ—¶å¯ä»¥ä½¿ç”¨çš„ Statement å¯¹è±¡çš„ä¸ªæ•° --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>maxStatementsPerConnection<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>named-config</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>c3p0-config</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="8-3-2-DBCPæ•°æ®åº“è¿æ¥æ± "><a href="#8-3-2-DBCPæ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3.2 DBCPæ•°æ®åº“è¿æ¥æ± "></a>8.3.2 DBCPæ•°æ®åº“è¿æ¥æ± </h4><ul><li>DBCP æ˜¯ Apache è½¯ä»¶åŸºé‡‘ç»„ç»‡ä¸‹çš„å¼€æºè¿æ¥æ± å®ç°ï¼Œè¯¥è¿æ¥æ± ä¾èµ–è¯¥ç»„ç»‡ä¸‹çš„å¦ä¸€ä¸ªå¼€æºç³»ç»Ÿï¼šCommon-poolã€‚å¦‚éœ€ä½¿ç”¨è¯¥è¿æ¥æ± å®ç°ï¼Œåº”åœ¨ç³»ç»Ÿä¸­å¢åŠ å¦‚ä¸‹ä¸¤ä¸ª jar æ–‡ä»¶ï¼š<ul><li>Commons-dbcp.jarï¼šè¿æ¥æ± çš„å®ç°</li><li>Commons-pool.jarï¼šè¿æ¥æ± å®ç°çš„ä¾èµ–åº“</li></ul></li><li><strong>Tomcat çš„è¿æ¥æ± æ­£æ˜¯é‡‡ç”¨è¯¥è¿æ¥æ± æ¥å®ç°çš„ã€‚</strong>è¯¥æ•°æ®åº“è¿æ¥æ± æ—¢å¯ä»¥ä¸åº”ç”¨æœåŠ¡å™¨æ•´åˆä½¿ç”¨ï¼Œä¹Ÿå¯ç”±åº”ç”¨ç¨‹åºç‹¬ç«‹ä½¿ç”¨ã€‚</li><li>æ•°æ®æºå’Œæ•°æ®åº“è¿æ¥ä¸åŒï¼Œæ•°æ®æºæ— éœ€åˆ›å»ºå¤šä¸ªï¼Œå®ƒæ˜¯äº§ç”Ÿæ•°æ®åº“è¿æ¥çš„å·¥å‚ï¼Œå› æ­¤æ•´ä¸ªåº”ç”¨åªéœ€è¦ä¸€ä¸ªæ•°æ®æºå³å¯ã€‚</li><li>å½“æ•°æ®åº“è®¿é—®ç»“æŸåï¼Œç¨‹åºè¿˜æ˜¯åƒä»¥å‰ä¸€æ ·å…³é—­æ•°æ®åº“è¿æ¥ï¼šconn.close(); ä½†ä¸Šé¢çš„ä»£ç å¹¶æ²¡æœ‰å…³é—­æ•°æ®åº“çš„ç‰©ç†è¿æ¥ï¼Œå®ƒä»…ä»…æŠŠæ•°æ®åº“è¿æ¥é‡Šæ”¾ï¼Œå½’è¿˜ç»™äº†æ•°æ®åº“è¿æ¥æ± ã€‚</li><li>é…ç½®å±æ€§è¯´æ˜</li></ul><table><thead><tr><th>å±æ€§</th><th>é»˜è®¤å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>initialSize</td><td>0</td><td>è¿æ¥æ± å¯åŠ¨æ—¶åˆ›å»ºçš„åˆå§‹åŒ–è¿æ¥æ•°é‡</td></tr><tr><td>maxActive</td><td>8</td><td>è¿æ¥æ± ä¸­å¯åŒæ—¶è¿æ¥çš„æœ€å¤§çš„è¿æ¥æ•°</td></tr><tr><td>maxIdle</td><td>8</td><td>è¿æ¥æ± ä¸­æœ€å¤§çš„ç©ºé—²çš„è¿æ¥æ•°ï¼Œè¶…è¿‡çš„ç©ºé—²è¿æ¥å°†è¢«é‡Šæ”¾ï¼Œå¦‚æœè®¾ç½®ä¸ºè´Ÿæ•°è¡¨ç¤ºä¸é™åˆ¶</td></tr><tr><td>minIdle</td><td>0</td><td>è¿æ¥æ± ä¸­æœ€å°çš„ç©ºé—²çš„è¿æ¥æ•°ï¼Œä½äºè¿™ä¸ªæ•°é‡ä¼šè¢«åˆ›å»ºæ–°çš„è¿æ¥ã€‚è¯¥å‚æ•°è¶Šæ¥è¿‘maxIdleï¼Œæ€§èƒ½è¶Šå¥½ï¼Œå› ä¸ºè¿æ¥çš„åˆ›å»ºå’Œé”€æ¯ï¼Œéƒ½æ˜¯éœ€è¦æ¶ˆè€—èµ„æºçš„ï¼›ä½†æ˜¯ä¸èƒ½å¤ªå¤§ã€‚</td></tr><tr><td>maxWait</td><td>æ— é™åˆ¶</td><td>æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå½“æ²¡æœ‰å¯ç”¨è¿æ¥æ—¶ï¼Œè¿æ¥æ± ç­‰å¾…è¿æ¥é‡Šæ”¾çš„æœ€å¤§æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´é™åˆ¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœè®¾ç½®-1è¡¨ç¤ºæ— é™ç­‰å¾…</td></tr><tr><td>poolPreparedStatements</td><td>false</td><td>å¼€å¯æ± çš„Statementæ˜¯å¦prepared</td></tr><tr><td>maxOpenPreparedStatements</td><td>æ— é™åˆ¶</td><td>å¼€å¯æ± çš„prepared åçš„åŒæ—¶æœ€å¤§è¿æ¥æ•°</td></tr><tr><td>minEvictableIdleTimeMillis</td><td></td><td>è¿æ¥æ± ä¸­è¿æ¥ï¼Œåœ¨æ—¶é—´æ®µå†…ä¸€ç›´ç©ºé—²ï¼Œ è¢«é€å‡ºè¿æ¥æ± çš„æ—¶é—´</td></tr><tr><td>removeAbandonedTimeout</td><td>300</td><td>è¶…è¿‡æ—¶é—´é™åˆ¶ï¼Œå›æ”¶æ²¡æœ‰ç”¨(åºŸå¼ƒ)çš„è¿æ¥</td></tr><tr><td>removeAbandoned</td><td>false</td><td>è¶…è¿‡removeAbandonedTimeoutæ—¶é—´åï¼Œæ˜¯å¦è¿› è¡Œæ²¡ç”¨è¿æ¥ï¼ˆåºŸå¼ƒï¼‰çš„å›æ”¶</td></tr></tbody></table><ul><li>è·å–è¿æ¥æ–¹å¼ä¸€ï¼š</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    BasicDataSource source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BasicDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    source<span class="token punctuation">.</span><span class="token function">setDriverClassName</span><span class="token punctuation">(</span><span class="token string">"com.mysql.jdbc.Driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    source<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token string">"jdbc:mysql:///test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    source<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    source<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">"abc123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//</span>    source<span class="token punctuation">.</span><span class="token function">setInitialSize</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Connection conn <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> conn<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è·å–è¿æ¥æ–¹å¼äºŒï¼š</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">//ä½¿ç”¨dbcpæ•°æ®åº“è¿æ¥æ± çš„é…ç½®æ–‡ä»¶æ–¹å¼ï¼Œè·å–æ•°æ®åº“çš„è¿æ¥ï¼šæ¨è</span><span class="token keyword">private</span> <span class="token keyword">static</span> DataSource source <span class="token operator">=</span> null<span class="token punctuation">;</span><span class="token keyword">static</span><span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        Properties pros <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        InputStream is <span class="token operator">=</span> DBCPTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"dbcp.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        pros<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//æ ¹æ®æä¾›çš„BasicDataSourceFactoryåˆ›å»ºå¯¹åº”çš„DataSourceå¯¹è±¡</span>        source <span class="token operator">=</span> BasicDataSourceFactory<span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>pros<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">public</span> <span class="token keyword">static</span> Connection <span class="token function">getConnection4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    Connection conn <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> conn<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œsrcä¸‹çš„é…ç½®æ–‡ä»¶ä¸ºï¼šã€dbcp.propertiesã€‘</p><pre class="line-numbers language-properties"><code class="language-properties"><span class="token attr-name">driverClassName</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.jdbc.Driver</span><span class="token attr-name">url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=true&amp;useServerPrepStmts=false</span><span class="token attr-name">username</span><span class="token punctuation">=</span><span class="token attr-value">root</span><span class="token attr-name">password</span><span class="token punctuation">=</span><span class="token attr-value">abc123</span><span class="token attr-name">initialSize</span><span class="token punctuation">=</span><span class="token attr-value">10</span><span class="token comment" spellcheck="true">#...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="8-3-3-Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± "><a href="#8-3-3-Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± " class="headerlink" title="8.3.3 Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± "></a>8.3.3 Druidï¼ˆå¾·é²ä¼Šï¼‰æ•°æ®åº“è¿æ¥æ± </h4><p>Druidæ˜¯é˜¿é‡Œå·´å·´å¼€æºå¹³å°ä¸Šä¸€ä¸ªæ•°æ®åº“è¿æ¥æ± å®ç°ï¼Œå®ƒç»“åˆäº†C3P0ã€DBCPã€Proxoolç­‰DBæ± çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶åŠ å…¥äº†æ—¥å¿—ç›‘æ§ï¼Œå¯ä»¥å¾ˆå¥½çš„ç›‘æ§DBæ± è¿æ¥å’ŒSQLçš„æ‰§è¡Œæƒ…å†µï¼Œå¯ä»¥è¯´æ˜¯é’ˆå¯¹ç›‘æ§è€Œç”Ÿçš„DBè¿æ¥æ± ï¼Œ<strong>å¯ä»¥è¯´æ˜¯ç›®å‰æœ€å¥½çš„è¿æ¥æ± ä¹‹ä¸€ã€‚</strong></p><pre class="line-numbers language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>druid<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span><span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Properties<span class="token punctuation">;</span><span class="token keyword">import</span> javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DataSource<span class="token punctuation">;</span><span class="token keyword">import</span> com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>DruidDataSourceFactory<span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDruid</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>        Properties pro <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         pro<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>TestDruid<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"druid.properties"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        DataSource ds <span class="token operator">=</span> DruidDataSourceFactory<span class="token punctuation">.</span><span class="token function">createDataSource</span><span class="token punctuation">(</span>pro<span class="token punctuation">)</span><span class="token punctuation">;</span>        Connection conn <span class="token operator">=</span> ds<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œsrcä¸‹çš„é…ç½®æ–‡ä»¶ä¸ºï¼šã€druid.propertiesã€‘</p><pre class="line-numbers language-java"><code class="language-java">url<span class="token operator">=</span>jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>test<span class="token operator">?</span>rewriteBatchedStatements<span class="token operator">=</span><span class="token boolean">true</span>username<span class="token operator">=</span>rootpassword<span class="token operator">=</span><span class="token number">123456</span>driverClassName<span class="token operator">=</span>com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>DriverinitialSize<span class="token operator">=</span><span class="token number">10</span>maxActive<span class="token operator">=</span><span class="token number">20</span>maxWait<span class="token operator">=</span><span class="token number">1000</span>filters<span class="token operator">=</span>wall<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>è¯¦ç»†é…ç½®å‚æ•°ï¼š</li></ul><table><thead><tr><th><strong>é…ç½®</strong></th><th><strong>ç¼ºçœ</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>name</td><td></td><td>é…ç½®è¿™ä¸ªå±æ€§çš„æ„ä¹‰åœ¨äºï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªæ•°æ®æºï¼Œç›‘æ§çš„æ—¶å€™å¯ä»¥é€šè¿‡åå­—æ¥åŒºåˆ†å¼€æ¥ã€‚   å¦‚æœæ²¡æœ‰é…ç½®ï¼Œå°†ä¼šç”Ÿæˆä¸€ä¸ªåå­—ï¼Œæ ¼å¼æ˜¯ï¼šâ€DataSource-â€ +   System.identityHashCode(this)</td></tr><tr><td>url</td><td></td><td>è¿æ¥æ•°æ®åº“çš„urlï¼Œä¸åŒæ•°æ®åº“ä¸ä¸€æ ·ã€‚ä¾‹å¦‚ï¼šmysql :   jdbc:mysql://10.20.153.104:3306/druid2      oracle :   jdbc:oracle:thin:@10.20.149.85:1521:ocnauto</td></tr><tr><td>username</td><td></td><td>è¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å</td></tr><tr><td>password</td><td></td><td>è¿æ¥æ•°æ®åº“çš„å¯†ç ã€‚å¦‚æœä½ ä¸å¸Œæœ›å¯†ç ç›´æ¥å†™åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ConfigFilterã€‚è¯¦ç»†çœ‹è¿™é‡Œï¼š<a href="https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter" target="_blank" rel="noopener">https://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter</a></td></tr><tr><td>driverClassName</td><td></td><td>æ ¹æ®urlè‡ªåŠ¨è¯†åˆ«   è¿™ä¸€é¡¹å¯é…å¯ä¸é…ï¼Œå¦‚æœä¸é…ç½®druidä¼šæ ¹æ®urlè‡ªåŠ¨è¯†åˆ«dbTypeï¼Œç„¶åé€‰æ‹©ç›¸åº”çš„driverClassName(å»ºè®®é…ç½®ä¸‹)</td></tr><tr><td>initialSize</td><td>0</td><td>åˆå§‹åŒ–æ—¶å»ºç«‹ç‰©ç†è¿æ¥çš„ä¸ªæ•°ã€‚åˆå§‹åŒ–å‘ç”Ÿåœ¨æ˜¾ç¤ºè°ƒç”¨initæ–¹æ³•ï¼Œæˆ–è€…ç¬¬ä¸€æ¬¡getConnectionæ—¶</td></tr><tr><td>maxActive</td><td>8</td><td>æœ€å¤§è¿æ¥æ± æ•°é‡</td></tr><tr><td>maxIdle</td><td>8</td><td>å·²ç»ä¸å†ä½¿ç”¨ï¼Œé…ç½®äº†ä¹Ÿæ²¡æ•ˆæœ</td></tr><tr><td>minIdle</td><td></td><td>æœ€å°è¿æ¥æ± æ•°é‡</td></tr><tr><td>maxWait</td><td></td><td>è·å–è¿æ¥æ—¶æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œå•ä½æ¯«ç§’ã€‚é…ç½®äº†maxWaitä¹‹åï¼Œç¼ºçœå¯ç”¨å…¬å¹³é”ï¼Œå¹¶å‘æ•ˆç‡ä¼šæœ‰æ‰€ä¸‹é™ï¼Œå¦‚æœéœ€è¦å¯ä»¥é€šè¿‡é…ç½®useUnfairLockå±æ€§ä¸ºtrueä½¿ç”¨éå…¬å¹³é”ã€‚</td></tr><tr><td>poolPreparedStatements</td><td>false</td><td>æ˜¯å¦ç¼“å­˜preparedStatementï¼Œä¹Ÿå°±æ˜¯PSCacheã€‚PSCacheå¯¹æ”¯æŒæ¸¸æ ‡çš„æ•°æ®åº“æ€§èƒ½æå‡å·¨å¤§ï¼Œæ¯”å¦‚è¯´oracleã€‚åœ¨mysqlä¸‹å»ºè®®å…³é—­ã€‚</td></tr><tr><td>maxOpenPreparedStatements</td><td>-1</td><td>è¦å¯ç”¨PSCacheï¼Œå¿…é¡»é…ç½®å¤§äº0ï¼Œå½“å¤§äº0æ—¶ï¼ŒpoolPreparedStatementsè‡ªåŠ¨è§¦å‘ä¿®æ”¹ä¸ºtrueã€‚åœ¨Druidä¸­ï¼Œä¸ä¼šå­˜åœ¨Oracleä¸‹PSCacheå ç”¨å†…å­˜è¿‡å¤šçš„é—®é¢˜ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ•°å€¼é…ç½®å¤§ä¸€äº›ï¼Œæ¯”å¦‚è¯´100</td></tr><tr><td>validationQuery</td><td></td><td>ç”¨æ¥æ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆçš„sqlï¼Œè¦æ±‚æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å¦‚æœvalidationQueryä¸ºnullï¼ŒtestOnBorrowã€testOnReturnã€testWhileIdleéƒ½ä¸ä¼šå…¶ä½œç”¨ã€‚</td></tr><tr><td>testOnBorrow</td><td>true</td><td>ç”³è¯·è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½ã€‚</td></tr><tr><td>testOnReturn</td><td>false</td><td>å½’è¿˜è¿æ¥æ—¶æ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆï¼Œåšäº†è¿™ä¸ªé…ç½®ä¼šé™ä½æ€§èƒ½</td></tr><tr><td>testWhileIdle</td><td>false</td><td>å»ºè®®é…ç½®ä¸ºtrueï¼Œä¸å½±å“æ€§èƒ½ï¼Œå¹¶ä¸”ä¿è¯å®‰å…¨æ€§ã€‚ç”³è¯·è¿æ¥çš„æ—¶å€™æ£€æµ‹ï¼Œå¦‚æœç©ºé—²æ—¶é—´å¤§äºtimeBetweenEvictionRunsMillisï¼Œæ‰§è¡ŒvalidationQueryæ£€æµ‹è¿æ¥æ˜¯å¦æœ‰æ•ˆã€‚</td></tr><tr><td>timeBetweenEvictionRunsMillis</td><td></td><td>æœ‰ä¸¤ä¸ªå«ä¹‰ï¼š 1)Destroyçº¿ç¨‹ä¼šæ£€æµ‹è¿æ¥çš„é—´éš”æ—¶é—´2)testWhileIdleçš„åˆ¤æ–­ä¾æ®ï¼Œè¯¦ç»†çœ‹testWhileIdleå±æ€§çš„è¯´æ˜</td></tr><tr><td>numTestsPerEvictionRun</td><td></td><td>ä¸å†ä½¿ç”¨ï¼Œä¸€ä¸ªDruidDataSourceåªæ”¯æŒä¸€ä¸ªEvictionRun</td></tr><tr><td>minEvictableIdleTimeMillis</td><td></td><td></td></tr><tr><td>connectionInitSqls</td><td></td><td>ç‰©ç†è¿æ¥åˆå§‹åŒ–çš„æ—¶å€™æ‰§è¡Œçš„sql</td></tr><tr><td>exceptionSorter</td><td></td><td>æ ¹æ®dbTypeè‡ªåŠ¨è¯†åˆ«   å½“æ•°æ®åº“æŠ›å‡ºä¸€äº›ä¸å¯æ¢å¤çš„å¼‚å¸¸æ—¶ï¼ŒæŠ›å¼ƒè¿æ¥</td></tr><tr><td>filters</td><td></td><td>å±æ€§ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé€šè¿‡åˆ«åçš„æ–¹å¼é…ç½®æ‰©å±•æ’ä»¶ï¼Œå¸¸ç”¨çš„æ’ä»¶æœ‰ï¼š   ç›‘æ§ç»Ÿè®¡ç”¨çš„filter:statæ—¥å¿—ç”¨çš„filter:log4jé˜²å¾¡sqlæ³¨å…¥çš„filter:wall</td></tr><tr><td>proxyFilters</td><td></td><td>ç±»å‹æ˜¯Listï¼Œå¦‚æœåŒæ—¶é…ç½®äº†filterså’ŒproxyFiltersï¼Œæ˜¯ç»„åˆå…³ç³»ï¼Œå¹¶éæ›¿æ¢å…³ç³»</td></tr></tbody></table><h2 id="ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ"><a href="#ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ" class="headerlink" title="ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ"></a>ç¬¬9ç« ï¼šApache-DBUtilså®ç°CRUDæ“ä½œ</h2><h3 id="9-1-Apache-DBUtilsç®€ä»‹"><a href="#9-1-Apache-DBUtilsç®€ä»‹" class="headerlink" title="9.1 Apache-DBUtilsç®€ä»‹"></a>9.1 Apache-DBUtilsç®€ä»‹</h3><ul><li><p>commons-dbutils æ˜¯ Apache ç»„ç»‡æä¾›çš„ä¸€ä¸ªå¼€æº JDBCå·¥å…·ç±»åº“ï¼Œå®ƒæ˜¯å¯¹JDBCçš„ç®€å•å°è£…ï¼Œå­¦ä¹ æˆæœ¬æä½ï¼Œå¹¶ä¸”ä½¿ç”¨dbutilsèƒ½æå¤§ç®€åŒ–jdbcç¼–ç çš„å·¥ä½œé‡ï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šå½±å“ç¨‹åºçš„æ€§èƒ½ã€‚</p></li><li><p>APIä»‹ç»ï¼š</p><ul><li>org.apache.commons.dbutils.QueryRunner</li><li>org.apache.commons.dbutils.ResultSetHandler</li><li>å·¥å…·ç±»ï¼šorg.apache.commons.dbutils.DbUtils   </li></ul></li><li><p>APIåŒ…è¯´æ˜ï¼š</p></li></ul><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555595163263.png" alt="1555595163263"></p><p><img src="/medias/loading.gif" data-original="https://gitee.com/ma_tung_zhou/imageuse1/raw/master/imgg/1555595198644.png" alt="1555595198644"></p><h3 id="9-2-ä¸»è¦APIçš„ä½¿ç”¨"><a href="#9-2-ä¸»è¦APIçš„ä½¿ç”¨" class="headerlink" title="9.2 ä¸»è¦APIçš„ä½¿ç”¨"></a>9.2 ä¸»è¦APIçš„ä½¿ç”¨</h3><h4 id="9-2-1-DbUtils"><a href="#9-2-1-DbUtils" class="headerlink" title="9.2.1 DbUtils"></a>9.2.1 DbUtils</h4><ul><li>DbUtils ï¼šæä¾›å¦‚å…³é—­è¿æ¥ã€è£…è½½JDBCé©±åŠ¨ç¨‹åºç­‰å¸¸è§„å·¥ä½œçš„å·¥å…·ç±»ï¼Œé‡Œé¢çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯é™æ€çš„ã€‚ä¸»è¦æ–¹æ³•å¦‚ä¸‹ï¼š<ul><li><strong>public static void close(â€¦) throws java.sql.SQLException</strong>ï¼šã€€DbUtilsç±»æä¾›äº†ä¸‰ä¸ªé‡è½½çš„å…³é—­æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•æ£€æŸ¥æ‰€æä¾›çš„å‚æ•°æ˜¯ä¸æ˜¯NULLï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼Œå®ƒä»¬å°±å…³é—­Connectionã€Statementå’ŒResultSetã€‚</li><li>public static void closeQuietly(â€¦): è¿™ä¸€ç±»æ–¹æ³•ä¸ä»…èƒ½åœ¨Connectionã€Statementå’ŒResultSetä¸ºNULLæƒ…å†µä¸‹é¿å…å…³é—­ï¼Œè¿˜èƒ½éšè—ä¸€äº›åœ¨ç¨‹åºä¸­æŠ›å‡ºçš„SQLEeceptionã€‚</li><li>public static void commitAndClose(Connection conn)throws SQLExceptionï¼š ç”¨æ¥æäº¤è¿æ¥çš„äº‹åŠ¡ï¼Œç„¶åå…³é—­è¿æ¥</li><li>public static void commitAndCloseQuietly(Connection conn)ï¼š ç”¨æ¥æäº¤è¿æ¥ï¼Œç„¶åå…³é—­è¿æ¥ï¼Œå¹¶ä¸”åœ¨å…³é—­è¿æ¥æ—¶ä¸æŠ›å‡ºSQLå¼‚å¸¸ã€‚ </li><li>public static void rollback(Connection conn)throws SQLExceptionï¼šå…è®¸connä¸ºnullï¼Œå› ä¸ºæ–¹æ³•å†…éƒ¨åšäº†åˆ¤æ–­</li><li>public static void rollbackAndClose(Connection conn)throws SQLException</li><li>rollbackAndCloseQuietly(Connection)</li><li>public static boolean loadDriver(java.lang.String driverClassName)ï¼šè¿™ä¸€æ–¹è£…è½½å¹¶æ³¨å†ŒJDBCé©±åŠ¨ç¨‹åºï¼Œå¦‚æœæˆåŠŸå°±è¿”å›trueã€‚ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œä½ ä¸éœ€è¦æ•æ‰è¿™ä¸ªå¼‚å¸¸ClassNotFoundExceptionã€‚</li></ul></li></ul><h4 id="9-2-2-QueryRunnerç±»"><a href="#9-2-2-QueryRunnerç±»" class="headerlink" title="9.2.2 QueryRunnerç±»"></a>9.2.2 QueryRunnerç±»</h4><ul><li><p><strong>è¯¥ç±»ç®€å•åŒ–äº†SQLæŸ¥è¯¢ï¼Œå®ƒä¸ResultSetHandlerç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨å¯ä»¥å®Œæˆå¤§éƒ¨åˆ†çš„æ•°æ®åº“æ“ä½œï¼Œèƒ½å¤Ÿå¤§å¤§å‡å°‘ç¼–ç é‡ã€‚</strong></p></li><li><p>QueryRunnerç±»æä¾›äº†ä¸¤ä¸ªæ„é€ å™¨ï¼š</p><ul><li>é»˜è®¤çš„æ„é€ å™¨</li><li>éœ€è¦ä¸€ä¸ª javax.sql.DataSource æ¥ä½œå‚æ•°çš„æ„é€ å™¨</li></ul></li><li><p>QueryRunnerç±»çš„ä¸»è¦æ–¹æ³•ï¼š</p><ul><li><strong>æ›´æ–°</strong><ul><li>public int update(Connection conn, String sql, Objectâ€¦ params) throws SQLException:ç”¨æ¥æ‰§è¡Œä¸€ä¸ªæ›´æ–°ï¼ˆæ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤ï¼‰æ“ä½œã€‚</li><li>â€¦â€¦</li></ul></li><li><strong>æ’å…¥</strong><ul><li>public <t> T insert(Connection conn,String sql,ResultSetHandler<t> rsh, Objectâ€¦ params) throws SQLExceptionï¼šåªæ”¯æŒINSERTè¯­å¥ï¼Œå…¶ä¸­ rsh - The handler used to create the result object from the ResultSet of auto-generated keys.  è¿”å›å€¼: An object generated by the handler.å³è‡ªåŠ¨ç”Ÿæˆçš„é”®å€¼</t></t></li><li>â€¦.</li></ul></li><li><strong>æ‰¹å¤„ç†</strong><ul><li>public int[] batch(Connection conn,String sql,Object[][] params)throws SQLExceptionï¼š INSERT, UPDATE, or DELETEè¯­å¥</li><li>public <t> T insertBatch(Connection conn,String sql,ResultSetHandler<t> rsh,Object[][] params)throws SQLExceptionï¼šåªæ”¯æŒINSERTè¯­å¥</t></t></li><li>â€¦..</li></ul></li><li><strong>æŸ¥è¯¢</strong><ul><li>public Object query(Connection conn, String sql, ResultSetHandler rsh,Objectâ€¦ params) throws SQLExceptionï¼šæ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢æ“ä½œï¼Œåœ¨è¿™ä¸ªæŸ¥è¯¢ä¸­ï¼Œå¯¹è±¡æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å€¼è¢«ç”¨æ¥ä½œä¸ºæŸ¥è¯¢è¯­å¥çš„ç½®æ¢å‚æ•°ã€‚è¯¥æ–¹æ³•ä¼šè‡ªè¡Œå¤„ç† PreparedStatement å’Œ ResultSet çš„åˆ›å»ºå’Œå…³é—­ã€‚</li><li>â€¦â€¦ </li></ul></li></ul></li><li><p>æµ‹è¯•</p></li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// æµ‹è¯•æ·»åŠ </span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testInsert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"insert into customers(name,email,birth)values(?,?,?)"</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> count <span class="token operator">=</span> runner<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> <span class="token string">"ä½•æˆé£"</span><span class="token punctuation">,</span> <span class="token string">"he@qq.com"</span><span class="token punctuation">,</span> <span class="token string">"1992-09-08"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ·»åŠ äº†"</span> <span class="token operator">+</span> count <span class="token operator">+</span> <span class="token string">"æ¡è®°å½•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">// æµ‹è¯•åˆ é™¤</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception <span class="token punctuation">{</span>    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"delete from customers where id &lt; ?"</span><span class="token punctuation">;</span>    <span class="token keyword">int</span> count <span class="token operator">=</span> runner<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åˆ é™¤äº†"</span> <span class="token operator">+</span> count <span class="token operator">+</span> <span class="token string">"æ¡è®°å½•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="9-2-3-ResultSetHandleræ¥å£åŠå®ç°ç±»"><a href="#9-2-3-ResultSetHandleræ¥å£åŠå®ç°ç±»" class="headerlink" title="9.2.3 ResultSetHandleræ¥å£åŠå®ç°ç±»"></a>9.2.3 ResultSetHandleræ¥å£åŠå®ç°ç±»</h4><ul><li><p>è¯¥æ¥å£ç”¨äºå¤„ç† java.sql.ResultSetï¼Œå°†æ•°æ®æŒ‰è¦æ±‚è½¬æ¢ä¸ºå¦ä¸€ç§å½¢å¼ã€‚</p></li><li><p>ResultSetHandler æ¥å£æä¾›äº†ä¸€ä¸ªå•ç‹¬çš„æ–¹æ³•ï¼šObject handle (java.sql.ResultSet .rs)ã€‚</p></li><li><p>æ¥å£çš„ä¸»è¦å®ç°ç±»ï¼š</p><ul><li><p>ArrayHandlerï¼šæŠŠç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®è½¬æˆå¯¹è±¡æ•°ç»„ã€‚</p></li><li><p>ArrayListHandlerï¼šæŠŠç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½è½¬æˆä¸€ä¸ªæ•°ç»„ï¼Œå†å­˜æ”¾åˆ°Listä¸­ã€‚</p></li><li><p><strong>BeanHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®å°è£…åˆ°ä¸€ä¸ªå¯¹åº”çš„JavaBeanå®ä¾‹ä¸­ã€‚</p></li><li><p><strong>BeanListHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªå¯¹åº”çš„JavaBeanå®ä¾‹ä¸­ï¼Œå­˜æ”¾åˆ°Listé‡Œã€‚</p></li><li><p>ColumnListHandlerï¼šå°†ç»“æœé›†ä¸­æŸä¸€åˆ—çš„æ•°æ®å­˜æ”¾åˆ°Listä¸­ã€‚</p></li><li><p>KeyedHandler(name)ï¼šå°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œå†æŠŠè¿™äº›mapå†å­˜åˆ°ä¸€ä¸ªmapé‡Œï¼Œå…¶keyä¸ºæŒ‡å®šçš„keyã€‚</p></li><li><p><strong>MapHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„ç¬¬ä¸€è¡Œæ•°æ®å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œkeyæ˜¯åˆ—åï¼Œvalueå°±æ˜¯å¯¹åº”çš„å€¼ã€‚</p></li><li><p><strong>MapListHandlerï¼š</strong>å°†ç»“æœé›†ä¸­çš„æ¯ä¸€è¡Œæ•°æ®éƒ½å°è£…åˆ°ä¸€ä¸ªMapé‡Œï¼Œç„¶åå†å­˜æ”¾åˆ°List</p></li><li><p><strong>ScalarHandlerï¼š</strong>æŸ¥è¯¢å•ä¸ªå€¼å¯¹è±¡</p></li></ul></li></ul><ul><li>æµ‹è¯•</li></ul><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/* * æµ‹è¯•æŸ¥è¯¢:æŸ¥è¯¢ä¸€æ¡è®°å½• *  * ä½¿ç”¨ResultSetHandlerçš„å®ç°ç±»ï¼šBeanHandler */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"select id,name,email,birth from customers where id = ?"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//</span>    BeanHandler<span class="token operator">&lt;</span>Customer<span class="token operator">></span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanHandler</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>Customer<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Customer customer <span class="token operator">=</span> runner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>        JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/* * æµ‹è¯•æŸ¥è¯¢:æŸ¥è¯¢å¤šæ¡è®°å½•æ„æˆçš„é›†åˆ *  * ä½¿ç”¨ResultSetHandlerçš„å®ç°ç±»ï¼šBeanListHandler */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"select id,name,email,birth from customers where id &lt; ?"</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//</span>    BeanListHandler<span class="token operator">&lt;</span>Customer<span class="token operator">></span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanListHandler</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span>Customer<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    List<span class="token operator">&lt;</span>Customer<span class="token operator">></span> list <span class="token operator">=</span> runner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span>    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/* * è‡ªå®šä¹‰ResultSetHandlerçš„å®ç°ç±» */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryInstance1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    String sql <span class="token operator">=</span> <span class="token string">"select id,name,email,birth from customers where id = ?"</span><span class="token punctuation">;</span>    ResultSetHandler<span class="token operator">&lt;</span>Customer<span class="token operator">></span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResultSetHandler</span><span class="token operator">&lt;</span>Customer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token annotation punctuation">@Override</span>        <span class="token keyword">public</span> Customer <span class="token function">handle</span><span class="token punctuation">(</span>ResultSet rs<span class="token punctuation">)</span> <span class="token keyword">throws</span> SQLException <span class="token punctuation">{</span>            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"handle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//            return new Customer(1,"Tom","tom@126.com",new Date(123323432L));</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">int</span> id <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                String name <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                String email <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                Date birth <span class="token operator">=</span> rs<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token string">"birth"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Customer</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> email<span class="token punctuation">,</span> birth<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">return</span> null<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    Customer customer <span class="token operator">=</span> runner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">;</span>    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java"><code class="language-java"><span class="token comment" spellcheck="true">/* * å¦‚ä½•æŸ¥è¯¢ç±»ä¼¼äºæœ€å¤§çš„ï¼Œæœ€å°çš„ï¼Œå¹³å‡çš„ï¼Œæ€»å’Œï¼Œä¸ªæ•°ç›¸å…³çš„æ•°æ®ï¼Œ * ä½¿ç”¨ScalarHandler *  */</span><span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> Exception<span class="token punctuation">{</span>    QueryRunner runner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryRunner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Connection conn <span class="token operator">=</span> JDBCUtils<span class="token punctuation">.</span><span class="token function">getConnection3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//æµ‹è¯•ä¸€ï¼š</span><span class="token comment" spellcheck="true">//    String sql = "select count(*) from customers where id &lt; ?";</span><span class="token comment" spellcheck="true">//    ScalarHandler handler = new ScalarHandler();</span><span class="token comment" spellcheck="true">//    long count = (long) runner.query(conn, sql, handler, 20);</span><span class="token comment" spellcheck="true">//    System.out.println(count);</span>    <span class="token comment" spellcheck="true">//æµ‹è¯•äºŒï¼š</span>    String sql <span class="token operator">=</span> <span class="token string">"select max(birth) from customers"</span><span class="token punctuation">;</span>    ScalarHandler handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ScalarHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    Date birth <span class="token operator">=</span> <span class="token punctuation">(</span>Date<span class="token punctuation">)</span> runner<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> sql<span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>    System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>birth<span class="token punctuation">)</span><span class="token punctuation">;</span>    JDBCUtils<span class="token punctuation">.</span><span class="token function">closeResource</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="JDBCæ€»ç»“"><a href="#JDBCæ€»ç»“" class="headerlink" title="JDBCæ€»ç»“"></a>JDBCæ€»ç»“</h2><pre class="line-numbers language-java"><code class="language-java">æ€»ç»“<span class="token annotation punctuation">@Test</span><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testUpdateWithTx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//1.è·å–è¿æ¥çš„æ“ä½œï¼ˆ</span>        <span class="token comment" spellcheck="true">//â‘  æ‰‹å†™çš„è¿æ¥ï¼šJDBCUtils.getConnection();</span>        <span class="token comment" spellcheck="true">//â‘¡ ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± ï¼šC3P0;DBCP;Druid</span>        <span class="token comment" spellcheck="true">//2.å¯¹æ•°æ®è¡¨è¿›è¡Œä¸€ç³»åˆ—CRUDæ“ä½œ</span>        <span class="token comment" spellcheck="true">//â‘  ä½¿ç”¨PreparedStatementå®ç°é€šç”¨çš„å¢åˆ æ”¹ã€æŸ¥è¯¢æ“ä½œï¼ˆversion 1.0 \ version 2.0)</span><span class="token comment" spellcheck="true">//version2.0çš„å¢åˆ æ”¹public void update(Connection conn,String sql,Object ... args){}</span><span class="token comment" spellcheck="true">//version2.0çš„æŸ¥è¯¢ public &lt;T> T getInstance(Connection conn,Class&lt;T> clazz,String sql,Object ... args){}</span>        <span class="token comment" spellcheck="true">//â‘¡ ä½¿ç”¨dbutilsæä¾›çš„jaråŒ…ä¸­æä¾›çš„QueryRunnerç±»</span>        <span class="token comment" spellcheck="true">//æäº¤æ•°æ®</span>        conn<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">//å›æ»šæ•°æ®</span>            conn<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>            e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">finally</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//3.å…³é—­è¿æ¥ç­‰æ“ä½œ</span>        <span class="token comment" spellcheck="true">//â‘  JDBCUtils.closeResource();</span>        <span class="token comment" spellcheck="true">//â‘¡ ä½¿ç”¨dbutilsæä¾›çš„jaråŒ…ä¸­æä¾›çš„DbUtilsç±»æä¾›äº†å…³é—­çš„ç›¸å…³æ“ä½œ</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> JavaWeb </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> JDBC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scikit-learnç³»åˆ—ä¹ï¼šK-å‡å€¼</title>
      <link href="/2020/07/16/scikit-learn-xi-lie-jiu-k-jun-zhi/"/>
      <url>/2020/07/16/scikit-learn-xi-lie-jiu-k-jun-zhi/</url>
      
        <content type="html"><![CDATA[<h2 id="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼"><a href="#é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼" class="headerlink" title="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼"></a>é¡¹ç›®åœ°å€<a href="https://github.com/DongZhouGu/scikit-learn-ml" target="_blank" rel="noopener">ä¼ é€é—¨</a>ï¼Œæ¬¢è¿ star å’Œ fork ï¼</h2><h2 id="K-Meansèšç±»ç®—æ³•"><a href="#K-Meansèšç±»ç®—æ³•" class="headerlink" title="K-Meansèšç±»ç®—æ³•"></a>K-Meansèšç±»ç®—æ³•</h2><p>èšç±»ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†ä¸€ä¸ªåºæ‚æ•°æ®é›†ä¸­å…·æœ‰ç›¸ä¼¼ç‰¹å¾çš„æ•°æ®è‡ªåŠ¨å½’ç±»åˆ°ä¸€èµ·ï¼Œç§°ä¸ºä¸€ä¸ªç°‡ï¼Œç°‡å†…çš„å¯¹è±¡è¶Šç›¸ä¼¼ï¼Œèšç±»çš„æ•ˆæœè¶Šå¥½ã€‚å®ƒæ˜¯ä¸€ç§æ— ç›‘ç£çš„å­¦ä¹ (Unsupervised Learning)æ–¹æ³•,ä¸éœ€è¦é¢„å…ˆæ ‡æ³¨å¥½çš„è®­ç»ƒé›†ã€‚èšç±»ä¸åˆ†ç±»æœ€å¤§çš„åŒºåˆ«å°±æ˜¯åˆ†ç±»çš„ç›®æ ‡äº‹å…ˆå·²çŸ¥ï¼Œä¾‹å¦‚çŒ«ç‹—è¯†åˆ«ï¼Œä½ åœ¨åˆ†ç±»ä¹‹å‰å·²ç»é¢„å…ˆçŸ¥é“è¦å°†å®ƒåˆ†ä¸ºçŒ«ã€ç‹—ä¸¤ä¸ªç§ç±»ï¼›è€Œåœ¨ä½ èšç±»ä¹‹å‰ï¼Œä½ å¯¹ä½ çš„ç›®æ ‡æ˜¯æœªçŸ¥çš„ï¼ŒåŒæ ·ä»¥åŠ¨ç‰©ä¸ºä¾‹ï¼Œå¯¹äºä¸€ä¸ªåŠ¨ç‰©é›†æ¥è¯´ï¼Œä½ å¹¶ä¸æ¸…æ¥šè¿™ä¸ªæ•°æ®é›†å†…éƒ¨æœ‰å¤šå°‘ç§ç±»çš„åŠ¨ç‰©ï¼Œä½ èƒ½åšçš„åªæ˜¯åˆ©ç”¨èšç±»æ–¹æ³•å°†å®ƒè‡ªåŠ¨æŒ‰ç…§ç‰¹å¾åˆ†ä¸ºå¤šç±»ï¼Œç„¶åäººä¸ºç»™å‡ºè¿™ä¸ªèšç±»ç»“æœçš„å®šä¹‰ï¼ˆå³ç°‡è¯†åˆ«ï¼‰ã€‚ä¾‹å¦‚ï¼Œä½ å°†ä¸€ä¸ªåŠ¨ç‰©é›†åˆ†ä¸ºäº†ä¸‰ç°‡ï¼ˆç±»ï¼‰ï¼Œç„¶åé€šè¿‡è§‚å¯Ÿè¿™ä¸‰ç±»åŠ¨ç‰©çš„ç‰¹å¾ï¼Œä½ ä¸ºæ¯ä¸€ä¸ªç°‡èµ·ä¸€ä¸ªåå­—ï¼Œå¦‚å¤§è±¡ã€ç‹—ã€çŒ«ç­‰ï¼Œè¿™å°±æ˜¯èšç±»çš„åŸºæœ¬æ€æƒ³ã€‚     </p><p>è‡³äºâ€œç›¸ä¼¼â€è¿™ä¸€æ¦‚å¿µï¼Œæ˜¯åˆ©ç”¨è·ç¦»è¿™ä¸ªè¯„ä»·æ ‡å‡†æ¥è¡¡é‡çš„ï¼Œæˆ‘ä»¬é€šè¿‡è®¡ç®—å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„è·ç¦»è¿œè¿‘æ¥åˆ¤æ–­å®ƒä»¬æ˜¯å¦å±äºåŒä¸€ç±»åˆ«ï¼Œå³æ˜¯å¦æ˜¯åŒä¸€ä¸ªç°‡ã€‚è‡³äºè·ç¦»å¦‚ä½•è®¡ç®—ï¼Œç§‘å­¦å®¶ä»¬æå‡ºäº†è®¸å¤šç§è·ç¦»çš„è®¡ç®—æ–¹æ³•ï¼Œå…¶ä¸­æ¬§å¼è·ç¦»æ˜¯æœ€ä¸ºç®€å•å’Œå¸¸ç”¨çš„ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰æ›¼å“ˆé¡¿è·ç¦»å’Œä½™å¼¦ç›¸ä¼¼æ€§è·ç¦»ç­‰ã€‚</p><p>æ¬§å¼è·ç¦»ï¼Œæˆ‘æƒ³å¤§å®¶å†ç†Ÿæ‚‰ä¸è¿‡äº†ï¼Œä½†ä¸ºå…æœ‰ä¸€äº›åŸºç¡€è–„å¼±çš„åŒå­¦ï¼Œåœ¨æ­¤å†è¯´æ˜ä¸€ä¸‹ï¼Œå®ƒçš„å®šä¹‰ä¸º:<br>å¯¹äºxç‚¹åæ ‡ä¸º(x1,x2,x3,â€¦,xn)å’Œ yç‚¹åæ ‡ä¸º(y1,y2,y3,â€¦,yn)ï¼Œä¸¤è€…çš„æ¬§å¼è·ç¦»ä¸º:<br>$$<br>d(x,y)<br>    ={\sqrt{<br>            (x_{1}-y_{1})^{2}+(x_{2}-y_{2})^{2} + \cdots +(x_{n}-y_{n})^{2}<br>        }}<br>    ={\sqrt{<br>            \sum_{ {i=1} }^{n}(x_{i}-y_{i})^{2}<br>        }}<br>$$</p><p>åœ¨äºŒç»´å¹³é¢ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬åˆä¸­æ—¶å°±å­¦è¿‡çš„ä¸¤ç‚¹è·ç¦»å…¬å¼</p><h2 id="1-K-Means-ç®—æ³•"><a href="#1-K-Means-ç®—æ³•" class="headerlink" title="1. K-Means ç®—æ³•"></a>1. K-Means ç®—æ³•</h2><p>K-Means æ˜¯å‘ç°ç»™å®šæ•°æ®é›†çš„ K ä¸ªç°‡çš„èšç±»ç®—æ³•, ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸º <code>K-å‡å€¼</code> æ˜¯å› ä¸ºå®ƒå¯ä»¥å‘ç° K ä¸ªä¸åŒçš„ç°‡, ä¸”æ¯ä¸ªç°‡çš„ä¸­å¿ƒé‡‡ç”¨ç°‡ä¸­æ‰€å«å€¼çš„å‡å€¼è®¡ç®—è€Œæˆ.<br>ç°‡ä¸ªæ•° K æ˜¯ç”¨æˆ·æŒ‡å®šçš„, æ¯ä¸€ä¸ªç°‡é€šè¿‡å…¶è´¨å¿ƒï¼ˆcentroidï¼‰, å³ç°‡ä¸­æ‰€æœ‰ç‚¹çš„ä¸­å¿ƒæ¥æè¿°.<br>èšç±»ä¸åˆ†ç±»ç®—æ³•çš„æœ€å¤§åŒºåˆ«åœ¨äº, åˆ†ç±»çš„ç›®æ ‡ç±»åˆ«å·²çŸ¥, è€Œèšç±»çš„ç›®æ ‡ç±»åˆ«æ˜¯æœªçŸ¥çš„. </p><p><strong>ä¼˜ç‚¹</strong>:</p><ul><li>å±äºæ— ç›‘ç£å­¦ä¹ ï¼Œæ— é¡»å‡†å¤‡è®­ç»ƒé›†</li><li>åŸç†ç®€å•ï¼Œå®ç°èµ·æ¥è¾ƒä¸ºå®¹æ˜“</li><li>ç»“æœå¯è§£é‡Šæ€§è¾ƒå¥½</li></ul><p><strong>ç¼ºç‚¹</strong>:</p><ul><li><strong>éœ€æ‰‹åŠ¨è®¾ç½®kå€¼</strong>ã€‚ åœ¨ç®—æ³•å¼€å§‹é¢„æµ‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è®¾ç½®kå€¼ï¼Œå³ä¼°è®¡æ•°æ®å¤§æ¦‚çš„ç±»åˆ«ä¸ªæ•°ï¼Œä¸åˆç†çš„kå€¼ä¼šä½¿ç»“æœç¼ºä¹è§£é‡Šæ€§</li><li>å¯èƒ½æ”¶æ•›åˆ°å±€éƒ¨æœ€å°å€¼, åœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šæ”¶æ•›è¾ƒæ…¢</li><li>å¯¹äºå¼‚å¸¸ç‚¹ã€ç¦»ç¾¤ç‚¹æ•æ„Ÿ</li></ul><p>ä½¿ç”¨æ•°æ®ç±»å‹ : æ•°å€¼å‹æ•°æ®</p><h3 id="1-1-K-Means-åœºæ™¯"><a href="#1-1-K-Means-åœºæ™¯" class="headerlink" title="1.1 K-Means åœºæ™¯"></a>1.1 K-Means åœºæ™¯</h3><p>kmeansï¼Œå¦‚å‰æ‰€è¿°ï¼Œç”¨äºæ•°æ®é›†å†…ç§ç±»å±æ€§ä¸æ˜æ™°ï¼Œå¸Œæœ›èƒ½å¤Ÿé€šè¿‡æ•°æ®æŒ–æ˜å‡ºæˆ–è‡ªåŠ¨å½’ç±»å‡ºæœ‰ç›¸ä¼¼ç‰¹ç‚¹çš„å¯¹è±¡çš„åœºæ™¯ã€‚å…¶å•†ä¸šç•Œçš„åº”ç”¨åœºæ™¯ä¸€èˆ¬ä¸ºæŒ–æ˜å‡ºå…·æœ‰ç›¸ä¼¼ç‰¹ç‚¹çš„æ½œåœ¨å®¢æˆ·ç¾¤ä½“ä»¥ä¾¿å…¬å¸èƒ½å¤Ÿé‡ç‚¹ç ”ç©¶ã€å¯¹ç—‡ä¸‹è¯ã€‚  </p><p>ä¾‹å¦‚ï¼Œåœ¨2000å¹´å’Œ2004å¹´çš„ç¾å›½æ€»ç»Ÿå¤§é€‰ä¸­ï¼Œå€™é€‰äººçš„å¾—ç¥¨æ•°æ¯”è¾ƒæ¥è¿‘æˆ–è€…è¯´éå¸¸æ¥è¿‘ã€‚ä»»ä¸€å€™é€‰äººå¾—åˆ°çš„æ™®é€‰ç¥¨æ•°çš„æœ€å¤§ç™¾åˆ†æ¯”ä¸º50.7%è€Œæœ€å°ç™¾åˆ†æ¯”ä¸º47.9% å¦‚æœ1%çš„é€‰æ°‘å°†æ‰‹ä¸­çš„é€‰ç¥¨æŠ•å‘å¦å¤–çš„å€™é€‰äººï¼Œé‚£ä¹ˆé€‰ä¸¾ç»“æœå°±ä¼šæˆªç„¶ä¸åŒã€‚ å®é™…ä¸Šï¼Œå¦‚æœå¦¥å–„åŠ ä»¥å¼•å¯¼ä¸å¸å¼•ï¼Œå°‘éƒ¨åˆ†é€‰æ°‘å°±ä¼šè½¬æ¢ç«‹åœºã€‚å°½ç®¡è¿™ç±»é€‰ä¸¾è€…å çš„æ¯”ä¾‹è¾ƒä½ï¼Œä½†å½“å€™é€‰äººçš„é€‰ç¥¨æ¥è¿‘æ—¶ï¼Œè¿™äº›äººçš„ç«‹åœºæ— ç–‘ä¼šå¯¹é€‰ä¸¾ç»“æœäº§ç”Ÿéå¸¸å¤§çš„å½±å“ã€‚å¦‚ä½•æ‰¾å‡ºè¿™ç±»é€‰æ°‘ï¼Œä»¥åŠå¦‚ä½•åœ¨æœ‰é™çš„é¢„ç®—ä¸‹é‡‡å–æªæ–½æ¥å¸å¼•ä»–ä»¬ï¼Ÿ ç­”æ¡ˆå°±æ˜¯èšç±»ï¼ˆClustering)ã€‚</p><p>é‚£ä¹ˆï¼Œå…·ä½“å¦‚ä½•å®æ–½å‘¢ï¼Ÿé¦–å…ˆï¼Œæ”¶é›†ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¯ä»¥åŒæ—¶æ”¶é›†ç”¨æˆ·æ»¡æ„æˆ–ä¸æ»¡æ„çš„ä¿¡æ¯ï¼Œè¿™æ˜¯å› ä¸ºä»»ä½•å¯¹ç”¨æˆ·é‡è¦çš„å†…å®¹éƒ½å¯èƒ½å½±å“ç”¨æˆ·çš„æŠ•ç¥¨ç»“æœã€‚ç„¶åï¼Œå°†è¿™äº›ä¿¡æ¯è¾“å…¥åˆ°æŸä¸ªèšç±»ç®—æ³•ä¸­ã€‚æ¥ç€ï¼Œå¯¹èšç±»ç»“æœä¸­çš„æ¯ä¸€ä¸ªç°‡ï¼ˆæœ€å¥½é€‰æ‹©æœ€å¤§ç°‡ ï¼‰ï¼Œ ç²¾å¿ƒæ„é€ èƒ½å¤Ÿå¸å¼•è¯¥ç°‡é€‰æ°‘çš„æ¶ˆæ¯ã€‚æœ€åï¼Œ å¼€å±•ç«é€‰æ´»åŠ¨å¹¶è§‚å¯Ÿä¸Šè¿°åšæ³•æ˜¯å¦æœ‰æ•ˆã€‚</p><p>å¦ä¸€ä¸ªä¾‹å­å°±æ˜¯äº§å“éƒ¨é—¨çš„å¸‚åœºè°ƒç ”äº†ã€‚ä¸ºäº†æ›´å¥½çš„äº†è§£è‡ªå·±çš„ç”¨æˆ·ï¼Œäº§å“éƒ¨é—¨å¯ä»¥é‡‡ç”¨èšç±»çš„æ–¹æ³•å¾—åˆ°ä¸åŒç‰¹å¾çš„ç”¨æˆ·ç¾¤ä½“ï¼Œç„¶åé’ˆå¯¹ä¸åŒçš„ç”¨æˆ·ç¾¤ä½“å¯ä»¥å¯¹ç—‡ä¸‹è¯ï¼Œä¸ºä»–ä»¬æä¾›æ›´åŠ ç²¾å‡†æœ‰æ•ˆçš„æœåŠ¡ã€‚</p><h3 id="1-2-K-Means-æœ¯è¯­"><a href="#1-2-K-Means-æœ¯è¯­" class="headerlink" title="1.2 K-Means æœ¯è¯­"></a>1.2 K-Means æœ¯è¯­</h3><ul><li>ç°‡: æ‰€æœ‰æ•°æ®çš„ç‚¹é›†åˆï¼Œç°‡ä¸­çš„å¯¹è±¡æ˜¯ç›¸ä¼¼çš„ã€‚</li><li>è´¨å¿ƒ: ç°‡ä¸­æ‰€æœ‰ç‚¹çš„ä¸­å¿ƒï¼ˆè®¡ç®—æ‰€æœ‰ç‚¹çš„å‡å€¼è€Œæ¥ï¼‰.</li><li>SSE: Sum of Sqared Errorï¼ˆè¯¯å·®å¹³æ–¹å’Œï¼‰, å®ƒè¢«ç”¨æ¥è¯„ä¼°æ¨¡å‹çš„å¥½åï¼ŒSSE å€¼è¶Šå°ï¼Œè¡¨ç¤ºè¶Šæ¥è¿‘å®ƒä»¬çš„è´¨å¿ƒ. èšç±»æ•ˆæœè¶Šå¥½ã€‚ç”±äºå¯¹è¯¯å·®å–äº†å¹³æ–¹ï¼Œå› æ­¤æ›´åŠ æ³¨é‡é‚£äº›è¿œç¦»ä¸­å¿ƒçš„ç‚¹ï¼ˆä¸€èˆ¬ä¸ºè¾¹ç•Œç‚¹æˆ–ç¦»ç¾¤ç‚¹ï¼‰ã€‚è¯¦æƒ…è§kmeansçš„è¯„ä»·æ ‡å‡†ã€‚</li></ul><p>æœ‰å…³ <code>ç°‡</code> å’Œ <code>è´¨å¿ƒ</code> æœ¯è¯­æ›´å½¢è±¡çš„ä»‹ç», è¯·å‚è€ƒä¸‹å›¾:</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/apachecn-k-means-term-1.jpg" alt="K-Means æœ¯è¯­å›¾"></p><h3 id="1-3-K-Means-å·¥ä½œæµç¨‹"><a href="#1-3-K-Means-å·¥ä½œæµç¨‹" class="headerlink" title="1.3 K-Means å·¥ä½œæµç¨‹"></a>1.3 K-Means å·¥ä½œæµç¨‹</h3><ol><li>é¦–å…ˆ, éšæœºç¡®å®š K ä¸ªåˆå§‹ç‚¹ä½œä¸ºè´¨å¿ƒï¼ˆ<strong>ä¸å¿…æ˜¯æ•°æ®ä¸­çš„ç‚¹</strong>ï¼‰ã€‚</li><li>ç„¶åå°†æ•°æ®é›†ä¸­çš„æ¯ä¸ªç‚¹åˆ†é…åˆ°ä¸€ä¸ªç°‡ä¸­, å…·ä½“æ¥è®², å°±æ˜¯ä¸ºæ¯ä¸ªç‚¹æ‰¾åˆ°è·å…¶æœ€è¿‘çš„è´¨å¿ƒ, å¹¶å°†å…¶åˆ†é…è¯¥è´¨å¿ƒæ‰€å¯¹åº”çš„ç°‡. è¿™ä¸€æ­¥å®Œæˆä¹‹å, æ¯ä¸ªç°‡çš„è´¨å¿ƒæ›´æ–°ä¸ºè¯¥ç°‡æ‰€æœ‰ç‚¹çš„å¹³å‡å€¼.<br>3.é‡å¤ä¸Šè¿°è¿‡ç¨‹ç›´åˆ°æ•°æ®é›†ä¸­çš„æ‰€æœ‰ç‚¹éƒ½è·ç¦»å®ƒæ‰€å¯¹åº”çš„è´¨å¿ƒæœ€è¿‘æ—¶ç»“æŸã€‚</li></ol><p>ä¸Šè¿°è¿‡ç¨‹çš„ <code>ä¼ªä»£ç </code> å¦‚ä¸‹:</p><ul><li>åˆ›å»º k ä¸ªç‚¹ä½œä¸ºèµ·å§‹è´¨å¿ƒï¼ˆé€šå¸¸æ˜¯éšæœºé€‰æ‹©ï¼‰</li><li>å½“ä»»æ„ä¸€ä¸ªç‚¹çš„ç°‡åˆ†é…ç»“æœå‘ç”Ÿæ”¹å˜æ—¶ï¼ˆä¸æ”¹å˜æ—¶ç®—æ³•ç»“æŸï¼‰<ul><li>å¯¹æ•°æ®é›†ä¸­çš„æ¯ä¸ªæ•°æ®ç‚¹<ul><li>å¯¹æ¯ä¸ªè´¨å¿ƒ<ul><li>è®¡ç®—è´¨å¿ƒä¸æ•°æ®ç‚¹ä¹‹é—´çš„è·ç¦»</li></ul></li><li>å°†æ•°æ®ç‚¹åˆ†é…åˆ°è·å…¶æœ€è¿‘çš„ç°‡</li></ul></li><li>å¯¹æ¯ä¸€ä¸ªç°‡, è®¡ç®—ç°‡ä¸­æ‰€æœ‰ç‚¹çš„å‡å€¼å¹¶å°†å‡å€¼ä½œä¸ºè´¨å¿ƒ</li></ul></li></ul><h2 id="2-sklearn-é‡Œçš„K-å‡å€¼ç®—æ³•"><a href="#2-sklearn-é‡Œçš„K-å‡å€¼ç®—æ³•" class="headerlink" title="2. sklearn é‡Œçš„K-å‡å€¼ç®—æ³•"></a>2. sklearn é‡Œçš„K-å‡å€¼ç®—æ³•</h2><p>cikit-learné‡Œçš„K-å‡å€¼ç®—æ³•ç”±sklearn.cluster.KMeansç±»å®ç°ã€‚ä¸‹é¢é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¥å­¦ä¹ æ€æ ·åœ¨scikit-learné‡Œä½¿ç”¨K-å‡å€¼ç®—æ³•ã€‚</p><p>æˆ‘ä»¬ç”Ÿæˆä¸€ç»„åŒ…å«ä¸¤ä¸ªç‰¹å¾çš„200ä¸ªæ ·æœ¬ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobsX<span class="token punctuation">,</span>y <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>                n_features<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>                centers<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>                cluster_std<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>                center_box<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10.0</span><span class="token punctuation">,</span><span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                shuffle<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæŠŠæ ·æœ¬ç”»åœ¨äºŒç»´åæ ‡ç³»ä¸Šï¼Œä»¥ä¾¿ç›´è§‚åœ°è§‚å¯Ÿï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltplt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200716173322275.png" alt="image-20200716173322275"></p><p>æ¥ç€ä½¿ç”¨ <code>KMeans</code> æ¨¡å‹æ¥æ‹Ÿåˆã€‚æˆ‘ä»¬è®¾ç½®ç±»åˆ«ä¸ªæ•°ä¸º3ï¼Œå¹¶è®¡ç®—å‡ºå…¶æ‹Ÿåˆåçš„æˆæœ¬ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeansn_clusters <span class="token operator">=</span> <span class="token number">3</span>kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span>n_clusters<span class="token punctuation">)</span>kmeans<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"kmeans: k = {}, cost = {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>n_clusters<span class="token punctuation">,</span>int<span class="token punctuation">(</span>kmeans<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">kmeans<span class="token punctuation">:</span> k <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> cost <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">668</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>KMeans.score()</code> å‡½æ•°è®¡ç®—K-å‡å€¼ç®—æ³•æ‹Ÿåˆåçš„æˆæœ¬ï¼Œç”¨è´Ÿæ•°è¡¨ç¤ºï¼Œå…¶ç»å¯¹å€¼è¶Šå¤§ï¼Œè¯´æ˜æˆæœ¬è¶Šé«˜ã€‚å‰é¢ä»‹ç»è¿‡ï¼ŒK-å‡å€¼ç®—æ³•æˆæœ¬çš„ç‰©ç†æ„ä¹‰ä¸ºè®­ç»ƒæ ·æœ¬åˆ°å…¶æ‰€å±çš„èšç±»ä¸­å¿ƒçš„è·ç¦»å¹³å‡å€¼ï¼Œåœ¨ <code>scikit-learn</code> é‡Œï¼Œå…¶è®¡ç®—æˆæœ¬çš„æ–¹æ³•ç•¥æœ‰ä¸åŒï¼Œå®ƒæ˜¯è®¡ç®—è®­ç»ƒæ ·æœ¬åˆ°å…¶æ‰€å±çš„èšç±»ä¸­å¿ƒçš„è·ç¦»çš„æ€»å’Œã€‚</p><p>å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥æŠŠåˆ†ç±»åçš„æ ·æœ¬åŠå…¶æ‰€å±çš„èšç±»ä¸­å¿ƒéƒ½ç”»å‡ºæ¥ï¼Œè¿™æ ·å¯ä»¥æ›´ç›´è§‚åœ°è§‚å¯Ÿç®—æ³•çš„æ‹Ÿåˆæ•ˆæœã€‚</p><pre class="line-numbers language-python"><code class="language-python">labels <span class="token operator">=</span> kmean<span class="token punctuation">.</span>labels_centers <span class="token operator">=</span> kmean<span class="token punctuation">.</span>cluster_centers_markers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'^'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">]</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">]</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># ç”»æ ·æœ¬</span><span class="token keyword">for</span> c <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_clusters<span class="token punctuation">)</span><span class="token punctuation">:</span>    cluster <span class="token operator">=</span> X<span class="token punctuation">[</span>labels <span class="token operator">==</span> c<span class="token punctuation">]</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>cluster<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cluster<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                 marker<span class="token operator">=</span>markers<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> c<span class="token operator">=</span>colors<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># ç”»å‡ºä¸­å¿ƒç‚¹</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>centers<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> centers<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>centers<span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'$%d$'</span> <span class="token operator">%</span> i<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> c<span class="token operator">=</span>colors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºç»“æœå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200716173439992.png" alt="image-20200716173439992"></p><p>å‰é¢è¯´è¿‡ï¼ŒK-å‡å€¼ç®—æ³•çš„ä¸€ä¸ªå…³é”®å‚æ•°æ˜¯Kï¼Œå³èšç±»ä¸ªæ•°ã€‚ä»æŠ€æœ¯è§’åº¦æ¥è®²ï¼ŒKå€¼è¶Šå¤§ï¼Œç®—æ³•æˆæœ¬è¶Šä½ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“ç†è§£ã€‚ä½†ä»ä¸šåŠ¡è§’åº¦æ¥çœ‹ï¼Œä¸æ˜¯Kå€¼è¶Šå¤§è¶Šå¥½ã€‚é’ˆå¯¹æœ¬èŠ‚çš„ä¾‹å­ï¼Œåˆ†åˆ«é€‰æ‹©K=[2,3,4]è¿™ä¸‰ç§ä¸åŒçš„èšç±»ä¸ªæ•°ï¼Œæ¥è§‚å¯Ÿä¸€ä¸‹K-å‡å€¼ç®—æ³•æœ€ç»ˆæ‹Ÿåˆçš„ç»“æœåŠå…¶æˆæœ¬ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠç”»å‡ºK-å‡å€¼èšç±»ç»“æœçš„ä»£ç ç¨å¾®æ”¹é€ ä¸€ä¸‹ï¼Œå˜æˆä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¼šä½¿ç”¨K-å‡å€¼ç®—æ³•æ¥è¿›è¡Œèšç±»æ‹Ÿåˆï¼ŒåŒæ—¶ä¼šç”»å‡ºæŒ‰ç…§è¿™ä¸ªèšç±»ä¸ªæ•°æ‹Ÿåˆåçš„åˆ†ç±»æƒ…å†µï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">fit_plot_kmean_model</span><span class="token punctuation">(</span>n_clusters<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># ä½¿ç”¨ k-å‡å€¼ç®—æ³•è¿›è¡Œæ‹Ÿåˆ</span>    kmean <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span>n_clusters<span class="token punctuation">)</span>    kmean<span class="token punctuation">.</span>fit_predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span>    labels <span class="token operator">=</span> kmean<span class="token punctuation">.</span>labels_    centers <span class="token operator">=</span> kmean<span class="token punctuation">.</span>cluster_centers_    markers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'^'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">]</span>    colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># è®¡ç®—æˆæœ¬</span>    score <span class="token operator">=</span> kmean<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"k={}, score={}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>n_clusters<span class="token punctuation">,</span> <span class="token punctuation">(</span>int<span class="token punctuation">)</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># ç”»æ ·æœ¬</span>    <span class="token keyword">for</span> c <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_clusters<span class="token punctuation">)</span><span class="token punctuation">:</span>        cluster <span class="token operator">=</span> X<span class="token punctuation">[</span>labels <span class="token operator">==</span> c<span class="token punctuation">]</span>        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>cluster<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cluster<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                     marker<span class="token operator">=</span>markers<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> c<span class="token operator">=</span>colors<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># ç”»å‡ºä¸­å¿ƒç‚¹</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>centers<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> centers<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>centers<span class="token punctuation">)</span><span class="token punctuation">:</span>        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'$%d$'</span> <span class="token operator">%</span> i<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> c<span class="token operator">=</span>colors<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‡½æ•°æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯èšç±»ä¸ªæ•°ï¼Œå³Kçš„å€¼ï¼Œå¦ä¸€ä¸ªæ˜¯æ•°æ®æ ·æœ¬ã€‚æœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œæ¥ä¸‹æ¥å°±ç®€å•äº†ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åˆ†åˆ«å¯¹[2,3,4]è¿™ä¸‰ç§ä¸åŒçš„Kå€¼æƒ…å†µè¿›è¡Œèšç±»åˆ†æï¼Œå¹¶æŠŠèšç±»ç»“æœå¯è§†åŒ–ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeansn_clusters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span><span class="token keyword">for</span> i<span class="token punctuation">,</span> c <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>n_clusters<span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    fit_plot_kmean_model<span class="token punctuation">(</span>c<span class="token punctuation">,</span> X<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200716175104911.png" alt="image-20200716175104911"></p><h2 id="3-ä½¿ç”¨K-å‡å€¼å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æ"><a href="#3-ä½¿ç”¨K-å‡å€¼å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æ" class="headerlink" title="3. ä½¿ç”¨K-å‡å€¼å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æ"></a>3. ä½¿ç”¨K-å‡å€¼å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æ</h2><p>æœ¬èŠ‚ä»‹ç»å¦‚ä½•ä½¿ç”¨K-å‡å€¼ç®—æ³•å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æã€‚å‡è®¾æœ‰ä¸€ä¸ªåšå®¢å¹³å°ï¼Œç”¨æˆ·åœ¨å¹³å°ä¸Šå‘å¸ƒåšå®¢ï¼Œæˆ‘ä»¬å¦‚ä½•å¯¹åšå®¢è¿›è¡Œèšç±»åˆ†æï¼Œä»¥æ–¹ä¾¿å±•ç¤ºä¸åŒç±»åˆ«ä¸‹çš„çƒ­é—¨æ–‡ç« å‘¢ï¼Ÿ</p><h3 id="3-1-åŠ è½½æ•°æ®é›†"><a href="#3-1-åŠ è½½æ•°æ®é›†" class="headerlink" title="3.1 åŠ è½½æ•°æ®é›†"></a>3.1 åŠ è½½æ•°æ®é›†</h3><p>æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æŠŠæ•°æ®é›†ç›®å½•ä¸‹<code>data/</code>çš„æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æã€‚ä½ å¯èƒ½æœ‰ç–‘é—®ï¼šè¿™äº›æ–‡æ¡£ä¸æ˜¯æŒ‰ç…§æ–‡ä»¶å¤¹å·²ç»åˆ†å¥½ç±»äº†å—ï¼Ÿæ˜¯çš„ï¼Œè¿™æ˜¯äººå·¥æ ‡è®°äº†çš„æ•°æ®ã€‚æœ‰äº†äººå·¥æ ‡è®°çš„æ•°æ®ï¼Œå°±å¯ä»¥æ£€éªŒK-å‡å€¼ç®—æ³•çš„æ€§èƒ½ã€‚</p><p>é¦–å…ˆéœ€è¦å¯¼å…¥æ•°æ®ï¼š</p><pre class="line-numbers language-go"><code class="language-go">from time <span class="token keyword">import</span> timefrom sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_files<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"loading documents ..."</span><span class="token punctuation">)</span>t <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>docs <span class="token operator">=</span> <span class="token function">load_files</span><span class="token punctuation">(</span><span class="token string">'datasets/clustering/data'</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"summary: {0} documents in {1} categories."</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>    <span class="token function">len</span><span class="token punctuation">(</span>docs<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>docs<span class="token punctuation">.</span>target_names<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">loading documents <span class="token punctuation">..</span>.summary: 3949 documents <span class="token keyword">in</span> 4 categories.<span class="token keyword">done</span> <span class="token keyword">in</span> 26.920000076293945 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ€»å…±æœ‰3949ç¯‡æ–‡ç« ï¼Œäººå·¥æ ‡è®°åœ¨4ä¸ªç±»åˆ«é‡Œã€‚æ¥ç€æŠŠæ–‡æ¡£è½¬åŒ–ä¸ºTF-IDFå‘é‡ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizermax_features <span class="token operator">=</span> <span class="token number">20000</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"vectorizing documents ..."</span><span class="token punctuation">)</span>t <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>vectorizer <span class="token operator">=</span> TfidfVectorizer<span class="token punctuation">(</span>max_df<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">,</span>                              min_df<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>                              max_features<span class="token operator">=</span>max_features<span class="token punctuation">,</span>                              encoding<span class="token operator">=</span><span class="token string">'latin-1'</span><span class="token punctuation">)</span>X <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span><span class="token punctuation">(</span>d <span class="token keyword">for</span> d <span class="token keyword">in</span> docs<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n_samples: %d, n_features: %d"</span> <span class="token operator">%</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"number of non-zero features in sample [{0}]: {1}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>    docs<span class="token punctuation">.</span>filenames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>getnnz<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œéœ€è¦æ³¨æ„TfidfVectorizerçš„å‡ ä¸ªå‚æ•°çš„é€‰æ‹©ã€‚max_df=0.4è¡¨ç¤ºå¦‚æœä¸€ä¸ªå•è¯åœ¨40%çš„æ–‡æ¡£é‡Œéƒ½å‡ºç°è¿‡ï¼Œåˆ™è®¤ä¸ºæ˜¯ä¸€ä¸ªé«˜é¢‘è¯ï¼Œå¯¹æ–‡æ¡£èšç±»æ²¡æœ‰å¸®åŠ©ï¼Œåœ¨ç”Ÿæˆè¯å…¸æ—¶å°±ä¼šå‰”é™¤è¿™ä¸ªè¯ã€‚min_df=2è¡¨ç¤ºï¼Œå¦‚æœä¸€ä¸ªå•è¯çš„è¯é¢‘å¤ªä½ï¼Œå°äºç­‰äº2ä¸ªï¼Œåˆ™ä¹ŸæŠŠè¿™ä¸ªå•è¯ä»è¯å…¸é‡Œå‰”é™¤ã€‚max_featureså¯ä»¥è¿›ä¸€æ­¥è¿‡æ»¤è¯å…¸çš„å¤§å°ï¼Œå®ƒä¼šæ ¹æ®TF-IDFæƒé‡ä»é«˜åˆ°ä½è¿›è¡Œæ’åºï¼Œç„¶åå–å‰é¢æƒé‡é«˜çš„å•è¯æ„æˆè¯å…¸ã€‚è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css">vectorizing documents <span class="token number">...</span><span class="token property">n_samples</span><span class="token punctuation">:</span> <span class="token number">3949</span>, <span class="token property">n_features</span><span class="token punctuation">:</span> <span class="token number">20000</span>number of non-zero features in sample [datasets/clustering/data\sci<span class="token number">.</span>electronics<span class="token entity" title="\11902">\11902</span>-<span class="token number">54322</span>]<span class="token punctuation">:</span> <span class="token number">56</span>done in <span class="token number">1.9150002002716064</span> seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä»è¾“å‡ºå¯çŸ¥ï¼Œæ¯ç¯‡æ–‡ç« æ„æˆçš„å‘é‡éƒ½æ˜¯ä¸€ä¸ªç¨€ç–å‘é‡ï¼Œå…¶å¤§éƒ¨åˆ†å…ƒç´ éƒ½ä¸º0ã€‚è¿™ä¹Ÿå®¹æ˜“ç†è§£ï¼Œæˆ‘ä»¬çš„è¯å…¸å¤§å°ä¸º20000ä¸ªè¯ï¼Œè€Œç¤ºä¾‹æ–‡ç« ä¸­ä¸é‡å¤çš„å•è¯å´åªæœ‰56ä¸ªã€‚</p><h3 id="3-2-æ–‡æœ¬èšç±»åˆ†æ"><a href="#3-2-æ–‡æœ¬èšç±»åˆ†æ" class="headerlink" title="3.2 æ–‡æœ¬èšç±»åˆ†æ"></a>3.2 æ–‡æœ¬èšç±»åˆ†æ</h3><p>æ¥ç€ä½¿ç”¨KMeansç®—æ³•å¯¹æ–‡æ¡£è¿›è¡Œèšç±»åˆ†æï¼š</p><pre class="line-numbers language-dart"><code class="language-dart">from sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeans<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"clustering documents ..."</span><span class="token punctuation">)</span>t <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>n_clusters <span class="token operator">=</span> <span class="token number">4</span>kmean <span class="token operator">=</span> <span class="token function">KMeans</span><span class="token punctuation">(</span>n_clusters<span class="token operator">=</span>n_clusters<span class="token punctuation">,</span>                max_iter<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>               tol<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>               verbose<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>               n_init<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>kmean<span class="token punctuation">.</span><span class="token function">fit</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"kmean: k={}, cost={}"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>n_clusters<span class="token punctuation">,</span> <span class="token function">int</span><span class="token punctuation">(</span>kmean<span class="token punctuation">.</span>inertia_<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€‰æ‹©èšç±»ä¸ªæ•°ä¸º4ä¸ªã€‚max_iter=100è¡¨ç¤ºæœ€å¤šè¿›è¡Œ100æ¬¡K-å‡å€¼è¿­ä»£ã€‚tol=0.1è¡¨ç¤ºä¸­å¿ƒç‚¹ç§»åŠ¨è·ç¦»å°äº0.1æ—¶å°±è®¤ä¸ºç®—æ³•å·²ç»æ”¶æ•›ï¼Œåœæ­¢è¿­ä»£ã€‚verbose=1è¡¨ç¤ºè¾“å‡ºè¿­ä»£è¿‡ç¨‹çš„è¯¦ç»†ä¿¡æ¯ã€‚n_init=3è¡¨ç¤ºè¿›è¡Œ3éK-å‡å€¼è¿ç®—åæ±‚å¹³å‡å€¼ã€‚å‰é¢ä»‹ç»è¿‡ï¼Œåœ¨ç®—æ³•åˆšå¼€å§‹è¿­ä»£æ—¶ï¼Œä¼šéšæœºé€‰æ‹©èšç±»ä¸­å¿ƒç‚¹ï¼Œä¸åŒçš„ä¸­å¿ƒç‚¹å¯èƒ½å¯¼è‡´ä¸åŒçš„æ”¶æ•›æ•ˆæœï¼Œå› æ­¤å¤šæ¬¡è¿ç®—æ±‚å¹³å‡å€¼çš„æ–¹æ³•å¯ä»¥æé«˜ç®—æ³•çš„ç¨³å®šæ€§ã€‚ç”±äºå¼€å¯äº†è¿­ä»£è¿‡ç¨‹ä¿¡æ¯æ˜¾ç¤ºï¼Œè¾“å‡ºäº†è¾ƒå¤šçš„ä¿¡æ¯ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">clustering documents <span class="token punctuation">..</span>.Initialization completeIteration  0, inertia 7488.362Iteration  1, inertia 3845.708Iteration  2, inertia 3835.369Iteration  3, inertia 3828.959Iteration  4, inertia 3824.555Iteration  5, inertia 3820.932Iteration  6, inertia 3818.555Iteration  7, inertia 3817.377Iteration  8, inertia 3816.317Iteration  9, inertia 3815.570Iteration 10, inertia 3815.351Iteration 11, inertia 3815.234Iteration 12, inertia 3815.181Iteration 13, inertia 3815.151Iteration 14, inertia 3815.136Iteration 15, inertia 3815.120Iteration 16, inertia 3815.113Iteration 17, inertia 3815.106Iteration 18, inertia 3815.104Converged at iteration 18: center <span class="token function">shift</span> 0.000000e+00 within tolerance 4.896692e-07Initialization completeIteration  0, inertia 7494.329Iteration  1, inertia 3843.474Iteration  2, inertia 3835.570Iteration  3, inertia 3828.511Iteration  4, inertia 3823.826Iteration  5, inertia 3819.972Iteration  6, inertia 3817.714Iteration  7, inertia 3816.666Iteration  8, inertia 3816.032Iteration  9, inertia 3815.778Iteration 10, inertia 3815.652Iteration 11, inertia 3815.548Iteration 12, inertia 3815.462Iteration 13, inertia 3815.424Iteration 14, inertia 3815.411Iteration 15, inertia 3815.404Iteration 16, inertia 3815.402Converged at iteration 16: center <span class="token function">shift</span> 0.000000e+00 within tolerance 4.896692e-07Initialization completeIteration  0, inertia 7538.349Iteration  1, inertia 3844.796Iteration  2, inertia 3828.820Iteration  3, inertia 3822.973Iteration  4, inertia 3821.341Iteration  5, inertia 3820.164Iteration  6, inertia 3819.181Iteration  7, inertia 3818.546Iteration  8, inertia 3818.167Iteration  9, inertia 3817.975Iteration 10, inertia 3817.862Iteration 11, inertia 3817.770Iteration 12, inertia 3817.723Iteration 13, inertia 3817.681Iteration 14, inertia 3817.654Iteration 15, inertia 3817.628Iteration 16, inertia 3817.607Iteration 17, inertia 3817.593Iteration 18, inertia 3817.585Iteration 19, inertia 3817.580Converged at iteration 19: center <span class="token function">shift</span> 0.000000e+00 within tolerance 4.896692e-07kmean: k<span class="token operator">=</span>4, cost<span class="token operator">=</span>3815<span class="token keyword">done</span> <span class="token keyword">in</span> 39.484999895095825 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¥½å¥‡çš„æ˜¯ï¼šåœ¨è¿›è¡Œèšç±»åˆ†æçš„è¿‡ç¨‹ä¸­ï¼Œå“ªäº›å•è¯çš„æƒé‡æœ€é«˜ï¼Œä»è€Œè¾ƒå®¹æ˜“åœ°å†³å®šä¸€ä¸ªæ–‡ç« çš„ç±»åˆ«ï¼Ÿæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ¯ç§ç±»åˆ«æ–‡æ¡£ä¸­ï¼Œå…¶æƒé‡æœ€é«˜çš„10ä¸ªå•è¯åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> print_function<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Top terms per cluster:"</span><span class="token punctuation">)</span>order_centroids <span class="token operator">=</span> kmean<span class="token punctuation">.</span>cluster_centers_<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>terms <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>get_feature_names<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_clusters<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Cluster %d:"</span> <span class="token operator">%</span> i<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> ind <span class="token keyword">in</span> order_centroids<span class="token punctuation">[</span>i<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">' %s'</span> <span class="token operator">%</span> terms<span class="token punctuation">[</span>ind<span class="token punctuation">]</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç†è§£è¿™æ®µä»£ç çš„å…³é”®åœ¨äºargsort()å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠä¸€ä¸ªNumpyæ•°ç»„è¿›è¡Œå‡åºæ’åˆ—ï¼Œè¿”å›çš„æ˜¯æ’åºåçš„ç´¢å¼•ã€‚</p><p>å›åˆ°æˆ‘ä»¬çš„ä»£ç é‡Œï¼Œç”±äº kmean.cluster_centers æ˜¯äºŒç»´æ•°ç»„ï¼Œå› æ­¤ kmean.cluster_centers.argsort()[:,::-1] è¯­å¥çš„å«ä¹‰å°±æ˜¯æŠŠèšç±»ä¸­å¿ƒç‚¹çš„ä¸åŒåˆ†é‡ï¼ŒæŒ‰ç…§ä»å¤§åˆ°å°çš„é¡ºåºè¿›è¡Œæ’åºï¼Œå¹¶ä¸”æŠŠæ’åºåçš„å…ƒç´ ç´¢å¼•ä¿å­˜åœ¨äºŒç»´æ•°ç»„order_centroidsé‡Œã€‚vectorizer.get_feature_names()å°†å¾—åˆ°æˆ‘ä»¬çš„è¯å…¸å•è¯ï¼Œæ ¹æ®ç´¢å¼•å³å¯å¾—åˆ°æ¯ä¸ªç±»åˆ«é‡Œæƒé‡æœ€é«˜çš„é‚£äº›å•è¯äº†ã€‚è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-csharp"><code class="language-csharp">Top terms per cluster<span class="token punctuation">:</span>Cluster <span class="token number">0</span><span class="token punctuation">:</span> space henry nasa toronto moon pat zoo shuttle gov orbitCluster <span class="token number">1</span><span class="token punctuation">:</span> my any me by know your some <span class="token keyword">do</span> so hasCluster <span class="token number">2</span><span class="token punctuation">:</span> key clipper encryption chip government will keys escrow we nsaCluster <span class="token number">3</span><span class="token punctuation">:</span> geb pitt banks gordon shameful dsl n3jxp chastity cadre surrender<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°"><a href="#4-èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°" class="headerlink" title="4.èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°"></a>4.èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°</h3><p>èšç±»æ€§èƒ½è¯„ä¼°æ¯”è¾ƒå¤æ‚ï¼Œä¸åƒåˆ†ç±»é‚£æ ·ç›´è§‚ã€‚é’ˆå¯¹åˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¡ç®—è¢«é”™è¯¯åˆ†ç±»çš„æ ·æœ¬æ•°é‡ï¼Œè¿™æ ·å¯ä»¥ç›´æ¥ç®—å‡ºåˆ†ç±»ç®—æ³•çš„å‡†ç¡®ç‡ã€‚èšç±»é—®é¢˜ä¸èƒ½ä½¿ç”¨ç»å¯¹æ•°é‡çš„æ–¹æ³•è¿›è¡Œæ€§èƒ½è¯„ä¼°ï¼ŒåŸå› æ˜¯ï¼Œèšç±»åˆ†æåçš„ç±»åˆ«ä¸åŸæ¥å·²æ ‡è®°çš„ç±»åˆ«ä¹‹é—´ä¸å­˜åœ¨å¿…ç„¶çš„ä¸€ä¸€å¯¹åº”å…³ç³»ã€‚æ›´å…¸å‹çš„ï¼Œé’ˆå¯¹K-å‡å€¼ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©Kçš„æ•°å€¼ä¸ç­‰äºå·²æ ‡è®°çš„ç±»åˆ«ä¸ªæ•°ã€‚</p><p>å‰é¢ä»‹ç»å†³ç­–æ ‘çš„æ—¶å€™ç®€å•ä»‹ç»è¿‡â€œç†µâ€çš„æ¦‚å¿µï¼Œå®ƒæ˜¯ä¿¡æ¯è®ºä¸­æœ€é‡è¦çš„åŸºç¡€æ¦‚å¿µã€‚ç†µè¡¨ç¤ºä¸€ä¸ªç³»ç»Ÿçš„æœ‰åºç¨‹åº¦ï¼Œè€Œèšç±»é—®é¢˜çš„æ€§èƒ½è¯„ä¼°ï¼Œå°±æ˜¯å¯¹æ¯”ç»è¿‡èšç±»ç®—æ³•å¤„ç†åçš„æ•°æ®çš„æœ‰åºç¨‹åº¦ï¼Œä¸äººå·¥æ ‡è®°çš„æœ‰åºç¨‹åº¦ä¹‹é—´çš„å·®å¼‚ã€‚ä¸‹é¢ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„èšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°æŒ‡æ ‡</p><h6 id="1-Adjust-Rand-Index"><a href="#1-Adjust-Rand-Index" class="headerlink" title="1.Adjust Rand Index"></a><strong>1.Adjust Rand Index</strong></h6><p>Adjust Rand Indexæ˜¯ä¸€ç§è¡¡é‡ä¸¤ä¸ªåºåˆ—ç›¸ä¼¼æ€§çš„ç®—æ³•ã€‚å®ƒçš„ä¼˜ç‚¹æ˜¯ï¼Œé’ˆå¯¹ä¸¤ä¸ªéšæœºåºåˆ—ï¼Œå®ƒçš„å€¼ä¸ºè´Ÿæ•°æˆ–æ¥è¿‘0ã€‚è€Œé’ˆå¯¹ä¸¤ä¸ªç»“æ„ç›¸åŒçš„åºåˆ—ï¼Œå®ƒçš„å€¼æ¥è¿‘1ã€‚è€Œä¸”å¯¹ç±»åˆ«æ ‡ç­¾ä¸æ•æ„Ÿã€‚</p><h6 id="2-é½æ¬¡æ€§å’Œå®Œæ•´æ€§"><a href="#2-é½æ¬¡æ€§å’Œå®Œæ•´æ€§" class="headerlink" title="2.é½æ¬¡æ€§å’Œå®Œæ•´æ€§"></a><strong>2.é½æ¬¡æ€§å’Œå®Œæ•´æ€§</strong></h6><p>æ ¹æ®æ¡ä»¶ç†µåˆ†æï¼Œå¯ä»¥å¾—åˆ°å¦å¤–ä¸¤ä¸ªè¡¡é‡èšç±»ç®—æ³•æ€§èƒ½çš„æŒ‡æ ‡ï¼Œåˆ†åˆ«æ˜¯é½æ¬¡æ€§ï¼ˆhomogeneityï¼‰å’Œå®Œæ•´æ€§ï¼ˆcompletenessï¼‰ã€‚é½æ¬¡æ€§è¡¨ç¤ºä¸€ä¸ªèšç±»å…ƒç´ åªç”±ä¸€ç§ç±»åˆ«çš„å…ƒç´ ç»„æˆã€‚å®Œæ•´æ€§è¡¨ç¤ºç»™å®šçš„å·²æ ‡è®°çš„ç±»åˆ«ï¼Œå…¨éƒ¨åˆ†é…åˆ°ä¸€ä¸ªèšç±»é‡Œã€‚å®ƒä»¬çš„å€¼å‡ä»‹äº[0,1]ä¹‹é—´ã€‚</p><h6 id="3-è½®å»“ç³»æ•°"><a href="#3-è½®å»“ç³»æ•°" class="headerlink" title="3.è½®å»“ç³»æ•°"></a><strong>3.è½®å»“ç³»æ•°</strong></h6><p>ä¸Šé¢ä»‹ç»çš„èšç±»æ€§èƒ½è¯„ä¼°æ–¹æ³•éƒ½éœ€è¦æœ‰å·²æ ‡è®°çš„ç±»åˆ«æ•°æ®ï¼Œè¿™ä¸ªåœ¨å®è·µä¸­æ˜¯å¾ˆéš¾åšåˆ°çš„ã€‚å¦‚æœå·²ç»æ ‡è®°äº†æ•°æ®ï¼Œå°±ä¼šç›´æ¥ä½¿ç”¨æœ‰ç›‘ç£çš„å­¦ä¹ ç®—æ³•ï¼Œè€Œæ— ç›‘ç£å­¦ä¹ ç®—æ³•çš„æœ€å¤§ä¼˜ç‚¹å°±æ˜¯ä¸éœ€è¦å¯¹æ•°æ®é›†è¿›è¡Œæ ‡è®°ã€‚è½®å»“ç³»æ•°å¯ä»¥åœ¨ä¸éœ€è¦å·²æ ‡è®°çš„æ•°æ®é›†çš„å‰æä¸‹ï¼Œå¯¹èšç±»ç®—æ³•çš„æ€§èƒ½è¿›è¡Œè¯„ä¼°ã€‚</p><p>è½®å»“ç³»æ•°ç”±ä»¥ä¸‹ä¸¤ä¸ªæŒ‡æ ‡æ„æˆï¼š</p><ul><li>aï¼šä¸€ä¸ªæ ·æœ¬ä¸å…¶æ‰€åœ¨ç›¸åŒèšç±»çš„ç‚¹çš„å¹³å‡è·ç¦»ï¼›</li><li>bï¼šä¸€ä¸ªæ ·æœ¬ä¸å…¶è·ç¦»æœ€è¿‘çš„ä¸‹ä¸€ä¸ªèšç±»é‡Œçš„ç‚¹çš„å¹³å‡è·ç¦»ã€‚</li></ul><p>é’ˆå¯¹è¿™ä¸ªæ ·æœ¬ï¼Œå…¶è½®å»“ç³»æ•°sçš„å€¼ä¸ºï¼š<br>$$<br>s=\frac{b-a}{\max (a, b)}<br>$$<br>é’ˆå¯¹ä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶è½®å»“ç³»æ•°sä¸ºå…¶æ‰€æœ‰æ ·æœ¬çš„è½®å»“ç³»æ•°çš„å¹³å‡å€¼ã€‚è½®å»“ç³»æ•°çš„æ•°å€¼ä»‹äº[-1,1]ä¹‹é—´ï¼Œ-1è¡¨ç¤ºå®Œå…¨é”™è¯¯çš„èšç±»ï¼Œ1è¡¨ç¤ºå®Œç¾çš„èšç±»ï¼Œ0è¡¨ç¤ºèšç±»é‡å ã€‚</p><p>é’ˆå¯¹å‰é¢çš„ä¾‹å­ï¼Œå¯ä»¥åˆ†åˆ«è®¡ç®—æœ¬èŠ‚ä»‹ç»çš„å‡ ä¸ªèšç±»ç®—æ³•æ€§èƒ½è¯„ä¼°æŒ‡æ ‡ï¼Œç»¼åˆæ¥çœ‹èšç±»ç®—æ³•çš„æ€§èƒ½ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> metricslabels <span class="token operator">=</span> docs<span class="token punctuation">.</span>target<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Homogeneity: %0.3f"</span> <span class="token operator">%</span> metrics<span class="token punctuation">.</span>homogeneity_score<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> kmean<span class="token punctuation">.</span>labels_<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Completeness: %0.3f"</span> <span class="token operator">%</span> metrics<span class="token punctuation">.</span>completeness_score<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> kmean<span class="token punctuation">.</span>labels_<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"V-measure: %0.3f"</span> <span class="token operator">%</span> metrics<span class="token punctuation">.</span>v_measure_score<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> kmean<span class="token punctuation">.</span>labels_<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Adjusted Rand-Index: %.3f"</span>      <span class="token operator">%</span> metrics<span class="token punctuation">.</span>adjusted_rand_score<span class="token punctuation">(</span>labels<span class="token punctuation">,</span> kmean<span class="token punctuation">.</span>labels_<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Silhouette Coefficient: %0.3f"</span>      <span class="token operator">%</span> metrics<span class="token punctuation">.</span>silhouette_score<span class="token punctuation">(</span>X<span class="token punctuation">,</span> kmean<span class="token punctuation">.</span>labels_<span class="token punctuation">,</span> sample_size<span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css"><span class="token property">Homogeneity</span><span class="token punctuation">:</span> <span class="token number">0.459</span><span class="token property">Completeness</span><span class="token punctuation">:</span> <span class="token number">0.519</span><span class="token property">V-measure</span><span class="token punctuation">:</span> <span class="token number">0.487</span>Adjusted <span class="token property">Rand-Index</span><span class="token punctuation">:</span> <span class="token number">0.328</span>Silhouette <span class="token property">Coefficient</span><span class="token punctuation">:</span> <span class="token number">0.004</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°æ¨¡å‹æ€§èƒ½å¾ˆä¸€èˆ¬ã€‚å¯èƒ½çš„ä¸€ä¸ªåŸå› æ˜¯æ•°æ®é›†è´¨é‡ä¸é«˜ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é˜…è¯»åŸå§‹çš„è¯­æ–™åº“ï¼Œæ£€éªŒä¸€ä¸‹å¦‚æœé€šè¿‡äººå·¥æ ‡è®°ï¼Œæ˜¯å¦èƒ½å¤Ÿæ ‡è®°å‡ºè¿™äº›æ–‡ç« çš„æ­£ç¡®åˆ†ç±»ã€‚å¦å¤–ï¼Œé’ˆå¯¹myã€anyã€meã€byã€knowã€yourã€someã€doã€soã€hasï¼Œè¿™äº›éƒ½æ˜¯æ²¡æœ‰ç‰¹å¾çš„å•è¯ï¼Œå³ä½¿äººå·¥æ ‡è®°ï¼Œä¹Ÿæ— æ³•åˆ¤æ–­è¿™äº›å•è¯åº”è¯¥å±äºå“ªç§ç±»åˆ«çš„æ–‡ç« ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MLç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scikit-learnç³»åˆ—å…«ï¼šPCA</title>
      <link href="/2020/07/15/scikit-learn-xi-lie-ba-pca/"/>
      <url>/2020/07/15/scikit-learn-xi-lie-ba-pca/</url>
      
        <content type="html"><![CDATA[<h2 id="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼"><a href="#é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼" class="headerlink" title="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼"></a>é¡¹ç›®åœ°å€<a href="https://github.com/DongZhouGu/scikit-learn-ml" target="_blank" rel="noopener">ä¼ é€é—¨</a>ï¼Œæ¬¢è¿ star å’Œ fork ï¼</h2><h2 id="1-PCAæ¦‚è¿°"><a href="#1-PCAæ¦‚è¿°" class="headerlink" title="1. PCAæ¦‚è¿°"></a>1. PCAæ¦‚è¿°</h2><p>PCAç®—æ³•å…¨ç§°æ˜¯ Principal Component Analysisï¼Œå³ä¸»æˆåˆ†åˆ†æç®—æ³•ã€‚å®ƒæ˜¯ä¸€ç§ç»´æ•°çº¦å‡ï¼ˆDimensionality Reductionï¼‰ç®—æ³•ï¼Œå³æŠŠé«˜ç»´åº¦æ•°æ®åœ¨æŸå¤±æœ€å°çš„æƒ…å†µä¸‹è½¬æ¢ä¸ºä½ç»´åº¦æ•°æ®çš„ç®—æ³•ã€‚æ˜¾ç„¶ï¼ŒPCAå¯ä»¥ç”¨æ¥å¯¹æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œå¯ä»¥åœ¨å¯æ§çš„å¤±çœŸèŒƒå›´å†…æé«˜è¿ç®—é€Ÿåº¦ã€‚ã€‚</p><h2 id="2-PCAç®—æ³•åŸç†"><a href="#2-PCAç®—æ³•åŸç†" class="headerlink" title="2. PCAç®—æ³•åŸç†"></a>2. PCAç®—æ³•åŸç†</h2><p>æˆ‘ä»¬å…ˆä»æœ€ç®€å•çš„æƒ…å†µè°ˆèµ·ï¼Œå‡è®¾éœ€è¦æŠŠä¸€ä¸ªäºŒç»´æ•°æ®é™ç»´æˆä¸€ç»´æ•°æ®ï¼Œè¦æ€ä¹ˆåšå‘¢ï¼Ÿå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-805dbb25ada21691.png" alt="img"></p><p>æˆ‘ä»¬å¯ä»¥æƒ³åŠæ³•æ‰¾å‡ºä¸€ä¸ªå‘é‡ $u^{(1)}$ ï¼Œä»¥ä¾¿è®©äºŒç»´æ•°æ®çš„ç‚¹ï¼ˆæ–¹å½¢ç‚¹ï¼‰åˆ°è¿™ä¸ªå‘é‡æ‰€åœ¨çš„ç›´çº¿ä¸Šçš„å¹³å‡è·ç¦»æœ€çŸ­ï¼Œå³æŠ•å°„è¯¯å·®æœ€å°ã€‚</p><p>è¿™æ ·å°±å¯ä»¥åœ¨å¤±çœŸæœ€å°çš„æƒ…å†µä¸‹ï¼ŒæŠŠäºŒç»´æ•°æ®è½¬æ¢ä¸ºå‘é‡ $u^{(1)}$ ï¼Œæ‰€åœ¨ç›´çº¿ä¸Šçš„ä¸€ç»´æ•°æ®ã€‚å†è¿›ä¸€æ­¥ï¼Œå‡è®¾éœ€è¦æŠŠä¸‰ç»´æ•°æ®é™ä¸ºäºŒç»´æ•°æ®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾å‡ºä¸¤ä¸ªå‘é‡  $u^{(1)}$  å’Œ $u^{(2)}$ ï¼Œä»¥ä¾¿è®©ä¸‰ç»´æ•°æ®çš„ç‚¹åœ¨è¿™ä¸¤ä¸ªå‘é‡å†³å®šçš„å¹³é¢ä¸Šçš„æŠ•å°„è¯¯å·®æœ€å°ã€‚</p><p>å¦‚æœä»æ•°å­¦è§’åº¦æ¥ä¸€èˆ¬åœ°æè¿°PCAç®—æ³•å°±æ˜¯ï¼šå½“éœ€è¦ä»nç»´æ•°æ®é™ä¸ºkç»´æ•°æ®æ—¶ï¼Œéœ€è¦æ‰¾å‡ºkä¸ªå‘é‡</p><p>  $u^{(1)}$  ï¼Œ  $u^{(2)}$  ï¼Œâ€¦â€¦  $u^{(k)}$  ï¼ŒæŠŠnç»´çš„æ•°æ®æŠ•å°„åˆ°è¿™kä¸ªå‘é‡å†³å®šçš„çº¿æ€§ç©ºé—´é‡Œï¼Œæœ€ç»ˆä½¿æŠ•å°„è¯¯å·®æœ€å°åŒ–çš„è¿‡ç¨‹ã€‚</p><p>é—®é¢˜æ¥äº†ï¼Œ<strong>æ€æ ·æ‰¾å‡ºæŠ•å°„è¯¯å·®æœ€å°çš„kä¸ªå‘é‡å‘¢</strong>ï¼Ÿè¦å®Œæ•´çš„ç”¨æ•°å­¦å…¬å¼æ¨å¯¼è¿™ä¸ªæ–¹æ³•ï¼Œæ¶‰åŠè¾ƒå¤šé«˜çº§çº¿æ€§ä»£æ•°çš„çŸ¥è¯†ï¼Œè¿™é‡Œä¸å†è¯¦è¿°ã€‚æ„Ÿå…´è¶£çš„è¯å¯ä»¥å‚è€ƒåé¢æ‰©å±•éƒ¨åˆ†çš„å†…å®¹ã€‚ä¸‹é¢æˆ‘ä»¬ç›´æ¥ä»‹ç»PCAç®—æ³•æ±‚è§£çš„ä¸€èˆ¬æ­¥éª¤ã€‚</p><p>å‡è®¾æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œç”¨m x nç»´çš„çŸ©é˜µAè¡¨ç¤ºã€‚çŸ©é˜µä¸­æ¯ä¸€è¡Œè¡¨ç¤ºä¸€ä¸ªæ ·æœ¬ï¼Œæ¯ä¸€åˆ—è¡¨ç¤ºä¸€ä¸ªç‰¹å¾ï¼Œæ€»å…±æœ‰mä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰nä¸ªç‰¹å¾ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å‡å°‘ç‰¹å¾ä¸ªæ•°ï¼Œä¿ç•™æœ€é‡è¦çš„kä¸ªç‰¹å¾ã€‚</p><h3 id="2-1æ•°æ®å½’ä¸€åŒ–å’Œç¼©æ”¾"><a href="#2-1æ•°æ®å½’ä¸€åŒ–å’Œç¼©æ”¾" class="headerlink" title="2.1æ•°æ®å½’ä¸€åŒ–å’Œç¼©æ”¾"></a>2.1æ•°æ®å½’ä¸€åŒ–å’Œç¼©æ”¾</h3><p>æ•°æ®å½’ä¸€åŒ–å’Œç¼©æ”¾æ˜¯ä¸€ç§æ•°å­¦æŠ€å·§ï¼Œæ—¨åœ¨æé«˜PCAè¿ç®—æ—¶çš„æ•ˆç‡ã€‚æ•°æ®å½’ä¸€åŒ–çš„ç›®æ ‡æ˜¯ä½¿ç‰¹å¾çš„å‡å€¼ä¸º0ã€‚æ•°æ®å½’ä¸€åŒ–å…¬å¼ä¸º:<br>$$<br>x_{j}^{(i)}=a_{j}^{(i)}-\mu_{j}<br>$$<br>å…¶ä¸­ï¼Œ$a_{j}^{(i)}$æ˜¯æŒ‡ç¬¬iä¸ªæ ·æœ¬çš„ç¬¬jä¸ªç‰¹å¾çš„å€¼ï¼Œ$\mu_{j}$è¡¨ç¤ºçš„æ˜¯ç¬¬jä¸ªç‰¹å¾çš„å‡å€¼ã€‚å½“ä¸åŒçš„ç‰¹å¾å€¼ä¸åœ¨åŒä¸€ä¸ªæ•°é‡çº§ä¸Šçš„æ—¶å€™ï¼Œè¿˜éœ€è¦å¯¹æ•°æ®è¿›è¡Œç¼©æ”¾ã€‚æ•°æ®å½’ä¸€åŒ–åœ¨ç¼©æ”¾çš„å…¬å¼ä¸ºï¼š<br>$$<br>x_{j}^{(i)}=\frac{a_{j}^{(i)}-\mu_{j}}{s_{j}}<br>$$<br>å…¶ä¸­ï¼Œ$a_{j}^{(i)}$æ˜¯æŒ‡ç¬¬iä¸ªæ ·æœ¬çš„ç¬¬jä¸ªç‰¹å¾çš„å€¼ï¼Œ$\mu_{j}$è¡¨ç¤ºçš„æ˜¯ç¬¬jä¸ªç‰¹å¾çš„å‡å€¼ã€‚$s_{j}$è¡¨ç¤ºç¬¬jä¸ªç‰¹å¾çš„èŒƒå›´ï¼Œå³ $s_{j} = max(a_{j}^{(i)})-min(a_{j}^{(i)})$</p><h3 id="2-2-è®¡ç®—åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å‘é‡"><a href="#2-2-è®¡ç®—åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å‘é‡" class="headerlink" title="2.2 è®¡ç®—åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å‘é‡"></a>2.2 è®¡ç®—åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å‘é‡</h3><p>é’ˆå¯¹é¢„å¤„ç†åçš„çŸ©é˜µXï¼Œå…ˆè®¡ç®—å…¶åæ–¹å·®çŸ©é˜µï¼ˆCovariance Matrixï¼‰ï¼š<br>$$<br>\Sigma=\frac{1}{m} X^{T} X<br>$$<br>å…¶ä¸­ï¼Œ$\Sigma $ è¡¨ç¤ºåæ–¹å·®çŸ©é˜µï¼Œç”¨å¤§å†™çš„Sigmaè¡¨ç¤ºï¼Œæ˜¯ä¸€ä¸ªn * nç»´çš„çŸ©é˜µã€‚</p><p>æ¥ç€é€šè¿‡å¥‡å¼‚å€¼åˆ†è§£æ¥è®¡ç®—åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å‘é‡ï¼š<br>$$<br>[U, S, V]=s v d(\Sigma)<br>$$<br>å…¶ä¸­ï¼Œsvd æ˜¯å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSingular Value Decompositionï¼‰è¿ç®—ï¼Œæ˜¯é«˜çº§çº¿æ€§ä»£æ•°çš„å†…å®¹ã€‚ç»è¿‡å¥‡å¼‚å€¼åˆ†è§£åï¼Œæœ‰3ä¸ªè¿”å›å€¼ï¼Œå…¶ä¸­çŸ©é˜µUæ˜¯ä¸€ä¸ªn * nçš„çŸ©é˜µï¼Œå¦‚æœæˆ‘ä»¬é€‰æ‹©Uçš„åˆ—ä½œä¸ºå‘é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å¾—åˆ°nä¸ªåˆ—å‘é‡ $u^{(1)}$  ï¼Œ  $u^{(2)}$  ï¼Œâ€¦â€¦  $u^{(n)}$  ,è¿™äº›å‘é‡å°±æ˜¯åæ–¹å·®çŸ©é˜µçš„ç‰¹å¾å‘é‡ã€‚å®ƒè¡¨ç¤ºçš„ç‰©ç†æ„ä¹‰æ˜¯ï¼Œåæ–¹å·®çŸ©é˜µ  $\Sigma $ å¯ä»¥ç”±è¿™äº›ç‰¹å¾å‘é‡è¿›è¡Œçº¿æ€§ç»„åˆå¾—åˆ°ã€‚</p><h3 id="2-3-æ•°æ®é™ç»´å’Œæ¢å¤"><a href="#2-3-æ•°æ®é™ç»´å’Œæ¢å¤" class="headerlink" title="2.3  æ•°æ®é™ç»´å’Œæ¢å¤"></a>2.3  æ•°æ®é™ç»´å’Œæ¢å¤</h3><p>å¾—åˆ°ç‰¹å¾çŸ©é˜µåï¼Œå°±å¯ä»¥å¯¹æ•°æ®è¿›è¡Œé™ç»´å¤„ç†äº†ã€‚å‡è®¾é™ç»´å‰çš„å€¼æ˜¯  $x^{(i)}$ï¼Œé™ç»´åæ˜¯$z^{(i)}$ï¼Œé‚£ä¹ˆ<br>$$<br>z^{(i)}=U_{r e d u c e}^{T} x^{(i)}<br>$$<br>å…¶ä¸­ï¼Œ$U_{r e d u c e}=[u^{(1)} ,u^{(2)}ï¼Œâ€¦â€¦u^{(k)}]$ ï¼Œå®ƒé€‰å–è‡ªçŸ©é˜µUçš„å‰kä¸ªå‘é‡ï¼Œ$U_{r e d u c e}$</p><p>ç§°ä¸ºä¸»æˆåˆ†ç‰¹å¾çŸ©é˜µï¼Œå®ƒæ˜¯æ•°æ®é™ç»´å’Œæ¢å¤çš„å…³é”®ä¸­é—´å˜é‡ã€‚çœ‹ä¸€ä¸‹æ•°æ®ç»´åº¦ï¼Œ$U_{r e d u c e}$æ˜¯n * kçš„çŸ©é˜µï¼Œå› æ­¤ $U_{r e d u c e}^{T}$æ˜¯k * nçš„çŸ©é˜µ.</p><p>ä¹Ÿå¯ä»¥ç”¨çŸ©é˜µè¿ç®—ä¸€æ¬¡æ€§è½¬æ¢å¤šä¸ªå‘é‡ï¼Œæé«˜æ•ˆç‡ã€‚å‡è®¾Xæ˜¯è¡Œå‘é‡ $x^{(i)}$ç»„æˆçš„çŸ©é˜µï¼Œåˆ™<br>$$<br>Z=X U_{\text {reduce}}<br>$$<br>å…¶ä¸­ï¼ŒXæ˜¯m * nçš„çŸ©é˜µï¼Œé™ç»´åçš„çŸ©é˜µZæ˜¯ä¸€ä¸ªm * kçš„çŸ©é˜µã€‚</p><p>æ•°æ®é™ç»´åï¼Œæ€ä¹ˆæ¢å¤å‘¢ï¼Ÿä»å‰é¢çš„è®¡ç®—å…¬å¼æˆ‘ä»¬çŸ¥é“ï¼Œé™ç»´åçš„æ•°æ®è®¡ç®—å…¬å¼<br>$ z^{(i)}=U_{r e d u c e}^{T} x^{(i)} $ ã€‚æ‰€ä»¥å¦‚æœè¦è¿˜åŸæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å…¬å¼ï¼š<br>$$<br>x_{a p p r o x}^{(i)}=U_{r e d u c e} z^{(i)}<br>$$<br>å…¶ä¸­ï¼Œ$U_{r e d u c e}$æ˜¯n * kçš„çŸ©é˜µï¼Œ$z^{(i)}$æ˜¯kç»´åˆ—å‘é‡ã€‚è¿™æ ·ç®—å‡ºæ¥çš„$x^{(i)} $å°±æ˜¯nç»´åˆ—å‘é‡ã€‚</p><p>çŸ©é˜µåŒ–æ•°æ®æ¢å¤è¿ç®—å…¬å¼ä¸ºï¼š<br>$$<br>X_{approx}=Z U_{r e d u c e}^{T}<br>$$<br>å…¶ä¸­, $X_{approx}$ æ˜¯è¿˜åŸå›æ¥çš„æ•°æ®ï¼Œæ˜¯ä¸€ä¸ªm * nçš„çŸ©é˜µï¼Œæ¯è¡Œè¡¨ç¤ºä¸€ä¸ªè®­ç»ƒæ ·ä¾‹ã€‚Zæ˜¯ä¸€ä¸ªm * kçš„çŸ©é˜µï¼Œæ˜¯é™ç»´åçš„æ•°æ®ã€‚</p><h2 id="3-PCAç®—æ³•ç¤ºä¾‹"><a href="#3-PCAç®—æ³•ç¤ºä¾‹" class="headerlink" title="3. PCAç®—æ³•ç¤ºä¾‹"></a>3. PCAç®—æ³•ç¤ºä¾‹</h2><p>å‡è®¾æˆ‘ä»¬çš„æ•°æ®é›†æ€»å…±æœ‰5ä¸ªè®°å½•ï¼Œæ¯ä¸ªè®°å½•æœ‰2ä¸ªç‰¹å¾ï¼Œè¿™æ ·æ„æˆçš„çŸ©é˜µAä¸ºï¼š<br>$$<br>A=\left[\begin{array}{ll}<br>3 &amp; 2000 \<br>2 &amp; 3000 \<br>4 &amp; 5000 \<br>5 &amp; 8000 \<br>1 &amp; 2000<br>\end{array}\right]<br>$$<br>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æŠŠäºŒç»´æ•°æ®é™ä¸ºä¸€ç»´æ•°æ®ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£PCAçš„è®¡ç®—è¿‡ç¨‹ï¼Œåˆ†åˆ«ä½¿ç”¨ Numpyå’Œsklearn å¯¹åŒä¸€ä¸ªæ•°æ®è¿›è¡ŒPCAé™ç»´å¤„ç†ã€‚</p><h3 id="3-1-ä½¿ç”¨Numpyæ¨¡æ‹ŸPCAè®¡ç®—è¿‡ç¨‹"><a href="#3-1-ä½¿ç”¨Numpyæ¨¡æ‹ŸPCAè®¡ç®—è¿‡ç¨‹" class="headerlink" title="3.1 ä½¿ç”¨Numpyæ¨¡æ‹ŸPCAè®¡ç®—è¿‡ç¨‹"></a>3.1 ä½¿ç”¨Numpyæ¨¡æ‹ŸPCAè®¡ç®—è¿‡ç¨‹</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npA <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>             <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>             <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>             <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">8000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>             <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token string">'float'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># æ•°æ®å½’ä¸€åŒ–ï¼Œaxis=0è¡¨ç¤ºæŒ‰åˆ—å½’ä¸€åŒ–</span>mean <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>A<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>norm <span class="token operator">=</span> A <span class="token operator">-</span> mean<span class="token comment" spellcheck="true"># æ•°æ®ç¼©æ”¾</span>score <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>norm<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">-</span>np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>norm<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>norm <span class="token operator">=</span> norm <span class="token operator">/</span> score<span class="token keyword">print</span><span class="token punctuation">(</span>norm<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äºä¸¤ä¸ªç‰¹å¾çš„å‡å€¼ä¸åœ¨åŒä¸€ä¸ªæ•°é‡çº§ï¼Œæ‰€ä»¥å¯¹æ•°æ®è¿›è¡Œäº†ç¼©æ”¾ã€‚è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">.</span>        <span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.33333333</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.25</span>      <span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.16666667</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.25</span>      <span class="token punctuation">,</span>  <span class="token number">0.16666667</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.5</span>       <span class="token punctuation">,</span>  <span class="token number">0.66666667</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.5</span>       <span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.33333333</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€ï¼Œå¯¹åæ–¹å·®çŸ©é˜µè¿›è¡Œå¥‡å¼‚å€¼åˆ†è§£ï¼Œæ±‚è§£å…¶ç‰¹å¾å‘é‡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">U<span class="token punctuation">,</span>S<span class="token punctuation">,</span>V <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>svd<span class="token punctuation">(</span>np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>norm<span class="token punctuation">.</span>T<span class="token punctuation">,</span>norm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>U<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.67710949</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.73588229</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.73588229</span><span class="token punctuation">,</span>  <span class="token number">0.67710949</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç”±äºéœ€è¦æŠŠäºŒç»´æ•°æ®é™ä¸ºä¸€ç»´æ•°æ®ï¼Œå› æ­¤åªå–ç‰¹å¾çŸ©é˜µçš„ç¬¬ä¸€åˆ—ï¼ˆå‰kåˆ—ï¼‰æ¥æ„é€ ä¸»æˆåˆ†ç‰¹å¾çŸ©é˜µ$U_{reduce}$</p><pre class="line-numbers language-python"><code class="language-python">U_reduce <span class="token operator">=</span> U<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>U_reduce<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.67710949</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.73588229</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æœ‰äº†ä¸»æˆåˆ†ç‰¹å¾çŸ©é˜µï¼Œå°±å¯ä»¥å¯¹æ•°æ®è¿›è¡Œé™ç»´äº†ï¼š</p><pre class="line-numbers language-python"><code class="language-python">R <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>norm<span class="token punctuation">,</span>U_reduce<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>R<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token number">0.2452941</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.29192442</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.29192442</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.82914294</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.58384884</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å°±æŠŠäºŒç»´çš„æ•°æ®é™ä¸ºä¸€ç»´çš„æ•°æ®äº†ã€‚å¦‚æœéœ€è¦è¿˜åŸæ•°æ®ï¼Œä¾ç…§PCAæ•°æ®æ¢å¤çš„è®¡ç®—å…¬å¼ï¼Œå¯å¾—ï¼š</p><pre class="line-numbers language-python"><code class="language-python">Z <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>R<span class="token punctuation">,</span>U_reduce<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>Z<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.16609096</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.18050758</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.19766479</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.21482201</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.19766479</span><span class="token punctuation">,</span>  <span class="token number">0.21482201</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.56142055</span><span class="token punctuation">,</span>  <span class="token number">0.6101516</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.39532959</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.42964402</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äºæˆ‘ä»¬åœ¨æ•°æ®é¢„å¤„ç†é˜¶æ®µå¯¹æ•°æ®è¿›è¡Œäº†å½’ä¸€åŒ–ï¼Œå¹¶ä¸”åšäº†ç¼©æ”¾å¤„ç†ï¼Œæ‰€ä»¥éœ€è¦è¿›ä¸€æ­¥è¿˜åŸæ‰èƒ½å¾—åˆ°åŸå§‹æ•°æ®ï¼Œè¿™ä¸€æ­¥æ˜¯æ•°æ®é¢„å¤„ç†çš„é€†è¿ç®—ã€‚</p><pre class="line-numbers language-python"><code class="language-python">A1 <span class="token operator">=</span> np<span class="token punctuation">.</span>multiply<span class="token punctuation">(</span>Z<span class="token punctuation">,</span>scope<span class="token punctuation">)</span><span class="token operator">+</span>mean<span class="token keyword">print</span><span class="token punctuation">(</span>A1<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œnp.multiplyæ˜¯çŸ©é˜µå¯¹åº”å…ƒç´ ç›¸ä¹˜ï¼Œnp.dotæ˜¯çŸ©é˜µçš„è¡Œä¹˜ä»¥çŸ©é˜µçš„åˆ—ã€‚è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2.33563616e+00</span><span class="token punctuation">,</span> <span class="token number">2.91695452e+03</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2.20934082e+00</span><span class="token punctuation">,</span> <span class="token number">2.71106794e+03</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">3.79065918e+00</span><span class="token punctuation">,</span> <span class="token number">5.28893206e+03</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">5.24568220e+00</span><span class="token punctuation">,</span> <span class="token number">7.66090960e+03</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1.41868164e+00</span><span class="token punctuation">,</span> <span class="token number">1.42213588e+03</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸åŸå§‹çŸ©é˜µAç›¸æ¯”ï¼Œæ¢å¤åçš„æ•°æ®A1è¿˜æ˜¯å­˜åœ¨ä¸€å®šç¨‹åº¦çš„å¤±çœŸï¼Œè¿™ç§å¤±çœŸæ˜¯ä¸å¯é¿å…çš„ã€‚</p><h3 id="3-2-ä½¿ç”¨sklearnè¿›è¡ŒPCAé™ç»´è¿ç®—"><a href="#3-2-ä½¿ç”¨sklearnè¿›è¡ŒPCAé™ç»´è¿ç®—" class="headerlink" title="3.2 ä½¿ç”¨sklearnè¿›è¡ŒPCAé™ç»´è¿ç®—"></a>3.2 ä½¿ç”¨sklearnè¿›è¡ŒPCAé™ç»´è¿ç®—</h3><p>åœ¨ <code>sklearn</code>å·¥å…·åŒ…é‡Œï¼Œç±» <code>sklearn.decomposition.PCA</code> å®ç°äº† PCA ç®—æ³•ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œä¸éœ€è¦äº†è§£å…·ä½“çš„PCAçš„è¿ç®—æ­¥éª¤ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ•°æ®çš„é¢„å¤„ç†éœ€è¦è‡ªå·±å®Œæˆï¼Œå…¶ PCA ç®—æ³•æœ¬èº«ä¸è¿›è¡Œæ•°æ®é¢„å¤„ç†ï¼ˆå½’ä¸€åŒ–å’Œç¼©æ”¾ï¼‰ã€‚æ­¤å¤„ï¼Œæˆ‘ä»¬é€‰æ‹© <code>MinMaxScalerç±»</code>è¿›è¡Œæ•°æ®é¢„å¤„ç†ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>decomposition <span class="token keyword">import</span> PCA<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> Pipeline<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScaler<span class="token keyword">def</span> <span class="token function">std_PCA</span><span class="token punctuation">(</span><span class="token operator">**</span>argv<span class="token punctuation">)</span><span class="token punctuation">:</span>    scaler <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>    pca <span class="token operator">=</span> PCA<span class="token punctuation">(</span><span class="token operator">**</span>argv<span class="token punctuation">)</span>    pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'scaler'</span><span class="token punctuation">,</span> scaler<span class="token punctuation">)</span><span class="token punctuation">,</span>                         <span class="token punctuation">(</span><span class="token string">'pca'</span><span class="token punctuation">,</span> pca<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> pipelinepca <span class="token operator">=</span> std_PCA<span class="token punctuation">(</span>n_components<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>R2 <span class="token operator">=</span> pca<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>R2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.2452941</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.29192442</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.29192442</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span> <span class="token number">0.82914294</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.58384884</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªè¾“å‡ºå€¼å°±æ˜¯çŸ©é˜µAç»è¿‡é¢„å¤„ç†ä»¥åŠPCAé™ç»´åçš„æ•°å€¼ã€‚æˆ‘ä»¬å‘ç°ï¼Œè¿™é‡Œçš„è¾“å‡ºç»“æœå’Œä¸Šé¢ä½¿ç”¨Numpyæ–¹å¼çš„è¾“å‡ºç»“æœç¬¦å·ç›¸åï¼Œè¿™å…¶å®ä¸æ˜¯é”™è¯¯ï¼Œåªæ˜¯é™ç»´åé€‰æ‹©çš„åæ ‡æ–¹å‘ä¸åŒè€Œå·²ã€‚</p><p>æ¥ç€æŠŠæ•°æ®æ¢å¤å›æ¥ï¼š</p><pre class="line-numbers language-python"><code class="language-python">A2 <span class="token operator">=</span> pca<span class="token punctuation">.</span>inverse_transform<span class="token punctuation">(</span>R2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>A2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™é‡Œçš„pcaæ˜¯ä¸€ä¸ªPipelineå®ä¾‹ï¼Œå…¶é€†è¿ç®—inverse_transform()æ˜¯é€çº§è¿›è¡Œçš„ï¼Œå³å…ˆè¿›è¡ŒPCAè¿˜åŸï¼Œå†æ‰§è¡Œé¢„å¤„ç†çš„é€†è¿ç®—ã€‚å³å…ˆè°ƒç”¨PCA.inverse_transform()ï¼Œç„¶åå†è°ƒç”¨MinMaxScaler.inverse_transform()ã€‚è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2.33563616e+00</span><span class="token punctuation">,</span> <span class="token number">2.91695452e+03</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">2.20934082e+00</span><span class="token punctuation">,</span> <span class="token number">2.71106794e+03</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">3.79065918e+00</span><span class="token punctuation">,</span> <span class="token number">5.28893206e+03</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">5.24568220e+00</span><span class="token punctuation">,</span> <span class="token number">7.66090960e+03</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token punctuation">[</span><span class="token number">1.41868164e+00</span><span class="token punctuation">,</span> <span class="token number">1.42213588e+03</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œè¿˜åŸå›æ¥çš„æ•°æ®å’Œå‰é¢Numpyæ–¹å¼è¿˜åŸå›æ¥çš„æ•°æ®æ˜¯ä¸€è‡´çš„ã€‚</p><h3 id="3-3-PCAçš„ç‰©ç†å«ä¹‰"><a href="#3-3-PCAçš„ç‰©ç†å«ä¹‰" class="headerlink" title="3.3 PCAçš„ç‰©ç†å«ä¹‰"></a>3.3 PCAçš„ç‰©ç†å«ä¹‰</h3><p>æˆ‘ä»¬å¯ä»¥æŠŠå‰é¢ä¾‹å­ä¸­çš„æ•°æ®åœ¨ä¸€ä¸ªåæ ‡è½´ä¸Šå…¨éƒ¨ç”»å‡ºæ¥ï¼Œä»è€Œä»”ç»†è§‚å¯ŸPCAé™ç»´è¿‡ç¨‹çš„ç‰©ç†å«ä¹‰ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>norm<span class="token punctuation">,</span> Z<span class="token punctuation">,</span> U<span class="token punctuation">,</span> U_reduce<span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Physcial meanings of PCA'</span><span class="token punctuation">)</span>    ymin <span class="token operator">=</span> xmin <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>    ymax <span class="token operator">=</span> xmax <span class="token operator">=</span> <span class="token number">1</span>    plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span>xmin<span class="token punctuation">,</span> xmax<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span>ymin<span class="token punctuation">,</span> ymax<span class="token punctuation">)</span>    ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>gca<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># gca ä»£è¡¨å½“å‰åæ ‡è½´ï¼Œå³ 'get current axis'</span>    ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'right'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># éšè—åæ ‡è½´</span>    ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'top'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>norm<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> norm<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'s'</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>Z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Z<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>arrow<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> U<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> U<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">'-'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>arrow<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> U<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> U<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>r<span class="token string">'$U_{reduce} = u^{(1)}$'</span><span class="token punctuation">,</span>                 xy<span class="token operator">=</span><span class="token punctuation">(</span>U<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> U<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xycoords<span class="token operator">=</span><span class="token string">'data'</span><span class="token punctuation">,</span>                 xytext<span class="token operator">=</span><span class="token punctuation">(</span>U_reduce<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">,</span> U_reduce<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>                 arrowprops<span class="token operator">=</span>dict<span class="token punctuation">(</span>arrowstyle<span class="token operator">=</span><span class="token string">"->"</span><span class="token punctuation">,</span> connectionstyle<span class="token operator">=</span><span class="token string">"arc3,rad=.2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>r<span class="token string">'$u^{(2)}$'</span><span class="token punctuation">,</span>                 xy<span class="token operator">=</span><span class="token punctuation">(</span>U<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> U<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xycoords<span class="token operator">=</span><span class="token string">'data'</span><span class="token punctuation">,</span>                 xytext<span class="token operator">=</span><span class="token punctuation">(</span>U<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">,</span> U<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>                 arrowprops<span class="token operator">=</span>dict<span class="token punctuation">(</span>arrowstyle<span class="token operator">=</span><span class="token string">"->"</span><span class="token punctuation">,</span> connectionstyle<span class="token operator">=</span><span class="token string">"arc3,rad=.2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>r<span class="token string">'raw data'</span><span class="token punctuation">,</span>                 xy<span class="token operator">=</span><span class="token punctuation">(</span>norm<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> norm<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xycoords<span class="token operator">=</span><span class="token string">'data'</span><span class="token punctuation">,</span>                 xytext<span class="token operator">=</span><span class="token punctuation">(</span>norm<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">,</span> norm<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>                 arrowprops<span class="token operator">=</span>dict<span class="token punctuation">(</span>arrowstyle<span class="token operator">=</span><span class="token string">"->"</span><span class="token punctuation">,</span> connectionstyle<span class="token operator">=</span><span class="token string">"arc3,rad=.2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>annotate<span class="token punctuation">(</span>r<span class="token string">'projected data'</span><span class="token punctuation">,</span>                 xy<span class="token operator">=</span><span class="token punctuation">(</span>Z<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Z<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xycoords<span class="token operator">=</span><span class="token string">'data'</span><span class="token punctuation">,</span>                 xytext<span class="token operator">=</span><span class="token punctuation">(</span>Z<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">,</span> Z<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>                 arrowprops<span class="token operator">=</span>dict<span class="token punctuation">(</span>arrowstyle<span class="token operator">=</span><span class="token string">"->"</span><span class="token punctuation">,</span> connectionstyle<span class="token operator">=</span><span class="token string">"arc3,rad=.2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200716110204443.png" alt="image-20200716110204443">å›¾ä¸­æ­£æ–¹å½¢çš„ç‚¹æ˜¯åŸå§‹æ•°æ®ç»è¿‡é¢„å¤„ç†åï¼ˆå½’ä¸€åŒ–ã€ç¼©æ”¾ï¼‰çš„æ•°æ®ï¼Œåœ†å½¢çš„ç‚¹æ˜¯ä»ä¸€ç»´æ¢å¤åˆ°äºŒç»´åçš„æ•°æ®ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ç”»å‡ºä¸»æˆåˆ†ç‰¹å¾å‘é‡ $u^{(1)}$ å’Œ  $u^{(2)}$ ï¼Œã€‚æ ¹æ®ä¸Šå›¾ï¼Œæ¥ä»‹ç»å‡ ä¸ªæœ‰æ„æ€çš„ç»“è®ºï¼šé¦–å…ˆï¼Œåœ†å½¢çš„ç‚¹å®é™…ä¸Šå°±æ˜¯æ–¹å½¢çš„ç‚¹åœ¨å‘é‡æ‰€åœ¨ $u^{(1)}$ ç›´çº¿ä¸Šçš„æŠ•å½±ã€‚æ‰€è°“PCAæ•°æ®æ¢å¤ï¼Œå¹¶ä¸æ˜¯çœŸæ­£çš„æ¢å¤ï¼Œåªæ˜¯æŠŠé™ç»´åçš„åæ ‡è½¬æ¢ä¸ºåŸåæ ‡ç³»ä¸­çš„åæ ‡è€Œå·²ã€‚é’ˆå¯¹æˆ‘ä»¬çš„ä¾‹å­ï¼Œåªæ˜¯æŠŠç”±å‘é‡ $u^{(1)}$å†³å®šçš„ä¸€ç»´åæ ‡ç³»ä¸­çš„åæ ‡è½¬æ¢ä¸ºåŸå§‹äºŒç»´åæ ‡ç³»ä¸­çš„åæ ‡ã€‚å…¶æ¬¡ï¼Œä¸»æˆåˆ†ç‰¹å¾å‘é‡ $u^{(1)}$ å’Œ  $u^{(2)}$ æ˜¯ç›¸äº’å‚ç›´çš„ã€‚å†æ¬¡ï¼Œæ–¹å½¢ç‚¹å’Œåœ†å½¢ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œå°±æ˜¯PCAæ•°æ®é™ç»´åçš„è¯¯å·®ã€‚</p><h2 id="4-ç¤ºä¾‹ï¼šäººè„¸è¯†åˆ«"><a href="#4-ç¤ºä¾‹ï¼šäººè„¸è¯†åˆ«" class="headerlink" title="4. ç¤ºä¾‹ï¼šäººè„¸è¯†åˆ«"></a>4. ç¤ºä¾‹ï¼šäººè„¸è¯†åˆ«</h2><p>æœ¬èŠ‚ä½¿ç”¨è‹±å›½å‰‘æ¡¥AT&amp;Tå®éªŒå®¤çš„ç ”ç©¶äººå‘˜è‡ªæ‹çš„ä¸€ç»„ç…§ç‰‡ï¼ˆAT&amp;TLaboratories Cambridgeï¼‰ï¼Œæ¥å¼€å‘ä¸€ä¸ªç‰¹å®šçš„äººè„¸è¯†åˆ«ç³»ç»Ÿã€‚äººè„¸è¯†åˆ«ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸ªåˆ†ç±»é—®é¢˜ï¼Œéœ€è¦æŠŠäººè„¸å›¾ç‰‡å½“æˆè®­ç»ƒæ•°æ®é›†ï¼Œå¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå°±å¯ä»¥å¯¹æ–°çš„äººè„¸ç…§ç‰‡è¿›è¡Œç±»åˆ«é¢„æµ‹ã€‚è¿™å°±æ˜¯äººè„¸è¯†åˆ«ç³»ç»Ÿçš„åŸç†ã€‚</p><h3 id="4-1-åŠ è½½æ•°æ®é›†"><a href="#4-1-åŠ è½½æ•°æ®é›†" class="headerlink" title="4.1 åŠ è½½æ•°æ®é›†"></a>4.1 åŠ è½½æ•°æ®é›†</h3><p>æŸ¥çœ‹æ•°æ®é›†é‡Œæ‰€æœ‰400å¼ ç…§ç‰‡çš„ç¼©ç•¥å›¾ã€‚æ•°æ®é›†æ€»å…±åŒ…å«40ä½äººå‘˜çš„ç…§ç‰‡ï¼Œæ¯ä¸ªäºº10å¼ ç…§ç‰‡ï¼Œæ•°æ®é›†åœ¨ä»“åº“<code>dataset</code>æ–‡ä»¶å¤¹å†…ã€‚</p><p>ä¸‹è½½å®Œç…§ç‰‡ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥åŠ è½½è¿™äº›ç…§ç‰‡äº†ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> time<span class="token keyword">import</span> logging<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> fetch_olivetti_faceslogging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">,</span> format<span class="token operator">=</span><span class="token string">'%(asctime)s %(message)s'</span><span class="token punctuation">)</span>data_home<span class="token operator">=</span><span class="token string">'datasets/'</span>logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'Start to load dataset'</span><span class="token punctuation">)</span>faces <span class="token operator">=</span> fetch_olivetti_faces<span class="token punctuation">(</span>data_home<span class="token operator">=</span>data_home<span class="token punctuation">)</span>logging<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">'Done with load dataset'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token number">2019</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">23</span> <span class="token number">21</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">639</span> Start to load dataset<span class="token number">2019</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">23</span> <span class="token number">21</span><span class="token punctuation">:</span><span class="token number">45</span><span class="token punctuation">:</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">666</span> Done <span class="token keyword">with</span> load dataset<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åŠ è½½çš„å›¾ç‰‡æ•°æ®é›†ä¿å­˜åœ¨faceså˜é‡é‡Œï¼Œ<code>scikit-learn</code> å·²ç»æ›¿æˆ‘ä»¬æŠŠæ¯å¼ ç…§ç‰‡åšäº†åˆæ­¥çš„å¤„ç†ï¼Œå‰ªè£æˆ64Ã—64å¤§å°ä¸”äººè„¸å±…ä¸­æ˜¾ç¤ºã€‚è¿™ä¸€æ­¥è‡³å…³é‡è¦ï¼Œå¦åˆ™æˆ‘ä»¬çš„æ¨¡å‹å°†è¢«å¤§é‡çš„å™ªå£°æ•°æ®ï¼Œå³å›¾ç‰‡èƒŒæ™¯å¹²æ‰°ã€‚å› ä¸ºäººè„¸è¯†åˆ«çš„å…³é”®æ˜¯äº”å®˜çº¹ç†å’Œç‰¹å¾ï¼Œæ¯å¼ ç…§ç‰‡çš„èƒŒæ™¯éƒ½ä¸åŒï¼Œäººçš„å‘å‹ä¹Ÿå¯èƒ½ç»å¸¸å˜åŒ–ï¼Œè¿™äº›ç‰¹å¾éƒ½åº”è¯¥å°½é‡æ’é™¤åœ¨è¾“å…¥ç‰¹å¾ä¹‹å¤–ã€‚</p><p>æˆåŠŸåŠ è½½æ•°æ®åï¼Œå…¶dataé‡Œä¿å­˜çš„å°±æ˜¯æŒ‰ç…§scikit-learnè¦æ±‚çš„è®­ç»ƒæ•°æ®é›†ï¼Œtargeté‡Œä¿å­˜çš„å°±æ˜¯ç±»åˆ«ç›®æ ‡ç´¢å¼•ã€‚æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œå°†æ•°æ®é›†çš„æ¦‚è¦ä¿¡æ¯æ˜¾ç¤ºå‡ºæ¥ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npX <span class="token operator">=</span> faces<span class="token punctuation">.</span>datay <span class="token operator">=</span> faces<span class="token punctuation">.</span>targettargets <span class="token operator">=</span> np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>faces<span class="token punctuation">.</span>target<span class="token punctuation">)</span>target_names <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"c%d"</span> <span class="token operator">%</span> t <span class="token keyword">for</span> t <span class="token keyword">in</span> targets<span class="token punctuation">]</span><span class="token punctuation">)</span>n_targets <span class="token operator">=</span> target_names<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>n_samples<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w <span class="token operator">=</span> faces<span class="token punctuation">.</span>images<span class="token punctuation">.</span>shape<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Sample count: {}\nTarget count: {}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>n_samples<span class="token punctuation">,</span> n_targets<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Image size: {}x{}\nDataset shape: {}\n'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>w<span class="token punctuation">,</span> h<span class="token punctuation">,</span> X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">Sample count<span class="token punctuation">:</span> <span class="token number">400</span>Target count<span class="token punctuation">:</span> <span class="token number">40</span>Image size<span class="token punctuation">:</span> 64x64Dataset shape<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">4096</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä»è¾“å‡ºå¯çŸ¥ï¼Œæ€»å…±æœ‰40ä½äººç‰©çš„ç…§ç‰‡ï¼Œå›¾ç‰‡æ€»æ•°æ˜¯400å¼ ï¼Œè¾“å…¥ç‰¹å¾æœ‰4096ä¸ªã€‚ä¸ºäº†åç»­åŒºåˆ†ä¸åŒçš„äººç‰©ï¼Œæˆ‘ä»¬ç”¨ç´¢å¼•å·ç»™ç›®æ ‡äººç‰©å‘½åï¼Œå¹¶ä¿å­˜åœ¨å˜é‡target_namesé‡Œã€‚ä¸ºäº†æ›´ç›´è§‚åœ°è§‚å¯Ÿæ•°æ®ï¼Œä»æ¯ä¸ªäººç‰©çš„ç…§ç‰‡é‡Œéšæœºé€‰æ‹©ä¸€å¼ æ˜¾ç¤ºå‡ºæ¥ã€‚å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥æ˜¾ç¤ºç…§ç‰‡é˜µåˆ—ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">def</span> <span class="token function">plot_gallery</span><span class="token punctuation">(</span>images<span class="token punctuation">,</span>titles<span class="token punctuation">,</span>h<span class="token punctuation">,</span>w<span class="token punctuation">,</span>n_row<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>n_col<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""æ˜¾ç¤ºå›¾ç‰‡é˜µåˆ—"""</span>    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>n_col<span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">*</span>n_row<span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>bottom<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>left<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>right<span class="token operator">=</span><span class="token number">0.99</span><span class="token punctuation">,</span>top<span class="token operator">=</span><span class="token number">0.90</span><span class="token punctuation">,</span>hspace<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_row<span class="token operator">*</span>n_col<span class="token punctuation">)</span><span class="token punctuation">:</span>        plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span>n_row<span class="token punctuation">,</span>n_col<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>images<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span>w<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span>plt<span class="token punctuation">.</span>cm<span class="token punctuation">.</span>gray<span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>titles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å…¥å‚æ•°imagesæ˜¯ä¸€ä¸ªäºŒç»´æ•°æ®ï¼Œæ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªå›¾ç‰‡æ•°æ®ã€‚åœ¨åŠ è½½æ•°æ®æ—¶ï¼Œfetch_olivetti_faces()å‡½æ•°å·²ç»å¸®æˆ‘ä»¬åšäº†é¢„å¤„ç†ï¼Œå›¾ç‰‡çš„æ¯ä¸ªåƒç´ çš„RGBå€¼éƒ½è½¬æ¢æˆäº†[0,1]çš„æµ®ç‚¹æ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç”»å‡ºæ¥çš„ç…§ç‰‡å°†æ˜¯é»‘ç™½çš„ï¼Œè€Œä¸æ˜¯å½©è‰²çš„ã€‚åœ¨å›¾ç‰‡è¯†åˆ«é¢†åŸŸï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç”¨é»‘ç™½ç…§ç‰‡å°±å¯ä»¥äº†ï¼Œå¯ä»¥å‡å°‘è®¡ç®—é‡ï¼Œä¹Ÿä¼šè®©æ¨¡å‹æ›´å‡†ç¡®ã€‚</p><p>æ¥ç€åˆ†æˆä¸¤è¡Œæ˜¾ç¤ºå‡ºè¿™äº›äººç‰©çš„ç…§ç‰‡ï¼š</p><pre class="line-numbers language-python"><code class="language-python">n_row <span class="token operator">=</span> <span class="token number">2</span>n_col <span class="token operator">=</span> <span class="token number">6</span>sample_images <span class="token operator">=</span> Nonesample_titles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n_targets<span class="token punctuation">)</span><span class="token punctuation">:</span>    people_images <span class="token operator">=</span> X<span class="token punctuation">[</span>y<span class="token operator">==</span>i<span class="token punctuation">]</span>    people_sample_index <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> people_images<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>    people_sample_image <span class="token operator">=</span> people_images<span class="token punctuation">[</span>people_sample_index<span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> sample_images <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>        sample_images <span class="token operator">=</span> np<span class="token punctuation">.</span>concatenate<span class="token punctuation">(</span><span class="token punctuation">(</span>sample_images<span class="token punctuation">,</span> people_sample_image<span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        sample_images <span class="token operator">=</span> people_sample_image    sample_titles<span class="token punctuation">.</span>append<span class="token punctuation">(</span>target_names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>plot_gallery<span class="token punctuation">(</span>sample_images<span class="token punctuation">,</span> sample_titles<span class="token punctuation">,</span> h<span class="token punctuation">,</span> w<span class="token punctuation">,</span> n_row<span class="token punctuation">,</span> n_col<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»£ç ä¸­ï¼ŒX[y==i]å¯ä»¥é€‰æ‹©å‡ºå±äºç‰¹å®šäººç‰©çš„æ‰€æœ‰ç…§ç‰‡ï¼Œéšæœºé€‰æ‹©å‡ºæ¥çš„ç…§ç‰‡éƒ½æ”¾åœ¨sample_imagesæ•°ç»„å¯¹è±¡é‡Œï¼Œæœ€åä½¿ç”¨æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„å‡½æ•°plot_gallery()æŠŠç…§ç‰‡ç”»å‡ºæ¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200716162800005.png" alt="image-20200716162800005"></p><p>ä»å›¾ç‰‡ä¸­å¯ä»¥çœ‹åˆ°ï¼Œfetch_olivetti_faces()å‡½æ•°å¸®æˆ‘ä»¬å‰ªè£äº†ä¸­é—´éƒ¨åˆ†ï¼Œåªç•™ä¸‹è„¸éƒ¨ç‰¹å¾ã€‚</p><p>æœ€åï¼ŒæŠŠæ•°æ®é›†åˆ’åˆ†æˆè®­ç»ƒæ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†ï¼š</p><pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_splitX_train<span class="token punctuation">,</span>X_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test <span class="token operator">=</span> <span class="token function">train_test_split</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="4-2-ä¸€æ¬¡å¤±è´¥çš„å°è¯•"><a href="#4-2-ä¸€æ¬¡å¤±è´¥çš„å°è¯•" class="headerlink" title="4.2 ä¸€æ¬¡å¤±è´¥çš„å°è¯•"></a>4.2 ä¸€æ¬¡å¤±è´¥çš„å°è¯•</h3><p>æˆ‘ä»¬ä½¿ç”¨æ”¯æŒå‘é‡æœºæ¥å®ç°äººè„¸è¯†åˆ«ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVC<span class="token keyword">from</span> time <span class="token keyword">import</span> timestart <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Fitting train datasets ...'</span><span class="token punctuation">)</span>clf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>class_weight<span class="token operator">=</span><span class="token string">'balanced'</span><span class="token punctuation">)</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Done in {0:.2f}s'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">Fitting train datasets <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Done <span class="token keyword">in</span> <span class="token number">0.</span>92s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æŒ‡å®šSVCçš„class_weightå‚æ•°ï¼Œè®©SVCæ¨¡å‹èƒ½æ ¹æ®è®­ç»ƒæ ·æœ¬çš„æ•°é‡æ¥å‡è¡¡åœ°è°ƒæ•´æƒé‡ï¼Œè¿™å¯¹ä¸å‡åŒ€çš„æ•°æ®é›†ï¼Œå³ç›®æ ‡äººç‰©çš„ç…§ç‰‡æ•°é‡ç›¸å·®è¾ƒå¤§çš„æƒ…å†µæ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚ç”±äºæ€»å…±åªæœ‰400å¼ ç…§ç‰‡ï¼Œæ•°æ®è§„æ¨¡è¾ƒå°ï¼Œæ¨¡å‹å¾ˆå¿«å°±è¿è¡Œå®Œäº†ã€‚</p><p>æ¥ç€ï¼Œé’ˆå¯¹æµ‹è¯•æ•°æ®é›†è¿›è¡Œé¢„æµ‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">start <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Predicting test dataset ...'</span><span class="token punctuation">)</span>y_pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Done in {0:.2f}s'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">Predicting <span class="token function">test</span> dataset <span class="token punctuation">..</span>.Done <span class="token keyword">in</span> 0.10s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æœ€åï¼Œåˆ†åˆ«ä½¿ç”¨ <code>confusion_matrix</code> å’Œ <code>classification_report</code> æ¥æŸ¥çœ‹æ¨¡å‹åˆ†ç±»çš„å‡†ç¡®æ€§ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrixcm <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">,</span>labels<span class="token operator">=</span>range<span class="token punctuation">(</span>n_targets<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'confusion matrix:\n'</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>set_printoptions<span class="token punctuation">(</span>threshold<span class="token operator">=</span>sys<span class="token punctuation">.</span>maxsize<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cm<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>np.set_printoptions()</code> æ˜¯ä¸ºäº†ç¡®ä¿å®Œæ•´åœ°è¾“å‡ºcmæ•°ç»„çš„å†…å®¹ï¼Œè¿™æ˜¯å› ä¸ºè¿™ä¸ªæ•°ç»„æ˜¯40Ã—40çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸ä¼šå…¨éƒ¨è¾“å‡ºã€‚è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-csharp"><code class="language-csharp">confusion matrix<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">4</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">4</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">4</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>confusion matrix</code> ç†æƒ³çš„è¾“å‡ºï¼Œæ˜¯çŸ©é˜µçš„å¯¹è§’çº¿ä¸Šæœ‰æ•°å­—ï¼Œå…¶ä»–åœ°æ–¹éƒ½æ²¡æœ‰æ•°å­—ã€‚ä½†æˆ‘ä»¬çš„ç»“æœæ˜¾ç¤ºä¸æ˜¯è¿™æ ·çš„ã€‚å¯ä»¥æ˜æ˜¾çœ‹å‡ºï¼Œå¾ˆå¤šå›¾ç‰‡éƒ½è¢«é¢„æµ‹æˆç´¢å¼•ä¸º12çš„ç±»åˆ«äº†ã€‚ç»“æœçœ‹èµ·æ¥å®Œå…¨ä¸å¯¹ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿæˆ‘ä»¬å†çœ‹ä¸€ä¸‹classification_reportçš„ç»“æœï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report<span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-undefined"><code class="language-undefined">             precision    recall  f1-score   support         c0       0.00      0.00      0.00         1         c1       0.00      0.00      0.00         3         c2       0.00      0.00      0.00         2         c3       0.00      0.00      0.00         1         c4       0.00      0.00      0.00         1         c5       0.00      0.00      0.00         1         c6       0.00      0.00      0.00         4         c7       0.00      0.00      0.00         2         c8       0.00      0.00      0.00         4         c9       0.00      0.00      0.00         2        c10       0.00      0.00      0.00         1        c11       0.00      0.00      0.00         0        c12       0.00      0.00      0.00         4        c13       0.00      0.00      0.00         4        c14       0.00      0.00      0.00         1        c15       0.00      0.00      0.00         1        c16       0.00      0.00      0.00         3        c17       0.00      0.00      0.00         2        c18       0.00      0.00      0.00         2        c19       0.00      0.00      0.00         2        c20       0.00      0.00      0.00         1        c21       0.00      0.00      0.00         2        c22       0.00      0.00      0.00         3        c23       0.00      0.00      0.00         2        c24       0.00      0.00      0.00         3        c25       0.00      0.00      0.00         3        c26       0.00      0.00      0.00         2        c27       0.00      0.00      0.00         2        c28       0.00      0.00      0.00         0        c29       0.00      0.00      0.00         2        c30       0.00      0.00      0.00         2        c31       0.00      0.00      0.00         3        c32       0.00      0.00      0.00         2        c33       0.00      0.00      0.00         2        c34       0.00      0.00      0.00         0        c35       0.00      0.00      0.00         2        c36       0.00      0.00      0.00         3        c37       0.00      0.00      0.00         1        c38       0.00      0.00      0.00         2        c39       0.00      0.00      0.00         2avg / total       0.00      0.00      0.00        80<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>40ä¸ªç±»åˆ«é‡Œï¼ŒæŸ¥å‡†ç‡ã€å¬å›ç‡ã€F1 Scoreå…¨ä¸º0ï¼Œä¸èƒ½æœ‰æ›´å·®çš„é¢„æµ‹ç»“æœäº†ã€‚ä¸ºä»€ä¹ˆï¼Ÿå“ªé‡Œå‡ºäº†å·®é”™ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼Œæˆ‘ä»¬æŠŠæ¯ä¸ªåƒç´ éƒ½ä½œä¸ºä¸€ä¸ªè¾“å…¥ç‰¹å¾æ¥å¤„ç†ï¼Œè¿™æ ·çš„æ•°æ®å™ªå£°å¤ªä¸¥é‡äº†ï¼Œæ¨¡å‹æ ¹æœ¬æ²¡æœ‰åŠæ³•å¯¹è®­ç»ƒæ•°æ®é›†è¿›è¡Œæ‹Ÿåˆã€‚æƒ³æƒ³çœ‹ï¼Œæˆ‘ä»¬æ€»å…±æœ‰4096ä¸ªç‰¹å¾ï¼Œå¯æ˜¯æ•°æ®é›†å¤§å°æ‰400ä¸ªï¼Œæ¯”ç‰¹å¾ä¸ªæ•°è¿˜å°‘ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜éœ€è¦æŠŠæ•°æ®é›†åˆ†å‡º20%æ¥ä½œä¸ºæµ‹è¯•æ•°æ®é›†ï¼Œè¿™æ ·è®­ç»ƒæ•°æ®é›†å°±æ›´å°äº†ã€‚è¿™æ ·çš„çŠ¶å†µä¸‹ï¼Œæ¨¡å‹æ ¹æœ¬æ— æ³•è¿›è¡Œå‡†ç¡®åœ°è®­ç»ƒå’Œé¢„æµ‹ã€‚</p><h3 id="4-3-ä½¿ç”¨PCAæ¥å¤„ç†æ•°æ®é›†"><a href="#4-3-ä½¿ç”¨PCAæ¥å¤„ç†æ•°æ®é›†" class="headerlink" title="4.3 ä½¿ç”¨PCAæ¥å¤„ç†æ•°æ®é›†"></a>4.3 ä½¿ç”¨PCAæ¥å¤„ç†æ•°æ®é›†</h3><p>è§£å†³ä¸Šè¿°é—®é¢˜çš„ä¸€ä¸ªåŠæ³•æ˜¯ä½¿ç”¨ PCA æ¥ç»™æ•°æ®é™ç»´ï¼Œåªé€‰æ‹©å‰kä¸ªæœ€é‡è¦çš„ç‰¹å¾ã€‚é—®é¢˜æ¥äº†ï¼Œé€‰æ‹©å¤šå°‘ä¸ªç‰¹å¾åˆé€‚å‘¢ï¼Ÿå³æ€ä¹ˆç¡®å®škçš„å€¼ï¼ŸPCA ç®—æ³•å¯ä»¥é€šè¿‡ä¸‹é¢çš„å…¬å¼æ¥è®¡ç®—å¤±çœŸå¹…åº¦ï¼š<br>$$<br>\frac{\frac{1}{m} \sum_{i=1}^{m}\left|x^{(i)}-x_{a p p r o x}^{(i)}\right|^{2}}{\frac{1}{m} \sum_{i=1}^{m}\left|x^{(i)}\right|}<br>$$<br>åœ¨scikit-learné‡Œï¼Œå¯ä»¥ä»PCAæ¨¡å‹çš„explained_variance_ratio_å˜é‡é‡Œè·å–ç»PCAå¤„ç†åçš„æ•°æ®è¿˜åŸç‡ã€‚è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€æœ‰å…ƒç´ æ±‚å’Œå³å¯çŸ¥é“æˆ‘ä»¬é€‰æ‹©çš„kå€¼çš„æ•°æ®è¿˜åŸç‡ï¼Œæ•°å€¼è¶Šå¤§è¯´æ˜å¤±çœŸè¶Šå°ï¼Œéšç€kå€¼çš„å¢å¤§ï¼Œæ•°å€¼ä¼šæ— é™æ¥è¿‘äº1ã€‚</p><p>åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œå¯ä»¥è®©kå–å€¼10~300ä¹‹é—´ï¼Œæ¯éš”30è¿›è¡Œä¸€æ¬¡å–æ ·ã€‚åœ¨æ‰€æœ‰çš„kå€¼æ ·æœ¬ä¸‹ï¼Œè®¡ç®—ç»è¿‡PCAç®—æ³•å¤„ç†åçš„æ•°æ®è¿˜åŸç‡ã€‚ç„¶åæ ¹æ®æ•°æ®è¿˜åŸç‡è¦æ±‚ï¼Œæ¥ç¡®å®šåˆç†çš„kå€¼ã€‚é’ˆå¯¹æˆ‘ä»¬çš„æƒ…å†µï¼Œé€‰æ‹©å¤±çœŸåº¦å°äº5%ï¼Œå³PCAå¤„ç†åèƒ½ä¿ç•™95%çš„åŸæ•°æ®ä¿¡æ¯ã€‚å…¶ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>decomposition <span class="token keyword">import</span> PCA<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Exploring explained variance ratio for dataset ..."</span><span class="token punctuation">)</span>candidate_components <span class="token operator">=</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span>explained_ratios <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>start <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> c <span class="token keyword">in</span> candidate_components<span class="token punctuation">:</span>    pca <span class="token operator">=</span> PCA<span class="token punctuation">(</span>n_components<span class="token operator">=</span>c<span class="token punctuation">)</span>    X_pca <span class="token operator">=</span> pca<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">)</span>    explained_ratios<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>pca<span class="token punctuation">.</span>explained_variance_ratio_<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Done in {0:.2f}s'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">Exploring explained variance ratio <span class="token keyword">for</span> dataset <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Done <span class="token keyword">in</span> <span class="token number">0.</span>75s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ ¹æ®ä¸åŒçš„kå€¼ï¼Œæ„å»ºPCAæ¨¡å‹ï¼Œç„¶åè°ƒç”¨fit_transform()å‡½æ•°æ¥å¤„ç†æ•°æ®é›†ï¼Œå†æŠŠæ¨¡å‹å¤„ç†åæ•°æ®è¿˜åŸç‡ï¼Œæ”¾å…¥explained_ratiosæ•°ç»„ã€‚æ¥ç€æŠŠè¿™ä¸ªæ•°ç»„ç”»å‡ºæ¥ï¼š</p><pre class="line-numbers language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>candidate_components<span class="token punctuation">,</span>explained_ratios<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Number of PCA Components'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Explained Variance Ratio'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Explained variance ratio for PCA'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">1.05</span><span class="token punctuation">,</span><span class="token number">0.05</span><span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200716163203114.png" alt="image-20200716163203114"></p><p>ä¸Šå›¾ä¸­æ¨ªåæ ‡è¡¨ç¤ºkå€¼ï¼Œçºµåæ ‡è¡¨ç¤ºæ•°æ®è¿˜åŸç‡ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œè¦ä¿ç•™95%ä»¥ä¸Šçš„æ•°æ®è¿˜åŸç‡ï¼Œkå€¼é€‰æ‹©140å³å¯ã€‚æ ¹æ®ä¸Šå›¾ï¼Œä¹Ÿå¯ä»¥éå¸¸å®¹æ˜“åœ°æ‰¾å‡ºä¸åŒçš„æ•°æ®è¿˜åŸç‡æ‰€å¯¹åº”çš„kå€¼ã€‚ä¸ºäº†æ›´ç›´è§‚åœ°è§‚å¯Ÿå’Œå¯¹æ¯”åœ¨ä¸åŒæ•°æ®è¿˜åŸç‡ä¸‹çš„æ•°æ®ï¼Œæˆ‘ä»¬é€‰æ‹©æ•°æ®è¿˜åŸç‡åˆ†åˆ«åœ¨95%ã€90%ã€80%ã€70%ã€60%çš„æƒ…å†µä¸‹ï¼Œè¿™äº›æ•°æ®è¿˜åŸç‡å¯¹åº”çš„kå€¼åˆ†åˆ«æ˜¯140ã€75ã€37ã€19ã€8ï¼Œç”»å‡ºç»PCAå¤„ç†åçš„å›¾ç‰‡ã€‚</p><h3 id="4-4-æœ€ç»ˆç»“æœ"><a href="#4-4-æœ€ç»ˆç»“æœ" class="headerlink" title="4.4 æœ€ç»ˆç»“æœ"></a>4.4 æœ€ç»ˆç»“æœ</h3><p>æ¥ä¸‹æ¥é—®é¢˜å°±å˜å¾—ç®€å•äº†ã€‚æˆ‘ä»¬é€‰æ‹©k=140ä½œä¸ºPCAå‚æ•°ï¼Œå¯¹è®­ç»ƒæ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†è¿›è¡Œç‰¹å¾æå–ã€‚</p><pre class="line-numbers language-python"><code class="language-python">n_components <span class="token operator">=</span> <span class="token number">140</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Fitting PCA by using training data ..."</span><span class="token punctuation">)</span>start <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>pca <span class="token operator">=</span> PCA<span class="token punctuation">(</span>n_components<span class="token operator">=</span>n_components<span class="token punctuation">,</span> svd_solver<span class="token operator">=</span><span class="token string">'randomized'</span><span class="token punctuation">,</span> whiten<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Done in {0:.2f}s"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Projecting input data for PCA ..."</span><span class="token punctuation">)</span>start <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>X_train_pca <span class="token operator">=</span> pca<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span>X_test_pca <span class="token operator">=</span> pca<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Done in {0:.2f}s"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">Fitting PCA by using training data <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Done <span class="token keyword">in</span> <span class="token number">0.</span>08sProjecting input data <span class="token keyword">for</span> PCA <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Done <span class="token keyword">in</span> <span class="token number">0.</span>01s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€ä½¿ç”¨ <code>GridSearchCV</code> æ¥é€‰æ‹©ä¸€ä¸ªæœ€ä½³çš„SVCæ¨¡å‹å‚æ•°ï¼Œç„¶åä½¿ç”¨æœ€ä½³å‚æ•°å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCV<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Searching the best parameters for SVC ..."</span><span class="token punctuation">)</span>param_grid <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token string">'gamma'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0.0001</span><span class="token punctuation">,</span> <span class="token number">0.0005</span><span class="token punctuation">,</span> <span class="token number">0.001</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">0.01</span><span class="token punctuation">]</span><span class="token punctuation">}</span>clf <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>SVC<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> class_weight<span class="token operator">=</span><span class="token string">'balanced'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param_grid<span class="token punctuation">,</span> verbose<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>clf <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train_pca<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Best parameters found by grid search:"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>clf<span class="token punctuation">.</span>best_params_<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸€æ­¥æ‰§è¡Œæ—¶é—´æ¯”è¾ƒé•¿ï¼Œå› ä¸ºGridSearchCVä½¿ç”¨çŸ©é˜µå¼æœç´¢æ³•ï¼Œå¯¹æ¯ç»„å‚æ•°ç»„åˆè¿›è¡Œä¸€æ¬¡è®­ç»ƒï¼Œç„¶åæ‰¾å‡ºæœ€å¥½çš„å‚æ•°çš„æ¨¡å‹ã€‚æˆ‘ä»¬é€šè¿‡è®¾ç½®n_jobs=4æ¥å¯åŠ¨4ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼ŒåŒæ—¶è®¾ç½®verbose=2æ¥è¾“å‡ºä¸€äº›è¿‡ç¨‹ä¿¡æ¯ã€‚æœ€ç»ˆé€‰æ‹©å‡ºæ¥çš„æœ€ä½³æ¨¡å‹å‚æ•°å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">Best parameters found by grid search<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'gamma'</span><span class="token punctuation">:</span> <span class="token number">0.001</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ¥ç€ä½¿ç”¨è¿™ä¸€æ¨¡å‹å¯¹æµ‹è¯•æ ·æœ¬è¿›è¡Œé¢„æµ‹ï¼Œå¹¶ä¸”ä½¿ç”¨confusion_matrixè¾“å‡ºé¢„æµ‹å‡†ç¡®æ€§ä¿¡æ¯ã€‚</p><pre class="line-numbers language-python"><code class="language-python">start <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Predict test dataset ..."</span><span class="token punctuation">)</span>y_pred <span class="token operator">=</span> clf<span class="token punctuation">.</span>best_estimator_<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test_pca<span class="token punctuation">)</span>cm <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">,</span> labels<span class="token operator">=</span>range<span class="token punctuation">(</span>n_targets<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Done in {0:.2f}.\n"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"confusion matrix:"</span><span class="token punctuation">)</span>np<span class="token punctuation">.</span>set_printoptions<span class="token punctuation">(</span>threshold<span class="token operator">=</span>np<span class="token punctuation">.</span>nan<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cm<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css">Predict test dataset <span class="token number">...</span>Done in <span class="token number">0.01.</span>confusion <span class="token property">matrix</span><span class="token punctuation">:</span>[[<span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">1</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">4</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">4</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">4</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">0</span>] [<span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">2</span>]]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»è¾“å‡ºçš„å¯¹è§’çº¿ä¸Šçš„æ•°æ®å¯ä»¥çœ‹å‡ºï¼Œå¤§éƒ¨åˆ†é¢„æµ‹ç»“æœéƒ½æ­£ç¡®ã€‚æˆ‘ä»¬å†ä½¿ç”¨classification_reportè¾“å‡ºåˆ†ç±»æŠ¥å‘Šï¼ŒæŸ¥çœ‹æµ‹å‡†ç‡ï¼Œå¬å›ç‡åŠF1 Scoreã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> y_pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">             precision    recall  f1<span class="token operator">-</span>score   support          <span class="token number">0</span>       <span class="token number">0.50</span>      <span class="token number">1.00</span>      <span class="token number">0.67</span>         <span class="token number">1</span>          <span class="token number">1</span>       <span class="token number">1.00</span>      <span class="token number">0.67</span>      <span class="token number">0.80</span>         <span class="token number">3</span>          <span class="token number">2</span>       <span class="token number">1.00</span>      <span class="token number">0.50</span>      <span class="token number">0.67</span>         <span class="token number">2</span>          <span class="token number">3</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">1</span>          <span class="token number">4</span>       <span class="token number">0.50</span>      <span class="token number">1.00</span>      <span class="token number">0.67</span>         <span class="token number">1</span>          <span class="token number">5</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">1</span>          <span class="token number">6</span>       <span class="token number">1.00</span>      <span class="token number">0.75</span>      <span class="token number">0.86</span>         <span class="token number">4</span>          <span class="token number">7</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>          <span class="token number">8</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">4</span>          <span class="token number">9</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">10</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">1</span>         <span class="token number">12</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">4</span>         <span class="token number">13</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">4</span>         <span class="token number">14</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">1</span>         <span class="token number">15</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">1</span>         <span class="token number">16</span>       <span class="token number">0.75</span>      <span class="token number">1.00</span>      <span class="token number">0.86</span>         <span class="token number">3</span>         <span class="token number">17</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">18</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">19</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">20</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">1</span>         <span class="token number">21</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">22</span>       <span class="token number">0.75</span>      <span class="token number">1.00</span>      <span class="token number">0.86</span>         <span class="token number">3</span>         <span class="token number">23</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">24</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">3</span>         <span class="token number">25</span>       <span class="token number">1.00</span>      <span class="token number">0.67</span>      <span class="token number">0.80</span>         <span class="token number">3</span>         <span class="token number">26</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">27</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">29</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">30</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">31</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">3</span>         <span class="token number">32</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">33</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">35</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">36</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">3</span>         <span class="token number">37</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">1</span>         <span class="token number">38</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>         <span class="token number">39</span>       <span class="token number">1.00</span>      <span class="token number">1.00</span>      <span class="token number">1.00</span>         <span class="token number">2</span>avg <span class="token operator">/</span> total       <span class="token number">0.97</span>      <span class="token number">0.95</span>      <span class="token number">0.95</span>        <span class="token number">80</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨æ€»å…±åªæœ‰400å¼ å›¾ç‰‡ï¼Œæ¯ä½ç›®æ ‡äººç‰©åªæœ‰10å¼ å›¾ç‰‡çš„æƒ…å†µä¸‹ï¼Œæµ‹å‡†ç‡å’Œå¬å›ç‡å¹³å‡è¾¾åˆ°äº†0.95ä»¥ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸äº†ä¸èµ·çš„æ€§èƒ½ã€‚</p><h2 id="5-æ‹“å±•é˜…è¯»"><a href="#5-æ‹“å±•é˜…è¯»" class="headerlink" title="5. æ‹“å±•é˜…è¯»"></a>5. æ‹“å±•é˜…è¯»</h2><p>PCAç®—æ³•çš„æ¨å¯¼æ¶‰åŠå¤§é‡çš„çº¿æ€§ä»£æ•°çš„çŸ¥è¯†ã€‚å¼ æ´‹å…ˆç”Ÿçš„ä¸€ç¯‡åšå®¢<a href="http://blog.codinglabs.org/articles/pca-tutorial.html" target="_blank" rel="noopener">ã€ŠPCAçš„æ•°å­¦åŸç†ã€‹</a>ï¼ŒåŸºæœ¬ä¸Šåšåˆ°äº†ä»æœ€åŸºç¡€çš„å†…å®¹è°ˆèµ·ï¼Œä¸€æ­¥æ­¥åœ°æ¨å¯¼å‡ºPCAç®—æ³•ï¼Œå€¼å¾—ä¸€è¯»ã€‚</p><p>æ­¤å¤–ï¼Œå­Ÿå²©å…ˆç”Ÿçš„å‡ ç¯‡åšå®¢ä¸­ä¹Ÿä»‹ç»äº†çŸ©é˜µåŠå…¶ç›¸å…³è¿ç®—çš„ç‰©ç†å«ä¹‰ï¼Œæ·±å…¥æµ…å‡ºï¼Œè¯»åçŠ¹å¦‚é†é†çŒé¡¶ï¼Œè¿™äº›åšæ–‡æ˜¯<a href="https://blog.csdn.net/myan/article/details/647511" target="_blank" rel="noopener">ã€Šç†è§£çŸ©é˜µã€‹</a>ä¸‰ç¯‡æ–‡ç« </p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MLç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scikit-learnç³»åˆ—ä¸ƒï¼šæœ´ç´ è´å¶æ–¯</title>
      <link href="/2020/07/02/scikit-learn-xi-lie-qi-po-su-bei-xie-si/"/>
      <url>/2020/07/02/scikit-learn-xi-lie-qi-po-su-bei-xie-si/</url>
      
        <content type="html"><![CDATA[<h2 id="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼"><a href="#é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼" class="headerlink" title="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼"></a>é¡¹ç›®åœ°å€<a href="https://github.com/DongZhouGu/scikit-learn-ml" target="_blank" rel="noopener">ä¼ é€é—¨</a>ï¼Œæ¬¢è¿ star å’Œ fork ï¼</h2><h2 id="1-æœ´ç´ è´å¶æ–¯æ¦‚è¿°"><a href="#1-æœ´ç´ è´å¶æ–¯æ¦‚è¿°" class="headerlink" title="1. æœ´ç´ è´å¶æ–¯æ¦‚è¿°"></a>1. æœ´ç´ è´å¶æ–¯æ¦‚è¿°</h2><p>è´å¶æ–¯åˆ†ç±»æ˜¯ä¸€ç±»åˆ†ç±»ç®—æ³•çš„æ€»ç§°ï¼Œè¿™ç±»ç®—æ³•å‡ä»¥è´å¶æ–¯å®šç†ä¸ºåŸºç¡€ï¼Œæ•…ç»Ÿç§°ä¸ºè´å¶æ–¯åˆ†ç±»ã€‚æœ´ç´ è´å¶æ–¯ï¼ˆNaive Bayersï¼‰ç®—æ³•æ˜¯ä¸€ç§åŸºäºæ¦‚ç‡ç»Ÿè®¡çš„åˆ†ç±»æ–¹æ³•ã€‚å®ƒåœ¨æ¡ä»¶ç‹¬ç«‹å‡è®¾çš„åŸºç¡€ä¸Šï¼Œä½¿ç”¨è´å¶æ–¯å®šç†æ„å»ºç®—æ³•ï¼Œåœ¨æ–‡æœ¬å¤„ç†é¢†åŸŸæœ‰å¹¿æ³›çš„åº”ç”¨ã€‚</p><h2 id="2-è´å¶æ–¯ç†è®º-amp-æ¡ä»¶æ¦‚ç‡"><a href="#2-è´å¶æ–¯ç†è®º-amp-æ¡ä»¶æ¦‚ç‡" class="headerlink" title="2. è´å¶æ–¯ç†è®º &amp; æ¡ä»¶æ¦‚ç‡"></a>2. è´å¶æ–¯ç†è®º &amp; æ¡ä»¶æ¦‚ç‡</h2><h3 id="2-1-è´å¶æ–¯ç†è®º"><a href="#2-1-è´å¶æ–¯ç†è®º" class="headerlink" title="2.1 è´å¶æ–¯ç†è®º"></a>2.1 è´å¶æ–¯ç†è®º</h3><p>æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œå®ƒç”±ä¸¤ç±»æ•°æ®ç»„æˆï¼Œæ•°æ®åˆ†å¸ƒå¦‚ä¸‹å›¾æ‰€ç¤º: </p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%A4%BA%E4%BE%8B%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83.png" alt="æœ´ç´ è´å¶æ–¯ç¤ºä¾‹æ•°æ®åˆ†å¸ƒ" title="å‚æ•°å·²çŸ¥çš„æ¦‚ç‡åˆ†å¸ƒ"></p><p>æˆ‘ä»¬ç°åœ¨ç”¨ p1(x,y) è¡¨ç¤ºæ•°æ®ç‚¹ (x,y) å±äºç±»åˆ« 1ï¼ˆå›¾ä¸­ç”¨åœ†ç‚¹è¡¨ç¤ºçš„ç±»åˆ«ï¼‰çš„æ¦‚ç‡ï¼Œç”¨ p2(x,y) è¡¨ç¤ºæ•°æ®ç‚¹ (x,y) å±äºç±»åˆ« 2ï¼ˆå›¾ä¸­ä¸‰è§’å½¢è¡¨ç¤ºçš„ç±»åˆ«ï¼‰çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªæ–°æ•°æ®ç‚¹ (x,y)ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„è§„åˆ™æ¥åˆ¤æ–­å®ƒçš„ç±»åˆ«: </p><ul><li>å¦‚æœ p1(x,y) &gt; p2(x,y) ï¼Œé‚£ä¹ˆç±»åˆ«ä¸º1</li><li>å¦‚æœ p2(x,y) &gt; p1(x,y) ï¼Œé‚£ä¹ˆç±»åˆ«ä¸º2</li></ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©é«˜æ¦‚ç‡å¯¹åº”çš„ç±»åˆ«ã€‚è¿™å°±æ˜¯è´å¶æ–¯å†³ç­–ç†è®ºçš„æ ¸å¿ƒæ€æƒ³ï¼Œå³é€‰æ‹©å…·æœ‰æœ€é«˜æ¦‚ç‡çš„å†³ç­–ã€‚</p><h3 id="2-2-æ¡ä»¶æ¦‚ç‡"><a href="#2-2-æ¡ä»¶æ¦‚ç‡" class="headerlink" title="2.2 æ¡ä»¶æ¦‚ç‡"></a>2.2 æ¡ä»¶æ¦‚ç‡</h3><p>å¦‚æœä½ å¯¹ p(x,y|c1) ç¬¦å·å¾ˆç†Ÿæ‚‰ï¼Œé‚£ä¹ˆå¯ä»¥è·³è¿‡æœ¬å°èŠ‚ã€‚</p><p>æœ‰ä¸€ä¸ªè£…äº† 7 å—çŸ³å¤´çš„ç½å­ï¼Œå…¶ä¸­ 3 å—æ˜¯ç™½è‰²çš„ï¼Œ4 å—æ˜¯é»‘è‰²çš„ã€‚å¦‚æœä»ç½å­ä¸­éšæœºå–å‡ºä¸€å—çŸ³å¤´ï¼Œé‚£ä¹ˆæ˜¯ç™½è‰²çŸ³å¤´çš„å¯èƒ½æ€§æ˜¯å¤šå°‘ï¼Ÿç”±äºå–çŸ³å¤´æœ‰ 7 ç§å¯èƒ½ï¼Œå…¶ä¸­ 3 ç§ä¸ºç™½è‰²ï¼Œæ‰€ä»¥å–å‡ºç™½è‰²çŸ³å¤´çš„æ¦‚ç‡ä¸º 3/7 ã€‚é‚£ä¹ˆå–åˆ°é»‘è‰²çŸ³å¤´çš„æ¦‚ç‡åˆæ˜¯å¤šå°‘å‘¢ï¼Ÿå¾ˆæ˜¾ç„¶ï¼Œæ˜¯ 4/7 ã€‚æˆ‘ä»¬ä½¿ç”¨ P(white) æ¥è¡¨ç¤ºå–åˆ°ç™½è‰²çŸ³å¤´çš„æ¦‚ç‡ï¼Œå…¶æ¦‚ç‡å€¼å¯ä»¥é€šè¿‡ç™½è‰²çŸ³å¤´æ•°ç›®é™¤ä»¥æ€»çš„çŸ³å¤´æ•°ç›®æ¥å¾—åˆ°ã€‚</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/NB_2.png" alt="åŒ…å« 7 å—çŸ³å¤´çš„é›†åˆ"></p><p>å¦‚æœè¿™ 7 å—çŸ³å¤´å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ”¾åœ¨ä¸¤ä¸ªæ¡¶ä¸­ï¼Œé‚£ä¹ˆä¸Šè¿°æ¦‚ç‡åº”è¯¥å¦‚ä½•è®¡ç®—ï¼Ÿ</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/NB_5.png" alt="7å—çŸ³å¤´æ”¾å…¥ä¸¤ä¸ªæ¡¶ä¸­"></p><p>è®¡ç®— P(white) æˆ–è€… P(black) ï¼Œå¦‚æœäº‹å…ˆæˆ‘ä»¬çŸ¥é“çŸ³å¤´æ‰€åœ¨æ¡¶çš„ä¿¡æ¯æ˜¯ä¼šæ”¹å˜ç»“æœçš„ã€‚è¿™å°±æ˜¯æ‰€è°“çš„æ¡ä»¶æ¦‚ç‡ï¼ˆconditional probablityï¼‰ã€‚å‡å®šè®¡ç®—çš„æ˜¯ä» B æ¡¶å–åˆ°ç™½è‰²çŸ³å¤´çš„æ¦‚ç‡ï¼Œè¿™ä¸ªæ¦‚ç‡å¯ä»¥è®°ä½œ P(white|bucketB) ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œåœ¨å·²çŸ¥çŸ³å¤´å‡ºè‡ª B æ¡¶çš„æ¡ä»¶ä¸‹ï¼Œå–å‡ºç™½è‰²çŸ³å¤´çš„æ¦‚ç‡â€ã€‚å¾ˆå®¹æ˜“å¾—åˆ°ï¼ŒP(white|bucketA) å€¼ä¸º 2/4 ï¼ŒP(white|bucketB) çš„å€¼ä¸º 1/3 ã€‚</p><p>æ¡ä»¶æ¦‚ç‡çš„è®¡ç®—å…¬å¼å¦‚ä¸‹: </p><p>P(white|bucketB) = P(white and bucketB) / P(bucketB)</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨ B æ¡¶ä¸­ç™½è‰²çŸ³å¤´çš„ä¸ªæ•°é™¤ä»¥ä¸¤ä¸ªæ¡¶ä¸­æ€»çš„çŸ³å¤´æ•°ï¼Œå¾—åˆ° P(white and bucketB) = 1/7 .å…¶æ¬¡ï¼Œç”±äº B æ¡¶ä¸­æœ‰ 3 å—çŸ³å¤´ï¼Œè€Œæ€»çŸ³å¤´æ•°ä¸º 7 ï¼Œäºæ˜¯ P(bucketB) å°±ç­‰äº 3/7 ã€‚äºæ˜¯åˆ P(white|bucketB) = P(white and bucketB) / P(bucketB) = (1/7) / (3/7) = 1/3 ã€‚</p><p>å¦å¤–ä¸€ç§æœ‰æ•ˆè®¡ç®—æ¡ä»¶æ¦‚ç‡çš„æ–¹æ³•ç§°ä¸ºè´å¶æ–¯å‡†åˆ™ã€‚è´å¶æ–¯å‡†åˆ™å‘Šè¯‰æˆ‘ä»¬å¦‚ä½•äº¤æ¢æ¡ä»¶æ¦‚ç‡ä¸­çš„æ¡ä»¶ä¸ç»“æœï¼Œå³å¦‚æœå·²çŸ¥ P(x|c)ï¼Œè¦æ±‚ P(c|x)ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è®¡ç®—æ–¹æ³•: </p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/NB_3.png" alt="è®¡ç®—p(c|x)çš„æ–¹æ³•"></p><h3 id="2-3-ä½¿ç”¨æ¡ä»¶æ¦‚ç‡æ¥åˆ†ç±»"><a href="#2-3-ä½¿ç”¨æ¡ä»¶æ¦‚ç‡æ¥åˆ†ç±»" class="headerlink" title="2.3 ä½¿ç”¨æ¡ä»¶æ¦‚ç‡æ¥åˆ†ç±»"></a>2.3 ä½¿ç”¨æ¡ä»¶æ¦‚ç‡æ¥åˆ†ç±»</h3><p>ä¸Šé¢æˆ‘ä»¬æåˆ°è´å¶æ–¯å†³ç­–ç†è®ºè¦æ±‚è®¡ç®—ä¸¤ä¸ªæ¦‚ç‡ p1(x, y) å’Œ p2(x, y):</p><ul><li>å¦‚æœ p1(x, y) &gt; p2(x, y), é‚£ä¹ˆå±äºç±»åˆ« 1;</li><li>å¦‚æœ p2(x, y) &gt; p1(X, y), é‚£ä¹ˆå±äºç±»åˆ« 2.</li></ul><p>è¿™å¹¶ä¸æ˜¯è´å¶æ–¯å†³ç­–ç†è®ºçš„æ‰€æœ‰å†…å®¹ã€‚ä½¿ç”¨ p1() å’Œ p2() åªæ˜¯ä¸ºäº†å°½å¯èƒ½ç®€åŒ–æè¿°ï¼Œè€ŒçœŸæ­£éœ€è¦è®¡ç®—å’Œæ¯”è¾ƒçš„æ˜¯ p(c1|x, y) å’Œ p(c2|x, y) .è¿™äº›ç¬¦å·æ‰€ä»£è¡¨çš„å…·ä½“æ„ä¹‰æ˜¯: ç»™å®šæŸä¸ªç”± xã€y è¡¨ç¤ºçš„æ•°æ®ç‚¹ï¼Œé‚£ä¹ˆè¯¥æ•°æ®ç‚¹æ¥è‡ªç±»åˆ« c1 çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿæ•°æ®ç‚¹æ¥è‡ªç±»åˆ« c2 çš„æ¦‚ç‡åˆæ˜¯å¤šå°‘ï¼Ÿæ³¨æ„è¿™äº›æ¦‚ç‡ä¸æ¦‚ç‡ p(x, y|c1) å¹¶ä¸ä¸€æ ·ï¼Œä¸è¿‡å¯ä»¥ä½¿ç”¨è´å¶æ–¯å‡†åˆ™æ¥äº¤æ¢æ¦‚ç‡ä¸­æ¡ä»¶ä¸ç»“æœã€‚å…·ä½“åœ°ï¼Œåº”ç”¨è´å¶æ–¯å‡†åˆ™å¾—åˆ°: </p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/NB_4.png" alt="åº”ç”¨è´å¶æ–¯å‡†åˆ™"></p><p>ä½¿ç”¨ä¸Šé¢è¿™äº›å®šä¹‰ï¼Œå¯ä»¥å®šä¹‰è´å¶æ–¯åˆ†ç±»å‡†åˆ™ä¸º:</p><ul><li>å¦‚æœ P(c1|x, y) &gt; P(c2|x, y), é‚£ä¹ˆå±äºç±»åˆ« c1;</li><li>å¦‚æœ P(c2|x, y) &gt; P(c1|x, y), é‚£ä¹ˆå±äºç±»åˆ« c2.</li></ul><p>åœ¨æ–‡æ¡£åˆ†ç±»ä¸­ï¼Œæ•´ä¸ªæ–‡æ¡£ï¼ˆå¦‚ä¸€å°ç”µå­é‚®ä»¶ï¼‰æ˜¯å®ä¾‹ï¼Œè€Œç”µå­é‚®ä»¶ä¸­çš„æŸäº›å…ƒç´ åˆ™æ„æˆç‰¹å¾ã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿæ–‡æ¡£ä¸­å‡ºç°çš„è¯ï¼Œå¹¶æŠŠæ¯ä¸ªè¯ä½œä¸ºä¸€ä¸ªç‰¹å¾ï¼Œè€Œæ¯ä¸ªè¯çš„å‡ºç°æˆ–è€…ä¸å‡ºç°ä½œä¸ºè¯¥ç‰¹å¾çš„å€¼ï¼Œè¿™æ ·å¾—åˆ°çš„ç‰¹å¾æ•°ç›®å°±ä¼šè·Ÿè¯æ±‡è¡¨ä¸­çš„è¯çš„æ•°ç›®ä¸€æ ·å¤šã€‚</p><p>æˆ‘ä»¬å‡è®¾ç‰¹å¾ä¹‹é—´  <strong>ç›¸äº’ç‹¬ç«‹</strong> ã€‚æ‰€è°“ <b>ç‹¬ç«‹(independence)</b> æŒ‡çš„æ˜¯ç»Ÿè®¡æ„ä¹‰ä¸Šçš„ç‹¬ç«‹ï¼Œå³ä¸€ä¸ªç‰¹å¾æˆ–è€…å•è¯å‡ºç°çš„å¯èƒ½æ€§ä¸å®ƒå’Œå…¶ä»–å•è¯ç›¸é‚»æ²¡æœ‰å…³ç³»ï¼Œæ¯”å¦‚è¯´ï¼Œâ€œæˆ‘ä»¬â€ä¸­çš„â€œæˆ‘â€å’Œâ€œä»¬â€å‡ºç°çš„æ¦‚ç‡ä¸è¿™ä¸¤ä¸ªå­—ç›¸é‚»æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚è¿™ä¸ªå‡è®¾æ­£æ˜¯æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ä¸­ æœ´ç´ (naive) ä¸€è¯çš„å«ä¹‰ã€‚æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ä¸­çš„å¦ä¸€ä¸ªå‡è®¾æ˜¯ï¼Œ<b>æ¯ä¸ªç‰¹å¾åŒç­‰é‡è¦</b>ã€‚</p><blockquote><p><b>Note:</b> æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨é€šå¸¸æœ‰ä¸¤ç§å®ç°æ–¹å¼: ä¸€ç§åŸºäºä¼¯åŠªåˆ©æ¨¡å‹å®ç°ï¼Œä¸€ç§åŸºäºå¤šé¡¹å¼æ¨¡å‹å®ç°ã€‚å‰è€…ä¸­å¹¶ä¸è€ƒè™‘è¯åœ¨æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œåªè€ƒè™‘å‡ºä¸å‡ºç°ï¼Œå› æ­¤åœ¨è¿™ä¸ªæ„ä¹‰ä¸Šç›¸å½“äºå‡è®¾è¯æ˜¯ç­‰æƒé‡çš„ã€‚</p></blockquote><h2 id="3-ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#3-ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="3. ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>3. ä¸€ä¸ªç®€å•çš„ä¾‹å­</h2><p>æˆ‘ä»¬å…ˆé€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œæ¥çœ‹æ€æ ·åº”ç”¨æœ´ç´ è´å¶æ–¯åˆ†ç±»ç®—æ³•ã€‚å‡è®¾æœ‰ä»¥ä¸‹å…³äºé©¾é¾„ã€å¹³å‡è½¦é€Ÿå’Œæ€§åˆ«çš„ç»Ÿè®¡æ•°æ®ï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-28f863c2b8a241e7.png" alt="img"></p><blockquote><p>ç°åœ¨è§‚å¯Ÿåˆ°ä¸€ä¸ªé©¾é¾„ä¸º2å¹´çš„äººï¼Œå¹³å‡è½¦é€Ÿä¸º80ã€‚é—®ï¼šè¿™ä¸ªäººçš„æ€§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p></blockquote><p>å‡è®¾ $C_{0}$ è¡¨ç¤ºå¥³  $C_{1}$ è¡¨ç¤ºç”·ï¼Œ$x_{0}$ è¡¨ç¤ºé©¾é¾„ï¼Œ$x_{1}$ è¡¨ç¤ºå¹³å‡è½¦é€Ÿã€‚æˆ‘ä»¬å…ˆæ¥è®¡ç®—è¿™ä¸ªäººä¸ºå¥³æ€§çš„æ¦‚ç‡ç›¸å¯¹å€¼ã€‚æ ¹æ®ç»Ÿè®¡æ•°æ®ï¼Œå¥³æ€§å¸æœºçš„æ¦‚ç‡ $P\left(C_{0}\right)=5 / 10=0.5$ ï¼Œã€‚é©¾é¾„ä¸º2å¹´çš„å¥³æ€§å¸æœºçš„æ¦‚ç‡å³ $P\left(x_{0} \mid C_{0}\right)=1 / 5=0.2$ ã€‚å¹³å‡è½¦é€Ÿä¸º80çš„å¥³æ€§å¸æœºçš„æ¦‚ç‡  $P\left(x_{1} \mid C_{0}\right)=1 / 5=0.2$ï¼Œæ ¹æ®æœ´ç´ è´å¶æ–¯åˆ†ç±»ç®—æ³•çš„æ•°å­¦å…¬å¼ï¼š</p><p>$$<br>P\left(C_{0}\right) \prod_{i=1}^{n} P\left(x_{i} \mid C_{0}\right)=0.5 \times 0.2 \times 0.2=0.02<br>$$<br>æ¥ç€è®¡ç®—è¿™ä¸ªäººä¸ºç”·æ€§çš„æ¦‚ç‡ç›¸å¯¹å€¼ã€‚æ ¹æ®ç»Ÿè®¡æ•°æ®ï¼Œä¸éš¾å¾—å‡ºç”·æ€§å¸æœºçš„æ¦‚ç‡ $P\left(C_{1}\right)=5 / 10=0.5$ ã€‚é©¾é¾„ä¸º2å¹´çš„ç”·æ€§å¸æœºçš„æ¦‚ç‡ $P\left(x_{0} \mid C_{1}\right)=2 / 5=0.4$ ã€‚å¹³å‡è½¦é€Ÿä¸º80çš„ç”·æ€§å¸æœºçš„æ¦‚ç‡ $P\left(x_{1} \mid C_{1}\right)=3 / 5=0.6$<br>$$<br>P\left(C_{1}\right) \prod_{i=1}^{n} P\left(x_{i} \mid C_{1}\right)=0.5 \times 0.4 \times 0.6=0.12<br>$$<br>ä»ç›¸å¯¹æ¦‚ç‡æ¥çœ‹ï¼Œè¿™ä¸ªäººæ˜¯ç”·æ€§çš„æ¦‚ç‡æ˜¯å¥³æ€§çš„æ¦‚ç‡çš„6å€ï¼Œæ®æ­¤åˆ¤æ–­è¿™ä¸ªäººæ˜¯ç”·æ€§ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»ç›¸å¯¹æ¦‚ç‡ä¸­ç®—å‡ºç»å¯¹æ¦‚ç‡ï¼Œå³è¿™ä¸ªäººæ˜¯ç”·æ€§çš„ç»å¯¹æ¦‚ç‡æ˜¯0.12/(0.12+0.02)=0.857ã€‚</p><h2 id="4-æ¦‚ç‡åˆ†å¸ƒ"><a href="#4-æ¦‚ç‡åˆ†å¸ƒ" class="headerlink" title="4.æ¦‚ç‡åˆ†å¸ƒ"></a>4.æ¦‚ç‡åˆ†å¸ƒ</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä»‹ç»çš„æœ´ç´ è´å¶æ–¯åˆ†ç±»ç®—æ³•æ˜¯æ ¹æ®æ•°æ®é›†é‡Œçš„æ•°æ®ï¼Œè®¡ç®—å‡ºç»å¯¹æ¦‚ç‡æ¥è¿›è¡Œæ±‚è§£ã€‚å†çœ‹ä¸€éæœ´ç´ è´å¶æ–¯åˆ†ç±»ç®—æ³•çš„æ•°å­¦å…¬å¼ï¼š<br>$$<br>P\left(C_{k} \mid x\right) \propto P\left(C_{k}\right) \prod_{i=1}^{n} P\left(x_{i} \mid C_{k}\right)<br>$$<br>å…¶ä¸­ï¼Œ $P\left(C_{k} \mid x\right) $è¡¨ç¤ºåœ¨ç±»åˆ«$C_{k}$ é‡Œç‰¹å¾$x_{i}$ å‡ºç°çš„æ¦‚ç‡ã€‚è¿™é‡Œæœ‰ä¸ªæœ€å¤§çš„é—®é¢˜ï¼Œå¦‚æœæ•°æ®é›†å¤ªå°ï¼Œé‚£ä¹ˆä»æ•°æ®é›†é‡Œè®¡ç®—å‡ºæ¥çš„æ¦‚ç‡åå·®å°†éå¸¸ä¸¥é‡ã€‚ä¾‹å¦‚ï¼Œè§‚å¯Ÿä¸€ä¸ªè´¨åœ°å‡åŒ€çš„éª°å­æŠ•æ·6æ¬¡çš„ç»“æœæ˜¯[1,3,1,5,3,3]ã€‚è´¨åœ°å‡åŒ€çš„éª°å­æ¯ä¸ªç‚¹å‡ºç°çš„æ¦‚ç‡éƒ½æ˜¯1/6ï¼Œå¦‚æœæ ¹æ®è§‚å¯Ÿåˆ°çš„æ•°æ®é›†å»è®¡ç®—æ¯ä¸ªç‚¹çš„æ¦‚ç‡ï¼Œå’ŒçœŸå®çš„æ¦‚ç‡ç›¸å·®å°†æ˜¯éå¸¸å¤§çš„ã€‚</p><p>æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨æ¦‚ç‡åˆ†å¸ƒæ¥è®¡ç®—æ¦‚ç‡ï¼Œè€Œä¸æ˜¯ä»æ•°æ®é›†é‡Œè®¡ç®—æ¦‚ç‡ã€‚</p><h3 id="4-1-æ¦‚ç‡ç»Ÿè®¡çš„åŸºæœ¬æ¦‚å¿µ"><a href="#4-1-æ¦‚ç‡ç»Ÿè®¡çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="4.1 æ¦‚ç‡ç»Ÿè®¡çš„åŸºæœ¬æ¦‚å¿µ"></a>4.1 æ¦‚ç‡ç»Ÿè®¡çš„åŸºæœ¬æ¦‚å¿µ</h3><p>äººçš„èº«é«˜æ˜¯ä¸€ä¸ªè¿ç»­çš„éšæœºå˜é‡ï¼Œè€ŒæŠ•æ·ä¸€ä¸ªéª°å­å¾—åˆ°çš„ç‚¹æ•°åˆ™æ˜¯ä¸€ä¸ªç¦»æ•£çš„éšæœºå˜é‡ã€‚æˆ‘ä»¬é—­ç€çœ¼ç›éšä¾¿æ‰¾ä¸€ä¸ªäººï¼Œé—®è¿™ä¸ªäººçš„èº«é«˜æ˜¯170cmçš„å¯èƒ½æ€§æ˜¯å¤šå¤§å‘¢ï¼Ÿå¦‚æœæœ‰ä¸€ä¸ªå‡½æ•°ï¼Œèƒ½æè¿°äººç±»èº«é«˜çš„å¯èƒ½æ€§ï¼Œé‚£ä¹ˆç›´æ¥æŠŠ170cmä»£å…¥å³å¯æ±‚å‡ºè¿™ä¸ªå¯èƒ½æ€§ã€‚è¿™ä¸ªå‡½æ•°å°±æ˜¯æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œä¹Ÿç§°ä¸º<code>PDFï¼ˆProbability Density Functionï¼‰</code>ã€‚å…¸å‹çš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯é«˜æ–¯åˆ†å¸ƒå‡½æ•°ï¼Œå¦‚äººç±»çš„èº«é«˜å°±æ»¡è¶³é«˜æ–¯åˆ†å¸ƒçš„è§„å¾‹ã€‚</p><p>å†ä¾‹å¦‚ï¼ŒæŠ•æ·ä¸€ä¸ªè´¨åœ°å‡åŒ€çš„éª°å­ï¼Œå¾—åˆ°6çš„æ¦‚ç‡æ˜¯å¤šå°‘å‘¢ï¼Ÿå¤§å®¶éƒ½çŸ¥é“ç­”æ¡ˆæ˜¯1/6ã€‚å‡å¦‚æœ‰ä¸€ä¸ªå‡½æ•°f(x)ï¼Œèƒ½æè¿°éª°å­å‡ºç°xç‚¹æ•°çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆæŠŠxä»£å…¥å³å¯å¾—åˆ°æ¦‚ç‡ï¼Œè¿™ä¸ªå‡½æ•°ç§°ä¸ºæ¦‚ç‡è´¨é‡å‡½æ•°ï¼Œå³PMFï¼ˆProbability Mass Functionï¼‰ã€‚é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿˜æœ‰ä½¿ç”¨æ¦‚ç‡è´¨é‡å‡½æ•°å‘¢ï¼Ÿä¸€æ˜¯åœ¨æ•°å­¦ä¸Šè¿½æ±‚ç»Ÿä¸€æ€§ï¼ŒäºŒæ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç¦»æ•£éšæœºå˜é‡çš„æ¦‚ç‡åˆ†å¸ƒéƒ½åƒæ·ä¸€æ¬¡éª°å­è¿™ä¸ªç›´è§‚ã€‚ä¾‹å¦‚ï¼ŒæŠ•æ·6æ¬¡è´¨åœ°å‡åŒ€çš„éª°å­ï¼Œå¾—åˆ°4ä¸ª4çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿè¿™ä¸ªæ—¶å€™å¦‚æœæœ‰æ¦‚ç‡è´¨é‡å‡½æ•°ï¼Œå°±å¯ä»¥è½»æ¾æ±‚è§£äº†ã€‚</p><blockquote><p>æ€»ç»“ä¸€ä¸‹ï¼Œéšæœºå˜é‡åˆ†æˆä¸¤ç§ï¼Œä¸€ç§æ˜¯è¿ç»­éšæœºå˜é‡ï¼Œå¦å¤–ä¸€ç§æ˜¯ç¦»æ•£éšæœºå˜é‡ã€‚æ¦‚ç‡å¯†åº¦å‡½æ•°æè¿°çš„æ˜¯è¿ç»­éšæœºå˜é‡åœ¨æŸä¸ªç‰¹å®šå€¼çš„å¯èƒ½æ€§ï¼Œæ¦‚ç‡è´¨é‡å‡½æ•°æè¿°çš„æ˜¯ç¦»æ•£éšæœºå˜é‡åœ¨æŸä¸ªç‰¹å®šå€¼çš„å¯èƒ½æ€§ã€‚è€Œæ¦‚ç‡åˆ†å¸ƒåˆ™æ˜¯æè¿°éšæœºå˜é‡å–å€¼çš„æ¦‚ç‡è§„å¾‹ã€‚</p></blockquote><h3 id="4-2-å¤šé¡¹å¼åˆ†å¸ƒ"><a href="#4-2-å¤šé¡¹å¼åˆ†å¸ƒ" class="headerlink" title="4.2 å¤šé¡¹å¼åˆ†å¸ƒ"></a>4.2 å¤šé¡¹å¼åˆ†å¸ƒ</h3><p> æŠ›ä¸€æšç¡¬å¸ï¼Œè¦ä¹ˆå‡ºç°æ­£é¢ï¼Œè¦ä¹ˆå‡ºç°åé¢ï¼ˆå‡è®¾ç¡¬å¸ä¸ä¼šç«‹èµ·æ¥ï¼‰ã€‚å‡å¦‚å‡ºç°æ­£é¢çš„æ¦‚ç‡æ˜¯pï¼Œåˆ™å‡ºç°åé¢çš„æ¦‚ç‡å°±æ˜¯1-pã€‚ç¬¦åˆè¿™ä¸ªè§„å¾‹çš„æ¦‚ç‡åˆ†å¸ƒï¼Œç§°ä¸º <code>ä¼¯åŠªåˆ©åˆ†å¸ƒï¼ˆBernoulli Distributionï¼‰</code>ã€‚å…¶æ¦‚ç‡è´¨é‡å‡½æ•°ä¸ºï¼š<br>$$<br>f(k ; p)=p^{k}(1-p)^{1-k}<br>$$<br>pæ˜¯å‡ºç°1çš„æ¦‚ç‡ã€‚ä¾‹å¦‚ï¼Œä¸€æšè´¨åœ°å‡åŒ€çš„ç¡¬å¸è¢«æŠ›ä¸€æ¬¡ï¼Œå¾—åˆ°æ­£é¢çš„æ¦‚ç‡ä¸º0.5ã€‚æˆ‘ä»¬ä»£å…¥ä¸Šè¿°å…¬å¼ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœï¼Œå³f(1;0.5)=0.5ã€‚</p><p>æ›´ä¸€èˆ¬çš„æƒ…å†µï¼Œå³ä¸æ­¢ä¸¤ç§å¯èƒ½æ€§æ—¶ï¼Œå‡è®¾æ¯ç§å¯èƒ½æ€§æ˜¯$p_{i}$, åˆ™æ»¡è¶³  $\sum_{i}^{n} p_{i}=1$ï¼Œ æ¡ä»¶çš„æ¦‚ç‡åˆ†å¸ƒï¼Œç§°ä¸º<code>ç±»åˆ«åˆ†å¸ƒï¼ˆCategorical Distributionï¼‰</code>ã€‚ä¾‹å¦‚ï¼ŒæŠ•æ·ä¸€æšéª°å­ï¼Œåˆ™ä¼šå‡ºç°6ä¸­å¯èƒ½æ€§ï¼Œæ‰€æœ‰çš„å¯èƒ½æ€§åŠ èµ·æ¥çš„æ¦‚ç‡ä¸º1ã€‚ç±»åˆ«åˆ†å¸ƒçš„æ¦‚ç‡è´¨é‡å‡½æ•°ä¸ºï¼š<br>$$<br>f(x \mid p)=\prod_{i=1}^{k} p_{i}^{x_{i}}<br>$$<br>é‚£ä¹ˆï¼Œä¸€æšè´¨åœ°å‡åŒ€çš„ç¡¬å¸è¢«æŠ›10æ¬¡ï¼Œå‡ºç°3æ¬¡æ­£é¢çš„æ¦‚ç‡æ˜¯å¤šå°‘å‘¢ï¼Ÿè¿™æ˜¯ä¸ªå…¸å‹çš„äºŒé¡¹å¼åˆ†å¸ƒé—®é¢˜ã€‚äºŒé¡¹å¼åˆ†å¸ƒæŒ‡çš„æ˜¯æŠŠç¬¦å·ä¼¯åŠªåˆ©åˆ†å¸ƒçš„å®éªŒåšäº†næ¬¡ï¼Œç»“æœ1å‡ºç°0æ¬¡ã€1æ¬¡ã€2æ¬¡â€¦â€¦næ¬¡çš„æ¦‚ç‡åˆ†åˆ«æ˜¯å¤šå°‘ï¼Œå®ƒçš„æ¦‚ç‡è´¨é‡å‡½æ•°ä¸ºï¼š<br>$$<br>f(k ; n, p)=C_{n}^{k} p^{k}(1-p)^{n-k}<br>$$<br>æšè´¨åœ°å‡åŒ€çš„ç¡¬å¸è¢«æŠ›10æ¬¡ï¼Œå‡ºç°3æ¬¡æ­£é¢çš„æ¦‚ç‡æ˜¯å¤šå°‘ï¼Ÿä»£å…¥äºŒé¡¹å¼åˆ†å¸ƒçš„æ¦‚ç‡è´¨é‡å‡½æ•°ï¼Œå¾—åˆ°ï¼š<br>$$<br>f(3 ; 10,0.5)=\frac{10 !}{3 ! \times(10-3) !} \times 0.5^{3} \times(1-0.5)^{10-3}=0.1171875<br>$$<br>å…¶ä¸­ï¼Œ0çš„é˜¶ä¹˜ä¸º1ï¼Œå³0!=1ã€‚ç»“æœè·Ÿæˆ‘ä»¬é¢„æœŸçš„ç›¸ç¬¦ã€‚å½“å®éªŒåªåšä¸€æ¬¡æ—¶ï¼ŒäºŒé¡¹å¼åˆ†å¸ƒé€€åŒ–ä¸ºä¼¯åŠªåˆ©åˆ†å¸ƒã€‚</p><p>ç®€å•æ€»ç»“ä¸€ä¸‹ï¼ŒäºŒé¡¹å¼åˆ†å¸ƒæè¿°çš„æ˜¯å¤šæ¬¡ä¼¯åŠªåˆ©å®éªŒä¸­ï¼ŒæŸä¸ªç»“æœå‡ºç°æ¬¡æ•°çš„æ¦‚ç‡ã€‚å¤šé¡¹å¼åˆ†å¸ƒæè¿°çš„æ˜¯å¤šæ¬¡è¿›è¡Œæ»¡è¶³ç±»åˆ«åˆ†å¸ƒçš„å®éªŒä¸­ï¼Œæ‰€æœ‰ç±»åˆ«å‡ºç°çš„æ¬¡æ•°ç»„åˆçš„åˆ†å¸ƒã€‚</p><p>äºŒé¡¹å¼åˆ†å¸ƒå’Œå¤šé¡¹å¼åˆ†å¸ƒç»“åˆæœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œç»å¸¸è¢«ç”¨æ¥å®ç°æ–‡ç« åˆ†ç±»ç®—æ³•ã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ªè®ºå›éœ€è¦å¯¹ç”¨æˆ·çš„è¯„è®ºè¿›è¡Œè¿‡æ»¤ï¼Œå±è”½ä¸æ–‡æ˜çš„è¯„è®ºã€‚é¦–å…ˆè¦æœ‰ä¸€ä¸ªç»è¿‡æ ‡è®°çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬ç§°ä¸ºè¯­æ–™åº“ã€‚å‡è®¾ä½¿ç”¨äººå·¥æ ‡è®°çš„æ–¹æ³•å¯¹è¯„è®ºè¿›è¡Œæ ‡è®°ï¼Œ1è¡¨ç¤ºä¸æ–‡æ˜çš„è¯„è®ºï¼Œ0è¡¨ç¤ºæ­£å¸¸è¯„è®ºã€‚</p><p>å‡è®¾æˆ‘ä»¬çš„è¯åº“å¤§å°ä¸º k ï¼Œåˆ™è¯„è®ºä¸­å‡ºç°æŸä¸ªè¯å¯ä»¥çœ‹æˆæ˜¯ä¸€æ¬¡æ»¡è¶³kä¸ªç±»åˆ«çš„ç±»åˆ«åˆ†å¸ƒå®éªŒã€‚æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ç¯‡è¯„è®ºæ˜¯ç”±nä¸ªè¯ç»„æˆçš„ï¼Œå› æ­¤ä¸€ç¯‡è¯„è®ºå¯ä»¥çœ‹å‡ºæ˜¯è¿›è¡Œnæ¬¡ç±»åˆ«åˆ†å¸ƒå®éªŒåçš„äº§ç‰©ã€‚ç”±æ­¤å¾—çŸ¥ï¼Œä¸€ç¯‡è¯„è®ºæœä»å¤šé¡¹å¼åˆ†å¸ƒï¼Œå®ƒæ˜¯è¯åº“é‡Œçš„æ‰€æœ‰è¯è¯­å‡ºç°çš„æ¬¡æ•°ç»„åˆæ„æˆçš„éšæœºå‘é‡ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¯åº“æ¯”è¾ƒå¤§ï¼Œè¯„è®ºåªæ˜¯ç”±å°‘é‡è¯ç»„æˆï¼Œæ‰€ä»¥è¿™ä¸ªéšæœºå‘é‡æ˜¯å¾ˆç¨€ç–çš„ï¼Œå³å¤§éƒ¨åˆ†å…ƒç´ ä¸º0ã€‚é€šè¿‡åˆ†æé¢„æ–™åº“ï¼Œæˆ‘ä»¬å®¹æ˜“ç»Ÿè®¡å‡ºæ¯ä¸ªè¯å‡ºç°åœ¨ä¸æ–‡æ˜è¯„è®ºåŠæ­£å¸¸è¯„è®ºçš„æ¦‚ç‡ï¼Œå³ $p_{i}$çš„å€¼ã€‚åŒæ—¶é’ˆå¯¹å¾…é¢„æµ‹çš„è¯„è®ºï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿè®¡è¯åº“é‡Œçš„æ‰€æœ‰è¯åœ¨è¿™ç¯‡è¯„è®ºé‡Œå‡ºç°çš„æ¬¡æ•°å³  $x_{i}$ çš„å€¼ï¼ŒåŠè¯„è®ºçš„è¯è¯­ä¸ªæ•°ã€‚ä»£å…¥å¤šé¡¹å¼åˆ†å¸ƒçš„æ¦‚ç‡è´¨é‡å‡½æ•°ï¼š<br>$$<br>f(X, n, P)=\frac{n !}{\prod_{i=1}^{k} x_{i} !} \prod_{i=1}^{k} p_{i}^{x_{i}}<br>$$<br>æˆ‘ä»¬å¯ä»¥æ±‚å‡ºï¼Œå¾…é¢„æµ‹è¯„è®ºæ„æˆçš„éšæœºå‘é‡xï¼Œå…¶ä¸ºä¸æ–‡æ˜è¯„è®ºçš„ç›¸å¯¹æ¦‚ç‡ã€‚åŒç†ä¹Ÿå¯ä»¥æ±‚å‡ºå…¶ä¸ºæ­£å¸¸è¯„è®ºçš„ç›¸å¯¹æ¦‚ç‡ã€‚é€šè¿‡æ¯”è¾ƒä¸¤ä¸ªç›¸å¯¹æ¦‚ç‡ï¼Œå°±å¯ä»¥å¯¹è¿™ç¯‡è¯„è®ºè¾“å‡ºä¸€ä¸ªé¢„æµ‹å€¼ã€‚å½“ç„¶ï¼Œå®é™…åº”ç”¨ä¸­ï¼Œæ¶‰åŠå¤§é‡çš„è‡ªç„¶è¯­è¨€å¤„ç†çš„æ‰‹æ®µï¼ŒåŒ…æ‹¬ä¸­æ–‡åˆ†è¯æŠ€æœ¯ã€è¯çš„æ•°å­¦è¡¨ç¤ºç­‰ï¼Œè¿™é‡Œä¸å†å±•å¼€ã€‚</p><h3 id="4-3-é«˜æ–¯åˆ†å¸ƒ"><a href="#4-3-é«˜æ–¯åˆ†å¸ƒ" class="headerlink" title="4.3 é«˜æ–¯åˆ†å¸ƒ"></a>4.3 é«˜æ–¯åˆ†å¸ƒ</h3><p>åœ¨å‰é¢çš„è½¦é€Ÿå’Œæ€§åˆ«é¢„æµ‹çš„ä¾‹å­é‡Œï¼Œå¯¹äºå¹³å‡è½¦é€Ÿï¼Œç»™å‡ºçš„æ˜¯ç¦»æ•£å€¼ï¼Œå®é™…ä¸Šå®ƒæ˜¯ä¸€ä¸ªè¿ç»­å€¼ã€‚è¿™ä¸ªæ—¶å€™æ€ä¹ˆä½¿ç”¨è´å¶æ–¯ç®—æ³•æ¥å¤„ç†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œå¯ä»¥ç”¨åŒºé—´æŠŠè¿ç»­å€¼è½¬æ¢æˆç¦»æ•£å€¼ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¹³å‡è½¦é€Ÿ[0,40]ä½œä¸ºä¸€ä¸ªçº§åˆ«ï¼Œ[40-80]ï¼Œç­‰ç­‰ã€‚è¿™æ ·å°±å¯ä»¥æŠŠè¿ç»­å€¼å˜æˆç¦»æ•£å€¼ï¼Œä»è€Œä½¿ç”¨è´å¶æ–¯ç®—æ³•è¿›è¡Œå¤„ç†ã€‚å¦å¤–ä¸€ä¸ªæ–¹æ³•ï¼Œæ˜¯ä½¿ç”¨è¿ç»­éšæœºå˜é‡çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ŒæŠŠæ•°å€¼è½¬æ¢ä¸ºä¸€ä¸ªç›¸å¯¹æ¦‚ç‡ã€‚é«˜æ–¯åˆ†å¸ƒå°±æ˜¯è¿™æ ·ä¸€ç§æ–¹æ³•ã€‚</p><p><code>é«˜æ–¯åˆ†å¸ƒï¼ˆGaussian Distributionï¼‰</code>ä¹Ÿç§°ä¸º <code>æ­£æ€åˆ†å¸ƒï¼ˆNormal Distributionï¼‰</code>ï¼Œæ˜¯æœ€å¸¸è§çš„ä¸€ç§åˆ†å¸ƒã€‚ä¾‹å¦‚äººçš„èº«é«˜æ»¡è¶³é«˜æ–¯åˆ†å¸ƒï¼Œç‰¹åˆ«é«˜å’Œç‰¹åˆ«çŸ®çš„äººå‡ºç°çš„ç›¸å¯¹æ¦‚ç‡éƒ½å¾ˆä½ï¼Œå¤§éƒ¨åˆ†äººèº«é«˜éƒ½å¤„åœ¨ä¸­é—´æ°´å¹³ã€‚è¿˜æœ‰äººçš„æ™ºå•†ä¹Ÿç¬¦åˆé«˜æ–¯åˆ†å¸ƒï¼Œç‰¹åˆ«èªæ˜çš„å¤©æ‰å’Œç‰¹åˆ«ç¬¨çš„äººå‡ºç°çš„ç›¸å¯¹æ¦‚ç‡éƒ½å¾ˆä½ï¼Œå¤§éƒ¨åˆ†äººçš„æ™ºåŠ›éƒ½å·®ä¸å¤šã€‚é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š<br>$$<br>f(x)=\frac{1}{\sqrt{2 \pi \sigma^{2}}} \exp \left(-\frac{(x-\mu)^{2}}{2 \sigma^{2}}\right)<br>$$<br>å…¶ä¸­ï¼Œ$x$ ä¸ºéšæœºå˜é‡çš„å€¼ï¼Œ$f(x)$ ä¸ºéšæœºå˜é‡çš„ç›¸å¯¹æ¦‚ç‡ï¼Œ$\mu$ä¸ºæ ·æœ¬çš„å¹³å‡å€¼ï¼Œå…¶å†³å®šäº†é«˜æ–¯åˆ†å¸ƒæ›²çº¿çš„ä½ç½®ï¼Œ<img src="/medias/loading.gif" data-original="https://math.jianshu.com/math?formula=%5Csigma" alt="\sigma">ä¸ºæ ‡å‡†å·®ï¼Œå…¶å†³å®šäº†é«˜æ–¯åˆ†å¸ƒçš„å¹…åº¦ï¼Œ$\sigma$ å€¼è¶Šå¤§ï¼Œåˆ†å¸ƒè¶Šåˆ†æ•£ï¼Œ<img src="/medias/loading.gif" data-original="https://math.jianshu.com/math?formula=%5Csigma" alt="\sigma">$\sigma$å€¼è¶Šå°ï¼Œåˆ†å¸ƒè¶Šé›†ä¸­ã€‚å…¸å‹çš„é«˜æ–¯åˆ†å¸ƒå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-e4f8952fc25052e3.png" alt="img"></p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°å’Œæ”¯æŒå‘é‡æœºé‡Œçš„é«˜æ–¯æ ¸å‡½æ•°çš„åŒºåˆ«ã€‚äºŒè€…çš„æ ¸å¿ƒæ•°å­¦æ¨¡å‹æ˜¯ç›¸åŒçš„ï¼Œä½†æ˜¯ç›®çš„ä¸åŒã€‚</p><h3 id="4-4-è¿ç»­å€¼å¾—å¤„ç†"><a href="#4-4-è¿ç»­å€¼å¾—å¤„ç†" class="headerlink" title="4.4 è¿ç»­å€¼å¾—å¤„ç†"></a>4.4 è¿ç»­å€¼å¾—å¤„ç†</h3><p>å‡è®¾ï¼Œæœ‰ä¸€ç»„èº«ä½“ç‰¹å¾çš„ç»Ÿè®¡æ•°æ®å¦‚ä¸‹ï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-ab2a72e2cf69b3f1.png" alt="img"></p><p>å‡è®¾æŸäººèº«é«˜6è‹±å°ºï¼Œä½“é‡130æ¦œï¼Œè„šæŒ8è‹±å¯¸ï¼Œè¯·é—®æ­¤äººçš„æ€§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æ ¹æ®æœ´ç´ è´å¶æ–¯å…¬å¼ï¼š<br>$$<br>P\left(C_{k} \mid x\right) \propto P\left(C_{k}\right) \prod_{i=1}^{n} P\left(x_{i} \mid C_{k}\right)<br>$$<br>é’ˆå¯¹å¾…é¢„æµ‹çš„è¿™ä¸ªäººçš„æ•°æ®$x$ ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ†åˆ«æ±‚å‡ºç”·æ€§å’Œå¥³æ€§çš„ç›¸å¯¹æ¦‚ç‡<br>$$<br>P(\text {Gender}) \times P(\text {Height} \mid \text {Gender}) \times P(\text {Weight} \mid \text {Gender}) \times P(\text {Feet} \mid \text {Gender})<br>$$<br>ç„¶åå–ç›¸å¯¹æ¦‚ç‡è¾ƒé«˜çš„æ€§åˆ«ä¸ºé¢„æµ‹å€¼å³å¯ã€‚è¿™é‡Œçš„å›°éš¾åœ¨äºï¼Œæ‰€æœ‰çš„ç‰¹å¾éƒ½æ˜¯è¿ç»­å˜é‡ï¼Œæ— æ³•æ ¹æ®ç»Ÿè®¡æ•°æ®è®¡ç®—æ¦‚ç‡ã€‚å½“ç„¶ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒºé—´æ³•ï¼ŒæŠŠè¿ç»­å˜é‡å˜ä¸ºç¦»æ•£å˜é‡ï¼Œç„¶åå†è®¡ç®—æ¦‚ç‡ã€‚ä½†ç”±äºæ•°æ®é‡è¾ƒå°ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯ä¸€ä¸ªå¥½åŠæ³•ã€‚ç”±äºäººç±»èº«é«˜ã€ä½“é‡ã€è„šæŒå°ºå¯¸æ»¡è¶³é«˜æ–¯åˆ†å¸ƒï¼Œå› æ­¤æ›´å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ¥æ±‚ç›¸å¯¹æ¦‚ç‡ã€‚</p><p>é¦–å…ˆï¼Œé’ˆå¯¹ç”·æ€§å’Œå¥³æ€§ï¼Œåˆ†åˆ«æ±‚å‡ºç‰¹å¾çš„å¹³å‡å€¼å’Œæ–¹å·®ï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-4755f7b16509dc1d.png" alt="img"></p><p>æ¥ç€åˆ©ç”¨é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œæ¥æ±‚è§£ç”·æ€§èº«é«˜ä¸º6è‹±å°ºçš„ç›¸å¯¹æ¦‚ç‡ï¼š<br>$$<br>P(\text {Height}=6 \mid \text {Male})=\frac{1}{\sqrt{2 \pi \times 0.035033^{2}}} \exp \left(-\frac{(6-5.855)^{2}}{2 \times 0.035033^{2}}\right) \approx 1.5789<br>$$<br>è¿™é‡Œçš„å…³é”®æ˜¯æŠŠè¿ç»­å€¼ï¼ˆèº«é«˜ï¼‰ä½œä¸ºè¾“å…¥ï¼Œé€šè¿‡é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°çš„å¤„ç†ï¼Œç›´æ¥è½¬æ¢ä¸ºç›¸å¯¹æ¦‚ç‡ã€‚æ³¨æ„è¿™é‡Œæ˜¯ç›¸å¯¹æ¦‚ç‡ï¼Œæ‰€ä»¥å…¶å€¼å¤§äº1å¹¶æœªè¿åæ¦‚ç‡è®ºè§„åˆ™ã€‚</p><h2 id="5-ç¤ºä¾‹ï¼šæ–‡æ¡£åˆ†ç±»"><a href="#5-ç¤ºä¾‹ï¼šæ–‡æ¡£åˆ†ç±»" class="headerlink" title="5. ç¤ºä¾‹ï¼šæ–‡æ¡£åˆ†ç±»"></a>5. ç¤ºä¾‹ï¼šæ–‡æ¡£åˆ†ç±»</h2><p>åœ¨ <code>scikit-learn</code>é‡Œï¼Œæœ´ç´ è´å¶æ–¯ç®—æ³•åœ¨ <code>sklearn.naive_bayes</code> åŒ…é‡Œå®ç°ï¼ŒåŒ…å«æœ¬æ–‡ä»‹ç»çš„å‡ ç§å…¸å‹çš„æ¦‚ç‡åˆ†å¸ƒç®—æ³•ã€‚å…¶ä¸­ <code>GaussianNB</code> å®ç°äº†é«˜æ–¯åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œ<code>MultinomialNB</code> å®ç°äº†å¤šé¡¹å¼åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œ<code>BernoulliNB</code>å®ç°äº†ä¼¯åŠªåˆ©åˆ†å¸ƒçš„æœ´ç´ è´å¶æ–¯ç®—æ³•ã€‚æœ´ç´ è´å¶æ–¯ç®—æ³•åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸæœ‰ç€å¹¿æ³›çš„åº”ç”¨ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <code>MultinomialNB</code> æ¥å®ç°æ–‡æ¡£çš„è‡ªåŠ¨åˆ†ç±»ã€‚</p><h3 id="5-1-è·å–æ•°æ®é›†"><a href="#5-1-è·å–æ•°æ®é›†" class="headerlink" title="5.1 è·å–æ•°æ®é›†"></a>5.1 è·å–æ•°æ®é›†</h3><p>è¿™é‡Œä½¿ç”¨çš„æ•°æ®é›†æ¥è‡ª mlcomp.orgä¸Šçš„20news-18828ï¼Œå¯ä»¥ç›´æ¥è®¿é—®<a href="https://links.jianshu.com/go?to=http%3A%2F%2Fmlcomp.org%2Fdatasets%2F379" target="_blank" rel="noopener">http://mlcomp.org/datasets/379</a>ä¸‹è½½ã€‚å…¶ç›®å½•ä¸‹åŒ…å«3ä¸ªå­ç›®å½•å’Œä¸€ä¸ªåä¸ºmetadataçš„ä»‹ç»æ–‡ä»¶ï¼Œæ•°æ®é›†ä¹Ÿå¯åœ¨ç™¾åº¦ç½‘ç›˜ä¸‹è½½ã€‚ï¼Œå·²åˆ†äº«ã€‚</p><blockquote><p>é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1uQNkLWIN0niz8-p8BppRJg" target="_blank" rel="noopener">https://pan.baidu.com/s/1uQNkLWIN0niz8-p8BppRJg</a><br>æå–ç ï¼šbvhe<br>å¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦</p></blockquote><p>æˆ‘ä»¬å°†ä½¿ç”¨ <code>train</code> å­ç›®å½•ä¸‹çš„æ–‡æ¡£è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œç„¶åä½¿ç”¨ <code>test</code> å­ç›®å½•ä¸‹çš„æ–‡æ¡£è¿›è¡Œæ¨¡å‹æµ‹è¯•ã€‚<code>train</code> å­ç›®å½•ä¸‹åŒ…å« 20 ä¸ªå­ç›®å½•ï¼Œæ¯ä¸ªå­ç›®å½•ä»£è¡¨ä¸€ç§æ–‡æ¡£çš„ç±»å‹ï¼Œå­ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡æ¡£éƒ½æ˜¯å±äºç›®å½•åç§°æ‰€æ ‡è¯†çš„æ–‡æ¡£ç±»å‹ã€‚å¯ä»¥éšæ„æµè§ˆæ•°æ®é›†ï¼Œä»¥ä¾¿å¯¹æ•°æ®é›†æœ‰ä¸€ä¸ªæ„Ÿæ€§çš„è®¤è¯†ã€‚ä¾‹å¦‚ï¼Œdatasets/mlcomp/379/train/rec.autos/6652-103421æ˜¯ä¸€ä¸ªè®¨è®ºæ±½è½¦ä¸»é¢˜çš„å¸–å­ï¼š</p><pre class="line-numbers language-kotlin"><code class="language-kotlin">Hahahahahaha<span class="token punctuation">.</span> gasp pant Hm<span class="token punctuation">,</span> Iâ€™m not sure whether the above was just a silly     remark <span class="token operator">or</span> a serious remark<span class="token punctuation">.</span> But <span class="token keyword">in</span> case there are some misconceptions<span class="token punctuation">,</span>I think Henry Robertson hasnâ€™t updated his <span class="token keyword">data</span> file on Korea sinceâ€¦mid 1970s<span class="token punctuation">.</span> Owning a car <span class="token keyword">in</span> Korea <span class="token keyword">is</span> no longer a luxury<span class="token punctuation">.</span> Most middle <span class="token keyword">class</span> people <span class="token keyword">in</span> Korea can afford a car <span class="token operator">and</span> <span class="token keyword">do</span> have at least one car<span class="token punctuation">.</span> The problem <span class="token keyword">in</span> Korea<span class="token punctuation">,</span>especially <span class="token keyword">in</span> Seoul<span class="token punctuation">,</span> <span class="token keyword">is</span> that there are just so many privately<span class="token operator">-</span>owned cars<span class="token punctuation">,</span><span class="token keyword">as</span> well <span class="token keyword">as</span> taxis <span class="token operator">and</span> buses<span class="token punctuation">,</span> the rush<span class="token operator">-</span>hour has become a <span class="token number">24</span> hour phenomenon     <span class="token operator">and</span> that there <span class="token keyword">is</span> no place <span class="token keyword">to</span> park<span class="token punctuation">.</span> Last time I heard<span class="token punctuation">,</span> back <span class="token keyword">in</span> January<span class="token punctuation">,</span> the Kim Administration wanted <span class="token keyword">to</span> legislate a law requireing a potential car owner <span class="token keyword">to</span> provide his <span class="token operator">or</span> her own parking area<span class="token punctuation">,</span> just like they <span class="token keyword">do</span> <span class="token keyword">in</span> Japan<span class="token punctuation">.</span>Also<span class="token punctuation">,</span> Henry would be glad <span class="token keyword">to</span> know that Hyundai isnâ€™t the only car manufacturer <span class="token keyword">in</span> Korea<span class="token punctuation">.</span> Daewoo has always manufactured cars <span class="token operator">and</span> I believe Kia <span class="token keyword">is</span> back <span class="token keyword">in</span> business <span class="token keyword">as</span> well<span class="token punctuation">.</span> Imported cars<span class="token punctuation">,</span> such <span class="token keyword">as</span> Mercury Sable are becoming quite popular <span class="token keyword">as</span> well<span class="token punctuation">,</span> though they are still quite expensive<span class="token punctuation">.</span>Finally<span class="token punctuation">,</span> please ignore Henryâ€™s posting about Korean politics <span class="token operator">and</span> bureaucracy<span class="token punctuation">.</span>     Heâ€™s quite uninformed<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-2-æ–‡æ¡£çš„æ•°å­¦è¡¨è¾¾"><a href="#5-2-æ–‡æ¡£çš„æ•°å­¦è¡¨è¾¾" class="headerlink" title="5.2 æ–‡æ¡£çš„æ•°å­¦è¡¨è¾¾"></a>5.2 æ–‡æ¡£çš„æ•°å­¦è¡¨è¾¾</h3><p>æ€æ ·æŠŠä¸€ä¸ªæ–‡æ¡£è¡¨è¾¾ä¸ºè®¡ç®—æœºå¯ä»¥ç†è§£å¹¶å¤„ç†çš„ä¿¡æ¯ï¼Œæ˜¯è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„ä¸€ä¸ªé‡è¦è¯¾é¢˜ï¼Œå®Œæ•´å†…å®¹å¯ä»¥å†™æˆé¸¿ç¯‡å·¨è‘—ã€‚æœ¬èŠ‚ç®€å•ä»‹ç»TF-IDFçš„åŸç†ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£æœ¬æ–‡ä»‹ç»çš„å®ä¾‹ã€‚</p><p><code>TF-IDF</code> æ˜¯ä¸€ç§ç»Ÿè®¡æ–¹æ³•ï¼Œç”¨ä»¥è¯„ä¼°ä¸€ä¸ªè¯è¯­å¯¹äºä¸€ä»½æ–‡æ¡£çš„é‡è¦ç¨‹åº¦ã€‚<code>TFï¼ˆTerm Frequencyï¼‰</code>è¡¨ç¤ºè¯é¢‘ï¼Œå¯¹äºä¸€ä»½æ–‡æ¡£è€Œè¨€ï¼Œè¯é¢‘æ˜¯æŒ‡ç‰¹å®šè¯è¯­åœ¨è¿™ç¯‡æ–‡æ¡£é‡Œå‡ºç°çš„æ¬¡æ•°é™¤ä»¥è¯¥æ–‡æ¡£æ€»è¯æ•°ã€‚ä¾‹å¦‚ï¼Œä¸€ç¯‡æ–‡æ¡£ä¸€å…±æœ‰1000ä¸ªè¯ï¼Œå…¶ä¸­â€œæœ´ç´ è´å¶æ–¯â€å‡ºç°äº†5æ¬¡ï¼Œâ€œçš„â€å‡ºç°äº†25æ¬¡ï¼Œâ€œåº”ç”¨â€å‡ºç°äº†12æ¬¡ï¼Œé‚£ä¹ˆå®ƒä»¬çš„è¯é¢‘åˆ†åˆ«æ˜¯0.005ï¼Œ0.025å’Œ0.012ã€‚</p><p><code>IDFï¼ˆInverse Document Frequencyï¼‰</code>è¡¨ç¤ºä¸€ä¸ªè¯çš„é€†å‘æ–‡æ¡£é¢‘ç‡ï¼Œç”±æ€»æ–‡æ¡£æ•°é™¤ä»¥åŒ…å«è¯¥è¯çš„æ–‡æ¡£æ•°çš„å•†å†å–å¯¹æ•°å¾—åˆ°ã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬çš„æ•°æ®é›†ä¸€å…±10000ç¯‡æ–‡æ¡£ï¼Œå…¶ä¸­â€œæœ´ç´ è´å¶æ–¯â€åªå‡ºç°åœ¨10ç¯‡æ–‡æ¡£ä¸­ï¼Œåˆ™å…¶<code>IDF=log(10000/10)=3</code>ï¼›â€œçš„â€åœ¨æ‰€æœ‰æ–‡æ¡£ä¸­éƒ½å‡ºç°è¿‡ï¼Œåˆ™å…¶ <code>IDF=log(10000/10000)=0</code>ï¼›â€œåº”ç”¨â€åœ¨1000ç¯‡æ–‡æ¡£ä¸­å‡ºç°è¿‡ï¼Œåˆ™å…¶ <code>IDF=log(10000/1000)=1</code>ã€‚</p><p>è®¡ç®—å‡ºæ¯ä¸ªè¯çš„TFå’ŒIDFä¹‹åï¼Œä¸¤è€…ç›¸ä¹˜ï¼Œå³å¯å¾—åˆ°è¿™ä¸ªè¯åœ¨æ–‡æ¡£ä¸­çš„é‡è¦ç¨‹åº¦ã€‚è¯è¯­çš„é‡è¦æ€§ä¸å®ƒåœ¨è¯¥æ–‡æ¡£ä¸­å‡ºç°çš„æ¬¡æ•°æˆæ­£æ¯”ï¼Œä¸å®ƒåœ¨è¯­æ–™åº“ä¸­å‡ºç°çš„æ–‡æ¡£æ•°æˆåæ¯”ã€‚</p><p>æœ‰äº†TF-IDFè¿™ä¸ªå·¥å…·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠä¸€ç¯‡æ–‡æ¡£è½¬æ¢ä¸ºä¸€ä¸ªå‘é‡ã€‚é¦–å…ˆï¼Œå¯ä»¥ä»æ•°æ®é›†<code>ï¼ˆåœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸä¹Ÿç§°corpusï¼Œå³è¯­æ–™åº“ï¼‰</code>é‡Œæå–å‡ºæ‰€æœ‰å‡ºç°çš„è¯ï¼Œæˆ‘ä»¬ç§°ä¸ºè¯å…¸ã€‚å‡è®¾è¯å…¸é‡Œæ€»å…±æœ‰10000ä¸ªè¯è¯­ï¼Œåˆ™æ¯ä¸ªæ–‡æ¡£éƒ½å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ª10000ç»´çš„å‘é‡ã€‚å…¶æ¬¡ï¼Œé’ˆå¯¹æˆ‘ä»¬è¦è½¬æ¢çš„æ–‡æ¡£é‡Œå‡ºç°çš„æ¯ä¸ªè¯è¯­ï¼Œéƒ½å»è®¡ç®—å…¶TF-IDFï¼Œå¹¶æŠŠè¿™ä¸ªå€¼å¡«å…¥æ–‡æ¡£å‘é‡é‡Œè¿™ä¸ªè¯å¯¹åº”çš„å…ƒç´ ä¸Šã€‚è¿™æ ·å°±å®Œæˆäº†æŠŠä¸€ç¯‡æ–‡æ¡£è½¬æ¢ä¸ºä¸€ä¸ªå‘é‡çš„è¿‡ç¨‹ã€‚ä¸€ä¸ªæ–‡æ¡£å¾€å¾€åªä¼šç”±è¯å…¸é‡Œçš„ä¸€å°éƒ¨åˆ†è¯è¯­æ„æˆï¼Œè¿™å°±æ„å‘³ç€è¿™ä¸ªå‘é‡é‡Œçš„å¤§éƒ¨åˆ†å…ƒç´ éƒ½æ˜¯0ã€‚</p><p>æ‰€å¹¸ï¼Œä¸Šè¿°è¿‡ç¨‹ä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å†™ä»£ç å»å®Œæˆï¼Œ<code>scikit-learn</code> è½¯ä»¶åŒ…é‡Œå®ç°äº†æŠŠæ–‡æ¡£è½¬æ¢ä¸ºå‘é‡çš„è¿‡ç¨‹ã€‚é¦–å…ˆï¼ŒæŠŠè®­ç»ƒç”¨çš„è¯­æ–™åº“è¯»å…¥å†…å­˜ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> time <span class="token keyword">import</span> time<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_files<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"loading train dataset ..."</span><span class="token punctuation">)</span>t <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>news_train <span class="token operator">=</span> load_files<span class="token punctuation">(</span><span class="token string">'datasets/mlcomp/379/train'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"summary: {0} documents in {1} categories."</span>      <span class="token punctuation">.</span>format<span class="token punctuation">(</span>len<span class="token punctuation">(</span>news_train<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>news_train<span class="token punctuation">.</span>target_names<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">loading train dataset <span class="token punctuation">..</span>.summary: 13180 documents <span class="token keyword">in</span> 20 categories.<span class="token keyword">done</span> <span class="token keyword">in</span> 1.2616519927978516 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œ<code>datasets/mlcomp/379/train</code>ç›®å½•ä¸‹æ”¾çš„å°±æ˜¯æˆ‘ä»¬çš„è¯­æ–™åº“ï¼Œå…¶ä¸­åŒ…å«20ä¸ªå­ç›®å½•ï¼Œæ¯ä¸ªå­ç›®å½•çš„åå­—è¡¨ç¤ºçš„æ˜¯æ–‡æ¡£çš„ç±»åˆ«ï¼Œå­ç›®å½•ä¸‹åŒ…å«è¿™ç§ç±»åˆ«çš„æ‰€æœ‰æ–‡æ¡£ã€‚<code>load_files()</code> å‡½æ•°ä¼šä»è¿™ä¸ªç›®å½•é‡ŒæŠŠæ‰€æœ‰çš„æ–‡æ¡£éƒ½è¯»å…¥å†…å­˜ï¼Œå¹¶ä¸”è‡ªåŠ¨æ ¹æ®æ‰€åœ¨çš„å­ç›®å½•åç§°æ‰“ä¸Šæ ‡ç­¾ã€‚å…¶ä¸­ï¼Œ<code>news_train.data</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢åŒ…å«äº†æ‰€æœ‰æ–‡æ¡£çš„æ–‡æœ¬ä¿¡æ¯ã€‚<code>news_train.target</code>ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†æ‰€æœ‰æ–‡æ¡£æ‰€å±çš„ç±»åˆ«ï¼Œè€Œ<code>news_train.target_names</code>åˆ™æ˜¯ç±»åˆ«çš„åç§°ï¼Œå› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æƒ³çŸ¥é“ç¬¬ä¸€ç¯‡æ–‡æ¡£æ‰€å±çš„ç±»åˆ«åç§°ï¼Œåªéœ€è¦é€šè¿‡ä»£ç <code>news_train.target_names[news_train.target[0]]</code>å³å¯å¾—åˆ°ã€‚</p><p>è¯¥è¯­æ–™åº“é‡Œæ€»å…±æœ‰13180ä¸ªæ–‡æ¡£ï¼Œåˆ†æˆ20ä¸ªç±»åˆ«ã€‚æ¥ç€éœ€è¦æŠŠè¿™äº›æ–‡æ¡£å…¨éƒ¨è½¬æ¢ä¸ºç”±TF-IDFè¡¨è¾¾çš„æƒé‡ä¿¡æ¯æ„æˆçš„å‘é‡ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizer<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"vectorizing train dataset ..."</span><span class="token punctuation">)</span>t <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>vectorizer <span class="token operator">=</span> TfidfVectorizer<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">'latin-1'</span><span class="token punctuation">)</span>X_train <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span><span class="token punctuation">(</span>d <span class="token keyword">for</span> d <span class="token keyword">in</span> news_train<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n_samples: %d, n_features: %d"</span> <span class="token operator">%</span> X_train<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"number of non-zero features in samples [{0}]:{1}"</span>      <span class="token punctuation">.</span>format<span class="token punctuation">(</span>news_train<span class="token punctuation">.</span>filenames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>getnnz<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css">vectorizing train dataset <span class="token number">...</span><span class="token property">n_samples</span><span class="token punctuation">:</span> <span class="token number">13180</span>, <span class="token property">n_features</span><span class="token punctuation">:</span> <span class="token number">130274</span>number of non-zero features in samples [datasets/mlcomp/<span class="token number">379</span>/train\talk<span class="token number">.</span>politics<span class="token number">.</span>misc<span class="token entity" title="\17860">\17860</span>-<span class="token number">178992</span>]<span class="token punctuation">:</span><span class="token number">108</span>done in <span class="token number">2.6174726486206055</span> seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œ<code>TfidfVectorizer</code>ç±»æ˜¯ç”¨æ¥æŠŠæ‰€æœ‰çš„æ–‡æ¡£è½¬æ¢ä¸ºçŸ©é˜µï¼Œè¯¥çŸ©é˜µæ¯è¡Œéƒ½ä»£è¡¨ä¸€ä¸ªæ–‡æ¡£ï¼Œä¸€è¡Œä¸­çš„æ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ªå¯¹åº”çš„è¯è¯­çš„é‡è¦æ€§ï¼Œè¯è¯­çš„é‡è¦æ€§ç”±<code>TF-IDF</code>æ¥è¡¨ç¤ºã€‚å…¶ <code>fit_transform()</code> æ–¹æ³•æ˜¯ fit() å’Œtransform()åˆå¹¶èµ·æ¥ã€‚å…¶ä¸­ï¼Œfit()  ä¼šå…ˆå®Œæˆè¯­æ–™åº“åˆ†æã€æå–è¯å…¸ç­‰æ“ä½œï¼Œtransform()ä¼šæŠŠå¯¹æ¯ç¯‡æ–‡æ¡£è½¬æ¢ä¸ºå‘é‡ï¼Œæœ€ç»ˆæ„æˆä¸€ä¸ªçŸ©é˜µï¼Œä¿å­˜åœ¨X_trainå˜é‡é‡Œã€‚</p><p>ç”±è¾“å‡ºå¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬çš„è¯å…¸æ€»å…±æœ‰ 130274 ä¸ªè¯è¯­ï¼Œå³æ¯ç¯‡æ–‡æ¡£éƒ½å¯è½¬æ¢ä¸ºä¸€ä¸ª 130274 ç»´çš„å‘é‡ã€‚ç¬¬ä¸€ç¯‡æ–‡æ¡£ä¸­ï¼Œåªæœ‰108ä¸ªéé›¶å…ƒç´ ï¼Œå³è¿™ç¯‡æ–‡æ¡£æ€»å…±ç”±108ä¸ªä¸é‡å¤çš„å•è¯ç»„æˆï¼Œåœ¨è¿™ç¯‡æ–‡æ¡£ä¸­å‡ºç°çš„è¿™108ä¸ªå•è¯çš„TF-IDFå€¼ä¼šè¢«è®¡ç®—å‡ºæ¥ï¼Œå¹¶ä¿å­˜åœ¨å‘é‡ä¸­çš„æŒ‡å®šä½ç½®ä¸Šã€‚X_trainæ˜¯ä¸€ä¸ªç»´åº¦ä¸º13180*130274çš„ç¨€ç–çŸ©é˜µã€‚</p><p>X_trainç¨€ç–çŸ©é˜µç”±ä¸€ä¸ªä¸‰å…ƒç»„(row,col,score)æ„æˆï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">print<span class="token punctuation">(</span>X_train<span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css">  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">56813</span><span class="token punctuation">)</span>    <span class="token number">0.014332663773643272</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">45689</span><span class="token punctuation">)</span>    <span class="token number">0.08373343949755</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">46084</span><span class="token punctuation">)</span>    <span class="token number">0.08109733529789522</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">125882</span><span class="token punctuation">)</span>   <span class="token number">0.0873157704840211</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">50150</span><span class="token punctuation">)</span>    <span class="token number">0.020654313721609956</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">87702</span><span class="token punctuation">)</span>    <span class="token number">0.04643235585055511</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">33334</span><span class="token punctuation">)</span>    <span class="token number">0.1025405658189532</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">111805</span><span class="token punctuation">)</span>   <span class="token number">0.</span><span class="token property">014332663773643272</span>  <span class="token punctuation">:</span> <span class="token punctuation">:</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">67768</span><span class="token punctuation">)</span>    <span class="token number">0.08982314745972582</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">41790</span><span class="token punctuation">)</span>    <span class="token number">0.09260592033433869</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">105800</span><span class="token punctuation">)</span>   <span class="token number">0.08713990737243116</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">37075</span><span class="token punctuation">)</span>    <span class="token number">0.10018566542781165</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">23162</span><span class="token punctuation">)</span>    <span class="token number">0.08920437523600384</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">124699</span><span class="token punctuation">)</span>   <span class="token number">0.06257976758779137</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">94119</span><span class="token punctuation">)</span>    <span class="token number">0.1159317059788844</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">56555</span><span class="token punctuation">)</span>    <span class="token number">0.06984885482106491</span>  <span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">62776</span><span class="token punctuation">)</span>    <span class="token number">0.10474995568339582</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-3-æ¨¡å‹è®­ç»ƒ"><a href="#5-3-æ¨¡å‹è®­ç»ƒ" class="headerlink" title="5.3 æ¨¡å‹è®­ç»ƒ"></a>5.3 æ¨¡å‹è®­ç»ƒ</h3><p>ä½¿ç”¨ <code>MultinomialNB</code> å¯¹æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> MultinomialNB<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"training models ..."</span><span class="token punctuation">)</span>t <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>y_train <span class="token operator">=</span> news_train<span class="token punctuation">.</span>targetclf <span class="token operator">=</span> MultinomialNB<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">0.0001</span><span class="token punctuation">)</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>train_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"train score: {0}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>train_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css">training models <span class="token number">...</span>train <span class="token property">score</span><span class="token punctuation">:</span> <span class="token number">0.9978755690440061</span>done in <span class="token number">0.15497064590454102</span> seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œalphaè¡¨ç¤ºå¹³æ»‘å‚æ•°ï¼Œå…¶å€¼è¶Šå°ï¼Œè¶Šå®¹æ˜“é€ æˆè¿‡æ‹Ÿåˆï¼Œå€¼å¤ªå¤§ï¼Œå®¹æ˜“é€ æˆæ¬ æ‹Ÿåˆã€‚</p><p>æ¥ç€ï¼Œæˆ‘ä»¬åŠ è½½æµ‹è¯•æ•°æ®é›†ï¼Œå¹¶ç”¨ä¸€ç¯‡æ–‡æ¡£æ¥é¢„æµ‹å…¶æ˜¯å¦å‡†ç¡®ã€‚æµ‹è¯•æ•°æ®é›†åœ¨<code>datasets/mlcomp/379/test</code>ç›®å½•ä¸‹ï¼Œæˆ‘ä»¬ç”¨å‰é¢ä»‹ç»çš„ç›¸åŒçš„æ–¹æ³•å…ˆåŠ è½½æ•°æ®é›†ï¼š</p><pre class="line-numbers language-go"><code class="language-go"><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"loading test dataset ..."</span><span class="token punctuation">)</span>t <span class="token operator">=</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span>news_test <span class="token operator">=</span> <span class="token function">load_files</span><span class="token punctuation">(</span><span class="token string">'datasets/mlcomp/379/test'</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"summary: {0} documents in {1} categories."</span>      <span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>news_test<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">len</span><span class="token punctuation">(</span>news_test<span class="token punctuation">.</span>target_names<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">loading <span class="token function">test</span> dataset <span class="token punctuation">..</span>.summary: 5648 documents <span class="token keyword">in</span> 20 categories.<span class="token keyword">done</span> <span class="token keyword">in</span> 0.3548290729522705 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•æ•°æ®é›†å…±æœ‰5648ç¯‡æ–‡æ¡£ã€‚æ¥ç€ï¼Œæˆ‘ä»¬æŠŠæ–‡æ¡£å‘é‡åŒ–ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">print<span class="token punctuation">(</span><span class="token string">"vectorizing test dataset ..."</span><span class="token punctuation">)</span>t <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>X_test <span class="token operator">=</span> vectorizer.transform<span class="token variable"><span class="token punctuation">((</span>d for d in news_test.data<span class="token punctuation">))</span></span>y_test <span class="token operator">=</span> news_test.targetprint<span class="token punctuation">(</span><span class="token string">"n_samples: %d, n_features: %d"</span> % X_test.shape<span class="token punctuation">)</span>print<span class="token punctuation">(</span><span class="token string">"number of non-zero features in sample [{0}]: {1}"</span>      .format<span class="token punctuation">(</span>news_test.filenames<span class="token punctuation">[</span>0<span class="token punctuation">]</span>,X_test<span class="token punctuation">[</span>0<span class="token punctuation">]</span>.getnnz<span class="token punctuation">(</span><span class="token punctuation">))</span><span class="token punctuation">)</span>print<span class="token punctuation">(</span><span class="token string">"done in {0} seconds"</span>.format<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>-t<span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">vectorizing <span class="token function">test</span> dataset <span class="token punctuation">..</span>.n_samples: 5648, n_features: 130274number of non-zero features <span class="token keyword">in</span> sample <span class="token punctuation">[</span>datasets/mlcomp/379/test\rec.autos\7429-103268<span class="token punctuation">]</span>: 61<span class="token keyword">done</span> <span class="token keyword">in</span> 0.9695498943328857 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼Œvectorizerå˜é‡æ˜¯æˆ‘ä»¬å¤„ç†è®­ç»ƒæ•°æ®é›†æ—¶ç”¨åˆ°çš„å‘é‡åŒ–çš„ç±»çš„å®ä¾‹ï¼Œæ­¤å¤„æˆ‘ä»¬åªéœ€è¦è°ƒç”¨transform()è¿›è¡ŒTF-IDFæ•°å€¼è®¡ç®—å³å¯ï¼Œä¸éœ€è¦å†è°ƒç”¨fit()è¿›è¡Œè¯­æ–™åº“åˆ†æäº†ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬çš„æµ‹è¯•æ•°æ®é›†ä¹Ÿè½¬æ¢ä¸ºäº†ä¸€ä¸ªç»´åº¦ä¸º5648*130274çš„ç¨€ç–çŸ©é˜µã€‚å¯ä»¥å–æµ‹è¯•æ•°æ®é›†é‡Œçš„ç¬¬ä¸€ç¯‡æ–‡æ¡£åˆæ­¥éªŒè¯ä¸€ä¸‹ï¼Œçœ‹çœ‹è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹èƒ½å¦æ­£ç¡®åœ°é¢„æµ‹è¿™ä¸ªæ–‡æ¡£æ‰€å±çš„ç±»åˆ«ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">pred <span class="token operator">=</span> clf.predict<span class="token punctuation">(</span>X_test<span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">)</span>print<span class="token punctuation">(</span><span class="token string">"predict: {0} is in category {1}"</span>      .format<span class="token punctuation">(</span>news_test.filenames<span class="token punctuation">[</span>0<span class="token punctuation">]</span>,news_test.target_names<span class="token punctuation">[</span>pred<span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">))</span>print<span class="token punctuation">(</span><span class="token string">"actually: {0} is in category {1}"</span>      .format<span class="token punctuation">(</span>news_test.filenames<span class="token punctuation">[</span>0<span class="token punctuation">]</span>,news_test.target_names<span class="token punctuation">[</span>news_test.target<span class="token punctuation">[</span>0<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">predict: datasets/mlcomp/379/test\rec.autos\7429-103268 is <span class="token keyword">in</span> category rec.autosactually: datasets/mlcomp/379/test\rec.autos\7429-103268 is <span class="token keyword">in</span> category rec.autos<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>çœ‹æ¥é¢„æµ‹çš„ç»“æœå’Œå®é™…ç»“æœæ˜¯ç›¸ç¬¦çš„ã€‚</p><h3 id="5-4-æ¨¡å‹è¯„ä»·"><a href="#5-4-æ¨¡å‹è¯„ä»·" class="headerlink" title="5.4 æ¨¡å‹è¯„ä»·"></a>5.4 æ¨¡å‹è¯„ä»·</h3><p>è™½ç„¶é€šè¿‡éªŒè¯ï¼Œè¯´æ˜æˆ‘ä»¬è®­ç»ƒçš„æ¨¡å‹æ˜¯å¯ç”¨çš„ï¼Œä½†æ˜¯ä¸èƒ½é€šè¿‡ä¸€ä¸ªæ ·æœ¬çš„é¢„æµ‹æ¥è¯„ä»·æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚æˆ‘ä»¬éœ€è¦å¯¹æ¨¡å‹æœ‰ä¸ªå…¨æ–¹ä½çš„è¯„ä»·ï¼Œæ‰€å¹¸ <code>scikit-learn</code> è½¯ä»¶åŒ…æä¾›äº†å…¨æ–¹ä½çš„æ¨¡å‹è¯„ä»·å·¥å…·ã€‚</p><p>é¦–å…ˆéœ€è¦å¯¹æµ‹è¯•æ•°æ®é›†è¿›è¡Œé¢„æµ‹ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">print<span class="token punctuation">(</span><span class="token string">"predicting test dataset ..."</span><span class="token punctuation">)</span>t <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>pred_test <span class="token operator">=</span> clf.predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>print<span class="token punctuation">(</span><span class="token string">"done in %fs"</span> % <span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>-t<span class="token punctuation">))</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€ä½¿ç”¨ <code>classification_report()</code> å‡½æ•°æ¥æŸ¥çœ‹ä¸€ä¸‹é’ˆå¯¹æ¯ä¸ªç±»åˆ«çš„é¢„æµ‹å‡†ç¡®æ€§ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"classification report on test set for classifier:"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>clf<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>pred_test<span class="token punctuation">,</span>target_names<span class="token operator">=</span>news_test<span class="token punctuation">.</span>target_names<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">classification report on <span class="token function">test</span> <span class="token keyword">set</span> <span class="token keyword">for</span> classifier:MultinomialNB<span class="token punctuation">(</span>alpha<span class="token operator">=</span>0.0001, class_prior<span class="token operator">=</span>None, fit_prior<span class="token operator">=</span>True<span class="token punctuation">)</span>                          precision    recall  f1-score   support             alt.atheism       0.90      0.91      0.91       245           comp.graphics       0.80      0.90      0.85       298 comp.os.ms-windows.misc       0.82      0.79      0.80       292comp.sys.ibm.pc.hardware       0.81      0.80      0.81       301   comp.sys.mac.hardware       0.90      0.91      0.91       256          comp.windows.x       0.88      0.88      0.88       297            misc.forsale       0.87      0.81      0.84       290               rec.autos       0.92      0.93      0.92       324         rec.motorcycles       0.96      0.96      0.96       294      rec.sport.baseball       0.97      0.94      0.96       315        rec.sport.hockey       0.96      0.99      0.98       302               sci.crypt       0.95      0.96      0.95       297         sci.electronics       0.91      0.85      0.88       313                 sci.med       0.96      0.96      0.96       277               sci.space       0.94      0.97      0.96       305  soc.religion.christian       0.93      0.96      0.94       293      talk.politics.guns       0.91      0.96      0.93       246   talk.politics.mideast       0.96      0.98      0.97       296      talk.politics.misc       0.90      0.90      0.90       236      talk.religion.misc       0.89      0.78      0.83       171             avg / total       0.91      0.91      0.91      5648<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»è¾“å‡ºç»“æœä¸­å¯ä»¥çœ‹å‡ºï¼Œé’ˆå¯¹æ¯ç§ç±»åˆ«éƒ½ç»Ÿè®¡äº†<code>æŸ¥å‡†ç‡</code>ã€<code>å¬å›ç‡</code>å’Œ<code>F1-Score</code>ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡confusion_matrix()å‡½æ•°ç”Ÿæˆæ··æ·†çŸ©é˜µï¼Œè§‚å¯Ÿæ¯ç§ç±»åˆ«è¢«é”™è¯¯åˆ†ç±»çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œè¿™äº›è¢«é”™è¯¯åˆ†ç±»çš„æ–‡æ¡£æ˜¯è¢«é”™è¯¯åˆ†ç±»åˆ°å“ªäº›ç±»åˆ«é‡Œçš„ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> confusion_matrixcm <span class="token operator">=</span> confusion_matrix<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>pred_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"confusion matrix:\n"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cm<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-csharp"><code class="language-csharp">confusion matrix<span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">224</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">5</span>   <span class="token number">0</span>   <span class="token number">0</span>    <span class="token number">1</span>  <span class="token number">13</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">1</span> <span class="token number">267</span>   <span class="token number">5</span>   <span class="token number">5</span>   <span class="token number">2</span>   <span class="token number">8</span>   <span class="token number">1</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">3</span>   <span class="token number">2</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>    <span class="token number">0</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">1</span>  <span class="token number">13</span> <span class="token number">230</span>  <span class="token number">24</span>   <span class="token number">4</span>  <span class="token number">10</span>   <span class="token number">5</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>    <span class="token number">1</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>   <span class="token number">9</span>  <span class="token number">21</span> <span class="token number">242</span>   <span class="token number">7</span>   <span class="token number">2</span>  <span class="token number">10</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">1</span>   <span class="token number">7</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>    <span class="token number">0</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">5</span>   <span class="token number">5</span> <span class="token number">233</span>   <span class="token number">2</span>   <span class="token number">2</span>   <span class="token number">2</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">3</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>    <span class="token number">0</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>  <span class="token number">20</span>   <span class="token number">6</span>   <span class="token number">3</span>   <span class="token number">1</span> <span class="token number">260</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">0</span>    <span class="token number">0</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">5</span>  <span class="token number">12</span>   <span class="token number">3</span>   <span class="token number">1</span> <span class="token number">235</span>  <span class="token number">10</span>   <span class="token number">2</span>   <span class="token number">3</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">7</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">1</span>    <span class="token number">4</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">8</span> <span class="token number">300</span>   <span class="token number">4</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">3</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">0</span>    <span class="token number">1</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">2</span>   <span class="token number">3</span> <span class="token number">283</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>    <span class="token number">1</span>   <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">0</span> <span class="token number">297</span>   <span class="token number">8</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>    <span class="token number">0</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">2</span> <span class="token number">298</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>    <span class="token number">0</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span> <span class="token number">284</span>   <span class="token number">2</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">1</span>    <span class="token number">2</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>  <span class="token number">11</span>   <span class="token number">3</span>   <span class="token number">5</span>   <span class="token number">4</span>   <span class="token number">2</span>   <span class="token number">4</span>   <span class="token number">5</span>   <span class="token number">1</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">4</span> <span class="token number">266</span>   <span class="token number">1</span>   <span class="token number">4</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>    <span class="token number">1</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">1</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span> <span class="token number">266</span>   <span class="token number">2</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>    <span class="token number">1</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">0</span>   <span class="token number">3</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">1</span> <span class="token number">296</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>    <span class="token number">1</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">3</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">1</span> <span class="token number">280</span>   <span class="token number">0</span>   <span class="token number">1</span>    <span class="token number">1</span>   <span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">2</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span> <span class="token number">236</span>   <span class="token number">1</span>    <span class="token number">4</span>   <span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">3</span>   <span class="token number">0</span> <span class="token number">290</span>    <span class="token number">1</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>  <span class="token number">2</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">1</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">1</span>  <span class="token number">10</span>   <span class="token number">7</span>  <span class="token number">212</span>   <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">[</span> <span class="token number">16</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>  <span class="token number">12</span>   <span class="token number">4</span>   <span class="token number">1</span>    <span class="token number">4</span> <span class="token number">134</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¾‹å¦‚ï¼šä»ç¬¬ä¸€è¡Œå¯ä»¥çœ‹å‡ºï¼Œç±»åˆ«0ï¼ˆalt.atheismï¼‰çš„æ–‡æ¡£ï¼Œæœ‰13ä¸ªè¢«é”™è¯¯åœ°åˆ†ç±»åˆ°ç±»åˆ«19ï¼ˆtalk.religion.miscï¼‰é‡Œã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŠŠæ··æ·†çŸ©é˜µè¿›è¡Œæ•°æ®å¯è§†åŒ–ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Show confusion matrix</span><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltplt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Confusion matrix of the classifier'</span><span class="token punctuation">)</span>ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>gca<span class="token punctuation">(</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'right'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'top'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'bottom'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>spines<span class="token punctuation">[</span><span class="token string">'left'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_color<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>xaxis<span class="token punctuation">.</span>set_ticks_position<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>yaxis<span class="token punctuation">.</span>set_ticks_position<span class="token punctuation">(</span><span class="token string">'none'</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>set_xticklabels<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>ax<span class="token punctuation">.</span>set_yticklabels<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>matshow<span class="token punctuation">(</span>cm<span class="token punctuation">,</span>fignum<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'gray'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå›¾å½¢å¦‚ä¸‹ï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200702160731221.png" alt="image-20200702160731221">é™¤å¯¹è§’çº¿å¤–ï¼Œå…¶ä»–åœ°æ–¹é¢œè‰²è¶Šæµ…ï¼Œè¯´æ˜æ­¤å¤„é”™è¯¯è¶Šå¤šã€‚é€šè¿‡è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è¯¦ç»†åˆ†ææ ·æœ¬æ•°æ®ï¼Œæ‰¾å‡ºä¸ºä»€ä¹ˆæŸç§ç±»åˆ«ä¼šè¢«é”™è¯¯åœ°åˆ†ç±»åˆ°å¦ä¸€ç§ç±»åˆ«é‡Œï¼Œä»è€Œè¿›ä¸€æ­¥ä¼˜åŒ–æ¨¡å‹ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MLç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scikit-learnç³»åˆ—å…­ï¼šSVM</title>
      <link href="/2020/07/01/scikit-learn-xi-lie-liu-svm/"/>
      <url>/2020/07/01/scikit-learn-xi-lie-liu-svm/</url>
      
        <content type="html"><![CDATA[<h2 id="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼"><a href="#é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼" class="headerlink" title="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼"></a>é¡¹ç›®åœ°å€<a href="https://github.com/DongZhouGu/scikit-learn-ml" target="_blank" rel="noopener">ä¼ é€é—¨</a>ï¼Œæ¬¢è¿ star å’Œ fork ï¼</h2><h2 id="1-SVMæ¦‚è¿°"><a href="#1-SVMæ¦‚è¿°" class="headerlink" title="1. SVMæ¦‚è¿°"></a>1. SVMæ¦‚è¿°</h2><p>æ”¯æŒå‘é‡æœº(Support Vector Machines, SVM): æ˜¯ä¸€ç§ç›‘ç£å­¦ä¹ ç®—æ³•ã€‚åœ¨å·¥ä¸šç•Œå’Œå­¦æœ¯ç•Œéƒ½æœ‰å¹¿æ³›çš„åº”ç”¨ã€‚ç‰¹åˆ«æ˜¯é’ˆå¯¹æ•°æ®é›†è¾ƒå°çš„æƒ…å†µä¸‹ï¼Œå¾€å¾€å…¶åˆ†ç±»æ•ˆæœæ¯”ç¥ç»ç½‘ç»œå¥½ã€‚</p><ul><li>æ”¯æŒå‘é‡(Support Vector) å°±æ˜¯ç¦»åˆ†éš”è¶…å¹³é¢æœ€è¿‘çš„é‚£äº›ç‚¹ã€‚</li><li>æœº(Machine) å°±æ˜¯è¡¨ç¤ºä¸€ç§ç®—æ³•ï¼Œè€Œä¸æ˜¯è¡¨ç¤ºæœºå™¨ã€‚</li></ul><h2 id="2-SVMåŸç†"><a href="#2-SVMåŸç†" class="headerlink" title="2. SVMåŸç†"></a>2. SVMåŸç†</h2><p>SVMçš„åŸç†å°±æ˜¯ä½¿ç”¨åˆ†éš”è¶…å¹³é¢æ¥åˆ’åˆ†æ•°æ®é›†ï¼Œå¹¶ä½¿å¾—æ”¯æŒå‘é‡ï¼ˆæ•°æ®é›†ä¸­ç¦»åˆ†éš”è¶…å¹³é¢æœ€è¿‘çš„ç‚¹ï¼‰åˆ°è¯¥åˆ†éš”è¶…å¹³é¢çš„è·ç¦»æœ€å¤§ã€‚å…¶æœ€å¤§ç‰¹ç‚¹æ˜¯èƒ½æ„é€ å‡ºæœ€å¤§é—´è·çš„å†³ç­–è¾¹ç•Œï¼Œä»è€Œæé«˜åˆ†ç±»ç®—æ³•çš„é²æ£’æ€§ã€‚</p><p>è¦ç»™å·¦å³ä¸¤è¾¹çš„ç‚¹è¿›è¡Œåˆ†ç±»ï¼Œæ˜æ˜¾å‘ç°: é€‰æ‹©Dä¼šæ¯”Bã€Cåˆ†éš”çš„æ•ˆæœè¦å¥½å¾ˆå¤šã€‚</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/SVM_3_linearly-separable.jpg" alt="çº¿æ€§å¯åˆ†"></p><h3 id="2-1-å¯»æ‰¾æœ€å¤§é—´éš”"><a href="#2-1-å¯»æ‰¾æœ€å¤§é—´éš”" class="headerlink" title="2.1 å¯»æ‰¾æœ€å¤§é—´éš”"></a>2.1 å¯»æ‰¾æœ€å¤§é—´éš”</h3><h4 id="ç‚¹åˆ°è¶…å¹³é¢çš„è·ç¦»"><a href="#ç‚¹åˆ°è¶…å¹³é¢çš„è·ç¦»" class="headerlink" title="ç‚¹åˆ°è¶…å¹³é¢çš„è·ç¦»"></a>ç‚¹åˆ°è¶…å¹³é¢çš„è·ç¦»</h4><ul><li><p>åˆ†éš”è¶…å¹³é¢<code>å‡½æ•°é—´è·</code>:  $y(x)=w^Tx+b$</p></li><li><p>åˆ†ç±»çš„ç»“æœ:  $f(x)=sign(w^Tx+b)$   (signè¡¨ç¤º&gt;0ä¸º1ï¼Œ&lt;0ä¸º-1ï¼Œ=0ä¸º0) </p></li><li><p>ç‚¹åˆ°è¶…å¹³é¢çš„<code>å‡ ä½•é—´è·</code>: $d(x)=(w^Tx+b)/||w||$  ï¼ˆ$||w||$è¡¨ç¤ºwçŸ©é˜µçš„äºŒèŒƒæ•°=&gt; $\sqrt{w^T*w}$, ç‚¹åˆ°è¶…å¹³é¢çš„è·ç¦»ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼‰</p></li></ul><p>$$<br>d=\left|\frac{A x_{0}+B y_{0}+C}{\sqrt{A^{2}+B^{2}}}\right|<br>$$</p><h4 id="æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•"><a href="#æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•" class="headerlink" title="æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•"></a>æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•</h4><ul><li>ç±»åˆ«æ ‡ç­¾ç”¨-1ã€1ï¼Œæ˜¯ä¸ºäº†åæœŸæ–¹ä¾¿ $ label<em>(w^Tx+b)$ çš„æ ‡è¯†å’Œè·ç¦»è®¡ç®—ï¼›å¦‚æœ $label</em>(w^Tx+b)&gt;0$ è¡¨ç¤ºé¢„æµ‹æ­£ç¡®ï¼Œå¦åˆ™é¢„æµ‹é”™è¯¯ã€‚</li><li>ç°åœ¨ç›®æ ‡å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯è¦æ‰¾åˆ°<code>w</code>å’Œ<code>b</code>ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»è¦æ‰¾åˆ°æœ€å°é—´éš”çš„æ•°æ®ç‚¹ï¼Œä¹Ÿå°±æ˜¯å‰é¢æ‰€è¯´çš„<code>æ”¯æŒå‘é‡</code>ã€‚<ul><li>ä¹Ÿå°±è¯´ï¼Œè®©æœ€å°çš„è·ç¦»å–æœ€å¤§.(æœ€å°çš„è·ç¦»: å°±æ˜¯æœ€å°é—´éš”çš„æ•°æ®ç‚¹ï¼›æœ€å¤§: å°±æ˜¯æœ€å¤§é—´è·ï¼Œä¸ºäº†æ‰¾å‡ºæœ€ä¼˜è¶…å¹³é¢â€“æœ€ç»ˆå°±æ˜¯æ”¯æŒå‘é‡)</li><li>ç›®æ ‡å‡½æ•°: $arg: max_{å…³äºw, b} \left( min[label<em>(w^Tx+b)]</em>\frac{1}{||w||} \right) $<ol><li>å¦‚æœ $label*(w^Tx+b)&gt;0$ è¡¨ç¤ºé¢„æµ‹æ­£ç¡®ï¼Œä¹Ÿç§°<code>å‡½æ•°é—´éš”</code>ï¼Œ$||w||$ å¯ä»¥ç†è§£ä¸ºå½’ä¸€åŒ–ï¼Œä¹Ÿç§°<code>å‡ ä½•é—´éš”</code>ã€‚</li><li>ä»¤ $label<em>(w^Tx+b)&gt;=1$ï¼Œ å› ä¸º0ï½1ä¹‹é—´ï¼Œå¾—åˆ°çš„ç‚¹æ˜¯å­˜åœ¨è¯¯åˆ¤çš„å¯èƒ½æ€§ï¼Œæ‰€ä»¥è¦ä¿éšœ $min[label</em>(w^Tx+b)]=1$ï¼Œæ‰èƒ½æ›´å¥½é™ä½å™ªéŸ³æ•°æ®å½±å“ã€‚</li><li>æ‰€ä»¥æœ¬è´¨ä¸Šæ˜¯æ±‚ $arg: max_{å…³äºw, b}  \frac{1}{||w||} $ï¼›ä¹Ÿå°±è¯´ï¼Œæˆ‘ä»¬çº¦æŸ(å‰æ)æ¡ä»¶æ˜¯: $label*(w^Tx+b)=1$</li></ol></li></ul></li><li>æ–°çš„ç›®æ ‡å‡½æ•°æ±‚è§£:  $arg: max_{å…³äºw, b}  \frac{1}{||w||} $<ul><li>=&gt; å°±æ˜¯æ±‚: $arg: min_{å…³äºw, b} ||w|| $ (æ±‚çŸ©é˜µä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœxåªæ˜¯ $\frac{1}{2}*x^2$ çš„åå¯¼æ•°ï¼Œé‚£ä¹ˆã€‚ã€‚åŒæ ·æ˜¯æ±‚æœ€å°å€¼)</li><li>=&gt; å°±æ˜¯æ±‚: $arg: min_{å…³äºw, b} (\frac{1}{2}*||w||^2)$ (äºŒæ¬¡å‡½æ•°æ±‚å¯¼ï¼Œæ±‚æå€¼ï¼Œå¹³æ–¹ä¹Ÿæ–¹ä¾¿è®¡ç®—)</li><li>æœ¬è´¨ä¸Šå°±æ˜¯æ±‚çº¿æ€§ä¸ç­‰å¼çš„äºŒæ¬¡ä¼˜åŒ–é—®é¢˜(æ±‚åˆ†éš”è¶…å¹³é¢ï¼Œç­‰ä»·äºæ±‚è§£ç›¸åº”çš„å‡¸äºŒæ¬¡è§„åˆ’é—®é¢˜)</li></ul></li><li>é€šè¿‡æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼Œæ±‚äºŒæ¬¡ä¼˜åŒ–é—®é¢˜<ul><li>å‡è®¾éœ€è¦æ±‚æå€¼çš„ç›®æ ‡å‡½æ•° (objective function) ä¸º f(x,y)ï¼Œé™åˆ¶æ¡ä»¶ä¸º Ï†(x,y)=M  # M=1</li><li>è®¾g(x,y)=M-Ï†(x,y)   # ä¸´æ—¶Ï†(x,y)è¡¨ç¤ºä¸‹æ–‡ä¸­ $label*(w^Tx+b)$</li><li>å®šä¹‰ä¸€ä¸ªæ–°å‡½æ•°: F(x,y,Î»)=f(x,y)+Î»g(x,y)</li><li>aä¸ºÎ»ï¼ˆa&gt;=0ï¼‰ï¼Œä»£è¡¨è¦å¼•å…¥çš„æ‹‰æ ¼æœ—æ—¥ä¹˜å­(Lagrange multiplier)</li><li>é‚£ä¹ˆ:  $L(w,b,\alpha)=\frac{1}{2} * ||w||^2 + \sum_{i=1}^{n} \alpha_i * [1 - label * (w^Tx+b)]$</li><li>å› ä¸º: $label<em>(w^Tx+b)&gt;=1, \alpha&gt;=0$ , æ‰€ä»¥ $\alpha</em>[1-label<em>(w^Tx+b)]&lt;=0$ , $\sum_{i=1}^{n} \alpha_i * [1-label</em>(w^Tx+b)]&lt;=0$ </li><li>å½“ $label*(w^Tx+b)&gt;1$ åˆ™ $\alpha=0$ ï¼Œè¡¨ç¤ºè¯¥ç‚¹ä¸º<font color="red">éæ”¯æŒå‘é‡</font></li><li>ç›¸å½“äºæ±‚è§£:  $max_{å…³äº\alpha} L(w,b,\alpha) = \frac{1}{2} *||w||^2$ </li><li>å¦‚æœæ±‚:  $min_{å…³äºw, b} \frac{1}{2} *||w||^2$ , ä¹Ÿå°±æ˜¯è¦æ±‚:  $min_{å…³äºw, b} \left( max_{å…³äº\alpha} L(w,b,\alpha)\right)$ </li></ul></li><li>ç°åœ¨è½¬åŒ–åˆ°å¯¹å¶é—®é¢˜çš„æ±‚è§£<ul><li>$min_{å…³äºw, b} \left(max_{å…³äº\alpha} L(w,b,\alpha) \right) $ &gt;= $max_{å…³äº\alpha} \left(min_{å…³äºw, b}\ L(w,b,\alpha) \right) $ </li><li>ç°åœ¨åˆ†2æ­¥</li><li>å…ˆæ±‚:  $min_{å…³äºw, b} L(w,b,\alpha)=\frac{1}{2} * ||w||^2 + \sum_{i=1}^{n} \alpha_i * [1 - label * (w^Tx+b)]$</li><li>å°±æ˜¯æ±‚<code>L(w,b,a)</code>å…³äº[w, b]çš„åå¯¼æ•°, å¾—åˆ°<code>wå’Œbçš„å€¼</code>ï¼Œå¹¶åŒ–ç®€ä¸º: <code>Lå’Œaçš„æ–¹ç¨‹</code>ã€‚</li><li>å‚è€ƒ:  å¦‚æœå…¬å¼æ¨å¯¼è¿˜æ˜¯ä¸æ‡‚ï¼Œä¹Ÿå¯ä»¥å‚è€ƒã€Šç»Ÿè®¡å­¦ä¹ æ–¹æ³•ã€‹æèˆª-P103&lt;å­¦ä¹ çš„å¯¹å¶ç®—æ³•&gt;<br><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/SVM_%E6%9D%BE%E5%BC%9B%E5%8F%98%E9%87%8F.jpg" alt="è®¡ç®—æ‹‰æ ¼æœ—æ—¥å‡½æ•°çš„å¯¹å¶å‡½æ•°"></li></ul></li><li>ç»ˆäºå¾—åˆ°è¯¾æœ¬ä¸Šçš„å…¬å¼:  $max_{å…³äº\alpha} \left( \sum_{i=1}^{m} \alpha_i - \frac{1}{2} \sum_{i, j=1}^{m} label_iÂ·label_jÂ·\alpha_iÂ·\alpha_jÂ·&lt;x_i, x_j&gt; \right) $</li><li>çº¦æŸæ¡ä»¶:  $a&gt;=0$ å¹¶ä¸” $\sum_{i=1}^{m} a_iÂ·label_i=0$</li></ul><h3 id="2-2-æ¾å¼›å˜é‡-slack-variable"><a href="#2-2-æ¾å¼›å˜é‡-slack-variable" class="headerlink" title="2.2 æ¾å¼›å˜é‡(slack variable)"></a>2.2 æ¾å¼›å˜é‡(slack variable)</h3><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/%E6%9D%BE%E5%BC%9B%E5%8F%98%E9%87%8F.png" alt="æ¾å¼›å˜é‡å…¬å¼"></p><ul><li>æˆ‘ä»¬çŸ¥é“å‡ ä¹æ‰€æœ‰çš„æ•°æ®éƒ½ä¸é‚£ä¹ˆå¹²å‡€, é€šè¿‡å¼•å…¥æ¾å¼›å˜é‡æ¥ <code>å…è®¸æ•°æ®ç‚¹å¯ä»¥å¤„äºåˆ†éš”é¢é”™è¯¯çš„ä¸€ä¾§</code>ã€‚</li><li>çº¦æŸæ¡ä»¶:  $C&gt;=a&gt;=0$ å¹¶ä¸” $\sum_{i=1}^{m} a_iÂ·label_i=0$</li><li>æ€»çš„æ¥è¯´: <ul><li><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/SVM_5_Lagrangemultiplier.png" alt="æ¾å¼›å˜é‡"> è¡¨ç¤º <code>æ¾å¼›å˜é‡</code></li><li>å¸¸é‡Cæ˜¯ <code>æƒ©ç½šå› å­</code>, è¡¨ç¤ºç¦»ç¾¤ç‚¹çš„æƒé‡ï¼ˆç”¨äºæ§åˆ¶â€œæœ€å¤§åŒ–é—´éš”â€å’Œâ€œä¿è¯å¤§éƒ¨åˆ†ç‚¹çš„å‡½æ•°é—´éš”å°äº1.0â€ ï¼‰<ul><li>$label*(w^Tx+b) &gt; 1$ and alpha = 0 (åœ¨è¾¹ç•Œå¤–ï¼Œå°±æ˜¯éæ”¯æŒå‘é‡)</li><li>$label*(w^Tx+b) = 1$ and 0&lt; alpha &lt; C (åœ¨åˆ†å‰²è¶…å¹³é¢ä¸Šï¼Œå°±æ”¯æŒå‘é‡)</li><li>$label*(w^Tx+b) &lt; 1$ and alpha = C (åœ¨åˆ†å‰²è¶…å¹³é¢å†…ï¼Œæ˜¯è¯¯å·®ç‚¹ -&gt; Cè¡¨ç¤ºå®ƒè¯¥å—åˆ°çš„æƒ©ç½šå› å­ç¨‹åº¦)</li><li>å‚è€ƒåœ°å€: <a href="https://www.zhihu.com/question/48351234/answer/110486455" target="_blank" rel="noopener">https://www.zhihu.com/question/48351234/answer/110486455</a></li></ul></li><li>Cå€¼è¶Šå¤§ï¼Œè¡¨ç¤ºç¦»ç¾¤ç‚¹å½±å“è¶Šå¤§ï¼Œå°±è¶Šå®¹æ˜“è¿‡åº¦æ‹Ÿåˆï¼›åä¹‹æœ‰å¯èƒ½æ¬ æ‹Ÿåˆã€‚</li><li>æˆ‘ä»¬çœ‹åˆ°ï¼Œç›®æ ‡å‡½æ•°æ§åˆ¶äº†ç¦»ç¾¤ç‚¹çš„æ•°ç›®å’Œç¨‹åº¦ï¼Œä½¿å¤§éƒ¨åˆ†æ ·æœ¬ç‚¹ä»ç„¶éµå®ˆé™åˆ¶æ¡ä»¶ã€‚</li><li>ä¾‹å¦‚: æ­£ç±»æœ‰10000ä¸ªæ ·æœ¬ï¼Œè€Œè´Ÿç±»åªç»™äº†100ä¸ªï¼ˆCè¶Šå¤§è¡¨ç¤º100ä¸ªè´Ÿæ ·æœ¬çš„å½±å“è¶Šå¤§ï¼Œå°±ä¼šå‡ºç°è¿‡åº¦æ‹Ÿåˆï¼Œæ‰€ä»¥Cå†³å®šäº†è´Ÿæ ·æœ¬å¯¹æ¨¡å‹æ‹Ÿåˆç¨‹åº¦çš„å½±å“ï¼ï¼ŒCå°±æ˜¯ä¸€ä¸ªéå¸¸å…³é”®çš„ä¼˜åŒ–ç‚¹ï¼ï¼‰</li></ul></li><li>è¿™ä¸€ç»“è®ºååˆ†ç›´æ¥ï¼ŒSVMä¸­çš„ä¸»è¦å·¥ä½œå°±æ˜¯è¦æ±‚è§£ alpha.</li></ul><h3 id="2-3-æ ¸å‡½æ•°"><a href="#2-3-æ ¸å‡½æ•°" class="headerlink" title="2.3 æ ¸å‡½æ•°"></a>2.3 æ ¸å‡½æ•°</h3><ul><li>å¯¹äºçº¿æ€§å¯åˆ†çš„æƒ…å†µï¼Œæ•ˆæœæ˜æ˜¾</li><li>å¯¹äºéçº¿æ€§çš„æƒ…å†µä¹Ÿä¸€æ ·ï¼Œæ­¤æ—¶éœ€è¦ç”¨åˆ°ä¸€ç§å«<code>æ ¸å‡½æ•°(kernel)</code>çš„å·¥å…·å°†æ•°æ®è½¬åŒ–ä¸ºåˆ†ç±»å™¨æ˜“äºç†è§£çš„å½¢å¼ã€‚</li></ul><blockquote><p>åˆ©ç”¨æ ¸å‡½æ•°å°†æ•°æ®æ˜ å°„åˆ°é«˜ç»´ç©ºé—´</p></blockquote><ul><li>ä½¿ç”¨æ ¸å‡½æ•°: å¯ä»¥å°†æ•°æ®ä»æŸä¸ªç‰¹å¾ç©ºé—´åˆ°å¦ä¸€ä¸ªç‰¹å¾ç©ºé—´çš„æ˜ å°„ã€‚ï¼ˆé€šå¸¸æƒ…å†µä¸‹: è¿™ç§æ˜ å°„ä¼šå°†ä½ç»´ç‰¹å¾ç©ºé—´æ˜ å°„åˆ°é«˜ç»´ç©ºé—´ã€‚ï¼‰</li><li>å¦‚æœè§‰å¾—ç‰¹å¾ç©ºé—´å¾ˆè£…é€¼ã€å¾ˆéš¾ç†è§£ã€‚</li><li>å¯ä»¥æŠŠæ ¸å‡½æ•°æƒ³è±¡æˆä¸€ä¸ªåŒ…è£…å™¨(wrapper)æˆ–è€…æ˜¯æ¥å£(interface)ï¼Œå®ƒèƒ½å°†æ•°æ®ä»æŸä¸ªå¾ˆéš¾å¤„ç†çš„å½¢å¼è½¬æ¢æˆä¸ºå¦ä¸€ä¸ªè¾ƒå®¹æ˜“å¤„ç†çš„å½¢å¼ã€‚</li><li>ç»è¿‡ç©ºé—´è½¬æ¢å: ä½ç»´éœ€è¦è§£å†³çš„éçº¿æ€§é—®é¢˜ï¼Œå°±å˜æˆäº†é«˜ç»´éœ€è¦è§£å†³çš„çº¿æ€§é—®é¢˜ã€‚</li><li>SVM ä¼˜åŒ–ç‰¹åˆ«å¥½çš„åœ°æ–¹ï¼Œåœ¨äºæ‰€æœ‰çš„è¿ç®—éƒ½å¯ä»¥å†™æˆå†…ç§¯(inner product: æ˜¯æŒ‡2ä¸ªå‘é‡ç›¸ä¹˜ï¼Œå¾—åˆ°å•ä¸ªæ ‡é‡ æˆ–è€… æ•°å€¼)ï¼›å†…ç§¯æ›¿æ¢æˆæ ¸å‡½æ•°çš„æ–¹å¼è¢«ç§°ä¸º<code>æ ¸æŠ€å·§(kernel trick)</code>æˆ–è€…<code>æ ¸"å˜ç”µ"(kernel substation)</code></li><li>æ ¸å‡½æ•°å¹¶ä¸ä»…ä»…åº”ç”¨äºæ”¯æŒå‘é‡æœºï¼Œå¾ˆå¤šå…¶ä»–çš„æœºå™¨å­¦ä¹ ç®—æ³•ä¹Ÿéƒ½ç”¨åˆ°æ ¸å‡½æ•°ã€‚æœ€æµè¡Œçš„æ ¸å‡½æ•°: å¾„å‘åŸºå‡½æ•°(radial basis function)hecn/AiLearning/blob/master/src/py2.x/ml/6.SVM/svm-complete.py</li></ul><h2 id="3-scikit-learné‡Œçš„SVM"><a href="#3-scikit-learné‡Œçš„SVM" class="headerlink" title="3. scikit-learné‡Œçš„SVM"></a>3. scikit-learné‡Œçš„SVM</h2><p>åœ¨scikit-learné‡Œå¯¹SVMçš„ç®—æ³•å®ç°éƒ½åœ¨åŒ…sklearn.svmä¸‹é¢ï¼Œå…¶ä¸­SVCç±»æ˜¯ç”¨æ¥è¿›è¡Œåˆ†ç±»ä»»åŠ¡çš„ï¼ŒSVRç±»æ˜¯ç”¨æ¥è¿›è¡Œæ•°å€¼å›å½’ä»»åŠ¡çš„ã€‚æˆ‘ä»¬å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼ŒSVMä¸æ˜¯ç”¨æ¥è¿›è¡Œåˆ†ç±»çš„ç®—æ³•å—ï¼Œä¸ºä»€ä¹ˆå¯ä»¥ç”¨æ¥è¿›è¡Œæ•°å€¼å›å½’ï¼Ÿå®é™…ä¸Šè¿™åªæ˜¯æ•°å­¦ä¸Šçš„ä¸€äº›æ‰©å±•è€Œå·²ï¼Œåœ¨è®¡ç®—æœºé‡Œï¼Œå¯ä»¥ç”¨ç¦»æ•£çš„æ•°å€¼è®¡ç®—æ¥ä»£æ›¿è¿ç»­çš„æ•°å€¼å›å½’ã€‚æˆ‘ä»¬åœ¨K-è¿‘é‚»ç®—æ³•ä¸­å·²ç»çœ‹åˆ°è¿‡è¿™ç§æ‰©å±•å®ç°ã€‚</p><p>æˆ‘ä»¬ä»¥ SVC ä¸ºä¾‹ã€‚é¦–å…ˆéœ€è¦é€‰æ‹© SVM çš„æ ¸å‡½æ•°ï¼Œç”±å‚æ•° kernel æ¥æŒ‡å®šï¼Œå…¶ä¸­å€¼ linea rè¡¨ç¤ºçº¿æ€§æ ¸å‡½æ•°ï¼Œå®ƒåªèƒ½äº§ç”Ÿç›´çº¿å½¢çŠ¶çš„åˆ†éš”è¶…å¹³é¢ï¼›å€¼ poly è¡¨ç¤ºå¤šé¡¹å¼æ ¸å‡½æ•°ï¼Œç”¨å®ƒå¯ä»¥æ„å»ºå‡ºå¤æ‚å½¢çŠ¶çš„åˆ†éš”è¶…å¹³é¢ï¼›å€¼ rbf è¡¨ç¤ºå¾„å‘åŸºæ ¸å‡½æ•°ï¼Œå³é«˜æ–¯æ ¸å‡½æ•°ã€‚</p><p>ä¸åŒçš„æ ¸å‡½æ•°éœ€è¦æŒ‡å®šä¸åŒçš„å‚æ•°ã€‚é’ˆå¯¹çº¿æ€§æ ¸å‡½æ•°ï¼Œåªéœ€è¦æŒ‡å®šå‚æ•° Cï¼Œå®ƒè¡¨ç¤ºå¯¹ä¸ç¬¦åˆæœ€å¤§é—´è·è§„åˆ™çš„æ ·æœ¬çš„æƒ©ç½šåŠ›åº¦ï¼Œå³å‰é¢ä»‹ç»çš„æ¾å¼›ç³»æ•°ã€‚é’ˆå¯¹å¤šé¡¹å¼æ ¸å‡½æ•°ï¼Œé™¤äº†å‚æ•° C ä¹‹å¤–ï¼Œè¿˜éœ€è¦æŒ‡å®š degreeï¼Œå®ƒè¡¨ç¤ºå¤šé¡¹å¼çš„é˜¶æ•°ã€‚é’ˆå¯¹é«˜æ–¯æ ¸å‡½æ•°ï¼Œé™¤äº†å‚æ•°Cä¹‹å¤–ï¼Œè¿˜éœ€è¦æŒ‡å®š gamma å€¼ï¼Œè¿™ä¸ªå€¼å¯¹åº”çš„æ˜¯é«˜æ–¯æ ¸å‡½æ•°å…¬å¼ä¸­çš„$\frac{1}{2 \sigma^{2}}$</p><p>ä¸‹é¢å…ˆæ¥çœ‹ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ã€‚æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªæœ‰ä¸¤ä¸ªç‰¹å¾ã€åŒ…å«ä¸¤ç§ç±»åˆ«çš„æ•°æ®ï¼Œç„¶åç”¨çº¿æ€§æ ¸å‡½æ•°çš„SVMç®—æ³•è¿›è¡Œåˆ†ç±»ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">def</span> <span class="token function">plot_hyperplane</span><span class="token punctuation">(</span>clf<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span>                     h<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">,</span>                     draw_sv<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                     title<span class="token operator">=</span><span class="token string">'hyperplan'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># create a mesh to plot in</span>    x_min<span class="token punctuation">,</span> x_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>    y_min<span class="token punctuation">,</span> y_max <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>    xx<span class="token punctuation">,</span> yy <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>x_min<span class="token punctuation">,</span> x_max<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">,</span>                         np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>y_min<span class="token punctuation">,</span> y_max<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>title<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> xx<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span>yy<span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>yticks<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    Z <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>np<span class="token punctuation">.</span>c_<span class="token punctuation">[</span>xx<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> yy<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># Put the result into a color plot</span>    Z <span class="token operator">=</span> Z<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>xx<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>contourf<span class="token punctuation">(</span>xx<span class="token punctuation">,</span> yy<span class="token punctuation">,</span> Z<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'hot'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>    markers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token string">'^'</span><span class="token punctuation">]</span>    colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span>    labels <span class="token operator">=</span> np<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>y<span class="token punctuation">)</span>    <span class="token keyword">for</span> label <span class="token keyword">in</span> labels<span class="token punctuation">:</span>        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span>y<span class="token operator">==</span>label<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                     X<span class="token punctuation">[</span>y<span class="token operator">==</span>label<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                     c<span class="token operator">=</span>colors<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">,</span>                     marker<span class="token operator">=</span>markers<span class="token punctuation">[</span>label<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> draw_sv<span class="token punctuation">:</span>        sv <span class="token operator">=</span> clf<span class="token punctuation">.</span>support_vectors_        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>sv<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> sv<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'y'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'x'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> svm<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobsX<span class="token punctuation">,</span> y <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> centers<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>                   random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> cluster_std<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>clf <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> kernel<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">)</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plot_hyperplane<span class="token punctuation">(</span>clf<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> h<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">,</span>                 title<span class="token operator">=</span><span class="token string">'Maximum Margin Hyperplan'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºçš„å›¾å½¢å¦‚ä¸‹æ‰€ç¤ºï¼Œå…¶ä¸­å¸¦æœ‰xæ ‡è®°çš„ç‚¹å³ä¸ºæ”¯æŒå‘é‡ï¼Œå®ƒä¿å­˜åœ¨æ¨¡å‹çš„ <code>support_vector</code></p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200701095026364.png" alt="image-20200701095026364"></p><p>æ­¤å¤„éœ€è¦æ³¨æ„çš„æ˜¯ <code>plot_hyperplane()</code> å‡½æ•°ï¼Œå…¶ä¸»è¦åŠŸèƒ½æ˜¯ç”»å‡ºæ ·æœ¬ç‚¹ï¼ŒåŒæ—¶ç”»å‡ºåˆ†ç±»åŒºé—´ã€‚å®ƒçš„ä¸»è¦åŸç†æ˜¯ä½¿ç”¨ <code>numpy.meshgrid()</code> ç”Ÿæˆä¸€ä¸ªåæ ‡çŸ©é˜µï¼Œæœ€åç”¨ <code>contourf()</code> å‡½æ•°ä¸ºåæ ‡çŸ©é˜µä¸­ä¸åŒç±»åˆ«çš„ç‚¹å¡«å……ä¸åŒçš„é¢œè‰²ã€‚å…¶ä¸­ï¼Œ<code>contourf()</code>å‡½æ•°æ˜¯ç”»ç­‰é«˜çº¿å¹¶å¡«å……é¢œè‰²çš„å‡½æ•°ã€‚</p><p>æ¥ç€æ¥çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ªæœ‰ä¸¤ä¸ªç‰¹å¾ã€åŒ…å«ä¸‰ç§ç±»åˆ«çš„æ•°æ®é›†ï¼Œç„¶ååˆ†åˆ«æ„é€ å‡º4ä¸ªSVMç®—æ³•æ¥æ‹Ÿåˆæ•°æ®é›†ï¼Œåˆ†åˆ«æ˜¯çº¿æ€§æ ¸å‡½æ•°ã€ä¸‰é˜¶å¤šé¡¹å¼æ ¸å‡½æ•°ã€gamma=0.5çš„é«˜æ–¯æ ¸å‡½æ•°ï¼Œä»¥åŠgamma=0.1çš„é«˜æ–¯æ ¸å‡½æ•°ã€‚æœ€åæŠŠè¿™4ä¸ªSVMç®—æ³•æ‹Ÿåˆå‡ºæ¥çš„åˆ†éš”è¶…å¹³é¢ç”»å‡ºæ¥ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn <span class="token keyword">import</span> svm<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobsX<span class="token punctuation">,</span> y <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> centers<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>                   random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> cluster_std<span class="token operator">=</span><span class="token number">0.8</span><span class="token punctuation">)</span>clf_linear <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> kernel<span class="token operator">=</span><span class="token string">'linear'</span><span class="token punctuation">)</span>clf_poly <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> kernel<span class="token operator">=</span><span class="token string">'poly'</span><span class="token punctuation">,</span> degree<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>clf_rbf <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>clf_rbf2 <span class="token operator">=</span> svm<span class="token punctuation">.</span>SVC<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>clfs <span class="token operator">=</span> <span class="token punctuation">[</span>clf_linear<span class="token punctuation">,</span> clf_poly<span class="token punctuation">,</span> clf_rbf<span class="token punctuation">,</span> clf_rbf2<span class="token punctuation">]</span>titles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Linear Kernel'</span><span class="token punctuation">,</span>           <span class="token string">'Polynomial Kernel with Degree=3'</span><span class="token punctuation">,</span>           <span class="token string">'Gaussian Kernel with $\gamma=0.5$'</span><span class="token punctuation">,</span>           <span class="token string">'Gaussian Kernel with $\gamma=0.1$'</span><span class="token punctuation">]</span><span class="token keyword">for</span> clf<span class="token punctuation">,</span> i <span class="token keyword">in</span> zip<span class="token punctuation">(</span>clfs<span class="token punctuation">,</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>clfs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>    plot_hyperplane<span class="token punctuation">(</span>clf<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> title<span class="token operator">=</span>titles<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºçš„å›¾å½¢å¦‚ä¸‹æ‰€ç¤ºï¼Œå…¶ä¸­å¸¦æœ‰ x æ ‡è®°çš„ç‚¹å³ä¸ºæ”¯æŒå‘é‡ã€‚</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_2.jpg" alt="image-20200701101406980"></p><p>å·¦ä¸Šè§’æ˜¯çº¿æ€§æ ¸å‡½æ•°ï¼Œå®ƒåªèƒ½æ‹Ÿåˆå‡ºç›´çº¿åˆ†éš”è¶…å¹³é¢ã€‚å³ä¸Šè§’æ˜¯ä¸‰é˜¶å¤šé¡¹å¼æ ¸å‡½æ•°ï¼Œå®ƒèƒ½æ‹Ÿåˆå‡ºå¤æ‚æ›²çº¿åˆ†éš”è¶…å¹³é¢ã€‚å·¦ä¸‹è§’æ˜¯ <code>gamma=0.5</code> çš„é«˜æ–¯æ ¸å‡½æ•°ï¼Œå³ä¸‹è§’æ˜¯ <code>gamma=0.1</code> çš„é«˜æ–¯æ ¸å‡½æ•°ï¼Œé€šè¿‡è°ƒæ•´å‚æ•° <code>gamma</code> çš„å€¼ï¼Œå¯ä»¥è°ƒæ•´åˆ†éš”è¶…å¹³é¢çš„å½¢çŠ¶ã€‚å…¸å‹åœ°ï¼Œ<code>gamma</code>å€¼å¤ªå¤§ï¼Œè¶Šå®¹æ˜“é€ æˆè¿‡æ‹Ÿåˆï¼Œ<code>gamma</code> å€¼å¤ªå°ï¼Œé«˜æ–¯æ ¸å‡½æ•°ä¼šé€€åŒ–æˆçº¿æ€§æ ¸å‡½æ•°ã€‚æˆ‘ä»¬æŠŠä»£ç ä¸­çš„ <code>gamma</code>å€¼ æ”¹ä¸º 100 å’Œ 0.01 åçœ‹ä¸€ä¸‹è¾“å‡ºå›¾å½¢æ˜¯ä»€ä¹ˆæ ·çš„ã€‚</p><p>æ€è€ƒï¼šå·¦ä¸‹è§’ gamma=0.5 çš„é«˜æ–¯æ ¸å‡½æ•°çš„å›¾ç‰‡ï¼Œå¸¦æœ‰ x æ ‡è®°çš„ç‚¹æ˜¯æ”¯æŒå‘é‡ã€‚æˆ‘ä»¬ä¹‹å‰ä»‹ç»è¿‡ï¼Œç¦»åˆ†éš”è¶…å¹³é¢æœ€è¿‘çš„ç‚¹æ˜¯æ”¯æŒå‘é‡ï¼Œä¸ºä»€ä¹ˆå¾ˆå¤šç¦»åˆ†éš”è¶…å¹³é¢å¾ˆè¿œçš„ç‚¹ï¼Œä¹Ÿæ˜¯æ”¯æŒå‘é‡å‘¢ï¼Ÿ</p><p>åŸå› æ˜¯é«˜æ–¯æ ¸å‡½æ•°æŠŠè¾“å…¥ç‰¹å¾å‘é‡æ˜ å°„åˆ°äº†æ— é™ç»´çš„å‘é‡ç©ºé—´é‡Œï¼Œåœ¨æ˜ å°„åçš„é«˜ç»´å‘é‡ç©ºé—´é‡Œï¼Œè¿™äº›ç‚¹å…¶å®æ˜¯ç¦»åˆ†éš”è¶…å¹³é¢æœ€è¿‘çš„ç‚¹ã€‚å½“å›åˆ°äºŒç»´å‘é‡ç©ºé—´ä¸­æ—¶ï¼Œè¿™äº›ç‚¹â€œçœ‹èµ·æ¥â€å°±ä¸åƒæ˜¯è·ç¦»åˆ†éš”è¶…å¹³é¢æœ€è¿‘çš„ç‚¹äº†ï¼Œä½†å®é™…ä¸Šå®ƒä»¬å°±æ˜¯æ”¯æŒå‘é‡ã€‚</p><h2 id="4-ç¤ºä¾‹ï¼šä¹³è…ºç™Œæ£€æµ‹"><a href="#4-ç¤ºä¾‹ï¼šä¹³è…ºç™Œæ£€æµ‹" class="headerlink" title="4.ç¤ºä¾‹ï¼šä¹³è…ºç™Œæ£€æµ‹"></a>4.ç¤ºä¾‹ï¼šä¹³è…ºç™Œæ£€æµ‹</h2><p>ä¹‹å‰æˆ‘ä»¬ä½¿ç”¨é€»è¾‘å›å½’ç®—æ³•è¿›è¡Œè¿‡ä¹³è…ºç™Œæ£€æµ‹æ¨¡å‹çš„å­¦ä¹ å’Œè®­ç»ƒã€‚è¿™é‡Œæˆ‘ä»¬å†ä½¿ç”¨æ”¯æŒå‘é‡æœºç®—æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚é¦–å…ˆæˆ‘ä»¬è½½å…¥æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token comment" spellcheck="true"># è½½å…¥æ•°æ®</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_breast_cancercancer <span class="token operator">=</span> load_breast_cancer<span class="token punctuation">(</span><span class="token punctuation">)</span>X <span class="token operator">=</span> cancer<span class="token punctuation">.</span>datay <span class="token operator">=</span> cancer<span class="token punctuation">.</span>target<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'data shape: {0}; no. positive: {1}; no. negative: {2}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>    X<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> y<span class="token punctuation">[</span>y<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>y<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-kotlin"><code class="language-kotlin"><span class="token keyword">data</span> shape<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">569</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> no<span class="token punctuation">.</span> positive<span class="token operator">:</span> <span class="token number">357</span><span class="token punctuation">;</span> no<span class="token punctuation">.</span> negative<span class="token operator">:</span> <span class="token number">212</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºï¼Œæˆ‘ä»¬çš„æ•°æ®é›†å¾ˆå°ã€‚é«˜æ–¯æ ¸å‡½æ•°å¤ªå¤æ‚ï¼Œå®¹æ˜“é€ æˆè¿‡æ‹Ÿåˆï¼Œæ¨¡å‹æ•ˆæœåº”è¯¥ä¸ä¼šå¤ªå¥½ã€‚æˆ‘ä»¬å…ˆç”¨é«˜æ–¯æ ¸å‡½æ•°æ¥è¯•ä¸€ä¸‹ï¼Œçœ‹ä¸æˆ‘ä»¬çš„çŒœæµ‹æ˜¯å¦ä¸€è‡´ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVCclf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>train_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>test_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'train score: {0}; test score: {1}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>train_score<span class="token punctuation">,</span> test_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">train score<span class="token punctuation">:</span> <span class="token number">1.0</span><span class="token punctuation">;</span> test score<span class="token punctuation">:</span> <span class="token number">0.6491228070175439</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®­ç»ƒæ•°æ®é›†åˆ†æ•°ä¸º1.0ï¼Œäº¤å‰éªŒè¯æ•°æ®é›†åˆ†æ•°åªæœ‰0.65ï¼Œè¿™æ˜¯å…¸å‹çš„è¿‡æ‹Ÿåˆç°è±¡ã€‚è¿™é‡Œ gamma=0.1ï¼Œè¿™ä¸ªå€¼ç›¸å¯¹å·²ç»æ¯”è¾ƒå°äº†ã€‚æˆ‘ä»¬å¯ä»¥æŠŠgammaæ”¹çš„æ›´å°å¦‚0.0001çœ‹çœ‹ä»€ä¹ˆç»“æœã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä½¿ç”¨å‰é¢ä»‹ç»è¿‡çš„ <code>GridSearchCV</code> æ¥è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜å‚æ•°ã€‚æˆ‘ä»¬çœ‹çœ‹å¦‚æœä½¿ç”¨é«˜æ–¯æ¨¡å‹ï¼Œæœ€ä¼˜çš„gammaå‚æ•°å€¼æ˜¯å¤šå°‘ï¼Œå…¶å¯¹åº”çš„æ¨¡å‹äº¤å‰éªŒè¯è¯„åˆ†æ˜¯å¤šå°‘ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCV<span class="token keyword">from</span> utils <span class="token keyword">import</span> plot_param_curve gammas <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.0003</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>param_grid <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'gamma'</span><span class="token punctuation">:</span> gammas<span class="token punctuation">}</span> clf <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>SVC<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param_grid<span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>return_train_score<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"best param: {0}\nbest score: {1}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>clf<span class="token punctuation">.</span>best_params_<span class="token punctuation">,</span>clf<span class="token punctuation">.</span>best_score_<span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plot_param_curve<span class="token punctuation">(</span>plt<span class="token punctuation">,</span> gammas<span class="token punctuation">,</span> clf<span class="token punctuation">.</span>cv_results_<span class="token punctuation">,</span> xlabel<span class="token operator">=</span><span class="token string">'gamma'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">best param<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'gamma'</span><span class="token punctuation">:</span> <span class="token number">0.00011379310344827585</span><span class="token punctuation">}</span>best score<span class="token punctuation">:</span> <span class="token number">0.9367334264865704</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200701101406980.png" alt="image-20200701102906477"></p><p>ç”±æ­¤å¯è§ï¼Œå³ä½¿åœ¨æœ€å¥½çš„ gamma å‚æ•°ä¸‹ï¼Œå…¶å¹³å‡æœ€ä¼˜å¾—åˆ†ä¹Ÿåªæ˜¯0.9367311072056239ã€‚æˆ‘ä»¬é€‰æ‹©åœ¨gammaä¸º0.01æ—¶ï¼Œç”»å‡ºå­¦ä¹ æ›²çº¿ï¼Œæ›´ç›´è§‚åœ°è§‚å¯Ÿæ¨¡å‹æ‹Ÿåˆæƒ…å†µã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> time<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> ShuffleSplitcv <span class="token operator">=</span> ShuffleSplit<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>title <span class="token operator">=</span> <span class="token string">'Learning Curves for Gaussian Kernel'</span>start <span class="token operator">=</span> time<span class="token punctuation">.</span>clock<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plot_learning_curve<span class="token punctuation">(</span>plt<span class="token punctuation">,</span> SVC<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span> gamma<span class="token operator">=</span><span class="token number">0.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span> title<span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> ylim<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv<span class="token operator">=</span>cv<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'elaspe: {0:.6f}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">.</span>clock<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">elaspe<span class="token punctuation">:</span> <span class="token number">0.687500</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”»å‡ºæ¥çš„å›¾å½¢å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_7.png" alt="image-20200701103141555"></p><p>è¿™æ˜¯æ˜æ˜¾çš„è¿‡æ‹Ÿåˆç°è±¡ï¼Œäº¤å‰éªŒè¯æ•°æ®é›†çš„è¯„åˆ†éå¸¸ä½ï¼Œä¸”ç¦»è®­ç»ƒæ•°æ®é›†è¯„åˆ†éå¸¸è¿œã€‚</p><hr><p><strong>æ¥ä¸‹æ¥æ¢ä¸€ä¸ªæ¨¡å‹ï¼Œä½¿ç”¨äºŒé˜¶å¤šé¡¹å¼æ ¸å‡½æ•°çš„SVMæ¥æ‹Ÿåˆæ¨¡å‹ï¼Œçœ‹çœ‹ç»“æœå¦‚ä½•ã€‚</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVCclf <span class="token operator">=</span> SVC<span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> kernel<span class="token operator">=</span><span class="token string">'poly'</span><span class="token punctuation">,</span> degree<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>train_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>test_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'train score: {0}; test score: {1}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>train_score<span class="token punctuation">,</span> test_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">train score<span class="token punctuation">:</span> <span class="token number">0.9098901098901099</span><span class="token punctuation">;</span> test score<span class="token punctuation">:</span> <span class="token number">0.9210526315789473</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>çœ‹èµ·æ¥ç»“æœå¥½å¤šäº†ã€‚ä½œä¸ºå¯¹æ¯”ï¼Œæˆ‘ä»¬ç”»å‡ºä¸€é˜¶å¤šé¡¹å¼æ ¸å‡½æ•°çš„SVMå’ŒäºŒé˜¶å¤šé¡¹å¼æ ¸å‡½æ•°çš„SVMçš„å­¦ä¹ æ›²çº¿ï¼Œè§‚å¯Ÿæ¨¡å‹çš„æ‹Ÿåˆæƒ…å†µã€‚</p><pre class="line-numbers language-go"><code class="language-go"><span class="token keyword">import</span> timefrom sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> ShuffleSplitcv <span class="token operator">=</span> <span class="token function">ShuffleSplit</span><span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>title <span class="token operator">=</span> <span class="token string">'Learning Curves with degree={0}'</span>degrees <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>start <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span><span class="token function">figure</span><span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span><span class="token keyword">for</span> i in <span class="token keyword">range</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>degrees<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span><span class="token function">subplot</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>degrees<span class="token punctuation">)</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token function">plot_learning_curve</span><span class="token punctuation">(</span>plt<span class="token punctuation">,</span> <span class="token function">SVC</span><span class="token punctuation">(</span>C<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span> kernel<span class="token operator">=</span><span class="token string">'poly'</span><span class="token punctuation">,</span> degree<span class="token operator">=</span>degrees<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                        title<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>degrees<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> ylim<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">1.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv<span class="token operator">=</span>cv<span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'elaspe: {0:.6f}'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css"><span class="token property">elaspe</span><span class="token punctuation">:</span> <span class="token number">0.281250</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºçš„å›¾å½¢å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200701102906477.png" alt="image-20200701103641519"></p><p>å‰é¢æˆ‘ä»¬ä½¿ç”¨é€»è¾‘å›å½’ç®—æ³•æ¥å¤„ç†ä¹³è…ºç™Œæ£€æµ‹é—®é¢˜æ—¶ï¼Œä½¿ç”¨äºŒé˜¶å¤šé¡¹å¼å¢åŠ ç‰¹å¾ï¼ŒåŒæ—¶ä½¿ç”¨L1èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ï¼Œå…¶æ‹Ÿåˆæ•ˆæœæ¯”è¿™é‡Œçš„æ”¯æŒå‘é‡æœºæ•ˆæœå¥½ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œé€»è¾‘å›å½’ç®—æ³•çš„è¿ç®—æ•ˆç‡è¿œè¿œé«˜äºäºŒé˜¶å¤šé¡¹å¼æ ¸å‡½æ•°çš„æ”¯æŒå‘é‡æœºç®—æ³•ã€‚å½“ç„¶ï¼Œè¿™é‡Œçš„æ”¯æŒå‘é‡æœºç®—æ³•çš„æ•ˆæœè¿˜æ˜¯æ¯”ä½¿ç”¨L2èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹çš„é€»è¾‘å›å½’ç®—æ³•å¥½çš„ã€‚ç”±æ­¤å¯è§ï¼Œæ¨¡å‹é€‰æ‹©å’Œæ¨¡å‹å‚æ•°è°ƒä¼˜ï¼Œåœ¨å·¥ç¨‹å®è·µä¸­æœ‰ç€éå¸¸é‡è¦çš„ä½œç”¨çš„ã€‚</p><h2 id="5-æ‹“å±•SVMçš„ç†è§£"><a href="#5-æ‹“å±•SVMçš„ç†è§£" class="headerlink" title="5. æ‹“å±•SVMçš„ç†è§£"></a>5. æ‹“å±•SVMçš„ç†è§£</h2><h3 id="ä»€ä¹ˆæ˜¯-SVM-ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-SVM-ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ SVM ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ SVM ï¼Ÿ</h3><p>Support Vector Machine, ä¸€ä¸ªæ™®é€šçš„ SVM å°±æ˜¯ä¸€æ¡ç›´çº¿ç½¢äº†ï¼Œç”¨æ¥å®Œç¾åˆ’åˆ† linearly separable çš„ä¸¤ç±»ã€‚ä½†è¿™åˆä¸æ˜¯ä¸€æ¡æ™®é€šçš„ç›´çº¿ï¼Œè¿™æ˜¯æ— æ•°æ¡å¯ä»¥åˆ†ç±»çš„ç›´çº¿å½“ä¸­æœ€å®Œç¾çš„ï¼Œå› ä¸ºå®ƒæ°å¥½åœ¨ä¸¤ä¸ªç±»çš„ä¸­é—´ï¼Œè·ç¦»ä¸¤ä¸ªç±»çš„ç‚¹éƒ½ä¸€æ ·è¿œã€‚è€Œæ‰€è°“çš„ Support vector å°±æ˜¯è¿™äº›ç¦»åˆ†ç•Œçº¿æœ€è¿‘çš„ã€ç‚¹ã€ã€‚å¦‚æœå»æ‰è¿™äº›ç‚¹ï¼Œç›´çº¿å¤šåŠæ˜¯è¦æ”¹å˜ä½ç½®çš„ã€‚å¯ä»¥è¯´æ˜¯è¿™äº› vectors ï¼ˆä¸»ï¼Œç‚¹ç‚¹ï¼‰ support ï¼ˆè°“ï¼Œå®šä¹‰ï¼‰äº† machine ï¼ˆå®¾ï¼Œåˆ†ç±»å™¨ï¼‰â€¦</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_8.png" alt="k_2" title="k_2"></p><p>æ‰€ä»¥è°œåº•å°±åœ¨è°œé¢ä¸Šå•Šæœ‹å‹ä»¬ï¼Œåªè¦æ‰¾åˆ°äº†è¿™äº›æœ€é è¿‘çš„ç‚¹ä¸å°±æ‰¾åˆ°äº† SVM äº†å˜›ã€‚</p><p>å¦‚æœæ˜¯é«˜ç»´çš„ç‚¹ï¼ŒSVM çš„åˆ†ç•Œçº¿å°±æ˜¯å¹³é¢æˆ–è€…è¶…å¹³é¢ã€‚å…¶å®æ²¡æœ‰å·®ï¼Œéƒ½æ˜¯ä¸€åˆ€åˆ‡ä¸¤å—ï¼Œæˆ‘å°±ç»Ÿç»Ÿå«ç›´çº¿äº†ã€‚</p><h3 id="æ€ä¹ˆæ±‚è§£-SVM-ï¼Ÿ"><a href="#æ€ä¹ˆæ±‚è§£-SVM-ï¼Ÿ" class="headerlink" title="æ€ä¹ˆæ±‚è§£ SVM ï¼Ÿ"></a>æ€ä¹ˆæ±‚è§£ SVM ï¼Ÿ</h3><p>å…³äºè¿™æ¡ç›´çº¿ï¼Œæˆ‘ä»¬çŸ¥é“ </p><p>(1)å®ƒç¦»ä¸¤è¾¹ä¸€æ ·è¿œï¼Œ(2)æœ€è¿‘è·ç¦»å°±æ˜¯åˆ°support vectorçš„è·ç¦»ï¼Œå…¶ä»–è·ç¦»åªèƒ½æ›´è¿œã€‚</p><p>äºæ˜¯è‡ªç„¶è€Œç„¶å¯ä»¥å¾—åˆ°é‡è¦è¡¨è¾¾ <b>I. direct representation</b></p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200701103141555.png" alt="k_7" title="k_7"></p><p>ï¼ˆå¯ä»¥æŠŠ margin çœ‹ä½œæ˜¯ boundary çš„å‡½æ•°ï¼Œå¹¶ä¸”æƒ³è¦æ‰¾åˆ°ä½¿å¾—æ˜¯ä½¿å¾— margin æœ€å¤§åŒ–çš„boundaryï¼Œè€Œ margin(*) è¿™ä¸ªå‡½æ•°æ˜¯: è¾“å…¥ä¸€ä¸ª boundary ï¼Œè®¡ç®—ï¼ˆæ­£ç¡®åˆ†ç±»çš„ï¼‰æ‰€æœ‰è‹¹æœå’Œé¦™è•‰ä¸­ï¼Œåˆ° boundary çš„æœ€å°è·ç¦»ã€‚ï¼‰</p><p>åˆæœ‰æœ€å¤§åˆæœ‰æœ€å°çœ‹èµ·æ¥å¥½çŸ›ç›¾ã€‚å®é™…ä¸Šã€æœ€å¤§ã€æ˜¯å¯¹è¿™ä¸ªæ•´ä½“ä½¿ç”¨ä¸åŒ boundary å±‚é¢çš„æœ€å¤§ï¼Œã€æœ€å°ã€æ˜¯åœ¨æ¯”è¾ƒã€ç‚¹ã€çš„å±‚é¢ä¸Šçš„æœ€å°ã€‚å¤–å±‚åœ¨æ¯”è¾ƒ boundary æ‰¾æœ€å¤§çš„ margin ï¼Œå†…å±‚åœ¨æ¯”è¾ƒç‚¹ç‚¹æ‰¾æœ€å°çš„è·ç¦»ã€‚</p><p>å…¶ä¸­è·ç¦»ï¼Œè¯´ç™½äº†å°±æ˜¯ç‚¹åˆ°ç›´çº¿çš„è·ç¦»ï¼›åªè¦å®šä¹‰å¸¦æ­£è´Ÿå·çš„è·ç¦»ï¼Œæ˜¯ {è‹¹æœ+1} é¢ä¸ºæ­£ {é¦™è•‰-1} é¢ä¸ºè´Ÿçš„è·ç¦»ï¼Œäº’ç›¸ä¹˜ä¸Šå„è‡ªçš„ label <img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200701103641519.png" alt="k_8" title="k_8"> ï¼Œå°±å’Œè°ç»Ÿä¸€æ°‘ä¸»å¯Œå¼ºäº†ã€‚</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_9.png" alt="k_9" title="k_9"></p><p>åˆ°è¿™é‡Œä¸ºæ­¢å·²ç»è¯´å®Œäº†æ‰€æœ‰å…³äºSVMçš„ç›´è§‚äº†è§£ï¼Œå¦‚æœä¸æƒ³çœ‹æ±‚è§£ï¼Œå¯ä»¥è·³è¿‡ä¸‹é¢ä¸€å¤§æ®µç›´æ¥åˆ° objective function ã€‚</p><p>ç›´æ¥è¡¨è¾¾è™½ç„¶æ¸…æ¥šä½†æ˜¯æ±‚è§£æ— ä»ä¸‹æ‰‹ã€‚åšä¸€äº›ç®€å•åœ°ç­‰ä»·å˜æ¢ï¼ˆåˆ†æ¯å€’ä¸Šæ¥ï¼‰å¯ä»¥å¾—åˆ° <b>II. canonical representation </b> ï¼ˆæ•²é»‘æ¿ï¼‰</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_10.png" alt="k_10" title="k_10"></p><p>è¦å¾—åˆ° <b>III. dual representation</b> ä¹‹å‰éœ€è¦å¤§æ¦‚çŸ¥é“ä¸€ä¸‹æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³• (method of lagrange multiplier)ï¼Œå®ƒæ˜¯ç”¨åœ¨æœ‰å„ç§çº¦æŸæ¡ä»¶(å„ç§ â€œsubject toâ€ )ä¸‹çš„ç›®æ ‡å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥å¯ä»¥æ±‚å¯¼å¯ä»¥å¼•å‡º dual representationï¼ˆæ€ä¹ˆè¿˜æ²¡å®Œæ‘”ï¼‰</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_11.png" alt="k_11" title="k_11"></p><p>ç¨å¾®å€Ÿç”¨åˆšåˆšæ•°å­¦è¡¨è¾¾é‡Œé¢çš„å†…å®¹çœ‹ä¸ªæœ‰è¶£çš„ä¸œè¥¿: </p><p>è¿˜è®°å¾—æˆ‘ä»¬æ€ä¹ˆé¢„æµ‹ä¸€ä¸ªæ–°çš„æ°´æœæ˜¯è‹¹æœè¿˜æ˜¯é¦™è•‰å—ï¼Ÿæˆ‘ä»¬ä»£å…¥åˆ°åˆ†ç•Œçš„ç›´çº¿é‡Œï¼Œç„¶åé€šè¿‡ç¬¦å·æ¥åˆ¤æ–­ã€‚</p><p>åˆšåˆšwå·²ç»è¢«è¡¨è¾¾å‡ºæ¥äº†ä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªç›´çº¿ç°åœ¨å˜æˆäº†:  <img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_12.png" alt="k_12" title="k_12"></p><p>çœ‹ä¼¼ä»¿ä½›ç”¨åˆ°äº†æ‰€æœ‰çš„è®­ç»ƒæ°´æœï¼Œä½†æ˜¯å…¶ä¸­ <img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_13.png" alt="k_13" title="k_13"> çš„æ°´æœéƒ½æ²¡æœ‰èµ·åˆ°ä½œç”¨ï¼Œå‰©ä¸‹çš„å°±æ˜¯å°éƒ¨åˆ†é è¾¹è¾¹çš„ Support vectors å‘€ã€‚</p><p><b>III. dual representation</b></p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_14.png" alt="k_14" title="k_14"></p><p><b>å¦‚æœé¦™è•‰å’Œè‹¹æœä¸èƒ½ç”¨ç›´çº¿åˆ†å‰²å‘¢ï¼Ÿ</b></p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_15.png" alt="k_3" title="k_3"></p><p>Kernel trick. </p><p>å…¶å®ç”¨ç›´çº¿åˆ†å‰²çš„æ—¶å€™æˆ‘ä»¬å·²ç»ä½¿ç”¨äº† kernel ï¼Œé‚£å°±æ˜¯çº¿æ€§ kernel , <img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_3.jpg" alt="k_15" title="k_15"></p><p>å¦‚æœè¦æ›¿æ¢ kernel é‚£ä¹ˆæŠŠç›®æ ‡å‡½æ•°é‡Œé¢çš„å†…ç§¯å…¨éƒ¨æ›¿æ¢æˆæ–°çš„ kernel function å°±å¥½äº†ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p><p>ç¬¬ä¸€ä¸ªæ­¦ä¾ å¤§å¸ˆçš„æ¯”å–»å·²ç»è¯´å¾—å¾ˆç›´è§‚äº†ï¼Œä½ç»´éçº¿æ€§çš„åˆ†ç•Œçº¿å…¶å®åœ¨é«˜ç»´æ˜¯å¯ä»¥çº¿æ€§åˆ†å‰²çš„ï¼Œå¯ä»¥ç†è§£ä¸ºâ€”â€”ã€ä½ ä»¬æ˜¯è™«å­ï¼ã€åˆ†å¾—å¼€ä¸ªpâ€¦ï¼ˆå¤§é›¾ï¼‰</p><p><b>å¦‚æœé¦™è•‰å’Œè‹¹æœæœ‰äº¤é›†å‘¢ï¼Ÿ</b></p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_4.jpg" alt="k_4" title="k_4"></p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_16.png" alt="k_16" title="k_16"></p><p><b>å¦‚æœè¿˜æœ‰æ¢¨å‘¢ï¼Ÿ</b></p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/k_5.jpg" alt="k_5" title="k_5"></p><p>å¯ä»¥æ¯ä¸ªç±»åˆ«åšä¸€æ¬¡ SVM: æ˜¯è‹¹æœè¿˜æ˜¯ä¸æ˜¯è‹¹æœï¼Ÿæ˜¯é¦™è•‰è¿˜æ˜¯ä¸æ˜¯é¦™è•‰ï¼Ÿæ˜¯æ¢¨å­è¿˜æ˜¯ä¸æ˜¯æ¢¨å­ï¼Ÿä»ä¸­é€‰å‡ºå¯èƒ½æ€§æœ€å¤§çš„ã€‚è¿™æ˜¯ one-versus-the-rest approachã€‚</p><p>ä¹Ÿå¯ä»¥ä¸¤ä¸¤åšä¸€æ¬¡ SVM: æ˜¯è‹¹æœè¿˜æ˜¯é¦™è•‰ï¼Ÿæ˜¯é¦™è•‰è¿˜æ˜¯æ¢¨å­ï¼Ÿæ˜¯æ¢¨å­è¿˜æ˜¯è‹¹æœï¼Ÿæœ€åä¸‰ä¸ªåˆ†ç±»å™¨æŠ•ç¥¨å†³å®šã€‚è¿™æ˜¯ one-versus-one approaceã€‚</p><p>ä½†è¿™å…¶å®éƒ½å¤šå¤šå°‘å°‘æœ‰é—®é¢˜ï¼Œæ¯”å¦‚è‹¹æœç‰¹åˆ«å¤šï¼Œé¦™è•‰ç‰¹åˆ«å°‘ï¼Œæˆ‘å°±æ— è„‘åˆ¤æ–­ä¸ºè‹¹æœä¹Ÿä¸ä¼šé”™å¤ªå¤šï¼›å¤šä¸ªåˆ†ç±»å™¨è¦æ”¾åˆ°ä¸€ä¸ªå°é¢ä¸Šï¼Œä¸‡ä¸€ä»–ä»¬çš„ scale æ²¡æœ‰åœ¨ä¸€ä¸ªå°é¢ä¸Šä¹Ÿæœªå¯çŸ¥ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MLç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scikit-learnç³»åˆ—äº”ï¼šå†³ç­–æ ‘</title>
      <link href="/2020/06/30/scikit-learn-xi-lie-wu-jue-ce-shu/"/>
      <url>/2020/06/30/scikit-learn-xi-lie-wu-jue-ce-shu/</url>
      
        <content type="html"><![CDATA[<h2 id="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼"><a href="#é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼" class="headerlink" title="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼"></a>é¡¹ç›®åœ°å€<a href="https://github.com/DongZhouGu/scikit-learn-ml" target="_blank" rel="noopener">ä¼ é€é—¨</a>ï¼Œæ¬¢è¿ star å’Œ fork ï¼</h2><h2 id="1-å†³ç­–æ ‘æ¦‚è¿°"><a href="#1-å†³ç­–æ ‘æ¦‚è¿°" class="headerlink" title="1. å†³ç­–æ ‘æ¦‚è¿°"></a>1. å†³ç­–æ ‘æ¦‚è¿°</h2><p>å†³ç­–æ ‘ï¼ˆDecision Treeï¼‰ç®—æ³•æ˜¯ä¸€ç§åŸºæœ¬çš„åˆ†ç±»ä¸å›å½’æ–¹æ³•ï¼Œæ˜¯æœ€ç»å¸¸ä½¿ç”¨çš„æ•°æ®æŒ–æ˜ç®—æ³•ä¹‹ä¸€ï¼Œå®ƒçš„é¢„æµ‹ç»“æœå®¹æ˜“ç†è§£ï¼Œæ˜“äºå‘ä¸šåŠ¡éƒ¨é—¨è§£é‡Šï¼Œé¢„æµ‹é€Ÿåº¦å¿«ï¼Œå¯ä»¥å¤„ç†ç¦»æ•£å‹æ•°æ®å’Œè¿ç»­å‹æ•°æ®ã€‚</p><p>å†³ç­–æ ‘æ¨¡å‹å‘ˆæ ‘å½¢ç»“æ„ï¼Œåœ¨åˆ†ç±»é—®é¢˜ä¸­ï¼Œè¡¨ç¤ºåŸºäºç‰¹å¾å¯¹å®ä¾‹è¿›è¡Œåˆ†ç±»çš„è¿‡ç¨‹ã€‚å®ƒå¯ä»¥è®¤ä¸ºæ˜¯ if-then è§„åˆ™çš„é›†åˆï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯å®šä¹‰åœ¨ç‰¹å¾ç©ºé—´ä¸ç±»ç©ºé—´ä¸Šçš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒã€‚</p><p>å†³ç­–æ ‘å­¦ä¹ é€šå¸¸åŒ…æ‹¬ 3 ä¸ªæ­¥éª¤: ç‰¹å¾é€‰æ‹©ã€å†³ç­–æ ‘çš„ç”Ÿæˆå’Œå†³ç­–æ ‘çš„ä¿®å‰ªã€‚</p><hr><h2 id="2-å†³ç­–æ ‘åŸç†"><a href="#2-å†³ç­–æ ‘åŸç†" class="headerlink" title="2. å†³ç­–æ ‘åŸç†"></a>2. å†³ç­–æ ‘åŸç†</h2><p>ä¸€ä¸ªå«åš â€œäºŒåä¸ªé—®é¢˜â€ çš„æ¸¸æˆï¼Œæ¸¸æˆçš„è§„åˆ™å¾ˆç®€å•: å‚ä¸æ¸¸æˆçš„ä¸€æ–¹åœ¨è„‘æµ·ä¸­æƒ³æŸä¸ªäº‹ç‰©ï¼Œå…¶ä»–å‚ä¸è€…å‘ä»–æé—®ï¼Œåªå…è®¸æ 20 ä¸ªé—®é¢˜ï¼Œé—®é¢˜çš„ç­”æ¡ˆä¹Ÿåªèƒ½ç”¨å¯¹æˆ–é”™å›ç­”ã€‚é—®é—®é¢˜çš„äººé€šè¿‡æ¨æ–­åˆ†è§£ï¼Œé€æ­¥ç¼©å°å¾…çŒœæµ‹äº‹ç‰©çš„èŒƒå›´ï¼Œæœ€åå¾—åˆ°æ¸¸æˆçš„ç­”æ¡ˆã€‚</p><p>ä¸€ä¸ªé‚®ä»¶åˆ†ç±»ç³»ç»Ÿï¼Œå¤§è‡´å·¥ä½œæµç¨‹å¦‚ä¸‹: </p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/%E5%86%B3%E7%AD%96%E6%A0%91-%E6%B5%81%E7%A8%8B%E5%9B%BE.jpg" alt="å†³ç­–æ ‘-æµç¨‹å›¾" title="å†³ç­–æ ‘ç¤ºä¾‹æµç¨‹å›¾"></p><pre><code>é¦–å…ˆæ£€æµ‹å‘é€é‚®ä»¶åŸŸååœ°å€ã€‚å¦‚æœåœ°å€ä¸º myEmployer.com, åˆ™å°†å…¶æ”¾åœ¨åˆ†ç±» "æ— èŠæ—¶éœ€è¦é˜…è¯»çš„é‚®ä»¶"ä¸­ã€‚å¦‚æœé‚®ä»¶ä¸æ˜¯æ¥è‡ªè¿™ä¸ªåŸŸåï¼Œåˆ™æ£€æµ‹é‚®ä»¶å†…å®¹é‡Œæ˜¯å¦åŒ…å«å•è¯ "æ›²æ£çƒ" , å¦‚æœåŒ…å«åˆ™å°†é‚®ä»¶å½’ç±»åˆ° "éœ€è¦åŠæ—¶å¤„ç†çš„æœ‹å‹é‚®ä»¶", å¦‚æœä¸åŒ…å«åˆ™å°†é‚®ä»¶å½’ç±»åˆ° "æ— éœ€é˜…è¯»çš„åƒåœ¾é‚®ä»¶" ã€‚</code></pre><p>é—®é¢˜æ¥äº†ï¼Œåœ¨åˆ›å»ºå†³ç­–æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œè¦å…ˆå¯¹å“ªä¸ªç‰¹å¾è¿›è¡Œåˆ†è£‚ï¼Ÿæ¯”å¦‚ä¸Šå›¾ä¸­çš„ä¾‹å­ï¼Œå…ˆåˆ¤æ–­åŸŸååœ°å€è¿›è¡Œåˆ†è£‚è¿˜æ˜¯å…ˆåˆ¤æ–­åŒ…å« â€œæ›²æ£çƒâ€ è¿›è¡Œåˆ†è£‚ï¼Ÿè¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¿¡æ¯çš„é‡åŒ–è°ˆèµ·ã€‚</p><h3 id="2-1-ä¿¡æ¯ç†µ-amp-ä¿¡æ¯å¢ç›Š"><a href="#2-1-ä¿¡æ¯ç†µ-amp-ä¿¡æ¯å¢ç›Š" class="headerlink" title="2.1 ä¿¡æ¯ç†µ &amp; ä¿¡æ¯å¢ç›Š"></a>2.1 ä¿¡æ¯ç†µ &amp; ä¿¡æ¯å¢ç›Š</h3><p><code>ç†µï¼ˆentropyï¼‰:</code><br>ç†µæŒ‡çš„æ˜¯ä½“ç³»çš„æ··ä¹±çš„ç¨‹åº¦ï¼Œåœ¨ä¸åŒçš„å­¦ç§‘ä¸­ä¹Ÿæœ‰å¼•ç”³å‡ºçš„æ›´ä¸ºå…·ä½“çš„å®šä¹‰ï¼Œæ˜¯å„é¢†åŸŸååˆ†é‡è¦çš„å‚é‡ã€‚</p><p><code>ä¿¡æ¯è®ºï¼ˆinformation theoryï¼‰ä¸­çš„ç†µï¼ˆé¦™å†œç†µï¼‰:</code><br>æ˜¯ä¸€ç§ä¿¡æ¯çš„åº¦é‡æ–¹å¼ï¼Œè¡¨ç¤ºä¿¡æ¯çš„æ··ä¹±ç¨‹åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´: ä¿¡æ¯è¶Šæœ‰åºï¼Œä¿¡æ¯ç†µè¶Šä½ã€‚ä¾‹å¦‚: ç«æŸ´æœ‰åºæ”¾åœ¨ç«æŸ´ç›’é‡Œï¼Œç†µå€¼å¾ˆä½ï¼Œç›¸åï¼Œç†µå€¼å¾ˆé«˜ã€‚</p><p><code>ä¿¡æ¯å¢ç›Šï¼ˆinformation gainï¼‰:</code><br>åœ¨åˆ’åˆ†æ•°æ®é›†å‰åä¿¡æ¯å‘ç”Ÿçš„å˜åŒ–ç§°ä¸ºä¿¡æ¯å¢ç›Šã€‚</p><h3 id="2-2-å†³ç­–æ ‘çš„åˆ›å»º"><a href="#2-2-å†³ç­–æ ‘çš„åˆ›å»º" class="headerlink" title="2.2 å†³ç­–æ ‘çš„åˆ›å»º"></a>2.2 å†³ç­–æ ‘çš„åˆ›å»º</h3><p>å†³ç­–æ ‘çš„æ„å»ºè¿‡ç¨‹ï¼Œå°±æ˜¯ä»è®­ç»ƒæ•°æ®é›†ä¸­å½’çº³å‡ºä¸€ç»„åˆ†ç±»è§„åˆ™ï¼Œä½¿å®ƒä¸è®­ç»ƒæ•°æ®çŸ›ç›¾è¾ƒå°çš„åŒæ—¶å…·æœ‰è¾ƒå¼ºçš„æ³›åŒ–èƒ½åŠ›ã€‚æœ‰äº†ä¿¡æ¯å¢ç›Šæ¥é‡åŒ–åœ°é€‰æ‹©æ•°æ®é›†çš„åˆ’åˆ†ç‰¹å¾ï¼Œä½¿å†³ç­–æ ‘çš„åˆ›å»ºè¿‡ç¨‹å˜å¾—å®¹æ˜“äº†ã€‚å†³ç­–æ ‘çš„åˆ›å»ºåŸºæœ¬ä¸Šåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><p> ï¼ˆ1ï¼‰è®¡ç®—æ•°æ®é›†åˆ’åˆ†å‰çš„ä¿¡æ¯ç†µã€‚<br> ï¼ˆ2ï¼‰éå†æ‰€æœ‰æœªä½œä¸ºåˆ’åˆ†æ¡ä»¶çš„ç‰¹å¾ï¼Œåˆ†åˆ«è®¡ç®—æ ¹æ®æ¯ä¸ªç‰¹å¾åˆ’åˆ†æ•°æ®é›†åçš„ä¿¡æ¯ç†µã€‚<br> ï¼ˆ3ï¼‰é€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªç‰¹å¾ä½œä¸ºæ•°æ®åˆ’åˆ†èŠ‚ç‚¹æ¥åˆ’åˆ†æ•°æ®ã€‚<br> ï¼ˆ4ï¼‰é€’å½’åœ°å¤„ç†è¢«åˆ’åˆ†åçš„æ‰€æœ‰å­æ•°æ®é›†ï¼Œä»æœªè¢«é€‰æ‹©çš„ç‰¹å¾é‡Œç»§ç»­é€‰æ‹©æœ€ä¼˜æ•°æ®åˆ’åˆ†ç‰¹å¾æ¥åˆ’åˆ†å­æ•°æ®é›†ã€‚</p><p>é—®é¢˜æ¥äº†ï¼Œé€’å½’è¿‡ç¨‹ä»€ä¹ˆæ—¶å€™ç»“æŸå‘¢ï¼Ÿä¸€èˆ¬æ¥è®²ï¼Œæœ‰ä¸¤ä¸ªç»ˆæ­¢æ¡ä»¶ï¼šä¸€æ˜¯æ‰€æœ‰çš„ç‰¹å¾éƒ½ç”¨å®Œäº†ï¼Œå³æ²¡æœ‰æ–°çš„ç‰¹å¾å¯ä»¥ç”¨æ¥è¿›ä¸€æ­¥åˆ’åˆ†æ•°æ®é›†ã€‚äºŒæ˜¯åˆ’åˆ†åçš„ä¿¡æ¯å¢ç›Šè¶³å¤Ÿå°äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥åœæ­¢é€’å½’åˆ’åˆ†äº†ã€‚é’ˆå¯¹è¿™ä¸ªåœæ­¢æ¡ä»¶ï¼Œéœ€è¦äº‹å…ˆé€‰æ‹©ä¿¡æ¯å¢ç›Šçš„é˜ˆå€¼æ¥ä½œä¸ºç»“æŸé€’å½’åœ°æ¡ä»¶ã€‚</p><p>ä½¿ç”¨ä¿¡æ¯å¢ç›Šä½œä¸ºç‰¹å¾é€‰æ‹©æŒ‡æ ‡çš„å†³ç­–æ ‘æ„å»ºç®—æ³•ï¼Œç§°ä¸ºID3ç®—æ³•ã€‚</p><h3 id="2-3-å‰ªæç®—æ³•"><a href="#2-3-å‰ªæç®—æ³•" class="headerlink" title="2.3 å‰ªæç®—æ³•"></a>2.3 å‰ªæç®—æ³•</h3><p>ä½¿ç”¨å†³ç­–æ ‘æ¨¡å‹æ‹Ÿåˆæ•°æ®æ—¶ï¼Œå®¹æ˜“é€ æˆè¿‡æ‹Ÿåˆã€‚è§£å†³è¿‡æ‹Ÿåˆçš„æ–¹æ³•æ˜¯å¯¹å†³ç­–æ ‘è¿›è¡Œå‰ªæå¤„ç†ã€‚å†³ç­–æ ‘çš„å‰ªææœ‰ä¸¤ç§æ€è·¯ï¼šå‰å‰ªæï¼ˆPre-Pruningï¼‰å’Œåå‰ªæï¼ˆPost-Pruningï¼‰ã€‚</p><h4 id="å‰å‰ªæï¼ˆPre-Pruningï¼‰"><a href="#å‰å‰ªæï¼ˆPre-Pruningï¼‰" class="headerlink" title="å‰å‰ªæï¼ˆPre-Pruningï¼‰"></a>å‰å‰ªæï¼ˆPre-Pruningï¼‰</h4><p> å‰å‰ªææ˜¯åœ¨æ„é€ å†³ç­–æ ‘çš„åŒæ—¶è¿›è¡Œå‰ªæã€‚åœ¨å†³ç­–æ ‘çš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ— æ³•è¿›ä¸€æ­¥é™ä½ä¿¡æ¯ç†µï¼Œå°±ä¼šåœæ­¢åˆ›å»ºåˆ†æ”¯ã€‚ä¸ºäº†é¿å…è¿‡æ‹Ÿåˆï¼Œå¯ä»¥è®¾å®šä¸€ä¸ªé˜ˆå€¼ï¼Œå³ä½¿å¯ä»¥ç»§ç»­é™ä½ä¿¡æ¯ç†µï¼Œä¹Ÿåœæ­¢ç»§ç»­åˆ›å»ºåˆ†æ”¯ã€‚è¿™ç§æ–¹æ³•ç§°ä¸ºå‰å‰ªæã€‚è¿˜æœ‰ä¸€äº›ç®€å•çš„å‰å‰ªææ–¹æ³•ï¼Œå¦‚é™åˆ¶å¶å­èŠ‚ç‚¹çš„æ ·æœ¬ä¸ªæ•°ï¼Œå½“æ ·æœ¬ä¸ªæ•°å°äºä¸€å®šçš„é˜ˆå€¼æ—¶ï¼Œå³ä¸å†ç»§ç»­åˆ›å»ºåˆ†æ”¯ã€‚</p><h4 id="åå‰ªæï¼ˆPost-Pruningï¼‰"><a href="#åå‰ªæï¼ˆPost-Pruningï¼‰" class="headerlink" title="åå‰ªæï¼ˆPost-Pruningï¼‰"></a>åå‰ªæï¼ˆPost-Pruningï¼‰</h4><p> åå‰ªææ˜¯æŒ‡å†³ç­–æ ‘æ„å»ºå®Œæˆä¹‹åè¿›è¡Œå‰ªæã€‚å‰ªæçš„è¿‡ç¨‹æ˜¯å¯¹æ‹¥æœ‰åŒæ ·çˆ¶èŠ‚ç‚¹çš„ä¸€ç»„èŠ‚ç‚¹è¿›è¡Œæ£€æŸ¥ï¼Œåˆ¤æ–­å¦‚æœå°†å…¶åˆå¹¶ï¼Œä¿¡æ¯ç†µçš„å¢åŠ é‡æ˜¯å¦å°äºæŸä¸€é˜ˆå€¼ã€‚å¦‚æœå°äºé˜ˆå€¼ï¼Œåˆ™è¿™ä¸€ç»„èŠ‚ç‚¹å¯ä»¥åˆå¹¶æˆä¸€ä¸ªèŠ‚ç‚¹ã€‚åå‰ªææ˜¯ç›®å‰è¾ƒæ™®éçš„åšæ³•ã€‚åå‰ªæçš„è¿‡ç¨‹æ˜¯åˆ é™¤ä¸€äº›å­æ ‘ï¼Œç„¶åç”¨å­æ ‘çš„æ ¹èŠ‚ç‚¹ä»£æ›¿ï¼Œæ¥ä½œä¸ºæ–°çš„å¶å­ç»“ç‚¹ã€‚è¿™ä¸ªæ–°çš„å¶å­èŠ‚ç‚¹æ‰€æ ‡è¯†çš„ç±»åˆ«é€šè¿‡å¤§å¤šæ•°åŸåˆ™æ¥ç¡®å®šï¼Œå³æŠŠè¿™ä¸ªå¶å­èŠ‚ç‚¹é‡Œæ ·æœ¬æœ€å¤šçš„ç±»åˆ«ï¼Œä½œä¸ºè¿™ä¸ªå¶å­èŠ‚ç‚¹çš„ç±»åˆ«ã€‚</p><p>åå‰ªæç®—æ³•æœ‰å¾ˆå¤šç§ï¼Œå…¶ä¸­å¸¸ç”¨çš„ä¸€ç§ç§°ä¸º <code>é™ä½é”™è¯¯ç‡å‰ªææ³•ï¼ˆReduced-Error Pruningï¼‰</code>ã€‚å…¶æ€è·¯æ˜¯ï¼Œè‡ªåº•å‘ä¸Šï¼Œä»å·²ç»æ„å»ºå¥½çš„å®Œå…¨å†³ç­–æ ‘ä¸­æ‰¾å‡ºä¸€æ£µå­æ ‘ï¼Œç„¶åç”¨å­æ ‘çš„æ ¹ä»£æ›¿è¿™æ£µå­æ ‘ï¼Œä½œä¸ºæ–°çš„å¶å­èŠ‚ç‚¹ã€‚å¶å­èŠ‚ç‚¹æ‰€æ ‡è¯†çš„ç±»åˆ«é€šè¿‡å¤§å¤šæ•°åŸåˆ™æ¥ç¡®å®šã€‚è¿™æ ·å°±æ„å»ºå‡ºäº†ä¸€ä¸ªæ–°çš„ç®€åŒ–ç‰ˆçš„å†³ç­–æ ‘ã€‚ç„¶åä½¿ç”¨äº¤å‰éªŒè¯æ•°æ®é›†æ¥æ£€æµ‹è¿™æ£µç®€åŒ–ç‰ˆçš„å†³ç­–æ ‘ï¼Œçœ‹å…¶é”™è¯¯ç‡æ˜¯å¦é™ä½äº†ã€‚å¦‚æœé”™è¯¯ç‡é™ä½äº†ï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¿™ä¸ªç®€åŒ–ç‰ˆçš„å†³ç­–æ ‘ä»£æ›¿å®Œå…¨å†³ç­–æ ‘ã€‚å¦åˆ™ï¼Œè¿˜æ˜¯é‡‡ç”¨åŸæ¥çš„å†³ç­–æ ‘ã€‚é€šè¿‡éå†æ‰€æœ‰çš„å­æ ‘ï¼Œç›´åˆ°é’ˆå¯¹äº¤å‰éªŒè¯æ•°æ®é›†ï¼Œæ— æ³•è¿›ä¸€æ­¥é™ä½é”™è¯¯ç‡ä¸ºæ­¢ã€‚</p><hr><h2 id="3-å†³ç­–æ ‘ç®—æ³•å‚æ•°"><a href="#3-å†³ç­–æ ‘ç®—æ³•å‚æ•°" class="headerlink" title="3. å†³ç­–æ ‘ç®—æ³•å‚æ•°"></a>3. å†³ç­–æ ‘ç®—æ³•å‚æ•°</h2><p><code>scikit-learn</code>ä½¿ç”¨ <code>sklearn.tree.DecisionTreeClassifier</code> ç±»æ¥å®ç°å†³ç­–æ ‘åˆ†ç±»ç®—æ³•ã€‚å…¶ä¸­å‡ ä¸ªå…¸å‹çš„å‚æ•°å¦‚ä¸‹ï¼š</p><ul><li><code>criterionï¼šç‰¹å¾é€‰æ‹©ç®—æ³•ã€‚</code>ä¸€ç§æ˜¯åŸºäºä¿¡æ¯ç†µï¼Œå¦å¤–ä¸€ç§æ˜¯åŸºäºåŸºå°¼ä¸çº¯åº¦ã€‚ç ”ç©¶è¡¨æ˜ï¼Œè¿™ä¸¤ç§ç®—æ³•çš„å·®å¼‚æ€§ä¸å¤§ï¼Œå¯¹æ¨¡å‹å‡†ç¡®æ€§æ²¡æœ‰å¤ªå¤§çš„å½±å“ã€‚ç›¸å¯¹è€Œè¨€ï¼Œä¿¡æ¯ç†µè¿ç®—æ•ˆç‡ä¼šä½ä¸€äº›ï¼Œå› ä¸ºå®ƒæœ‰å¯¹æ•°è¿ç®—ã€‚</li><li><code>splitterï¼šåˆ›å»ºå†³ç­–æ ‘åˆ†æ”¯çš„é€‰é¡¹ã€‚</code>ä¸€ç§æ˜¯é€‰æ‹©æœ€ä¼˜çš„åˆ†æ”¯åˆ›å»ºåŸåˆ™ã€‚å¦å¤–ä¸€ç§æ˜¯ä»æ’åé å‰çš„ç‰¹å¾ä¸­ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ªç‰¹å¾æ¥åˆ›å»ºåˆ†æ”¯ï¼Œè¿™ä¸ªæ–¹æ³•å’Œæ­£åˆ™é¡¹çš„æ•ˆæœç±»ä¼¼ï¼Œå¯ä»¥é¿å…è¿‡æ‹Ÿåˆã€‚</li><li><code>max_depthï¼š</code>æŒ‡å®šå†³ç­–æ ‘çš„æœ€å¤§æ·±åº¦ã€‚é€šè¿‡æŒ‡å®šè¯¥å‚æ•°ï¼Œç”¨æ¥è§£å†³æ¨¡å‹è¿‡æ‹Ÿåˆé—®é¢˜ã€‚</li><li><code>min_samples_splitï¼š</code>è¿™ä¸ªå‚æ•°æŒ‡å®šèƒ½åˆ›å»ºåˆ†æ”¯çš„æ•°æ®é›†çš„å¤§å°ï¼Œé»˜è®¤æ˜¯2ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®æ ·æœ¬ä¸ªæ•°å°äºè¿™ä¸ªæ•°å€¼ï¼Œåˆ™ä¸å†åˆ›å»ºåˆ†æ”¯ã€‚è¿™å°±æ˜¯ä¸Šé¢ä»‹ç»çš„å‰å‰ªæçš„ä¸€ç§æ–¹æ³•ã€‚</li><li><code>min_samples_leafï¼š</code>å¶å­èŠ‚ç‚¹çš„æœ€å°æ ·æœ¬æ•°é‡ï¼Œå¶å­èŠ‚ç‚¹çš„æ ·æœ¬æ•°é‡å¿…é¡»å¤§äºç­‰äºè¿™ä¸ªå€¼ã€‚è¿™ä¹Ÿæ˜¯ä¸Šé¢ä»‹ç»çš„å¦ä¸€ç§å‰å‰ªæçš„æ–¹æ³•ã€‚</li><li><code>max_leaf_nodesï¼š</code>æœ€å¤§å¶å­èŠ‚ç‚¹ä¸ªæ•°ï¼Œå³æ•°æ®é›†æœ€å¤šèƒ½åˆ’åˆ†æˆå‡ ä¸ªç±»åˆ«ã€‚</li><li><code>min_impurity_splitï¼š</code>ä¿¡æ¯å¢ç›Šå¿…é¡»å¤§äºç­‰äºè¿™ä¸ªé˜ˆå€¼æ‰å¯ä»¥ç»§ç»­åˆ†æ”¯ï¼Œå¦åˆ™ä¸åˆ›å»ºåˆ†æ”¯ã€‚<br> ä»è¿™äº›å‚æ•°å¯ä»¥çœ‹å‡ºï¼Œ<code>scikit-learn</code>æœ‰ä¸€ç³»åˆ—çš„å‚æ•°ç”¨æ¥æ§åˆ¶å†³ç­–æ ‘çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œä»è€Œè§£å†³è¿‡æ‹Ÿåˆé—®é¢˜ã€‚</li></ul><hr><h2 id="4-ç¤ºä¾‹ï¼šé¢„æµ‹æ³°å¦å°¼å…‹å·å¹¸å­˜è€…"><a href="#4-ç¤ºä¾‹ï¼šé¢„æµ‹æ³°å¦å°¼å…‹å·å¹¸å­˜è€…" class="headerlink" title="4. ç¤ºä¾‹ï¼šé¢„æµ‹æ³°å¦å°¼å…‹å·å¹¸å­˜è€…"></a>4. ç¤ºä¾‹ï¼šé¢„æµ‹æ³°å¦å°¼å…‹å·å¹¸å­˜è€…</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæ³°å¦å°¼å…‹å·æ˜¯å†å²ä¸Šæœ€ä¸¥é‡çš„ä¸€èµ·æµ·éš¾äº‹æ•…ã€‚æˆ‘ä»¬é€šè¿‡å†³ç­–æ ‘æ¨¡å‹ï¼Œæ¥é¢„æµ‹å“ªäº›äººå¯èƒ½æˆä¸ºå¹¸å­˜è€…ã€‚<a href="https://www.kaggle.com/c/titanic" target="_blank" rel="noopener">æ•°æ®é›†ä¸‹è½½</a>ï¼Œä¹Ÿå¯ä»¥å»<a href="https://github.com/DongZhouGu/scikit-learn-ml" target="_blank" rel="noopener">ä»“åº“åœ°å€</a></p><p>æ•°æ®é›†ä¸­æ€»å…±æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œéƒ½æ˜¯ csv æ ¼å¼çš„æ•°æ®ã€‚å…¶ä¸­ï¼Œtrain.csv æ˜¯è®­ç»ƒæ•°æ®é›†ï¼ŒåŒ…å«å·²æ ‡æ³¨çš„è®­ç»ƒæ ·æœ¬æ•°æ®ã€‚test.csv æ˜¯æ¨¡å‹è¿›è¡Œå¹¸å­˜è€…é¢„æµ‹çš„æµ‹è¯•æ•°æ®ã€‚æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æ ¹æ® train.csv é‡Œçš„æ•°æ®è®­ç»ƒå‡ºå†³ç­–æ ‘æ¨¡å‹ï¼Œç„¶åä½¿ç”¨è¯¥æ¨¡å‹æ¥é¢„æµ‹test.csvé‡Œçš„æ•°æ®ï¼Œå¹¶æŸ¥çœ‹æ¨¡å‹çš„é¢„æµ‹æ•ˆæœã€‚</p><h3 id="4-1-æ•°æ®åˆ†æ"><a href="#4-1-æ•°æ®åˆ†æ" class="headerlink" title="4.1 æ•°æ®åˆ†æ"></a>4.1 æ•°æ®åˆ†æ</h3><p>train.csv æ˜¯ä¸€ä¸ª892è¡Œã€12åˆ—çš„æ•°æ®è¡¨æ ¼ã€‚æ„å‘³ç€æˆ‘ä»¬æœ‰ 891 ä¸ªè®­ç»ƒæ ·æœ¬ï¼ˆæ‰£é™¤è¡¨å¤´ï¼‰ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰12ä¸ªç‰¹å¾ã€‚æˆ‘ä»¬éœ€è¦å…ˆåˆ†æè¿™äº›ç‰¹å¾ï¼Œä»¥ä¾¿å†³å®šå“ªäº›ç‰¹å¾å¯ä»¥ç”¨æ¥è¿›è¡Œæ¨¡å‹è®­ç»ƒã€‚</p><ul><li><code>PassengerIdï¼š</code>ä¹˜å®¢çš„IDå·ï¼Œè¿™ä¸ªæ˜¯é¡ºåºç¼–å·ï¼Œç”¨æ¥å”¯ä¸€åœ°æ ‡è¯†ä¸€åä¹˜å®¢ã€‚è¿™ä¸ªç‰¹å¾å’Œå¹¸å­˜ä¸å¦æ— å…³ï¼Œä¸¢å¼ƒè¿™ä¸ªç‰¹å¾ã€‚</li><li><code>Survived</code>ï¼š1è¡¨ç¤ºå¹¸å­˜ï¼Œ0è¡¨ç¤ºé‡éš¾ã€‚è¿™æ˜¯æ ‡æ³¨æ•°æ®ã€‚</li><li><code>Pclass</code>ï¼šä»“ä½ç­‰çº§ã€‚è¿™æ˜¯ä¸ªå¾ˆé‡è¦çš„ç‰¹å¾ï¼Œé«˜ä»“ä½çš„ä¹˜å®¢èƒ½æ›´å¿«çš„åˆ°è¾¾ç”²æ¿ï¼Œä»è€Œæ›´å®¹æ˜“è·æ•‘ã€‚</li><li><code>Name</code>ï¼šä¹˜å®¢çš„åå­—ï¼Œè¿™ä¸ªç‰¹å¾å’Œå¹¸å­˜ä¸å¦æ— å…³ï¼Œä¸¢å¼ƒè¿™ä¸ªç‰¹å¾ã€‚</li><li><code>Sex</code>ï¼šä¹˜å®¢æ€§åˆ«ã€‚ç”±äºæ•‘ç”Ÿè‰‡æ•°é‡ä¸å¤Ÿï¼Œèˆ¹é•¿è®©å¦‡å¥³å’Œå„¿ç«¥å…ˆä¸Šæ•‘ç”Ÿè‰‡ã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ªå¾ˆé‡è¦çš„ç‰¹å¾ã€‚</li><li><code>Age</code>ï¼šä¹˜å®¢çš„å¹´é¾„ã€‚å„¿ç«¥ä¼šä¼˜å…ˆä¸Šæ•‘ç”Ÿè‰‡ï¼Œèº«å¼ºåŠ›å£®è€…å¹¸å­˜æ¦‚ç‡ä¹Ÿä¼šé«˜ä¸€äº›ã€‚æ‰€ä»¥è¿™ä¹Ÿæ˜¯ä¸ªå¾ˆé‡è¦çš„ç‰¹å¾ã€‚</li><li><code>SibSp</code>ï¼šå…„å¼Ÿå§å¦¹åŒåœ¨èˆ¹ä¸Šçš„æ•°é‡ã€‚</li><li><code>Parch</code>ï¼šåŒèˆ¹çš„çˆ¶è¾ˆäººå‘˜çš„æ•°é‡ã€‚</li><li><code>Ticket</code>ï¼šä¹˜å®¢çš„ç¥¨å·ã€‚è¿™ä¸ªç‰¹å¾å’Œå¹¸å­˜ä¸å¦æ— å…³ï¼Œä¸¢å¼ƒè¿™ä¸ªç‰¹å¾ã€‚</li><li><code>Fare</code>ï¼šä¹˜å®¢çš„ä½“çƒ­æŒ‡æ ‡ã€‚</li><li><code>Cabin</code>ï¼šä¹˜å®¢æ‰€åœ¨çš„èˆ¹èˆ±å·ã€‚å®é™…ä¸Šè¿™ä¸ªç‰¹å¾å’Œå¹¸å­˜ä¸å¦æœ‰ä¸€å®šçš„å…³ç³»ï¼Œæ¯”å¦‚æœ€æ—©è¢«æ°´æ·¹æ²¡çš„èˆ¹èˆ±ä½ç½®ï¼Œå…¶ä¹˜å®¢çš„å¹¸å­˜æ¦‚ç‡è¦ä½ä¸€äº›ã€‚ä½†ç”±äºè¿™ä¸ªç‰¹å¾æœ‰å¤§é‡çš„ä¸¢å¤±æ•°æ®ï¼Œè€Œä¸”æ²¡æœ‰æ›´å¤šçš„æ•°æ®æ¥å¯¹èˆ¹èˆ±è¿›è¡Œå½’ç±»ï¼Œå› æ­¤æˆ‘ä»¬ä¸¢å¼ƒè¿™ä¸ªç‰¹å¾çš„æ•°æ®ã€‚</li><li><code>Embarked</code>ï¼šä¹˜å®¢ç™»èˆ¹çš„æ¸¯å£ã€‚æˆ‘ä»¬éœ€è¦æŠŠæ¸¯å£æ•°æ®è½¬æ¢ä¸ºæ•°å€¼ç±»å‹çš„æ•°æ®ã€‚</li></ul><p>æˆ‘ä»¬éœ€è¦åŠ è½½csvæ•°æ®ã€‚å¹¶åšä¸€äº›é¢„å¤„ç†ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>æå–Survivedåˆ—çš„æ•°æ®ä½œä¸ºæ¨¡å‹çš„æ ‡æ³¨æ•°æ®ã€‚</li><li>ä¸¢å¼ƒä¸éœ€è¦çš„ç‰¹å¾æ•°æ®ã€‚</li><li>å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œä»¥ä¾¿æ¨¡å‹å¤„ç†ã€‚æ¯”å¦‚æŠŠæ€§åˆ«æ•°æ®è½¬æ¢ä¸º0å’Œ1.</li><li>å¤„ç†ç¼ºå¤±çš„æ•°æ®ã€‚æ¯”å¦‚å¹´é¾„è¿™ä¸ªç‰¹å¾ï¼Œæœ‰å¾ˆå¤šç¼ºå¤±çš„æ•°æ®ã€‚</li></ul><p><code>Pandas</code> æ˜¯å®Œæˆè¿™äº›ä»»åŠ¡çš„ç†æƒ³è½¯ä»¶åŒ…ï¼Œæˆ‘ä»¬å…ˆæŠŠæ•°æ®ä»æ–‡ä»¶é‡Œè¯»å–å‡ºæ¥ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">def</span> <span class="token function">read_dataset</span><span class="token punctuation">(</span>fname<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># æŒ‡å®šç¬¬ä¸€åˆ—ä½œä¸ºè¡Œç´¢å¼•</span>    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>fname<span class="token punctuation">,</span>index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># ä¸¢å¼ƒæ— ç”¨çš„æ•°æ®</span>    data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Name'</span><span class="token punctuation">,</span><span class="token string">'Ticket'</span><span class="token punctuation">,</span><span class="token string">'Cabin'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># å¤„ç†æ€§åˆ«æ•°æ®</span>    data<span class="token punctuation">[</span><span class="token string">'Sex'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'Sex'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'male'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># å¤„ç†ç™»èˆ¹æ¸¯å£æ•°æ®</span>    labels <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'Embarked'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>    data<span class="token punctuation">[</span><span class="token string">'Embarked'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'Embarked'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> n<span class="token punctuation">:</span>labels<span class="token punctuation">.</span>index<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># å¤„ç†ç¼ºå¤±æ•°æ®</span>    data <span class="token operator">=</span> data<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> datatrain <span class="token operator">=</span> read_dataset<span class="token punctuation">(</span><span class="token string">'./titanic/train.csv'</span><span class="token punctuation">)</span>train<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤„ç†å®Œçš„æ•°æ®å¦‚ä¸‹ï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630171531856.png" alt="img"></p><h3 id="4-2-æ¨¡å‹è®­ç»ƒ"><a href="#4-2-æ¨¡å‹è®­ç»ƒ" class="headerlink" title="4.2 æ¨¡å‹è®­ç»ƒ"></a>4.2 æ¨¡å‹è®­ç»ƒ</h3><p>é¦–å…ˆéœ€è¦æŠŠ <code>Survived</code> åˆ—æå–å‡ºæ¥ä½œä¸ºæ ‡ç­¾ï¼Œå¹¶åœ¨åŸæ•°æ®é›†ä¸­åˆ é™¤è¿™ä¸€åˆ—ã€‚ç„¶åæŠŠæ•°æ®é›†åˆ’åˆ†æˆè®­ç»ƒæ•°æ®é›†å’Œäº¤å‰éªŒè¯æ•°æ®é›†ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_splity <span class="token operator">=</span> train<span class="token punctuation">[</span><span class="token string">'Survived'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valuesX <span class="token operator">=</span> train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Survived'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>valuesX_train<span class="token punctuation">,</span>X_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'train dataset: {0}; test dataset: {1}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>X_test<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">train dataset<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">712</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span> test dataset<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ç€ï¼Œä½¿ç”¨ <code>scikit-learn</code> çš„å†³ç­–æ ‘æ¨¡å‹å¯¹æ•°æ®é›†è¿›è¡Œæ‹Ÿåˆï¼Œå¹¶è§‚å¯Ÿæ¨¡å‹çš„æ€§èƒ½ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeClassifierclf <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>train_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>test_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'train score: {0}; test score: {1}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>train_score<span class="token punctuation">,</span>test_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">train score<span class="token punctuation">:</span> <span class="token number">0.9859550561797753</span><span class="token punctuation">;</span> test score<span class="token punctuation">:</span> <span class="token number">0.7877094972067039</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œé’ˆå¯¹è®­ç»ƒæ ·æœ¬è¯„åˆ†å¾ˆé«˜ï¼Œä½†æ˜¯é’ˆå¯¹äº¤å‰éªŒè¯æ•°æ®é›†è¯„åˆ†è¾ƒä½ï¼Œä¸¤è€…å·®è·è¾ƒå¤§ã€‚æ²¡é”™ï¼Œè¿™æ˜¯è¿‡æ‹Ÿåˆç°è±¡ã€‚è§£å†³å†³ç­–æ ‘è¿‡æ‹Ÿåˆçš„æ–¹æ³•æ˜¯å‰ªæï¼ŒåŒ…æ‹¬å‰å‰ªæå’Œåå‰ªæã€‚ä¸å¹¸çš„æ˜¯ <code>scikit-learn</code> ä¸æ”¯æŒåå‰ªæï¼Œä½†æ˜¯æä¾›äº†ä¸€ç³»åˆ—æ¨¡å‹å‚æ•°è¿›è¡Œå‰å‰ªæã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡ <code>max_depth</code> å‚æ•°é™å®šå†³ç­–æ ‘çš„æ·±åº¦ï¼Œå½“å†³ç­–æ ‘è¾¾åˆ°é™å®šçš„æ·±åº¦æ—¶ï¼Œå°±ä¸å†è¿›è¡Œåˆ†è£‚äº†ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šé¿å…è¿‡æ‹Ÿåˆã€‚</p><h3 id="4-3-ä¼˜åŒ–æ¨¡å‹å‚æ•°"><a href="#4-3-ä¼˜åŒ–æ¨¡å‹å‚æ•°" class="headerlink" title="4.3 ä¼˜åŒ–æ¨¡å‹å‚æ•°"></a>4.3 ä¼˜åŒ–æ¨¡å‹å‚æ•°</h3><p>æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ç³»åˆ—çš„å‚æ•°å€¼ï¼Œç„¶ååˆ†åˆ«è®¡ç®—æŒ‡å®šå‚æ•°è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹çš„è¯„åˆ†ã€‚è¿˜å¯ä»¥æŠŠå‚æ•°å€¼å’Œæ¨¡å‹è¯„åˆ†é€šè¿‡å›¾å½¢ç”»å‡ºæ¥ï¼Œä»¥ä¾¿ç›´è§‚åœ°å‘ç°ä¸¤è€…ä¹‹é—´çš„å…³ç³»ã€‚</p><p>è¿™é‡Œä»¥é™åˆ¶å†³ç­–æ ‘æ·±åº¦ <code>max_depth</code> ä¸ºäº†æ¥ä»‹ç»æ¨¡å‹å‚æ•°çš„ä¼˜åŒ–è¿‡ç¨‹ã€‚æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä½¿ç”¨ä¸åŒçš„<code>max_depth</code> æ¥è®­ç»ƒæ¨¡å‹ï¼Œå¹¶è®¡ç®—æ¨¡å‹è¯„åˆ†ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># å‚æ•°é€‰æ‹© max_depth</span><span class="token keyword">def</span> <span class="token function">cv_score</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span>    clf <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>max_depth<span class="token operator">=</span>d<span class="token punctuation">)</span>    clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>    tr_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>    cv_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>tr_score<span class="token punctuation">,</span>cv_score<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€æ„é€ å‚æ•°èŒƒå›´ï¼Œåœ¨è¿™ä¸ªèŒƒå›´å†…åˆ†åˆ«è®¡ç®—æ¨¡å‹è¯„åˆ†ï¼Œå¹¶æ‰¾å‡ºè¯„åˆ†æœ€é«˜çš„æ¨¡å‹æ‰€å¯¹åº”çš„å‚æ•°ã€‚</p><pre class="line-numbers language-dart"><code class="language-dart"><span class="token keyword">import</span> numpy <span class="token operator">as</span> npdepths <span class="token operator">=</span> <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span>scores <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">cv_score</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token keyword">for</span> d <span class="token keyword">in</span> depths<span class="token punctuation">]</span>tr_scores <span class="token operator">=</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> scores<span class="token punctuation">]</span>cv_scores <span class="token operator">=</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> scores<span class="token punctuation">]</span>best_score_index <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token function">argmax</span><span class="token punctuation">(</span>cv_scores<span class="token punctuation">)</span>best_score <span class="token operator">=</span> cv_scores<span class="token punctuation">[</span>best_score_index<span class="token punctuation">]</span>best_param <span class="token operator">=</span> depths<span class="token punctuation">[</span>best_score_index<span class="token punctuation">]</span><span class="token function">print</span><span class="token punctuation">(</span>scores<span class="token punctuation">)</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'best param: {0}ï¼› best scoreï¼š {1}'</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>best_param<span class="token punctuation">,</span>best_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css">best <span class="token property">param</span><span class="token punctuation">:</span> <span class="token number">4</span>ï¼› best scoreï¼š <span class="token number">0.8212290502793296</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œé’ˆå¯¹æ¨¡å‹æ·±åº¦è¿™ä¸ªå‚æ•°ï¼Œæœ€ä¼˜çš„å€¼æ˜¯4ï¼Œå…¶å¯¹åº”çš„äº¤å‰éªŒè¯æ•°æ®é›†è¯„åˆ†ä¸º0.82ã€‚æˆ‘ä»¬è¿˜å¯ä»¥æŠŠæ¨¡å‹å‚æ•°å’Œå¯¹åº”çš„æ¨¡å‹è¯„åˆ†ç”»å‡ºæ¥ï¼Œæ›´ç›´è§‚åœ°è§‚å¯Ÿå…¶å˜åŒ–è§„å¾‹ã€‚</p><pre class="line-numbers language-dart"><code class="language-dart"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token operator">as</span> pltplt<span class="token punctuation">.</span><span class="token function">figure</span><span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span><span class="token function">grid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span><span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'max depth of decision tree'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span><span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'score'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span>depths<span class="token punctuation">,</span>cv_scores<span class="token punctuation">,</span><span class="token string">'.g-'</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'cross-validation score'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span>depths<span class="token punctuation">,</span>tr_scores<span class="token punctuation">,</span><span class="token string">'.r--'</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'training score'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span><span class="token function">legend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-8536c1c2cfda1d0f.png" alt="image-20200630171531856"></p><p>ä½¿ç”¨åŒæ ·çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒå¯Ÿå‚æ•° m<code>in_impurity_split</code> ã€‚è¿™ä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šä¿¡æ¯ç†µæˆ–åŸºå°¼ä¸çº¯åº¦çš„é˜ˆå€¼ã€‚å½“å†³ç­–æ ‘åˆ†è£‚åï¼Œå…¶ä¿¡æ¯å¢ç›Šä½äºè¿™ä¸ªé˜ˆå€¼ï¼Œåˆ™ä¸å†åˆ†è£‚ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># è®­ç»ƒæ¨¡å‹ï¼Œå¹¶è®¡ç®—è¯„åˆ†</span><span class="token keyword">def</span> <span class="token function">cv_score</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span>    clf <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>criterion<span class="token operator">=</span><span class="token string">'gini'</span><span class="token punctuation">,</span> min_impurity_decrease<span class="token operator">=</span>val<span class="token punctuation">)</span>    clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>    tr_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>    cv_score <span class="token operator">=</span> clf<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>tr_score<span class="token punctuation">,</span> cv_score<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># æŒ‡å®šå‚æ•°èŒƒå›´ï¼Œåˆ†åˆ«è®­ç»ƒæ¨¡å‹ï¼Œå¹¶è®¡ç®—è¯„åˆ†</span>values <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.005</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>scores <span class="token operator">=</span> <span class="token punctuation">[</span>cv_score<span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token keyword">for</span> v <span class="token keyword">in</span> values<span class="token punctuation">]</span>tr_scores <span class="token operator">=</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> scores<span class="token punctuation">]</span>cv_scores <span class="token operator">=</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> scores<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># æ‰¾å‡ºè¯„åˆ†æœ€é«˜çš„æ¨¡å‹å‚æ•°</span>best_score_index <span class="token operator">=</span> np<span class="token punctuation">.</span>argmax<span class="token punctuation">(</span>cv_scores<span class="token punctuation">)</span>best_score <span class="token operator">=</span> cv_scores<span class="token punctuation">[</span>best_score_index<span class="token punctuation">]</span>best_param <span class="token operator">=</span> values<span class="token punctuation">[</span>best_score_index<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'best param: {0}; best score: {1}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>best_param<span class="token punctuation">,</span> best_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># ç”»å‡ºæ¨¡å‹å‚æ•°ä¸æ¨¡å‹è¯„åˆ†çš„å…³ç³»</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'threshold of entropy'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'score'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>values<span class="token punctuation">,</span> cv_scores<span class="token punctuation">,</span> <span class="token string">'.g-'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'cross-validation score'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>values<span class="token punctuation">,</span> tr_scores<span class="token punctuation">,</span> <span class="token string">'.r--'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'training score'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">best param<span class="token punctuation">:</span> <span class="token number">0.0005102040816326531</span><span class="token punctuation">;</span> best score<span class="token punctuation">:</span> <span class="token number">0.8100558659217877</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630181702264.png" alt="image-20200630174835975"></p><p>è¿™é‡ŒæŠŠ[0,0.005]ç­‰åˆ†50ä»½ï¼Œä»¥æ¯ä¸ªç­‰åˆ†ç‚¹ä½œä¸ºä¿¡æ¯å¢ç›Šé˜ˆå€¼æ¥è®­ç»ƒä¸€æ¬¡æ¨¡å‹ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè®­ç»ƒæ•°æ®é›†çš„è¯„åˆ†æ€¥é€Ÿä¸‹é™ï¼Œä¸”è®­ç»ƒè¯„åˆ†å’Œæµ‹è¯•è¯„åˆ†éƒ½ä¿æŒè¾ƒä½æ°´å¹³ï¼Œè¯´æ˜æ¨¡å‹æ¬ æ‹Ÿåˆã€‚æˆ‘ä»¬å¯ä»¥æŠŠå†³ç­–æ ‘ç‰¹å¾é€‰æ‹©çš„åŸºå°¼ä¸çº¯åº¦æ”¹ä¸ºä¿¡æ¯ç†µï¼Œå³æŠŠå‚æ•°<code>criterion</code>çš„å€¼æ”¹ä¸º<code>'entropy'</code>è§‚å¯Ÿå›¾å½¢çš„å˜åŒ–ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>clf <span class="token operator">=</span> DecisionTreeClassifier<span class="token punctuation">(</span>criterion<span class="token operator">=</span><span class="token string">'entropy'</span><span class="token punctuation">,</span> min_impurity_decrease<span class="token operator">=</span>val<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630174835975.png" alt="image-20200630175057127"></p><h3 id="4-4-æ¨¡å‹å‚æ•°é€‰æ‹©å·¥å…·åŒ…"><a href="#4-4-æ¨¡å‹å‚æ•°é€‰æ‹©å·¥å…·åŒ…" class="headerlink" title="4.4 æ¨¡å‹å‚æ•°é€‰æ‹©å·¥å…·åŒ…"></a>4.4 æ¨¡å‹å‚æ•°é€‰æ‹©å·¥å…·åŒ…</h3><p>ä¸Šé¢çš„æ¨¡å‹å‚æ•°ä¼˜åŒ–è¿‡ç¨‹å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ã€‚å…¶ä¸€ï¼Œæ•°æ®ä¸ç¨³å®šï¼Œå³æ•°æ®é›†æ¯æ¬¡éƒ½æ˜¯éšæœºåˆ’åˆ†çš„ï¼Œé€‰æ‹©å‡ºæ¥çš„æœ€ä¼˜å‚æ•°åœ¨ä¸‹ä¸€æ¬¡è¿è¡Œæ—¶å°±ä¸æ˜¯æœ€ä¼˜çš„äº†ã€‚å…¶äºŒï¼Œä¸èƒ½ä¸€æ¬¡é€‰æ‹©å¤šä¸ªå‚æ•°ï¼Œä¾‹å¦‚ï¼Œæƒ³è¦è€ƒå¯Ÿ <code>max_depth</code>å’Œ<code>min_samples_leaf</code>ä¸¤ä¸ªç»“åˆèµ·æ¥çš„æœ€ä¼˜å‚æ•°å°±æ— æ³•å®ç°ã€‚</p><p>é—®é¢˜ä¸€çš„åŸå› æ˜¯ï¼Œæ¯æ¬¡æŠŠæ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒæ ·æœ¬å’Œäº¤å‰éªŒè¯æ ·æœ¬æ—¶ï¼Œæ˜¯éšæœºåˆ’åˆ†çš„ï¼Œè¿™æ ·å¯¼è‡´æ¯æ¬¡çš„è®­ç»ƒæ•°æ®é›†æ˜¯æœ‰å·®å¼‚çš„ï¼Œè®­ç»ƒå‡ºæ¥çš„æ¨¡å‹ä¹Ÿæœ‰å·®å¼‚ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æ˜¯å¤šæ¬¡è®¡ç®—ï¼Œæ±‚å¹³å‡å€¼ã€‚å…·ä½“æ¥è®²ï¼Œå°±æ˜¯é’ˆå¯¹æ¨¡å‹çš„æŸä¸ªç‰¹å®šçš„å‚æ•°ï¼Œå¤šæ¬¡åˆ’åˆ†æ•°æ®é›†ï¼Œå¤šæ¬¡è®­ç»ƒæ¨¡å‹ï¼Œè®¡ç®—å‡ºè¿™ä¸ªå‚æ•°å¯¹åº”çš„æ¨¡å‹çš„æœ€ä½è¯„åˆ†ã€æœ€é«˜è¯„åˆ†ä»¥åŠè¯„ä»·è¯„åˆ†ã€‚é—®é¢˜äºŒçš„è§£å†³åŠæ³•æ¯”è¾ƒç®€å•ï¼ŒæŠŠä»£ç å†ä¼˜åŒ–ä¸€ä¸‹ï¼Œèƒ½å¤„ç†å¤šä¸ªå‚æ•°ç»„åˆå³å¯ã€‚</p><p>æ‰€å¹¸ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä»å¤´å®ç°è¿™äº›ä»£ç ã€‚<code>scikit-learn</code>åœ¨ <code>sklearn.model_selection</code>åŒ…é‡Œæä¾›äº†å¤§é‡æ¨¡å‹é€‰æ‹©å’Œè¯„ä¼°å·¥å…·ä¾›æˆ‘ä»¬ä½¿ç”¨ã€‚é’ˆå¯¹ä»¥ä¸Šé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ <code>GridSearchCV</code> ç±»æ¥è§£å†³ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCVthresholds <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>param_grid <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'min_impurity_split'</span><span class="token punctuation">:</span> thresholds<span class="token punctuation">}</span>clf <span class="token operator">=</span> GridSearchCV<span class="token punctuation">(</span>DecisionTreeClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> param_grid<span class="token punctuation">,</span> cv<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>return_train_score<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"best param: {0}\nbest score: {1}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>clf<span class="token punctuation">.</span>best_params_<span class="token punctuation">,</span> clf<span class="token punctuation">.</span>best_score_<span class="token punctuation">)</span><span class="token punctuation">)</span>plot_curve<span class="token punctuation">(</span>thresholds<span class="token punctuation">,</span> clf<span class="token punctuation">.</span>cv_results_<span class="token punctuation">,</span> xlabel<span class="token operator">=</span><span class="token string">'gini thresholds'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">best param<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'min_impurity_split'</span><span class="token punctuation">:</span> <span class="token number">0.19387755102040816</span><span class="token punctuation">}</span>best score<span class="token punctuation">:</span> <span class="token number">0.82045069361622</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å…¶ä¸­å…³é”®çš„å‚æ•°æ˜¯<code>param_grid</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå­—å…¸ï¼Œé”®å¯¹åº”çš„å€¼æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚<code>GridSearchCV</code>ä¼šæšä¸¾åˆ—è¡¨é‡Œçš„æ‰€æœ‰å€¼æ¥æ„å»ºæ¨¡å‹ï¼Œæœ€ç»ˆå¾—å‡ºæŒ‡å®šå‚æ•°å€¼çš„å¹³å‡è¯„åˆ†åŠæ ‡å‡†å·®ã€‚å¦å¤–ä¸€ä¸ªå…³é”®å‚æ•°æ˜¯cvï¼Œå®ƒç”¨æ¥æŒ‡å®šäº¤å‰éªŒè¯æ•°æ®é›†çš„ç”Ÿæˆè§„åˆ™ï¼Œä»£ç ä¸­çš„ cv=5 ï¼Œè¡¨ç¤ºæ¯æ¬¡è®¡ç®—éƒ½æŠŠæ•°æ®é›†åˆ†æˆ 5 ä»½ï¼Œæ‹¿å…¶ä¸­ä¸€ä»½ä½œä¸ºäº¤å‰éªŒè¯æ•°æ®é›†ï¼Œå…¶ä»–çš„ä½œä¸ºè®­ç»ƒæ•°æ®é›†ã€‚æœ€ç»ˆå¾—å‡ºçš„æœ€ä¼˜å‚æ•°åŠæœ€ä¼˜è¯„åˆ†ä¿å­˜åœ¨ <code>clf.best_params</code> å’Œ <code>clf.best_score</code>é‡Œã€‚æ­¤å¤–ï¼Œ<code>clf.cv_results_</code>ä¿å­˜äº†è®¡ç®—è¿‡ç¨‹çš„æ‰€æœ‰ä¸­é—´ç»“æœã€‚æˆ‘ä»¬å¯ä»¥æ‹¿è¿™ä¸ªæ•°æ®æ¥ç”»å‡ºæ¨¡å‹å‚æ•°ä¸æ¨¡å‹è¯„åˆ†çš„å…³ç³»å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630175057127.png" alt="image-20200630181702264"></p><p>æ¥ä¸‹æ¥çœ‹ä¸€ä¸‹å¦‚ä½•åœ¨å¤šç»„å‚æ•°ä¹‹é—´é€‰æ‹©æœ€ä¼˜çš„å‚æ•°ç»„åˆï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> GridSearchCVentropy_thresholds <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span>gini_thresholds <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span>param_grid <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">'criterion'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'entropy'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'min_impurity_split'</span><span class="token punctuation">:</span>entropy_thresholds<span class="token punctuation">}</span><span class="token punctuation">,</span>              <span class="token punctuation">{</span><span class="token string">'criterion'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">'gini'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'min_impurity_split'</span><span class="token punctuation">:</span>gini_thresholds<span class="token punctuation">}</span><span class="token punctuation">,</span>              <span class="token punctuation">{</span><span class="token string">'max_depth'</span><span class="token punctuation">:</span>range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>              <span class="token punctuation">{</span><span class="token string">'min_samples_split'</span><span class="token punctuation">:</span>range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">]</span>clf<span class="token operator">=</span>GridSearchCV<span class="token punctuation">(</span>DecisionTreeClassifier<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>param_grid<span class="token punctuation">,</span>cv<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'best param: {0}\nbest score: {1}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>clf<span class="token punctuation">.</span>best_params_<span class="token punctuation">,</span>clf<span class="token punctuation">.</span>best_score_<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">best param<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">'criterion'</span><span class="token punctuation">:</span> <span class="token string">'entropy'</span><span class="token punctuation">,</span> <span class="token string">'min_impurity_split'</span><span class="token punctuation">:</span> <span class="token number">0.5306122448979591</span><span class="token punctuation">}</span>best score<span class="token punctuation">:</span> <span class="token number">0.8305818843763729</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä»£ç å…³é”®éƒ¨åˆ†è¿˜æ˜¯<code>param_grid</code>å‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å­—å…¸ã€‚ä¾‹å¦‚ï¼šé’ˆå¯¹åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå­—å…¸ï¼Œé€‰æ‹©ä¿¡æ¯ç†µä½œä¸ºå†³ç­–æ ‘ç‰¹å¾é€‰æ‹©çš„åˆ¤æ–­æ ‡å‡†ï¼ŒåŒæ—¶å…¶é˜ˆå€¼èŒƒå›´æ˜¯[0,1]ä¹‹é—´åˆ†äº†50ç­‰ä»½ã€‚<code>GridSearchCV</code>ä¼šé’ˆå¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸ªå­—å…¸è¿›è¡Œè¿­ä»£ï¼Œæœ€ç»ˆæ¯”è¾ƒåˆ—è¡¨ä¸­æ¯ä¸ªå­—å…¸æ‰€å¯¹åº”çš„å‚æ•°ç»„åˆï¼Œé€‰æ‹©å‡ºæœ€ä¼˜çš„å‚æ•°ã€‚å…³äº<code>GridSearchCV</code>çš„æ›´å¤šè¯¦æƒ…å¯å‚è€ƒ<a href="http://lijiancheng0614.github.io/scikit-learn/modules/generated/sklearn.grid_search.GridSearchCV.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p><p>æœ€ååŸºäºå¥½å¥‡ï¼Œä½¿ç”¨æœ€ä¼˜å‚æ•°çš„å†³ç­–æ ‘åˆ°åº•æ˜¯ä»€ä¹ˆæ ·å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>sklearn.tree.export_graphviz()</code> å‡½æ•°æŠŠå†³ç­–æ ‘æ¨¡å‹å¯¼å‡ºåˆ°æ–‡ä»¶ä¸­ï¼Œç„¶åä½¿ç”¨<code>graphviz</code>å·¥å…·åŒ…ç”Ÿæˆå†³ç­–æ ‘ç¤ºæ„å›¾ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> export_graphvizcolumns <span class="token operator">=</span> train<span class="token punctuation">.</span>columns<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true"># å¯¼å‡º titanic.dot æ–‡ä»¶</span><span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"E:/titanic.dot"</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f <span class="token operator">=</span> export_graphviz<span class="token punctuation">(</span>clf<span class="token punctuation">,</span> out_file<span class="token operator">=</span>f<span class="token punctuation">,</span>feature_names<span class="token operator">=</span>columns<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 1. condaå®‰è£… graphviz ï¼šconda install python-graphviz </span><span class="token comment" spellcheck="true"># 2. è¿è¡Œ `dot -Tpdf titanic.dot -o titanic.pdf` </span><span class="token comment" spellcheck="true"># 3. åœ¨å½“å‰ç›®å½•æŸ¥çœ‹ç”Ÿæˆçš„å†³ç­–æ ‘ titanic.png</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€ä¼˜å‚æ•°çš„å†³ç­–æ ‘å°±é•¿è¿™ä¸ªæ ·å­</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630185703496.png" alt="image-20200630185703496"></p><hr><h2 id="5-é›†åˆç®—æ³•"><a href="#5-é›†åˆç®—æ³•" class="headerlink" title="5.é›†åˆç®—æ³•"></a>5.é›†åˆç®—æ³•</h2><p>é›†åˆç®—æ³•ï¼ˆEnsembleï¼‰æ˜¯ä¸€ç§å…ƒç®—æ³•ï¼ˆMeta-algorithmï¼‰ï¼Œå®ƒåˆ©ç”¨ç»Ÿè®¡å­¦é‡‡æ ·åŸç†ï¼Œè®­ç»ƒå‡ºæˆç™¾ä¸Šåƒä¸ªä¸åŒçš„ç®—æ³•æ¨¡å‹ã€‚å½“éœ€è¦é¢„æµ‹ä¸€ä¸ªæ–°æ ·æœ¬æ—¶ï¼Œä½¿ç”¨è¿™äº›æ¨¡å‹åˆ†åˆ«å¯¹è¿™ä¸ªæ ·æœ¬è¿›è¡Œé¢„æµ‹ï¼Œç„¶åé‡‡æ ·å°‘æ•°æœä»å¤šæ•°çš„åŸåˆ™ï¼Œå†³å®šæ–°æ ·æœ¬çš„ç±»åˆ«ã€‚é›†åˆç®—æ³•å¯ä»¥æœ‰æ•ˆåœ°è§£å†³è¿‡æ‹Ÿåˆé—®é¢˜ã€‚åœ¨scikit-learn é‡Œï¼Œæ‰€æœ‰çš„é›†åˆç®—æ³•éƒ½å®ç°åœ¨<code>sklearn.ensemble</code>åŒ…é‡Œã€‚</p><h3 id="5-1-è‡ªåŠ©èšåˆç®—æ³•Bagging"><a href="#5-1-è‡ªåŠ©èšåˆç®—æ³•Bagging" class="headerlink" title="5.1 è‡ªåŠ©èšåˆç®—æ³•Bagging"></a>5.1 è‡ªåŠ©èšåˆç®—æ³•Bagging</h3><p>è‡ªåŠ©èšåˆï¼ˆBaggingï¼ŒBootstrap Aggregatingçš„ç¼©å†™ï¼‰çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œé‡‡ç”¨æœ‰æ”¾å›çš„é‡‡æ ·è§„åˆ™ï¼Œä»mä¸ªæ ·æœ¬çš„åŸæ•°æ®é›†é‡Œè¿›è¡Œnæ¬¡é‡‡æ ·ï¼ˆn&lt;=mï¼‰ï¼Œæ„æˆä¸€ä¸ªåŒ…å«nä¸ªæ ·æœ¬çš„æ–°è®­ç»ƒæ•°æ®é›†ã€‚é‡å¤è¿™ä¸ªè¿‡ç¨‹Bæ¬¡ï¼Œå¾—åˆ°Bä¸ªæ¨¡å‹ï¼Œå½“æœ‰æ–°æ ·æœ¬éœ€è¦é¢„æµ‹æ—¶ï¼Œæ‹¿è¿™Bä¸ªæ¨¡å‹åˆ†åˆ«å¯¹è¿™ä¸ªæ ·æœ¬è¿›è¡Œé¢„æµ‹ï¼Œç„¶åé‡‡ç”¨æŠ•ç¥¨æ–¹å¼ï¼ˆå›å½’é—®é¢˜ï¼‰å¾—åˆ°æ–°æ ·æœ¬çš„é¢„æµ‹å€¼ã€‚</p><p>æ‰€è°“çš„æœ‰æ”¾å›é‡‡æ ·è§„åˆ™æ˜¯æŒ‡ï¼Œåœ¨mä¸ªæ•°æ®é›†é‡Œï¼Œéšæœºå–å‡ºä¸€ä¸ªæ ·æœ¬æ”¾åˆ°æ–°æ•°æ®é›†é‡Œï¼Œç„¶åæŠŠè¿™ä¸ªæ ·æœ¬æ”¾å›åˆ°åŸæ•°æ®é›†é‡Œï¼Œç»§ç»­éšæœºé‡‡æ ·ï¼Œç›´åˆ°åˆ°è¾¾é‡‡æ ·æ¬¡æ•°nä¸ºæ­¢ã€‚ç”±æ­¤å¯è§ï¼Œéšæœºé‡‡æ ·å‡ºçš„æ•°æ®é›†é‡Œå¯èƒ½æœ‰é‡å¤æ•°æ®ï¼Œå¹¶ä¸”åŸæ•°æ®é›†çš„æ¯ä¸€ä¸ªæ•°æ®ä¸ä¸€å®šéƒ½å‡ºç°åœ¨æ–°æ•°æ®é›†é‡Œã€‚</p><p>å•ä¸€æ¨¡å‹å¾€å¾€å®¹æ˜“å¯¹æ•°æ®å™ªå£°æ•æ„Ÿï¼Œä»è€Œé€ æˆé«˜æ–¹å·®ï¼ˆHigh Varianceï¼‰ã€‚è‡ªåŠ©èšåˆç®—æ³•å¯ä»¥é™ä½å¯¹æ•°æ®å™ªå£°çš„æ•æ„Ÿæ€§ï¼Œä»è€Œæé«˜æ¨¡å‹å‡†ç¡®æ€§å’Œç¨³å®šæ€§ã€‚è¿™ç§æ–¹æ³•ä¸éœ€è¦é¢å¤–çš„è¾“å…¥ï¼Œåªæ˜¯ç®€å•åœ°å¯¹åŒä¸€ä¸ªæ•°æ®é›†è®­ç»ƒå‡ºå¤šä¸ªæ¨¡å‹å³å¯å®ç°ã€‚å½“ç„¶è¿™å¹¶ä¸æ˜¯è¯´æ²¡æœ‰ä»£ä»·ï¼Œè‡ªåŠ©èšåˆç®—æ³•ä¸€èˆ¬ä¼šå¢åŠ æ¨¡å‹è®­ç»ƒçš„è®¡ç®—é‡ã€‚</p><p>åœ¨<code>scikit-learn</code>é‡Œï¼Œç”±<code>BaggingClassifier</code>ç±»å’ŒB<code>aggingRegressor</code>ç±»åˆ†åˆ«å®ç°äº†åˆ†ç±»å’Œå›å½’çš„Baggingç®—æ³•ã€‚</p><h3 id="5-2-æ­£å‘æ¿€åŠ±ç®—æ³•Boosting"><a href="#5-2-æ­£å‘æ¿€åŠ±ç®—æ³•Boosting" class="headerlink" title="5.2 æ­£å‘æ¿€åŠ±ç®—æ³•Boosting"></a>5.2 æ­£å‘æ¿€åŠ±ç®—æ³•Boosting</h3><p>æ­£å‘æ¿€åŠ±ç®—æ³•ï¼ˆBoostingï¼‰çš„åŸºæœ¬åŸç†æ˜¯ï¼Œåˆå§‹åŒ–æ—¶ï¼Œé’ˆå¯¹æœ‰mä¸ªè®­ç»ƒæ ·æœ¬çš„æ•°æ®é›†ï¼Œç»™æ¯ä¸ªæ ·æœ¬éƒ½åˆ†é…ä¸€ä¸ªåˆå§‹æƒé‡ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªå¸¦æœ‰æƒé‡çš„æ•°æ®é›†æ¥è®­ç»ƒæ¨¡å‹ã€‚è®­ç»ƒå‡ºæ¨¡å‹ä¹‹åï¼Œé’ˆå¯¹è¿™ä¸ªæ¨¡å‹é¢„æµ‹é”™è¯¯çš„é‚£äº›æ ·æœ¬ï¼Œå¢åŠ å…¶æƒé‡ï¼Œç„¶åæ‹¿è¿™ä¸ªæ›´æ–°è¿‡æƒé‡çš„æ•°æ®é›†æ¥è®­ç»ƒå‡ºä¸€ä¸ªæ–°çš„æ¨¡å‹ã€‚é‡å¤è¿™ä¸ªè¿‡ç¨‹Bæ¬¡ï¼Œå°±å¯ä»¥è®­ç»ƒå‡ºBä¸ªæ¨¡å‹ã€‚</p><p>Boostingç®—æ³•å’ŒBaggingç®—æ³•çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li>é‡‡æ ·è§„åˆ™ä¸åŒï¼šBaggingç®—æ³•æ˜¯é‡‡æ ·æœ‰æ”¾å›çš„éšæœºé‡‡æ ·è§„åˆ™ã€‚è€ŒBoostingç®—æ³•æ˜¯ä½¿ç”¨å¢åŠ é¢„æµ‹é”™è¯¯æ ·æœ¬æƒé‡çš„æ–¹æ³•ï¼Œç›¸å½“äºåŠ å¼ºäº†å¯¹é¢„æµ‹é”™è¯¯çš„æ ·æœ¬çš„å­¦ä¹ åŠ›åº¦ï¼Œä»è€Œæé«˜æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚</li><li>è®­ç»ƒæ–¹å¼ä¸åŒï¼šBaggingç®—æ³•å¯ä»¥å¹¶è¡Œè®­ç»ƒå¤šä¸ªæ¨¡å‹ã€‚è€ŒBoostingç®—æ³•åªèƒ½ä¸²è¡Œè®­ç»ƒï¼Œå› ä¸ºä¸‹ä¸€ä¸ªæ¨¡å‹ä¾èµ–ä¸Šä¸€ä¸ªæ¨¡å‹çš„é¢„æµ‹ç»“æœã€‚</li><li>æ¨¡å‹æƒé‡ä¸åŒï¼šBaggingç®—æ³•è®­ç»ƒå‡ºæ¥çš„Bä¸ªæ¨¡å‹çš„æƒé‡æ˜¯ä¸€æ ·çš„ã€‚è€ŒBoostingç®—æ³•è®­ç»ƒå‡ºæ¥çš„Bä¸ªæ¨¡å‹æœ¬èº«å¸¦æœ‰æƒé‡ä¿¡æ¯ï¼Œåœ¨å¯¹æ–°æ ·æœ¬è¿›è¡Œé¢„æµ‹æ—¶ï¼Œæ¯ä¸ªæ¨¡å‹çš„æƒé‡æ˜¯ä¸ä¸€æ ·çš„ã€‚å•ä¸ªæ¨¡å‹çš„æƒé‡ç”±æ¨¡å‹è®­ç»ƒçš„æ•ˆæœæ¥å†³å®šï¼Œå³å‡†ç¡®æ€§é«˜çš„æ¨¡å‹æƒé‡æ›´é«˜ã€‚</li></ul><p>Boostingç®—æ³•æœ‰å¾ˆå¤šç§å®ç°ï¼Œå…¶ä¸­æœ€è‘—åçš„æ˜¯ <code>AdaBoosting</code> ç®—æ³•ã€‚åœ¨ <code>scikit-learn</code> é‡Œç”±<code>AdaBoostingClassifier</code>ç±»å’Œ <code>AdaBoostingRegression</code>ç±»åˆ†åˆ«å®ç°Boostingåˆ†ç±»å’ŒBoostingå›å½’ã€‚</p><h3 id="5-3-éšæœºæ£®æ—"><a href="#5-3-éšæœºæ£®æ—" class="headerlink" title="5.3 éšæœºæ£®æ—"></a>5.3 éšæœºæ£®æ—</h3><p>éšæœºæ£®æ—ï¼ˆRFï¼ŒRandom Forestï¼‰åœ¨è‡ªåŠ©èšåˆç®—æ³•ï¼ˆBaggingï¼‰çš„åŸºç¡€ä¸Šæ›´è¿›ä¸€æ­¥ï¼Œå¯¹ç‰¹å¾åº”ç”¨è‡ªåŠ©èšåˆç®—æ³•ã€‚å³ï¼Œæ¯æ¬¡è®­ç»ƒæ—¶ï¼Œä¸æ‹¿æ‰€æœ‰çš„ç‰¹å¾æ¥è®­ç»ƒï¼Œè€Œæ˜¯éšæœºé€‰æ‹©ä¸€ä¸ªç‰¹å¾çš„å­é›†æ¥è¿›è¡Œè®­ç»ƒã€‚éšæœºæ£®æ—ç®—æ³•æœ‰ä¸¤ä¸ªå…³é”®å‚æ•°ï¼Œä¸€æ˜¯æ„å»ºçš„å†³ç­–æ ‘çš„ä¸ªæ•°tï¼ŒäºŒæ˜¯æ„å»ºå•æ£µå†³ç­–æ ‘ç‰¹å¾çš„ä¸ªæ•°fã€‚</p><p>å‡è®¾ï¼Œé’ˆå¯¹ä¸€ä¸ªæœ‰mä¸ªæ ·æœ¬ã€nä¸ªç‰¹å¾çš„æ•°æ®é›†ï¼Œåˆ™å…¶ç®—æ³•åŸç†å¦‚ä¸‹ï¼š</p><h4 id="å•æ£µå†³ç­–æ ‘çš„æ„å»º"><a href="#å•æ£µå†³ç­–æ ‘çš„æ„å»º" class="headerlink" title="å•æ£µå†³ç­–æ ‘çš„æ„å»º"></a>å•æ£µå†³ç­–æ ‘çš„æ„å»º</h4><ul><li>é‡‡ç”¨æœ‰æ”¾å›é‡‡æ ·ï¼Œä»åŸæ•°æ®é›†ä¸­ç»è¿‡mæ¬¡é‡‡æ ·ï¼Œè·å–åˆ°ä¸€ä¸ªmä¸ªæ ·æœ¬çš„æ•°æ®é›†ï¼ˆè¿™ä¸ªæ•°æ®é›†é‡Œå¯èƒ½æœ‰é‡å¤çš„æ ·æœ¬ï¼‰</li><li>ä»nä¸ªç‰¹å¾é‡Œï¼Œé‡‡ç”¨æ— æ”¾å›é‡‡æ ·è§„åˆ™ï¼Œä»ä¸­å–å‡ºfä¸ªç‰¹å¾ä½œä¸ºè¾“å…¥ç‰¹å¾ã€‚</li><li>é‡å¤ä¸Šè¿°è¿‡ç¨‹tæ¬¡ï¼Œæ„å»ºå‡ºtæ£µå†³ç­–æ ‘ã€‚</li></ul><h4 id="éšæœºæ£®æ—çš„åˆ†ç±»ç»“æœ"><a href="#éšæœºæ£®æ—çš„åˆ†ç±»ç»“æœ" class="headerlink" title="éšæœºæ£®æ—çš„åˆ†ç±»ç»“æœ"></a>éšæœºæ£®æ—çš„åˆ†ç±»ç»“æœ</h4><p> ç”Ÿæˆtæ£µå†³ç­–æ ‘ä¹‹åï¼Œå¯¹äºæ¯ä¸ªæ–°çš„æµ‹è¯•æ ·ä¾‹ï¼Œé›†åˆå¤šæ£µå†³ç­–æ ‘çš„é¢„æµ‹ç»“æœæ¥ä½œä¸ºéšæœºæ£®æ—çš„é¢„æµ‹ç»“æœã€‚å…·ä½“ä¸ºï¼Œå¦‚æœæ˜¯å›å½’é—®é¢˜ï¼Œå–tæ£µå†³ç­–æ ‘çš„é¢„æµ‹å€¼çš„å¹³å‡å€¼ä½œä¸ºéšæœºæ£®æ—çš„é¢„æµ‹ç»“æœï¼›å¦‚æœæ˜¯åˆ†ç±»é—®é¢˜ï¼Œé‡‡å–å°‘æ•°æœä»å¤šæ•°çš„åŸåˆ™ï¼Œå–å•æ£µå†³ç­–æ ‘é¢„æµ‹æœ€å¤šçš„é‚£ä¸ªç±»åˆ«ä½œä¸ºéšæœºæ£®æ—çš„åˆ†ç±»ç»“æœã€‚</p><blockquote><p>æ€è€ƒï¼šä¸ºä»€ä¹ˆéšæœºæ£®æ—è¦é€‰å–ç‰¹å¾çš„å­é›†æ¥æ„å»ºå†³ç­–æ ‘ï¼Ÿ</p></blockquote><p> å‡å¦‚æŸä¸ªè¾“å…¥ç‰¹å¾å¯¹é¢„æµ‹ç»“æœæ˜¯å¼ºå…³è”çš„ï¼Œé‚£ä¹ˆå¦‚æœé€‰æ‹©å…¨éƒ¨çš„ç‰¹å¾æ¥æ„å»ºå†³ç­–æ ‘ï¼Œè¿™ä¸ªç‰¹å¾éƒ½ä¼šä½“ç°åœ¨æ‰€æœ‰çš„å†³ç­–æ ‘é‡Œé¢ã€‚ç”±äºè¿™ä¸ªç‰¹å¾å’Œé¢„æµ‹ç»“æœå¼ºå…³è”ï¼Œä¼šé€ æˆæ‰€æœ‰çš„å†³ç­–æ ‘éƒ½å¼ºçƒˆåœ°åæ˜ è¿™ä¸ªç‰¹å¾çš„â€œå€¾å‘æ€§â€ï¼Œä»è€Œå¯¼è‡´æ— æ³•å¾ˆå¥½åœ°è§£å†³è¿‡æ‹Ÿåˆé—®é¢˜ã€‚æˆ‘ä»¬åœ¨è®¨è®ºçº¿æ€§å›å½’ç®—æ³•æ—¶ï¼Œé€šè¿‡å¢åŠ æ­£åˆ™é¡¹æ¥è§£å†³è¿‡æ‹Ÿåˆï¼Œå®ƒçš„åŸç†å°±æ˜¯ç¡®ä¿æ¯ä¸ªç‰¹å¾éƒ½å¯¹é¢„æµ‹ç»“æœæœ‰å°‘é‡çš„è´¡çŒ®ï¼Œä»è€Œé¿å…å•ä¸ªç‰¹å¾å¯¹é¢„æµ‹ç»“æœæœ‰è¿‡å¤§è´¡çŒ®å¯¼è‡´çš„è¿‡æ‹Ÿåˆé—®é¢˜ã€‚è¿™é‡Œçš„åŸç†æ˜¯ä¸€æ ·çš„ã€‚</p><p>åœ¨ <code>scikit-learn</code> é‡Œç”± <code>RandomForestClassifier</code> ç±»å’Œ <code>RandomForestRegression</code> ç±»åˆ†åˆ«å®ç°éšæœºæ£®æ—çš„åˆ†ç±»ç®—æ³•å’Œéšæœºæ£®æ—çš„å›å½’ç®—æ³•ã€‚</p><h3 id="5-4-ExtraTreesç®—æ³•"><a href="#5-4-ExtraTreesç®—æ³•" class="headerlink" title="5.4 ExtraTreesç®—æ³•"></a>5.4 ExtraTreesç®—æ³•</h3><p>ExtraTreesï¼Œå«åšæé™æ ‘æˆ–è€…æç«¯éšæœºæ ‘ã€‚éšæœºæ£®æ—åœ¨æ„å»ºå†³ç­–æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä½¿ç”¨ä¿¡æ¯ç†µæˆ–è€…åŸºå°¼ä¸çº¯åº¦ï¼Œç„¶åé€‰æ‹©ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾æ¥è¿›è¡Œåˆ†è£‚ã€‚è€Œ <code>ExtraTrees</code> æ˜¯ç›´æ¥ä»æ‰€æœ‰ç‰¹å¾é‡Œéšæœºé€‰æ‹©ä¸€ä¸ªç‰¹å¾æ¥åˆ†è£‚ï¼Œä»è€Œé¿å…äº†è¿‡æ‹Ÿåˆé—®é¢˜ã€‚</p><p>åœ¨<code>scikit-learn</code>é‡Œï¼Œç”±<code>ExtraTreesClassifier</code>ç±»å’Œ <code>ExtraTreesRegression</code> ç±»åˆ†åˆ«å®ç° <code>ExtraTrees</code> çš„åˆ†ç±»ç®—æ³•å’Œ ExtraTrees çš„å›å½’ç®—æ³•ã€‚</p><hr><h2 id="6-æ‰©å±•é˜…è¯»"><a href="#6-æ‰©å±•é˜…è¯»" class="headerlink" title="6. æ‰©å±•é˜…è¯»"></a>6. æ‰©å±•é˜…è¯»</h2><h3 id="6-1-ç†µå’Œæ¡ä»¶ç†µ"><a href="#6-1-ç†µå’Œæ¡ä»¶ç†µ" class="headerlink" title="6.1 ç†µå’Œæ¡ä»¶ç†µ"></a>6.1 ç†µå’Œæ¡ä»¶ç†µ</h3><p>åœ¨å†³ç­–æ ‘åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šè®¡ç®—ä»¥æŸä¸ªç‰¹å¾åˆ›å»ºåˆ†æ”¯åçš„å­æ•°æ®é›†çš„ä¿¡æ¯ç†µã€‚ç”¨æ•°å­¦è¯­è¨€æè¿°å®é™…ä¸Šæ˜¯è®¡ç®—æ¡ä»¶ç†µï¼Œå³æ»¡è¶³æŸä¸ªæ¡ä»¶çš„ä¿¡æ¯ç†µã€‚</p><p>å…³äºä¿¡æ¯ç†µå’Œæ¡ä»¶ç†µçš„ç›¸å…³æ¦‚å¿µï¼Œå¯ä»¥é˜…è¯»å´å†›è€å¸ˆçš„<a href="https://baike.baidu.com/item/%E6%95%B0%E5%AD%A6%E4%B9%8B%E7%BE%8E/1580521?fr=aladdin" target="_blank" rel="noopener">ã€Šæ•°å­¦ä¹‹ç¾ã€‹</a>é‡Œâ€ä¿¡æ¯çš„åº¦é‡å’Œä½œç”¨â€ä¸€æ–‡ã€‚ã€Šæ•°å­¦ä¹‹ç¾ã€‹è¿™æœ¬ä¹¦ï¼Œå´å†›è€å¸ˆç”¨å¹³å®çš„è¯­è¨€ï¼ŒæŠŠå¤æ‚çš„æ•°å­¦æ¦‚å¿µè§£é‡Šçš„å…¥æœ¨ä¸‰åˆ†ï¼Œå³ä½¿ä½ åªæœ‰é«˜ä¸­çš„æ•°å­¦æ°´å¹³ï¼Œä¹Ÿå¯ä»¥é¢†ç•¥åˆ°æ•°å­¦çš„â€œä¼˜é›…â€å’Œâ€œå¨åŠ›â€ã€‚</p><h3 id="6-2-å†³ç­–æ ‘çš„æ„å»ºç®—æ³•"><a href="#6-2-å†³ç­–æ ‘çš„æ„å»ºç®—æ³•" class="headerlink" title="6.2 å†³ç­–æ ‘çš„æ„å»ºç®—æ³•"></a>6.2 å†³ç­–æ ‘çš„æ„å»ºç®—æ³•</h3><p>æœ¬æ–‡é‡ç‚¹ä»‹ç»çš„å†³ç­–æ ‘æ„å»ºç®—æ³•æ˜¯ID3ç®—æ³•ï¼Œå®ƒæ˜¯1986å¹´ç”±Ross Quinlanæå‡ºçš„ã€‚1993å¹´ï¼Œè¯¥ç®—æ³•ä½œè€…å‘å¸ƒäº†æ–°çš„å†³ç­–æ ‘æ„å»ºç®—æ³•C4.5ï¼Œä½œä¸ºID3ç®—æ³•çš„æ”¹è¿›ï¼Œä¸»è¦ä½“ç°åœ¨ï¼š</p><ul><li>å¢åŠ äº†å¯¹è¿ç»­å€¼çš„å¤„ç†ï¼Œæ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªé˜ˆå€¼ä½œä¸ºè¿ç»­å€¼çš„åˆ’åˆ†æ¡ä»¶ï¼Œä»è€ŒæŠŠæ•°æ®ç¦»æ•£åŒ–ã€‚</li><li>è‡ªåŠ¨å¤„ç†ç‰¹å¾å€¼ç¼ºå¤±é—®é¢˜ï¼Œå¤„ç†æ–¹æ³•æ˜¯ç›´æ¥æŠŠè¿™ä¸ªç‰¹å¾æŠ›å¼ƒï¼Œä¸å‚ä¸è®¡ç®—ä¿¡æ¯å¢ç›Šæ¯”ã€‚</li><li>ä½¿ç”¨ä¿¡æ¯å¢ç›Šæ¯”ä½œä¸ºç‰¹å¾é€‰æ‹©æ ‡å‡†ã€‚</li><li>é‡‡ç”¨åå‰ªæç®—æ³•å¤„ç†è¿‡æ‹Ÿåˆï¼Œå³åœ¨å†³ç­–æ ‘åˆ›å»ºå®Œæˆä¹‹åï¼Œå†é€šè¿‡åˆå¹¶å¶å­èŠ‚ç‚¹çš„æ–¹å¼è¿›è¡Œå‰ªæã€‚</li></ul><p>æ­¤åï¼Œè¯¥ç®—æ³•ä½œè€…åˆå‘å¸ƒäº†æ”¹è¿›çš„å•†ä¸šç‰ˆæœ¬C5.0ï¼Œå®ƒè¿ç®—æ•ˆç‡æ›´é«˜ï¼Œä½¿ç”¨å†…å­˜æ›´å°ï¼Œåˆ›å»ºå‡ºæ¥çš„å†³ç­–æ ‘æ›´å°ï¼Œå¹¶ä¸”å‡†ç¡®æ€§æ›´é«˜ï¼Œé€‚åˆå¤§æ•°æ®é›†çš„å†³ç­–æ ‘æ„å»ºã€‚</p><p>é™¤äº†å‰é¢ä»‹ç»çš„ä½¿ç”¨åŸºå°¼ä¸çº¯åº¦æ¥æ„å»ºå†³ç­–æ ‘çš„CARTç®—æ³•ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–çŸ¥åçš„å†³ç­–æ ‘æ„å»ºç®—æ³•ï¼Œå¦‚CHAIDç®—æ³•ã€MARSç®—æ³•ç­‰ã€‚è¿™é‡Œä¸å†è¯¦è¿°ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MLç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scikit-learnç³»åˆ—å››ï¼šé€»è¾‘å›å½’</title>
      <link href="/2020/06/30/scikit-learn-xi-lie-si-luo-ji-hui-gui/"/>
      <url>/2020/06/30/scikit-learn-xi-lie-si-luo-ji-hui-gui/</url>
      
        <content type="html"><![CDATA[<h2 id="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼"><a href="#é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼" class="headerlink" title="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼"></a>é¡¹ç›®åœ°å€<a href="https://github.com/DongZhouGu/scikit-learn-ml" target="_blank" rel="noopener">ä¼ é€é—¨</a>ï¼Œæ¬¢è¿ star å’Œ fork ï¼</h2><h2 id="1-Logistic-å›å½’æ¦‚è¿°"><a href="#1-Logistic-å›å½’æ¦‚è¿°" class="headerlink" title="1. Logistic å›å½’æ¦‚è¿°"></a>1. Logistic å›å½’æ¦‚è¿°</h2><p>Logistic å›å½’ æˆ–è€…å«é€»è¾‘å›å½’ï¼Œè™½ç„¶åå­—æœ‰å›å½’ï¼Œä½†æ˜¯å®ƒæ˜¯ç”¨æ¥åšåˆ†ç±»çš„ã€‚å…¶ä¸»è¦æ€æƒ³æ˜¯: æ ¹æ®ç°æœ‰æ•°æ®å¯¹åˆ†ç±»è¾¹ç•Œçº¿ (Decision Boundary) å»ºç«‹å›å½’å…¬å¼ï¼Œä»¥æ­¤è¿›è¡Œåˆ†ç±»ã€‚</p><h2 id="2-ç®—æ³•åŸç†"><a href="#2-ç®—æ³•åŸç†" class="headerlink" title="2. ç®—æ³•åŸç†"></a>2. ç®—æ³•åŸç†</h2><p>å‡è®¾æœ‰ä¸€åœºè¶³çƒèµ›ï¼Œæˆ‘ä»¬æœ‰ä¸¤æ”¯çƒé˜Ÿçš„æ‰€æœ‰å‡ºåœºçƒå‘˜ä¿¡æ¯ã€å†å²äº¤é”‹æˆç»©ã€æ¯”èµ›æ—¶é—´ã€ä¸»å®¢åœºã€è£åˆ¤å’Œå¤©æ°”ç­‰ä¿¡æ¯ï¼Œæ ¹æ®è¿™äº›ä¿¡æ¯é¢„æµ‹çƒé˜Ÿçš„è¾“èµ¢ã€‚å‡è®¾æ¯”èµ›ç»“æœè®°ä¸ºyï¼Œèµ¢çƒæ ‡è®°ä¸º1ï¼Œè¾“çƒæ ‡è®°ä¸º0ï¼Œè¿™å°±æ˜¯å…¸å‹çš„äºŒå…ƒåˆ†ç±»é—®é¢˜ï¼Œå¯ä»¥ç”¨é€»è¾‘å›å½’ç®—æ³•æ¥è§£å†³ã€‚</p><p>ä¸çº¿æ€§å›å½’ç®—æ³•çš„æœ€å¤§åŒºåˆ«æ˜¯ï¼Œé€»è¾‘å›å½’ç®—æ³•çš„è¾“å‡ºæ˜¯ä¸ªç¦»æ•£å€¼ã€‚</p><h3 id="2-1-é¢„æµ‹å‡½æ•°"><a href="#2-1-é¢„æµ‹å‡½æ•°" class="headerlink" title="2.1 é¢„æµ‹å‡½æ•°"></a>2.1 é¢„æµ‹å‡½æ•°</h3><p>éœ€è¦æ‰¾å‡ºä¸€ä¸ªé¢„æµ‹å‡½æ•°æ¨¡å‹ï¼Œä½¿å…¶å€¼è¾“å‡ºåœ¨[0,1]ä¹‹é—´ã€‚ç„¶åé€‰æ‹©ä¸€ä¸ªåŸºå‡†å€¼ï¼Œå¦‚0.5ï¼Œå¦‚æœç®—å‡ºæ¥çš„é¢„æµ‹å€¼å¤§äº0.5ï¼Œå°±è®¤ä¸ºå…¶é¢„æµ‹å€¼ä¸º1ï¼Œåä¹‹ï¼Œåˆ™å…¶é¢„æµ‹å€¼ä¸º0ã€‚</p><p>é€‰æ‹©Sigmoidå‡½æ•°ï¼ˆä¹Ÿç§°ä¸ºLogisticå‡½æ•°ï¼Œé€»è¾‘å›å½’çš„åå­—ç”±æ­¤è€Œæ¥ï¼‰<br>$$<br>g(z)=\frac{1}{1+e^{-z}}<br>$$<br>æ¥ä½œä¸ºé¢„æµ‹å‡½æ•°ï¼Œå…¶ä¸­eæ˜¯è‡ªç„¶å¯¹æ•°çš„åº•æ•°ã€‚ä»¥zä¸ºæ¨ªåæ ‡ï¼Œä»¥g(z)ä¸ºçºµåæ ‡ï¼Œç”»å‡ºçš„å›¾å½¢å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/LR_3.png" alt="Sigmoid å‡½æ•°åœ¨ä¸åŒåæ ‡ä¸‹çš„å›¾ç‰‡"></p><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå½“z=0æ—¶ï¼Œg(z)=0.5ï¼›å½“z&gt;0æ—¶ï¼Œg(z)&gt;0.5ï¼Œå½“zè¶Šæ¥è¶Šå¤§æ—¶ï¼Œg(z)æ— é™æ¥è¿‘äº1ï¼›å½“z&lt;0æ—¶ï¼Œg(z)&lt;0.5ï¼Œå½“zè¶Šæ¥è¶Šå°æ—¶ï¼Œg(z)æ— é™æ¥è¿‘äº0ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„é’ˆå¯¹äºŒå…ƒåˆ†ç±»ç®—æ³•çš„é¢„æµ‹å‡½æ•°ã€‚</p><h3 id="2-2-åˆ¤å®šè¾¹ç•Œ"><a href="#2-2-åˆ¤å®šè¾¹ç•Œ" class="headerlink" title="2.2 åˆ¤å®šè¾¹ç•Œ"></a>2.2 åˆ¤å®šè¾¹ç•Œ</h3><p>é€»è¾‘å›å½’ç®—æ³•çš„é¢„æµ‹å‡½æ•°ç”±ä¸‹é¢ä¸¤ä¸ªå…¬å¼ç»™å‡ºï¼š<br>$$<br>h_{\theta}(x)=g\left(\theta^{T} x\right)<br>$$</p><p>$$<br>g(z)=\frac{1}{1+e^{-z}}<br>$$</p><p>ä¸‹é¢ç»™å‡ºä¸¤ä¸ªåˆ¤å®šè¾¹ç•Œçš„ä¾‹å­ã€‚å‡è®¾æœ‰ä¸¤ä¸ªå˜é‡x1ï¼Œx2ï¼Œå…¶é€»è¾‘å›å½’é¢„æµ‹å‡½æ•°æ˜¯$h_{\theta}(x)=g\left(\theta_{0}+\theta_{1} x_{1}+\theta_{2} x_{2}\right)$</p><p>å‡è®¾ç»™å®šå‚æ•°ï¼š<br>$$<br>\theta=\left[\begin{array}{c}<br>-3 \<br>1 \<br>1<br>\end{array}\right]<br>$$<br>é‚£ä¹ˆï¼Œå¯ä»¥å¾—åˆ°åˆ¤å®šè¾¹$-3+x_{1}+x_{2}=0$ ï¼Œå¦‚æœä»¥ $x_{1}$ ä¸ºæ¨ªåæ ‡ï¼Œ $x_{2}$  ä¸ºçºµåæ ‡ï¼Œåˆ™è¿™ä¸ªå‡½æ•°ç”»å‡ºæ¥å°±æ˜¯ä¸€æ¡é€šè¿‡(0,3)å’Œ(3,0)ä¸¤ç‚¹çš„ç›´çº¿ã€‚è¿™æ¡çº¿å°±æ˜¯åˆ¤å®šè¾¹ç•Œï¼Œå…¶ä¸­ï¼Œç›´çº¿å·¦ä¸‹æ–¹ä¸ºy=0ï¼Œç›´çº¿å³ä¸Šæ–¹ä¸ºy=1ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-0bf913a36c2847a8.png" alt="img"></p><p>å¦‚æœé¢„æµ‹å‡½æ•°æ˜¯å¤šé¡¹å¼ $h_{\theta}(x)=g\left(\theta_{0}+\theta_{1} x_{1}+\theta_{2} x_{2}+\theta_{3} x_{1}^{2}+\theta_{4} x_{2}^{2}\right)$ï¼Œä¸”ç»™å®š</p><p>$$<br>\theta=\left[\begin{array}{c}<br>-1 \<br>0 \<br>0 \<br>1 \<br>1<br>\end{array}\right]<br>$$<br>åˆ™å¯ä»¥å¾—åˆ°åˆ¤å®šè¾¹ç•Œå‡½æ•°$x_{1}^{2}+x_{2}^{2}=1$ åˆ™è¿™æ˜¯ä¸€ä¸ªåŠå¾„ä¸º1çš„åœ†ã€‚åœ†å†…éƒ¨æ˜¯y=0ï¼Œåœ†å¤–éƒ¨æ˜¯y=1ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤ºã€‚</p><h3 id="2-3-æŸå¤±å‡½æ•°"><a href="#2-3-æŸå¤±å‡½æ•°" class="headerlink" title="2.3 æŸå¤±å‡½æ•°"></a>2.3 æŸå¤±å‡½æ•°</h3><p>æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨çº¿æ€§å›å½’æ¨¡å‹çš„æŸå¤±å‡½æ•°æ¥æ¨å¯¼é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°ï¼Œå› ä¸ºé‚£æ ·çš„æŸå¤±å‡½æ•°å¤ªå¤æ‚ï¼Œæœ€ç»ˆå¾ˆå¯èƒ½ä¼šå¯¼è‡´æ— æ³•é€šè¿‡è¿­ä»£æ‰¾åˆ°æŸå¤±å‡½æ•°å€¼æœ€å°çš„ç‚¹ã€‚</p><p>ä¸ºäº†å®¹æ˜“åœ°æ±‚å‡ºæŸå¤±å‡½æ•°çš„æœ€å°å€¼ï¼Œæˆ‘ä»¬åˆ†æˆ y=1 å’Œ y=0 ä¸¤ç§æƒ…å†µæ¥åˆ†åˆ«è€ƒè™‘å…¶é¢„æµ‹å€¼å’ŒçœŸå®å€¼çš„è¯¯å·®ã€‚æˆ‘ä»¬å…ˆè€ƒè™‘æœ€ç®€å•çš„æƒ…å†µï¼Œå³è®¡ç®—æŸä¸ªæ ·æœ¬ xï¼Œy=1 å’Œ y=0 ä¸¤ç§æƒ…å†µä¸‹çš„é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„è¯¯å·®ï¼Œæˆ‘ä»¬é€‰æ‹©çš„æŸå¤±å…¬å¼å¦‚ä¸‹ï¼š</p><p>$\operatorname{cost}\left(h_{\theta}(x), y\right)=\left{\begin{array}{ccc}-\log \left(h_{\theta}(x)\right), &amp; \text { if } &amp; y=1 \ -\log \left(1-h_{\theta}(x)\right), &amp; \text { if } &amp; y=0\end{array}\right.$</p><p>å…¶ä¸­ï¼Œ $h_{\theta}(x)$ è¡¨ç¤ºé¢„æµ‹ä¸º1çš„æ¦‚ç‡ï¼Œlog(x)ä¸ºè‡ªç„¶å¯¹æ•°ã€‚å¦‚å›¾æ‰€ç¤º</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630141514106.png" alt="img"></p><p>æ ¹æ®æŸå¤±å‡½æ•°çš„å®šä¹‰ï¼ŒæŸå¤±æ˜¯é¢„æµ‹å€¼ä¸çœŸå®å€¼çš„å·®å¼‚ã€‚å½“å·®å¼‚è¶Šå¤§æ—¶ï¼ŒæŸå¤±è¶Šå¤§ï¼Œæ¨¡å‹å—åˆ°çš„â€œæƒ©ç½šâ€ä¹Ÿè¶Šä¸¥é‡ã€‚åœ¨å·¦å›¾ä¸­ï¼Œå½“ y=1 æ—¶ï¼Œéšç€ï¼ˆé¢„æµ‹ä¸º1çš„æ¦‚ç‡ï¼‰è¶Šæ¥è¶Šå¤§ï¼Œé¢„æµ‹å€¼è¶Šæ¥è¶Šæ¥è¿‘çœŸå®å€¼ï¼Œå…¶æŸå¤±è¶Šæ¥è¶Šå°ï¼›åœ¨å³å›¾ä¸­ï¼Œå½“ y=0 æ—¶ï¼Œéšç€ï¼ˆé¢„æµ‹ä¸º1çš„æ¦‚ç‡ï¼‰è¶Šæ¥è¶Šå¤§ï¼Œé¢„æµ‹å€¼è¶Šæ¥è¶Šåç¦»çœŸå®å€¼ï¼Œå…¶æŸå¤±è¶Šæ¥è¶Šå¤§ã€‚</p><h3 id="2-4-æ¢¯åº¦ä¸‹é™ç®—æ³•"><a href="#2-4-æ¢¯åº¦ä¸‹é™ç®—æ³•" class="headerlink" title="2.4 æ¢¯åº¦ä¸‹é™ç®—æ³•"></a>2.4 æ¢¯åº¦ä¸‹é™ç®—æ³•</h3><p>å’Œçº¿æ€§å›å½’ç±»ä¼¼ï¼Œè¿™é‡Œä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æ¥æ±‚è§£é€»è¾‘å›å½’æ¨¡å‹å‚æ•°ã€‚å…·ä½“å¯è§ä¸Šä¸€èŠ‚ <a href="https://dongzhougu.github.io/2020/06/30/scikit-learn-xi-lie-san-xian-xing-hui-gui/">çº¿æ€§å›å½’å›å½’ç®—æ³•</a>ã€‚</p><h2 id="3-å¤šå…ƒåˆ†ç±»"><a href="#3-å¤šå…ƒåˆ†ç±»" class="headerlink" title="3. å¤šå…ƒåˆ†ç±»"></a>3. å¤šå…ƒåˆ†ç±»</h2><p>é€»è¾‘å›å½’æ¨¡å‹å¯ä»¥è§£å†³äºŒå…ƒåˆ†ç±»é—®é¢˜ï¼Œå³ y={0,1}ï¼Œèƒ½ä¸èƒ½è§£å†³å¤šå…ƒåˆ†ç±»é—®é¢˜å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚é’ˆå¯¹å¤šå…ƒåˆ†ç±»é—®é¢˜ï¼Œy={0,1,2,3,â€¦,n}ï¼Œæ€»å…±æœ‰n+1ä¸ªç±»åˆ«ã€‚å…¶è§£å†³æ€è·¯æ˜¯ï¼šé¦–å…ˆæŠŠé—®é¢˜è½¬æ¢ä¸ºäºŒå…ƒåˆ†ç±»é—®é¢˜ï¼Œå³y=0æ˜¯ä¸€ä¸ªç±»åˆ«ï¼Œy={1,2,3,â€¦,n}ä½œä¸ºå¦å¤–ä¸€ä¸ªç±»åˆ«ï¼Œç„¶åè®¡ç®—è¿™ä¸¤ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼›æ¥ç€ï¼ŒæŠŠy=1ä½œä¸ºä¸€ä¸ªç±»åˆ«ï¼ŒæŠŠy={0,2,3,â€¦,n}ä½œä¸ºå¦å¤–ä¸€ä¸ªç±»åˆ«ï¼Œå†è®¡ç®—è¿™ä¸¤ä¸ªç±»åˆ«çš„æ¦‚ç‡ã€‚</p><h2 id="4-æ­£åˆ™åŒ–"><a href="#4-æ­£åˆ™åŒ–" class="headerlink" title="4. æ­£åˆ™åŒ–"></a>4. æ­£åˆ™åŒ–</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œè¿‡æ‹Ÿåˆæ˜¯æŒ‡æ¨¡å‹å¾ˆå¥½åœ°æ‹Ÿåˆäº†è®­ç»ƒæ ·æœ¬ï¼Œä½†å¯¹æ–°æ•°æ®é¢„æµ‹çš„å‡†ç¡®æ€§å¾ˆå·®ï¼Œè¿™æ˜¯å› ä¸ºæ¨¡å‹å¤ªå¤æ‚äº†ã€‚è§£å†³åŠæ³•æ˜¯å‡å°‘è¾“å…¥ç‰¹å¾çš„ä¸ªæ•°ï¼Œæˆ–è€…è·å–æ›´å¤šçš„è®­ç»ƒæ ·æœ¬ã€‚è¿™é‡Œä»‹ç»çš„æ­£åˆ™åŒ–ä¹Ÿå¯ä»¥ç”¨æ¥è§£å†³è¿‡æ‹Ÿåˆé—®é¢˜ï¼š</p><ul><li><p>ä¿ç•™æ‰€æœ‰çš„ç‰¹å¾ï¼Œå‡å°‘ç‰¹å¾çš„æƒé‡ $\theta_{j} $ çš„å€¼ã€‚ç¡®ä¿æ‰€æœ‰çš„ç‰¹å¾å¯¹é¢„æµ‹å€¼éƒ½æœ‰å°‘é‡çš„è´¡çŒ®ã€‚</p></li><li><p>å½“æ¯ä¸ªç‰¹å¾ $x_{j} $ å¯¹é¢„æµ‹å€¼yéƒ½æœ‰å°‘é‡çš„è´¡çŒ®æ—¶ï¼Œè¿™æ ·çš„æ¨¡å‹å¯ä»¥è‰¯å¥½çš„å·¥ä½œï¼Œè¿™æ­£æ˜¯æ­£åˆ™åŒ–çš„ç›®çš„ï¼Œå¯ä»¥ç”¨å®ƒæ¥è§£å†³ç‰¹å¾è¿‡å¤šæ—¶çš„è¿‡æ‹Ÿåˆé—®é¢˜ã€‚</p></li></ul><h3 id="4-1-çº¿æ€§å›å½’æ¨¡å‹æ­£åˆ™åŒ–"><a href="#4-1-çº¿æ€§å›å½’æ¨¡å‹æ­£åˆ™åŒ–" class="headerlink" title="4.1 çº¿æ€§å›å½’æ¨¡å‹æ­£åˆ™åŒ–"></a>4.1 çº¿æ€§å›å½’æ¨¡å‹æ­£åˆ™åŒ–</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹çº¿æ€§å›å½’æ¨¡å‹çš„æŸå¤±å‡½æ•°æ˜¯å¦‚ä½•æ­£åˆ™åŒ–çš„ï¼š<br>$$<br>J(\theta)=\frac{1}{2 m} \sum_{i=1}^{m}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right)^{2}+\lambda \sum_{j=1}^{n} \theta_{j}^{2}<br>$$<br>å…¬å¼ä¸­å‰åŠéƒ¨åˆ†å°±æ˜¯åŸæ¥çš„çº¿æ€§å›å½’æ¨¡å‹çš„æŸå¤±å‡½æ•°ï¼Œä¹Ÿç§°ä¸ºé¢„æµ‹å€¼ä¸å®é™…å€¼çš„è¯¯å·®ã€‚ååŠéƒ¨åˆ†ä¸ºåŠ å…¥çš„æ­£åˆ™é¡¹ã€‚å…¶ä¸­ $\lambda $ çš„å€¼æœ‰ä¸¤ä¸ªç›®çš„ï¼Œå³è¦ç»´æŒå¯¹è®­ç»ƒæ ·æœ¬çš„æ‹Ÿåˆï¼Œåˆè¦é¿å…å¯¹è®­ç»ƒæ ·æœ¬çš„è¿‡æ‹Ÿåˆã€‚å¦‚æœ  $\lambda $  çš„å€¼å¤ªå¤§ï¼Œåˆ™èƒ½ç¡®ä¿ä¸å‡ºç°è¿‡æ‹Ÿåˆï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´å¯¹ç°æœ‰è®­ç»ƒæ ·æœ¬å‡ºç°æ¬ æ‹Ÿåˆã€‚</p><h3 id="4-2-çº¿æ€§å›å½’æ¨¡å‹æ­£åˆ™åŒ–"><a href="#4-2-çº¿æ€§å›å½’æ¨¡å‹æ­£åˆ™åŒ–" class="headerlink" title="4.2 çº¿æ€§å›å½’æ¨¡å‹æ­£åˆ™åŒ–"></a>4.2 çº¿æ€§å›å½’æ¨¡å‹æ­£åˆ™åŒ–</h3><p>åŒæ ·ï¼Œå¯ä»¥å¯¹é€»è¾‘å›å½’æ¨¡å‹çš„æŸå¤±å‡½æ•°è¿›è¡Œæ­£åˆ™åŒ–ï¼Œå…¶æ–¹æ³•ä¹Ÿæ˜¯åœ¨åŸæ¥çš„æŸå¤±å‡½æ•°çš„åŸºç¡€ä¸ŠåŠ ä¸Šæ­£åˆ™é¡¹ï¼š<br>$$<br>J(\theta)=-\frac{1}{m}\left[\sum_{i=1}^{m} y^{(i)} \log \left(h_{\theta}\left(x^{(i)}\right)\right)+\left(1-y^{(i)}\right) \log \left(1-h_{\theta}\left(x^{(i)}\right)\right)\right]+\frac{\lambda}{2 m} \sum_{j=1}^{n} \theta_{j}^{2}<br>$$</p><h2 id="5-ç®—æ³•å‚æ•°"><a href="#5-ç®—æ³•å‚æ•°" class="headerlink" title="5. ç®—æ³•å‚æ•°"></a>5. ç®—æ³•å‚æ•°</h2><p>åœ¨ <code>scikit-learn</code>é‡Œï¼Œé€»è¾‘å›å½’æ¨¡å‹ç”±ç±» <code>sklearn.linear_model.LogisticRegression</code>å®ç°ã€‚</p><h3 id="5-1-æ­£åˆ™é¡¹æƒé‡"><a href="#5-1-æ­£åˆ™é¡¹æƒé‡" class="headerlink" title="5.1 æ­£åˆ™é¡¹æƒé‡"></a>5.1 æ­£åˆ™é¡¹æƒé‡</h3><p>ä¸Šé¢ä»‹ç»çš„æ­£åˆ™é¡¹æƒé‡  $\lambda $  ï¼Œåœ¨<code>LogisticRegression</code>ç±»é‡Œæœ‰ä¸ªå‚æ•° C ä¸ä¹‹å¯¹åº”ï¼Œä½†æˆåæ¯”ã€‚å³ C å€¼è¶Šå¤§ï¼Œ  $\lambda $ è¶Šå°ï¼Œæ¨¡å‹å®¹æ˜“å‡ºç°è¿‡æ‹Ÿåˆï¼›C å€¼è¶Šå°ï¼Œ  $\lambda $  è¶Šå¤§ï¼Œæ¨¡å‹å®¹æ˜“å‡ºç°æ¬ æ‹Ÿåˆã€‚</p><h3 id="5-2-L1-L2èŒƒæ•°"><a href="#5-2-L1-L2èŒƒæ•°" class="headerlink" title="5.2 L1/L2èŒƒæ•°"></a>5.2 L1/L2èŒƒæ•°</h3><p>åˆ›å»ºé€»è¾‘å›å½’æ¨¡å‹æ—¶ï¼Œæœ‰ä¸ªå‚æ•°penaltyï¼ˆæƒ©ç½šï¼‰ï¼Œå…¶å–å€¼æœ‰â€œl1â€æˆ–â€œl2â€</p><ul><li>L1èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ï¼Œä¼šè®©æ¨¡å‹å‚æ•° $\theta$ ç¨€ç–åŒ–ï¼Œå³è®©æ¨¡å‹å‚æ•°å‘é‡é‡Œçš„0å…ƒç´ å°½å¯èƒ½å¤šï¼Œåªä¿ç•™æ¨¡å‹å‚æ•°å‘é‡ä¸­é‡è¦ç‰¹å¾çš„è´¡çŒ®ã€‚</li><li>L2èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ï¼Œåˆ™è®©æ¨¡å‹å‚æ•°å°½é‡å°ï¼Œä½†ä¸ä¼šä¸º0ï¼Œå³å°½é‡è®©æ¯ä¸ªç‰¹å¾å¯¹åº”é¢„æµ‹å€¼éƒ½æœ‰ä¸€äº›å°çš„è´¡çŒ®ã€‚</li></ul><p>å‡è®¾æ¨¡å‹åªæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå®ƒä»¬æ„æˆä¸€ä¸ªäºŒç»´å‘é‡ $\theta=\left[\theta_{1}, \theta_{2}\right]$,åˆ™L1èŒƒæ•°ä¸ºï¼š</p><p>$|\theta|<em>{1}=\left|\theta</em>{1}\right|+\left|\theta_{2}\right|$</p><p>å³L1èŒƒæ•°æ˜¯å‘é‡é‡Œå…ƒç´ çš„ç»å¯¹å€¼ä¹‹å’Œã€‚L2èŒƒæ•°ä¸ºå‘é‡é‡Œæ‰€æœ‰å…ƒç´ çš„å¹³æ–¹å’Œçš„ç®—æœ¯å¹³æ–¹æ ¹ï¼š</p><p>$|\theta|<em>{2}=\sqrt{\theta</em>{1}^{2}+\theta_{2}^{2}}$</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•åœ¨å‚æ•°è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œå®é™…ä¸Šæ˜¯åœ¨æŸå¤±å‡½æ•°çš„ç­‰é«˜çº¿ä¸Šè·³è·ƒï¼Œå¹¶æœ€ç»ˆæ”¶æ•›åœ¨è¯¯å·®æœ€å°çš„ç‚¹ä¸Šã€‚é‚£ä¹ˆæ­£åˆ™é¡¹çš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Ÿæ­£åˆ™é¡¹çš„æœ¬è´¨æ˜¯æƒ©ç½šã€‚åœ¨å‚æ•°è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ²¡æœ‰éµå¾ªæ­£åˆ™é¡¹æ‰€è¡¨è¾¾çš„è§„åˆ™ï¼Œé‚£ä¹ˆå…¶æŸå¤±ä¼šå˜å¤§ï¼Œå³å—åˆ°äº†æƒ©ç½šï¼Œä»è€Œå¾€æ­£åˆ™é¡¹æ‰€è¡¨è¾¾çš„è§„åˆ™å¤„æ”¶æ•›ã€‚æ­£åˆ™åŒ–åçš„æ¨¡å‹å‚æ•°åº”è¯¥æ”¶æ•›åœ¨è¯¯å·®ç­‰é«˜çº¿ä¸æ­£åˆ™é¡¹ç­‰é«˜çº¿ç›¸åˆ‡çš„ç‚¹ä¸Šã€‚</p><p>ä½œä¸ºæ¨è®ºï¼ŒL1èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªç”¨é€”ï¼š</p><ul><li>é€‰æ‹©é‡è¦ç‰¹å¾ï¼šL1èŒƒæ•°ä¼šè®©æ¨¡å‹å‚æ•°å‘é‡é‡Œçš„å…ƒç´ ä¸º0çš„ç‚¹å°½é‡å¤šï¼Œè¿™æ ·å¯ä»¥æ’é™¤æ‰é‚£äº›å¯¹é¢„æµ‹å€¼æ²¡æœ‰ä»€ä¹ˆå½±å“çš„ç‰¹å¾ï¼Œä»è€Œç®€åŒ–é—®é¢˜ã€‚æ‰€ä»¥L1èŒƒæ•°è§£å†³è¿‡æ‹Ÿåˆï¼Œå®é™…ä¸Šæ˜¯å‡å°‘ç‰¹å¾æ•°é‡ã€‚</li><li>æ¨¡å‹å¯è§£é‡Šæ€§å¥½ï¼šæ¨¡å‹å‚æ•°å‘é‡ç¨€ç–åŒ–åï¼Œåªä¼šç•™ä¸‹é‚£äº›å¯¹é¢„æµ‹å€¼æœ‰é‡è¦å½±å“çš„ç‰¹å¾ã€‚è¿™æ ·æˆ‘ä»¬å°±å®¹æ˜“è§£é‡Šæ¨¡å‹çš„å› æœå…³ç³»ã€‚æ¯”å¦‚ï¼Œé’ˆå¯¹æŸç§ç™Œç—‡çš„ç­›æŸ¥ï¼Œå¦‚æœæœ‰100ä¸ªç‰¹å¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ— ä»è§£é‡Šåˆ°åº•å“ªäº›ç‰¹å¾å¯¹é˜³æ€§å‘ˆå…³é”®ä½œç”¨ã€‚ç¨€ç–åŒ–åï¼Œåªç•™ä¸‹å‡ ä¸ªå…³é”®çš„ç‰¹å¾ï¼Œå°±å®¹æ˜“çœ‹åˆ°å› æœå…³ç³»ã€‚</li></ul><p>ç”±æ­¤å¯è§ï¼ŒL1èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ï¼Œæ›´å¤šçš„æ˜¯ä¸€ä¸ªåˆ†æå·¥å…·ï¼Œè€Œé€‚åˆç”¨æ¥å¯¹æ¨¡å‹æ±‚è§£ã€‚å› ä¸ºå®ƒä¼šæŠŠä¸é‡è¦çš„ç‰¹å¾ç›´æ¥å»é™¤ã€‚å¤§éƒ¨åˆ†çš„æƒ…å†µä¸‹è§£å†³è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œè¿˜æ˜¯é€‰æ‹©L2èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ï¼Œè¿™ä¹Ÿæ˜¯ <code>scikit-learn</code> é‡Œçš„é»˜è®¤å€¼ã€‚</p><h2 id="6-ç¤ºä¾‹ï¼šä¹³è…ºç™Œæ£€æµ‹"><a href="#6-ç¤ºä¾‹ï¼šä¹³è…ºç™Œæ£€æµ‹" class="headerlink" title="6 ç¤ºä¾‹ï¼šä¹³è…ºç™Œæ£€æµ‹"></a>6 ç¤ºä¾‹ï¼šä¹³è…ºç™Œæ£€æµ‹</h2><p>æœ¬èŠ‚æ¥çœ‹ä¸€ä¸ªå®ä¾‹ï¼Œä½¿ç”¨é€»è¾‘å›å½’ç®—æ³•è§£å†³ä¹³è…ºç™Œæ£€æµ‹é—®é¢˜ã€‚æˆ‘ä»¬éœ€è¦å…ˆé‡‡é›†è‚¿ç˜¤ç—…ç¶é€ å½±å›¾ç‰‡ï¼Œç„¶åå¯¹å›¾ç‰‡è¿›è¡Œåˆ†æï¼Œä»å›¾ç‰‡ä¸­æå–ç‰¹å¾ï¼Œå†æ ¹æ®ç‰¹å¾æ¥è®­ç»ƒæ¨¡å‹ã€‚æœ€ç»ˆä½¿ç”¨æ¨¡å‹æ¥æ£€æµ‹æ–°é‡‡é›†åˆ°çš„è‚¿ç˜¤ç—…ç¶é€ å½±ï¼Œä»¥ä¾¿åˆ¤æ–­è‚¿ç˜¤æ˜¯è‰¯æ€§çš„è¿˜æ˜¯æ¶æ€§çš„ã€‚è¿™æ˜¯ä¸ªå…¸å‹çš„äºŒå…ƒåˆ†ç±»é—®é¢˜ã€‚</p><h3 id="6-1-æ•°æ®é‡‡é›†åŠç‰¹å¾æå–"><a href="#6-1-æ•°æ®é‡‡é›†åŠç‰¹å¾æå–" class="headerlink" title="6.1 æ•°æ®é‡‡é›†åŠç‰¹å¾æå–"></a>6.1 æ•°æ®é‡‡é›†åŠç‰¹å¾æå–</h3><p>ä¸ºäº†ç®€å•èµ·è§ï¼Œç›´æ¥åŠ è½½ <code>scikit-learn</code> è‡ªå¸¦çš„ä¸€ä¸ªä¹³è…ºç™Œæ•°æ®é›†ã€‚è¿™ä¸ªæ•°æ®é›†æ˜¯å·²ç»é‡‡é›†åçš„æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_breast_cancercancer <span class="token operator">=</span> load_breast_cancer<span class="token punctuation">(</span><span class="token punctuation">)</span>X <span class="token operator">=</span> cancer<span class="token punctuation">.</span>datay <span class="token operator">=</span> cancer<span class="token punctuation">.</span>target<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'data shape: {0}; no. positive: {1}; no. negative: {2}'</span>      <span class="token punctuation">.</span>format<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>y<span class="token punctuation">[</span>y<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y<span class="token punctuation">[</span>y<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cancer<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">data shape<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">569</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span> no<span class="token punctuation">.</span> positive<span class="token punctuation">:</span> <span class="token number">357</span><span class="token punctuation">;</span> no<span class="token punctuation">.</span> negative<span class="token punctuation">:</span> <span class="token number">212</span><span class="token punctuation">[</span><span class="token number">1.799e+01</span> <span class="token number">1.038e+01</span> <span class="token number">1.228e+02</span> <span class="token number">1.001e+03</span> <span class="token number">1.184e-01</span> <span class="token number">2.776e-01</span> <span class="token number">3.001e-01</span> <span class="token number">1.471e-01</span> <span class="token number">2.419e-01</span> <span class="token number">7.871e-02</span> <span class="token number">1.095e+00</span> <span class="token number">9.053e-01</span> <span class="token number">8.589e+00</span> <span class="token number">1.534e+02</span> <span class="token number">6.399e-03</span> <span class="token number">4.904e-02</span> <span class="token number">5.373e-02</span> <span class="token number">1.587e-02</span> <span class="token number">3.003e-02</span> <span class="token number">6.193e-03</span> <span class="token number">2.538e+01</span> <span class="token number">1.733e+01</span> <span class="token number">1.846e+02</span> <span class="token number">2.019e+03</span> <span class="token number">1.622e-01</span> <span class="token number">6.656e-01</span> <span class="token number">7.119e-01</span> <span class="token number">2.654e-01</span> <span class="token number">4.601e-01</span> <span class="token number">1.189e-01</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ•°æ®é›†ä¸­æ€»å…±æœ‰569ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰30ä¸ªç‰¹å¾ï¼Œå…¶ä¸­357ä¸ªé˜³æ€§ï¼ˆy=1ï¼‰æ ·æœ¬ï¼Œ212ä¸ªé˜´æ€§ï¼ˆy=0ï¼‰æ ·æœ¬ã€‚åŒæ—¶ï¼Œè¿˜æ‰“å°å‡ºä¸€ä¸ªæ ·æœ¬æ•°æ®ï¼Œä»¥ä¾¿ç›´è§‚åœ°è¿›è¡Œè§‚å¯Ÿã€‚</p><p>è¿™30ä¸ªç‰¹å¾æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿè¿™ä¸ªæ•°æ®é›†æ€»å…±ä»ç—…ç¶é€ å½±å›¾ç‰‡ä¸­æå–äº†ä»¥ä¸‹10ä¸ªå…³é”®å±æ€§ï¼š</p><ul><li>radiusï¼šåŠå¾„ï¼Œå³ç—…ç¶ä¸­å¿ƒç‚¹ç¦»è¾¹ç•Œçš„å¹³å‡è·ç¦»ã€‚</li><li>textureï¼šçº¹ç†ï¼Œç°åº¦å€¼çš„æ ‡å‡†åå·®ã€‚</li><li>perimeterï¼šå‘¨é•¿ï¼Œå³ç—…ç¶çš„å¤§å°ã€‚</li><li>areaï¼šé¢ç§¯ï¼Œä¹Ÿæ˜¯åæ˜ ç—…ç¶å¤§å°çš„ä¸€ä¸ªæŒ‡æ ‡ã€‚</li><li>smoothnessï¼šå¹³æ»‘åº¦ï¼Œå³åŠå¾„çš„å˜åŒ–å¹…åº¦ã€‚</li><li>compactnessï¼šå¯†å®åº¦ï¼Œå‘¨é•¿çš„å¹³æ–¹é™¤ä»¥é¢ç§¯ï¼Œå†å‡å»1</li><li>concavityï¼šå‡¹åº¦ï¼Œå‡¹é™·éƒ¨åˆ†è½®å»“çš„ä¸¥é‡ç¨‹åº¦ã€‚</li><li>concave pointsï¼šå‡¹ç‚¹ï¼Œå‡¹é™·è½®å»“çš„æ•°é‡ã€‚</li><li>symmetryï¼šå¯¹ç§°æ€§ã€‚</li><li>fractal demensionï¼šåˆ†å½¢ç»´åº¦ã€‚</li></ul><p>å®é™…ä¸Šå®ƒåªå…³æ³¨10ä¸ªç‰¹å¾ï¼Œç„¶ååˆæ„é€ å‡ºäº†æ¯ä¸ªç‰¹å¾çš„æ ‡å‡†å·®åŠæœ€å¤§å€¼ï¼Œè¿™æ ·æ¯ä¸ªç‰¹å¾å°±è¡ç”Ÿå‡ºäº†ä¸¤ä¸ªç‰¹å¾ï¼Œæ‰€ä»¥æ€»å…±å°±æœ‰äº†30ä¸ªç‰¹å¾ã€‚å¯ä»¥é€šè¿‡ <code>cancer.feature_names</code> å˜é‡æ¥æŸ¥çœ‹è¿™äº›ç‰¹å¾çš„åç§°ã€‚</p><h3 id="6-2-æ¨¡å‹è®­ç»ƒ"><a href="#6-2-æ¨¡å‹è®­ç»ƒ" class="headerlink" title="6.2 æ¨¡å‹è®­ç»ƒ"></a>6.2 æ¨¡å‹è®­ç»ƒ</h3><p>é¦–å…ˆï¼ŒæŠŠæ•°æ®é›†åˆ†æˆè®­ç»ƒæ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_splitX_train<span class="token punctuation">,</span>X_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç„¶åä½¿ç”¨ <code>LogisticRegression</code> æ¨¡å‹æ¥è®­ç»ƒï¼Œå¹¶è®¡ç®—è®­ç»ƒæ•°æ®é›†çš„è¯„åˆ†æ•°æ®å’Œæµ‹è¯•æ•°æ®é›†çš„è¯„åˆ†æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegressionmodel <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>train_score <span class="token operator">=</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>test_score <span class="token operator">=</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'train score: {train_score:.6f}; test_score:{test_score:.6f}'</span>      <span class="token punctuation">.</span>format<span class="token punctuation">(</span>train_score<span class="token operator">=</span>train_score<span class="token punctuation">,</span>             test_score<span class="token operator">=</span>test_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css">train <span class="token property">score</span><span class="token punctuation">:</span> <span class="token number">0.940659</span><span class="token punctuation">;</span> <span class="token property">test_score</span><span class="token punctuation">:</span><span class="token number">0.964912</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è§‚å¯Ÿæ¨¡å‹åœ¨æµ‹è¯•æ ·æœ¬é›†çš„è¡¨ç°ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npy_pred <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'matchs: {0}/{1}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>np<span class="token punctuation">.</span>equal<span class="token punctuation">(</span>y_pred<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>y_test<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">matchs<span class="token punctuation">:</span> <span class="token number">114</span><span class="token operator">/</span><span class="token number">114</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ€»å…±114ä¸ªæµ‹è¯•æ ·æœ¬ï¼Œå…¨éƒ¨é¢„æµ‹æ­£ç¡®ã€‚ä¸ºä»€ä¹ˆ <code>testscore</code> å´åªæœ‰0.973684ï¼Œè€Œä¸æ˜¯1å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œ<code>scikit-learn</code>ä¸æ˜¯ä½¿ç”¨è¿™ä¸ªæ•°æ®æ¥è®¡ç®—åˆ†æ•°ï¼Œå› ä¸ºè¿™ä¸ªæ•°æ®ä¸èƒ½å®Œå…¨åæ˜ è¯¯å·®æƒ…å†µï¼Œè€Œæ˜¯ä½¿ç”¨é¢„æµ‹æ¦‚ç‡æ•°æ®è®¡ç®—æ¨¡å‹è¯„åˆ†ã€‚</p><p>é’ˆå¯¹äºŒå…ƒåˆ†ç±»é—®é¢˜ï¼Œ<code>LogisticRegression</code>æ¨¡å‹ä¼šå¯¹æ¯ä¸ªæ ·æœ¬è¾“å‡ºä¸¤ä¸ªæ¦‚ç‡ï¼Œå³ä¸º 0 çš„æ¦‚ç‡å’Œä¸º 1 çš„æ¦‚ç‡ï¼Œå“ªä¸ªæ¦‚ç‡é«˜å°±é¢„æµ‹ä¸ºå“ªä¸ªç±»åˆ«ã€‚</p><p>æ‰¾å‡ºæµ‹è¯•æ•°æ®é›†ä¸­é¢„æµ‹â€œè‡ªä¿¡åº¦â€ä½äº90%çš„æ ·æœ¬ã€‚è¿™é‡Œå…ˆè®¡ç®—å‡ºæµ‹è¯•æ•°æ®é›†é‡Œçš„æ¯ä¸ªæ ·æœ¬çš„é¢„æµ‹æ¦‚ç‡æ•°æ®ï¼Œé’ˆå¯¹æ¯ä¸ªæ ·æœ¬ï¼Œå®ƒä¼šæœ‰ä¸¤ä¸ªæ•°æ®ï¼Œä¸€æ˜¯é¢„æµ‹å…¶ä¸ºé˜³æ€§çš„æ¦‚ç‡ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯é¢„æµ‹å…¶ä¸ºé˜´æ€§çš„æ¦‚ç‡ã€‚æ¥ç€æ‰¾å‡ºé¢„æµ‹ä¸ºé˜´æ€§çš„æ¦‚ç‡å¤§äº0.1ä¸”å°äº0.9çš„æ ·æœ¬ï¼ˆåŒæ—¶ä¹Ÿæ˜¯é¢„æµ‹ä¸ºé˜³æ€§çš„æ¦‚ç‡å¤§äº0.1å°äº0.9ï¼‰ï¼Œè¿™äº›æ ·æœ¬å°±æ˜¯â€œè‡ªä¿¡åº¦â€ä¸è¶³90%çš„æ ·æœ¬ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># é¢„æµ‹æ¦‚ç‡ï¼šæ‰¾å‡ºé¢„æµ‹æ¦‚ç‡ä½äº 90% çš„æ ·æœ¬</span>y_pred_proba <span class="token operator">=</span> model<span class="token punctuation">.</span>predict_proba<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># è®¡ç®—æ¯ä¸ªæµ‹è¯•æ ·æœ¬çš„é¢„æµ‹æ¦‚ç‡</span><span class="token comment" spellcheck="true"># æ‰¾å‡ºç¬¬ä¸€åˆ—ï¼Œå³é¢„æµ‹ä¸ºé˜´æ€§çš„æ¦‚ç‡å¤§äº 0.1 çš„æ ·æœ¬ï¼Œä¿å­˜åœ¨ result é‡Œ</span>y_pred_proba_0 <span class="token operator">=</span> y_pred_proba<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0.1</span>result <span class="token operator">=</span> y_pred_proba<span class="token punctuation">[</span>y_pred_proba_0<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># åœ¨ result ç»“æœé›†é‡Œï¼Œæ‰¾å‡ºç¬¬äºŒåˆ—ï¼Œå³é¢„æµ‹ä¸ºé˜³æ€§çš„æ¦‚ç‡å¤§äº 0.1 çš„æ ·æœ¬</span>y_pred_proba_1 <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0.1</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span>y_pred_proba_1<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0.29623162</span> <span class="token number">0.70376838</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.54660262</span> <span class="token number">0.45339738</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.17874247</span> <span class="token number">0.82125753</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.20917573</span> <span class="token number">0.79082427</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.10943452</span> <span class="token number">0.89056548</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.35503614</span> <span class="token number">0.64496386</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.23849987</span> <span class="token number">0.76150013</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.13634228</span> <span class="token number">0.86365772</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.80171734</span> <span class="token number">0.19828266</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.21744759</span> <span class="token number">0.78255241</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.81346356</span> <span class="token number">0.18653644</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.2225791</span>  <span class="token number">0.7774209</span> <span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.10788007</span> <span class="token number">0.89211993</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.88068005</span> <span class="token number">0.11931995</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">0.18189724</span> <span class="token number">0.81810276</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±æ­¤å¯è§ï¼Œè®¡ç®—é¢„æµ‹æ¦‚ç‡ä½¿ç”¨model.predict_proba()å‡½æ•°ï¼Œè€Œè®¡ç®—é¢„æµ‹åˆ†ç±»ç”¨model.predict()å‡½æ•°ã€‚</p><h3 id="6-3-æ¨¡å‹ä¼˜åŒ–"><a href="#6-3-æ¨¡å‹ä¼˜åŒ–" class="headerlink" title="6.3 æ¨¡å‹ä¼˜åŒ–"></a>6.3 æ¨¡å‹ä¼˜åŒ–</h3><p>é¦–å…ˆï¼Œä½¿ç”¨Pipelineæ¥å¢åŠ å¤šé¡¹å¼ç‰¹å¾ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LogisticRegression<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> PolynomialFeatures<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> Pipeline<span class="token comment" spellcheck="true"># å¢åŠ å¤šé¡¹å¼é¢„å¤„ç†</span><span class="token keyword">def</span> <span class="token function">polynomial_model</span><span class="token punctuation">(</span>degree<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwarg<span class="token punctuation">)</span><span class="token punctuation">:</span>    polynomial_features <span class="token operator">=</span> PolynomialFeatures<span class="token punctuation">(</span>degree<span class="token operator">=</span>degree<span class="token punctuation">,</span>                                             include_bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    logistic_regression <span class="token operator">=</span> LogisticRegression<span class="token punctuation">(</span><span class="token operator">**</span>kwarg<span class="token punctuation">)</span>    pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"polynomial_features"</span><span class="token punctuation">,</span> polynomial_features<span class="token punctuation">)</span><span class="token punctuation">,</span>                         <span class="token punctuation">(</span><span class="token string">"logistic_regression"</span><span class="token punctuation">,</span> logistic_regression<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> pipeline<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€ï¼Œå¢åŠ äºŒé˜¶å¤šé¡¹å¼ç‰¹å¾ï¼Œåˆ›å»ºå¹¶è®­ç»ƒæ¨¡å‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> timemodel <span class="token operator">=</span> polynomial_model<span class="token punctuation">(</span>degree<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> penalty<span class="token operator">=</span><span class="token string">'l1'</span><span class="token punctuation">,</span> solver<span class="token operator">=</span><span class="token string">'liblinear'</span><span class="token punctuation">)</span>start <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>train_score <span class="token operator">=</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>test_score <span class="token operator">=</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'elaspe: {0:.6f}; train_score: {1:0.6f}; cv_score: {2:.6f}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>    time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">,</span> train_score<span class="token punctuation">,</span> test_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨L1èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ï¼ˆå‚æ•°penalty=â€™l1â€™ï¼‰ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">elaspe<span class="token punctuation">:</span> <span class="token number">0.156250</span><span class="token punctuation">;</span> train_score<span class="token punctuation">:</span> <span class="token number">1.000000</span><span class="token punctuation">;</span> cv_score<span class="token punctuation">:</span> <span class="token number">0.956140</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œè®­ç»ƒæ•°æ®é›†è¯„åˆ†å’Œæµ‹è¯•æ•°æ®é›†è¯„åˆ†éƒ½å¢åŠ äº†ã€‚ä¸ºä»€ä¹ˆä½¿ç”¨L1èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹å‘¢ï¼ŸL1èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹å¯ä»¥å®ç°å‚æ•°çš„ç¨€ç–åŒ–ï¼Œå³è‡ªåŠ¨é€‰æ‹©å‡ºé‚£äº›å¯¹æ¨¡å‹æœ‰å…³è”çš„é‡è¦ç‰¹å¾ã€‚</p><pre class="line-numbers language-python"><code class="language-python">logistic_regression <span class="token operator">=</span> model<span class="token punctuation">.</span>named_steps<span class="token punctuation">[</span><span class="token string">'logistic_regression'</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'model parameters shape: {0}; count of non-zero element: {1}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>    logistic_regression<span class="token punctuation">.</span>coef_<span class="token punctuation">.</span>shape<span class="token punctuation">,</span>     np<span class="token punctuation">.</span>count_nonzero<span class="token punctuation">(</span>logistic_regression<span class="token punctuation">.</span>coef_<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">model parameters shape<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">495</span><span class="token punctuation">)</span><span class="token punctuation">;</span> count of non<span class="token operator">-</span>zero element<span class="token punctuation">:</span> <span class="token number">110</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é€»è¾‘å›å½’æ¨¡å‹çš„coef_å±æ€§é‡Œä¿å­˜çš„å°±æ˜¯æ¨¡å‹å‚æ•°ã€‚ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹åˆ°ï¼Œå¢åŠ äºŒé˜¶å¤šé¡¹å¼ç‰¹å¾åï¼Œè¾“å…¥ç‰¹å¾ç”±åŸæ¥çš„30ä¸ªå¢åŠ åˆ°äº†495ä¸ªï¼Œæœ€ç»ˆå¤§å¤šæ•°ç‰¹å¾éƒ½è¢«ä¸¢å¼ƒï¼Œåªä¿ç•™äº†110ä¸ªæœ‰æ•ˆç‰¹å¾ã€‚</p><h3 id="6-4-å­¦ä¹ æ›²çº¿"><a href="#6-4-å­¦ä¹ æ›²çº¿" class="headerlink" title="6.4 å­¦ä¹ æ›²çº¿"></a>6.4 å­¦ä¹ æ›²çº¿</h3><p>é¦–å…ˆç”»å‡ºä½¿ç”¨L1èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹æ‰€å¯¹åº”çš„ä¸€é˜¶å’ŒäºŒé˜¶å¤šé¡¹å¼çš„å­¦ä¹ æ›²çº¿ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> utils <span class="token keyword">import</span> plot_learning_curve<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> ShuffleSplit<span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> pltcv <span class="token operator">=</span> ShuffleSplit<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>title <span class="token operator">=</span> <span class="token string">'Learning Curves (degree={0}, penalty={1})'</span>degrees <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>penalty <span class="token operator">=</span> <span class="token string">'l1'</span>start <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    plot_learning_curve<span class="token punctuation">(</span>plt<span class="token punctuation">,</span> polynomial_model<span class="token punctuation">(</span>degree<span class="token operator">=</span>degrees<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> penalty<span class="token operator">=</span>penalty<span class="token punctuation">,</span> solver<span class="token operator">=</span><span class="token string">'liblinear'</span><span class="token punctuation">,</span> max_iter<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                         title<span class="token punctuation">.</span>format<span class="token punctuation">(</span>degrees<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> penalty<span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> ylim<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">1.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv<span class="token operator">=</span>cv<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'elaspe: {0:.6f}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">l1_elaspe<span class="token punctuation">:</span> <span class="token number">10.781250</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>L1èŒƒæ•°å­¦ä¹ æ›²çº¿å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-08d8944e88c2ae64.png" alt="image-20200630141514106"></p><p>æ¥ç€ç”»å‡ºä½¿ç”¨L2èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹æ‰€å¯¹åº”çš„ä¸€é˜¶å’ŒäºŒé˜¶å¤šé¡¹å¼çš„å­¦ä¹ æ›²çº¿ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">"ignore"</span><span class="token punctuation">)</span>penalty <span class="token operator">=</span> <span class="token string">'l2'</span>start <span class="token operator">=</span> time<span class="token punctuation">.</span>clock<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>    plot_learning_curve<span class="token punctuation">(</span>plt<span class="token punctuation">,</span> polynomial_model<span class="token punctuation">(</span>degree<span class="token operator">=</span>degrees<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> penalty<span class="token operator">=</span>penalty<span class="token punctuation">,</span> solver<span class="token operator">=</span><span class="token string">'lbfgs'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                         title<span class="token punctuation">.</span>format<span class="token punctuation">(</span>degrees<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> penalty<span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> ylim<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">1.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv<span class="token operator">=</span>cv<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'elaspe: {0:.6f}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">.</span>clock<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">l2_elaspe<span class="token punctuation">:</span> <span class="token number">2.718750</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>L2èŒƒæ•°å­¦ä¹ æ›²çº¿å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630141743010.png" alt="image-20200630141743010"></p><p>å¯ä»¥æ˜æ˜¾åœ°çœ‹å‡ºï¼Œä½¿ç”¨äºŒé˜¶å¤šé¡¹å¼å¹¶ä½¿ç”¨L1èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹çš„æ¨¡å‹æœ€ä¼˜ï¼Œå› ä¸ºå®ƒçš„è®­ç»ƒæ ·æœ¬è¯„åˆ†æœ€é«˜ï¼Œäº¤å‰éªŒè¯æ ·æœ¬è¯„åˆ†ä¹Ÿæœ€é«˜ã€‚ä»å›¾ä¸­è¿˜å¯ä»¥çœ‹å‡ºï¼Œè®­ç»ƒæ ·æœ¬è¯„åˆ†å’Œäº¤å‰éªŒè¯æ ·æœ¬è¯„åˆ†ä¹‹é—´çš„é—´éš™è¿˜æ¯”è¾ƒå¤§ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡é›†æ›´å¤šçš„æ•°æ®æ¥è®­ç»ƒæ¨¡å‹ï¼Œä»¥ä¾¿è¿›ä¸€æ­¥ä¼˜åŒ–æ¨¡å‹ã€‚</p><p>å¦å¤–ä»è¾“å‡ºçš„æ—¶é—´å¯ä»¥çœ‹å‡ºï¼ŒL1 èŒƒæ•°å¯¹åº”çš„å­¦ä¹ æ›²çº¿ï¼Œéœ€è¦èŠ±è´¹è¾ƒé•¿çš„æ—¶é—´ï¼ŒåŸå› æ˜¯ï¼Œ<code>scikit-learn</code> çš„<code>learning_curve()</code> å‡½æ•°åœ¨ç”»å­¦ä¹ æ›²çº¿çš„è¿‡ç¨‹ä¸­ï¼Œè¦å¯¹æ¨¡å‹è¿›è¡Œå¤šæ¬¡è®­ç»ƒï¼Œå¹¶è®¡ç®—äº¤å‰éªŒè¯æ ·æœ¬è¯„åˆ†ã€‚åŒæ—¶ï¼Œä¸ºäº†ä½¿æ›²çº¿æ›´å¹³æ»‘ï¼Œé’ˆå¯¹æ¯ä¸ªç‚¹è¿˜ä¼šè¿›è¡Œå¤šæ¬¡è®¡ç®—æ±‚å¹³å‡å€¼ã€‚è¿™ä¸ªå°±æ˜¯ <code>ShuffleSplit</code> ç±»çš„ä½œç”¨ã€‚åœ¨æˆ‘ä»¬è¿™ä¸ªå®ä¾‹é‡Œï¼Œåªæœ‰569ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œè¿™æ˜¯ä¸ªå¾ˆå°çš„æ•°æ®é›†ã€‚å¦‚æœæ•°æ®é›†å¢åŠ 100å€ï¼Œç”šè‡³1000å€ï¼Œæ‹¿å‡ºæ¥ç”»å­¦ä¹ æ›²çº¿å°†æ˜¯åœºç¾éš¾ã€‚</p><p>é‚£ä¹ˆï¼Œé’ˆå¯¹å¤§æ•°æ®é›†ï¼Œæ€æ ·é«˜æ•ˆåœ°ç”»å­¦ä¹ æ›²çº¿ï¼Ÿç­”æ¡ˆå¾ˆç®€å•ï¼Œå¯ä»¥ä»å¤§æ•°æ®é›†é‡Œé€‰æ‹©ä¸€å°éƒ¨åˆ†æ•°æ®æ¥ç”»å­¦ä¹ æ›²çº¿ï¼Œå¾…é€‰æ‹©å¥½æœ€ä¼˜çš„æ¨¡å‹ä¹‹åï¼Œå†ä½¿ç”¨å…¨éƒ¨çš„æ•°æ®é›†æ¥è®­ç»ƒæ¨¡å‹ã€‚ä½†æ˜¯è¦å°½é‡ä¿æŒé€‰æ‹©å‡ºæ¥çš„è¿™éƒ¨åˆ†æ•°æ®çš„æ ‡ç­¾åˆ†å¸ƒä¸å¤§æ•°æ®é›†çš„æ ‡ç­¾åˆ†å¸ƒç›¸åŒï¼Œå¦‚é’ˆå¯¹äºŒå…ƒåˆ†ç±»ï¼Œé˜³æ€§å’Œé˜´æ€§æ¯”ä¾‹è¦ä¸€è‡´ã€‚æ›´ç›´è§‚çš„è¯´å°±æ˜¯ï¼ŒæŠ½å–å‡ºæ¥çš„æ ·æœ¬é›†ä¸ºåŸæ¥æ•°æ®é›†çš„ä¸€ä¸ªç¼©å½±ï¼Œå°½å¯èƒ½ç›¸ä¼¼ã€‚</p><h2 id="7-æ‹“å±•é˜…è¯»"><a href="#7-æ‹“å±•é˜…è¯»" class="headerlink" title="7.æ‹“å±•é˜…è¯»"></a>7.æ‹“å±•é˜…è¯»</h2><p>å®é™…ä¸Šï¼Œæˆ‘ä»¬çš„é¢„æµ‹å‡½æ•°å°±æ˜¯å†™æˆå‘é‡å½¢å¼çš„ï¼š<br>$$<br>h_{\theta}(x)=g(z)=g\left(\theta^{T} x\right)=\frac{1}{1+e^{-\theta^{T} x}}<br>$$<br>è¿™ä¸ªé¢„æµ‹å‡½æ•°ä¸€æ¬¡åªè®¡ç®—ä¸€ä¸ªè®­ç»ƒæ ·æœ¬çš„é¢„æµ‹å€¼ï¼Œæ€æ ·ä¸€æ¬¡æ€§è®¡ç®—å‡ºæ‰€æœ‰æ ·æœ¬çš„é¢„æµ‹å€¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æŠŠé¢„æµ‹å‡½æ•°çš„å‚æ•°å†™æˆå‘é‡çš„å½¢å¼ï¼š<br>$$<br>h=g(X \theta)<br>$$<br>å…¶ä¸­g(x)ä¸ºSigmoidå‡½æ•°ã€‚Xä¸ºmÃ—nçš„çŸ©é˜µï¼Œå³æ•°æ®é›†çš„çŸ©é˜µè¡¨è¾¾ã€‚æŸå¤±å‡½æ•°ä¹Ÿæœ‰å¯¹åº”çš„çŸ©é˜µå½¢å¼ï¼š<br>$$<br>J(\theta)=\frac{1}{m}\left(-y^{T} \log (h)-(1-y)^{T} \log (1-h)\right)<br>$$<br>å…¶ä¸­ï¼Œyä¸ºç›®æ ‡å€¼å‘é‡ï¼Œhä¸ºä¸€æ¬¡æ€§è®¡ç®—å‡ºæ¥çš„æ‰€æœ‰æ ·æœ¬çš„é¢„æµ‹å€¼ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MLç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scikit-learnç³»åˆ—ä¸‰ï¼šçº¿æ€§å›å½’</title>
      <link href="/2020/06/30/scikit-learn-xi-lie-san-xian-xing-hui-gui/"/>
      <url>/2020/06/30/scikit-learn-xi-lie-san-xian-xing-hui-gui/</url>
      
        <content type="html"><![CDATA[<h2 id="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼"><a href="#é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼" class="headerlink" title="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼"></a>é¡¹ç›®åœ°å€<a href="https://github.com/DongZhouGu/scikit-learn-ml" target="_blank" rel="noopener">ä¼ é€é—¨</a>ï¼Œæ¬¢è¿ star å’Œ fork ï¼</h2><h1 id="çº¿æ€§å›å½’ç®—æ³•"><a href="#çº¿æ€§å›å½’ç®—æ³•" class="headerlink" title="çº¿æ€§å›å½’ç®—æ³•"></a>çº¿æ€§å›å½’ç®—æ³•</h1><p>çº¿æ€§å›å½’ç®—æ³•æ˜¯ä½¿ç”¨çº¿æ€§æ–¹ç¨‹å¯¹æ•°æ®é›†æ‹Ÿåˆçš„ç®—æ³•ï¼Œæœ¬æ–‡ä»å•å˜é‡çº¿æ€§å›å½’ç®—æ³•ã€å¤šå˜é‡çº¿æ€§å›å½’ç®—æ³•ï¼Œå…¶ä¸­æŸå¤±å‡½æ•°ä»¥åŠæ¢¯åº¦ä¸‹é™ç®—æ³•çš„æ¨å¯¼è¿‡ç¨‹ä¼šç”¨åˆ°éƒ¨åˆ†çº¿æ€§ä»£æ•°å’Œåå¯¼æ•°ï¼›æ¥ç€é‡ç‚¹ä»‹ç»äº†æ¢¯åº¦ä¸‹é™ç®—æ³•çš„æ±‚è§£æ­¥éª¤ä»¥åŠæ€§èƒ½ä¼˜åŒ–æ–¹é¢çš„å†…å®¹ï¼›æœ€åé€šè¿‡ä¸€ä¸ªæˆ¿ä»·é¢„æµ‹æ¨¡å‹ï¼Œä»‹ç»äº†çº¿æ€§å›å½’ç®—æ³•æ€§èƒ½ä¼˜åŒ–çš„ä¸€äº›å¸¸ç”¨æ­¥éª¤å’Œæ–¹æ³•ã€‚</p><h2 id="çº¿æ€§å›å½’æ¦‚è¿°"><a href="#çº¿æ€§å›å½’æ¦‚è¿°" class="headerlink" title="çº¿æ€§å›å½’æ¦‚è¿°"></a>çº¿æ€§å›å½’æ¦‚è¿°</h2><p>è¯´åˆ°å›å½’ï¼Œä¸€èˆ¬éƒ½æ˜¯æŒ‡ <code>çº¿æ€§å›å½’(linear regression)</code>ã€‚çº¿æ€§å›å½’æ„å‘³ç€å¯ä»¥å°†è¾“å…¥é¡¹åˆ†åˆ«ä¹˜ä»¥ä¸€äº›å¸¸é‡ï¼Œå†å°†ç»“æœåŠ èµ·æ¥å¾—åˆ°è¾“å‡ºã€‚å›å½’çš„ç›®çš„æ˜¯é¢„æµ‹æ•°å€¼å‹çš„ç›®æ ‡å€¼ï¼Œæœ€ç›´æ¥çš„åŠæ³•æ˜¯ä¾æ®è¾“å…¥å†™å‡ºä¸€ä¸ªç›®æ ‡å€¼çš„è®¡ç®—å…¬å¼ã€‚</p><p>å‡å¦‚ä½ æƒ³è¦é¢„æµ‹å…°åšåŸºå°¼è·‘è½¦çš„åŠŸç‡å¤§å°ï¼Œå¯èƒ½ä¼šè¿™æ ·è®¡ç®—:</p><blockquote><p>HorsePower = 0.0015 * annualSalary - 0.99 * hoursListeningToPublicRadio</p></blockquote><p>è¿™å°±æ˜¯æ‰€è°“çš„ <code>å›å½’æ–¹ç¨‹(regression equation)</code>ï¼Œå…¶ä¸­çš„ 0.0015 å’Œ -0.99 ç§°ä½œ <code>å›å½’ç³»æ•°ï¼ˆregression weightsï¼‰</code>ï¼Œæ±‚è¿™äº›å›å½’ç³»æ•°çš„è¿‡ç¨‹å°±æ˜¯å›å½’ã€‚ä¸€æ—¦æœ‰äº†è¿™äº›å›å½’ç³»æ•°ï¼Œå†ç»™å®šè¾“å…¥ï¼Œåšé¢„æµ‹å°±éå¸¸å®¹æ˜“äº†ã€‚å…·ä½“çš„åšæ³•æ˜¯ç”¨å›å½’ç³»æ•°ä¹˜ä»¥è¾“å…¥å€¼ï¼Œå†å°†ç»“æœå…¨éƒ¨åŠ åœ¨ä¸€èµ·ï¼Œå°±å¾—åˆ°äº†é¢„æµ‹å€¼ã€‚æˆ‘ä»¬è¿™é‡Œæ‰€è¯´çš„ï¼Œå›å½’ç³»æ•°æ˜¯ä¸€ä¸ªå‘é‡ï¼Œè¾“å…¥ä¹Ÿæ˜¯å‘é‡ï¼Œè¿™äº›è¿ç®—ä¹Ÿå°±æ˜¯æ±‚å‡ºäºŒè€…çš„å†…ç§¯ã€‚</p><h2 id="å•å˜é‡çº¿æ€§å›å½’ç®—æ³•"><a href="#å•å˜é‡çº¿æ€§å›å½’ç®—æ³•" class="headerlink" title="å•å˜é‡çº¿æ€§å›å½’ç®—æ³•"></a>å•å˜é‡çº¿æ€§å›å½’ç®—æ³•</h2><p>å…ˆè€ƒè™‘æœ€ç®€å•çš„å•å˜é‡çº¿æ€§å›å½’ç®—æ³•ï¼Œå³åªæœ‰ä¸€ä¸ªè¾“å…¥ç‰¹å¾ã€‚</p><h3 id="é¢„æµ‹å‡½æ•°"><a href="#é¢„æµ‹å‡½æ•°" class="headerlink" title="é¢„æµ‹å‡½æ•°"></a>é¢„æµ‹å‡½æ•°</h3><p>é’ˆå¯¹æ•°æ®é›†xå’Œyï¼Œé¢„æµ‹å‡½æ•°ä¼šæ ¹æ®è¾“å…¥ç‰¹å¾xæ¥è®¡ç®—è¾“å‡ºå€¼h(x)ã€‚å…¶è¾“å…¥å’Œè¾“å‡ºçš„å‡½æ•°å…³ç³»å¦‚ä¸‹ï¼š<br>$$<br>h_{\theta}(x)=\theta_{0}+\theta_{1} x<br>$$</p><p>è¿™ä¸ªæ–¹ç¨‹è¡¨è¾¾çš„æ˜¯ä¸€æ¡ç›´çº¿ã€‚æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯æ„é€ ä¸€ä¸ª $h_{\theta}$ å‡½æ•°ï¼Œæ¥æ˜ å°„æ•°æ®é›†ä¸­çš„è¾“å…¥ç‰¹å¾xå’Œè¾“å‡ºå€¼yï¼Œä½¿å¾—é¢„æµ‹å‡½æ•° $h_{\theta}$ è®¡ç®—å‡ºæ¥çš„å€¼ä¸çœŸå®å€¼yçš„æ•´ä½“è¯¯å·®æœ€å°ã€‚æ„é€   $h_{\theta}$ å‡½æ•°çš„å…³é”®å°±æ˜¯æ‰¾åˆ°åˆé€‚çš„ $\theta_{0}$å’Œ $\theta_{1}$ çš„å€¼ï¼Œ æ¨¡å‹å‚æ•°ï¼Œä¹Ÿå°±æ˜¯æ‰€è¯´çš„æ¨¡å‹å‚æ•°ã€‚</p><p>å‡è®¾æœ‰å¦‚ä¸‹çš„æ•°æ®é›†ï¼š</p><table><thead><tr><th align="center">è¾“å…¥ç‰¹å¾x</th><th align="center">è¾“å‡ºy</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">4</td></tr><tr><td align="center">2</td><td align="center">6</td></tr><tr><td align="center">3</td><td align="center">10</td></tr><tr><td align="center">4</td><td align="center">15</td></tr></tbody></table><p>å‡è®¾æ¨¡å‹å‚æ•° $\theta_{0}=1,  \theta_{1}=3$ ,  åˆ™é¢„æµ‹å‡½æ•°ä¸º $h_{\theta}(x)=1+3 x$ ã€‚é’ˆå¯¹æ•°æ®é›†ä¸­çš„ç¬¬ä¸€ä¸ªæ ·æœ¬ï¼Œè¾“å…¥ä¸º1ï¼Œæ ¹æ®æ¨¡å‹å‡½æ•°é¢„æµ‹å‡ºæ¥çš„å€¼æ˜¯4ï¼Œä¸è¾“å‡ºå€¼yæ˜¯å»åˆçš„ã€‚é’ˆå¯¹ç¬¬äºŒä¸ªæ ·æœ¬ï¼Œè¾“å…¥ä¸º2ï¼Œæ ¹æ®æ¨¡å‹å‡½æ•°é¢„æµ‹å‡ºæ¥çš„å€¼æ˜¯7ï¼Œä¸å®é™…è¾“å‡ºå€¼yç›¸å·®1ã€‚æ¨¡å‹çš„æ±‚è§£è¿‡ç¨‹å°±æ˜¯æ‰¾å‡ºä¸€ç»„æœ€åˆé€‚çš„æ¨¡å‹å‚æ•° $\theta_{0}$å’Œ $\theta_{1}$ï¼Œä»¥ä¾¿èƒ½æœ€å¥½åœ°æ‹Ÿåˆæ•°æ®é›†ã€‚</p><p>æ€æ ·æ¥åˆ¤æ–­æœ€å¥½åœ°æ‹Ÿåˆäº†æ•°æ®é›†å‘¢ï¼Ÿæ²¡é”™ï¼Œå°±æ˜¯ä½¿ç”¨æŸå¤±å‡½æ•°ï¼ˆä¹Ÿå«æŸå¤±å‡½æ•°ï¼‰ã€‚å½“æ‹ŸåˆæŸå¤±æœ€å°æ—¶ï¼Œå³æ‰¾åˆ°äº†æœ€å¥½çš„æ‹Ÿåˆå‚æ•°ã€‚</p><h3 id="æŸå¤±å‡½æ•°"><a href="#æŸå¤±å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°"></a>æŸå¤±å‡½æ•°</h3><p>å•å˜é‡çº¿æ€§å›å½’ç®—æ³•çš„æŸå¤±å‡½æ•°æ˜¯ï¼š</p><p>$$<br>J(\theta)=J\left(\theta_{0}, \theta_{1}\right)=\frac{1}{2 m} \sum_{i=1}^{m}\left(h\left(x^{(i)}\right)-y^{(i)}\right)^{2}<br>$$<br>å…¶ä¸­ï¼Œ$h\left(x^{(i)}\right)-y^{(i)}$ æ˜¯é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„è¯¯å·®ï¼Œæ•…æŸå¤±å°±æ˜¯é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´è¯¯å·®å¹³æ–¹çš„å¹³å‡å€¼ï¼Œä¹‹æ‰€ä»¥ä¹˜ä»¥1/2æ˜¯ä¸ºäº†æ–¹ä¾¿è®¡ç®—ã€‚è¿™ä¸ªå‡½æ•°ä¹Ÿç§°ä¸ºå‡æ–¹å·®å…¬å¼ã€‚æœ‰äº†æŸå¤±å‡½æ•°ï¼Œå°±å¯ä»¥ç²¾ç¡®åœ°æµ‹é‡æ¨¡å‹å¯¹è®­ç»ƒæ ·æœ¬æ‹Ÿåˆçš„å¥½åç¨‹åº¦ã€‚</p><h3 id="æ¢¯åº¦ä¸‹é™ç®—æ³•"><a href="#æ¢¯åº¦ä¸‹é™ç®—æ³•" class="headerlink" title="æ¢¯åº¦ä¸‹é™ç®—æ³•"></a>æ¢¯åº¦ä¸‹é™ç®—æ³•</h3><p>æœ‰äº†é¢„æµ‹å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ç²¾ç¡®åœ°æµ‹é‡é¢„æµ‹å‡½æ•°å¯¹è®­ç»ƒæ ·æœ¬çš„æ‹Ÿåˆæƒ…å†µã€‚ä½†æ€ä¹ˆæ±‚è§£æ¨¡å‹å‚æ•° $\theta_{0}$å’Œ $\theta_{1}$çš„å€¼å‘¢ï¼Ÿè¿™æ—¶æ¢¯åº¦ä¸‹é™ç®—æ³•å°±æ’ä¸Šäº†ç”¨åœºã€‚</p><p>æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯æ‰¾åˆ°åˆé€‚çš„ $\theta_{0}$å’Œ $\theta_{1}$ ï¼Œä½¿å¾—æŸå¤±å‡½æ•° $J\left(\theta_{0}, \theta_{1}\right)$ æœ€å°ã€‚ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬åˆ‡æ¢åˆ°ä¸‰ç»´ç©ºé—´æ¥æè¿°è¿™ä¸ªä»»åŠ¡ã€‚åœ¨ä¸€ä¸ªä¸‰ç»´ç©ºé—´é‡Œï¼Œä»¥  $\theta_{0}$ ä½œä¸º x è½´ï¼Œ ä»¥ $\theta_{1}$ ä½œä¸º y è½´ï¼Œä»¥æŸå¤±å‡½æ•° $J\left(\theta_{0}, \theta_{1}\right)$ ä½œä¸º z è½´ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯è¦æ‰¾å‡ºå½“ z è½´ä¸Šçš„å€¼æœ€å°çš„æ—¶å€™æ‰€å¯¹åº”çš„ x è½´ä¸Šçš„å€¼å’Œ y è½´ä¸Šçš„å€¼ã€‚</p><p><strong>æ¢¯åº¦ä¸‹é™ç®—æ³•çš„åŸç†ï¼š</strong>å…ˆéšæœºé€‰æ‹©ä¸€ç»„ $\theta_{0}$ å’Œ $\theta_{1}$ ï¼ŒåŒæ—¶é€‰æ‹©ä¸€ä¸ªå‚æ•° $\alpha$ ä½œä¸ºç§»åŠ¨çš„æ­¥é•¿ã€‚ç„¶åï¼Œè®©xè½´ä¸Šçš„ $\theta_{0}$ å’Œ yè½´ä¸Šçš„  $\theta_{1}$ åˆ«å‘ç‰¹å®šçš„æ–¹å‘ç§»åŠ¨ä¸€å°æ­¥ï¼Œè¿™ä¸ªæ­¥é•¿çš„å¤§å°å°±ç”±å‚æ•°  $\alpha$ å†³å®šã€‚ç»è¿‡å¤šæ¬¡è¿­ä»£ä¹‹åï¼Œx è½´å’Œ y è½´ä¸Šçš„å€¼å†³å®šçš„ç‚¹å°±æ…¢æ…¢é è¿‘ z è½´ä¸Šçš„æœ€å°å€¼å¤„ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/u=3721595541,2272727131&amp;fm=26&amp;gp=0.jpg" alt="img"></p><p>é‚£ç‰¹å®šçš„æ–¹å‘æ€ä¹ˆç¡®å®šå‘¢ï¼Ÿç­”æ¡ˆæ˜¯<strong>åå¯¼æ•°</strong>ã€‚</p><p>å¯ä»¥ç®€å•åœ°æŠŠåå¯¼æ•°ç†è§£ä¸ºæ–œç‡ã€‚æˆ‘ä»¬è¦è®© $\theta_{j}$ ä¸åœåœ°è¿­ä»£ï¼Œç”±å½“å‰  $\theta_{j}$ çš„å€¼ï¼Œæ ¹æ® $J(\theta)$ çš„åå¯¼æ•°å‡½æ•°ï¼Œç®—å‡º $J(\theta)$ åœ¨  $\theta_{j}$ ä¸Šçš„æ–œç‡ï¼Œç„¶ååœ¨ä¹˜ä»¥å­¦ä¹ ç‡  $\alpha$ ï¼Œå°±å¯ä»¥è®© $\theta_{j}$ å¾€ $J(\theta)$ å˜å°çš„æ–¹å‘è¿ˆä¸€å°æ­¥ã€‚</p><p>ç”¨æ•°å­¦æ¥æè¿°ä¸Šè¿°è¿‡ç¨‹ï¼Œæ¢¯åº¦ä¸‹é™çš„å…¬å¼ä¸ºï¼š<br>$$<br>\theta_{j}=\theta_{j}-\alpha \frac{\partial}{\partial \theta_{j}} J(\theta)<br>$$<br>æŠŠæŸå¤±å‡½æ•° $J(\theta)$ çš„å®šä¹‰ä»£å…¥ä¸Šé¢çš„å…¬å¼ä¸­ï¼Œä¸éš¾æ¨å¯¼å‡ºæ¢¯åº¦ä¸‹é™ç®—æ³•å…¬å¼ï¼š<br>$$<br>\begin{array}{c}<br>\theta_{0}=\theta_{0}-\frac{\alpha}{m} \sum_{i=1}^{m}\left(h\left(x^{(i)}\right)-y^{(j)}\right) \<br>\<br>\theta_{1}=\theta_{1}-\frac{\alpha}{m} \sum_{i=1}^{m}\left(\left(h\left(x^{(i)}\right)-y^{(i)}\right) x_{i}\right)<br>\end{array}<br>$$<br>å…¬å¼ä¸­ï¼Œ $\alpha$  æ˜¯å­¦ä¹ ç‡ï¼›m æ˜¯è®­ç»ƒæ ·æœ¬çš„ä¸ªæ•°: $h\left(x^{(i)}\right)-y^{(i)}$ æ˜¯æ¨¡å‹é¢„æµ‹å€¼å’ŒçœŸå®å€¼çš„è¯¯å·®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé’ˆå¯¹</p><p> $\theta_{0}$ å’Œ $\theta_{1}$ åˆ†åˆ«æ±‚å‡ºäº†å…¶è¿­ä»£å…¬å¼ï¼Œåœ¨ $\theta_{1}$ çš„è¿­ä»£å…¬å¼é‡Œï¼Œç´¯åŠ å™¨ä¸­è¿˜éœ€è¦ä¹˜ä»¥ $x_{i}$, å…·ä½“å‚è€ƒæ‰©å±•éƒ¨åˆ†ã€‚</p><h2 id="å¤šå˜é‡çº¿æ€§å›å½’ç®—æ³•"><a href="#å¤šå˜é‡çº¿æ€§å›å½’ç®—æ³•" class="headerlink" title="å¤šå˜é‡çº¿æ€§å›å½’ç®—æ³•"></a>å¤šå˜é‡çº¿æ€§å›å½’ç®—æ³•</h2><p>å®é™…åº”ç”¨ä¸­å¾€å¾€ä¸æ­¢ä¸€ä¸ªè¾“å…¥ç‰¹å¾ã€‚ç†Ÿæ‚‰äº†å•å˜é‡çº¿æ€§å›å½’ç®—æ³•åï¼Œæˆ‘ä»¬æ¥æ¢è®¨ä¸€ä¸‹å¤šå˜é‡çº¿æ€§å›å½’ç®—æ³•ã€‚</p><h3 id="é¢„æµ‹å‡½æ•°-1"><a href="#é¢„æµ‹å‡½æ•°-1" class="headerlink" title="é¢„æµ‹å‡½æ•°"></a>é¢„æµ‹å‡½æ•°</h3><p>ä¸Šé¢ä»‹ç»çš„å•å˜é‡çº¿æ€§å›å½’æ¨¡å‹é‡Œåªæœ‰ä¸€ä¸ªè¾“å…¥ç‰¹å¾ï¼Œæˆ‘ä»¬æ¨å¹¿åˆ°æ›´ä¸€èˆ¬çš„æƒ…å†µï¼Œå³å¤šä¸ªè¾“å…¥ç‰¹å¾ã€‚æ­¤æ—¶è¾“å‡ºyçš„å€¼ç”±nä¸ªè¾“å…¥ç‰¹å¾ $x_{1}, x_{2}, \ldots, x_{n}$ å†³å®šã€‚é‚£ä¹ˆé¢„æµ‹å‡½æ•°æ¨¡å‹å¯ä»¥æ”¹å†™å¦‚ä¸‹ï¼š</p><p>$$<br>h_{\theta}(x)=\theta_{0}+\theta_{1} x_{1}+\theta_{2} x_{2}+\ldots+\theta_{n} x_{n}<br>$$<br>å‡è®¾ $x_{0}=1$ï¼Œé‚£ä¹ˆä¸Šé¢çš„å…¬å¼å¯ä»¥é‡å†™ä¸ºï¼š<br>$$<br>h_{\theta}(x)=\sum_{j=0}^{n} \theta_{j} x_{j}<br>$$<br>å…¶ä¸­ï¼Œ$\theta_{0}, \theta_{1}, \dots, \theta_{n}$ ç»Ÿç§°ä¸º $\theta$ , æ˜¯é¢„æµ‹å‡½æ•°çš„å‚æ•°ã€‚å³ä¸€ç»„ $\theta$ å€¼å°±å†³å®šäº†ä¸€ä¸ªé¢„æµ‹å‡½æ•°ï¼Œè®°ä¸º $h_{\theta}(x)$ , ä¸ºäº†ç®€ä¾¿èµ·è§ï¼Œåœ¨ä¸å¼•èµ·è¯¯è§£çš„æƒ…å†µä¸‹å¯ä»¥ç®€å†™ä¸º $h(x)$ ã€‚ç†è®ºä¸Šï¼Œé¢„æµ‹å‡½æ•°æœ‰æ— ç©·å¤šä¸ªï¼Œæˆ‘ä»¬æ±‚è§£çš„ç›®æ ‡å°±æ˜¯æ‰¾å‡ºä¸€ä¸ªæœ€ä¼˜çš„ $\theta$ å€¼ã€‚</p><h4 id="å‘é‡å½¢å¼çš„é¢„æµ‹å‡½æ•°"><a href="#å‘é‡å½¢å¼çš„é¢„æµ‹å‡½æ•°" class="headerlink" title="å‘é‡å½¢å¼çš„é¢„æµ‹å‡½æ•°"></a>å‘é‡å½¢å¼çš„é¢„æµ‹å‡½æ•°</h4><p>æ ¹æ®å‘é‡ä¹˜æ³•è¿ç®—æ³•åˆ™ï¼ŒæŸå¤±å‡½æ•°å¯é‡å†™ä¸ºï¼š</p><p>$$<br>h_{\theta}(x)=\left[\theta_{0}, \theta_{1}, \cdots, \theta_{n}\right]\left[\begin{array}{c}<br>x_{0} \<br>x_{1} \<br>\vdots \<br>x_{n}<br>\end{array}\right]=\theta^{T} x<br>$$<br>æ­¤å¤„ï¼Œä¾ç„¶å‡è®¾ $x_{0}=1$ï¼Œ $x_{0}$ ç§°ä¸ºæ¨¡å‹åç½®ï¼ˆbiasï¼‰ã€‚</p><p>å†™æˆå‘é‡å½¢å¼çš„é¢„æµ‹å‡½æ•°æœ‰ä¸¤ä¸ªåŸå› ã€‚ä¸€æ˜¯å› ä¸ºç®€æ´ï¼ŒäºŒæ˜¯å› ä¸ºåœ¨å®ç°ç®—æ³•æ—¶ï¼Œè¦ç”¨åˆ°æ•°å€¼è®¡ç®—é‡Œçš„çŸ©é˜µè¿ç®—æ¥æé«˜æ•ˆç‡ï¼Œæ¯”å¦‚ <code>Numpy</code> åº“é‡Œçš„çŸ©é˜µè¿ç®—ã€‚</p><h4 id="å‘é‡å½¢å¼çš„è®­ç»ƒæ ·æœ¬"><a href="#å‘é‡å½¢å¼çš„è®­ç»ƒæ ·æœ¬" class="headerlink" title="å‘é‡å½¢å¼çš„è®­ç»ƒæ ·æœ¬"></a>å‘é‡å½¢å¼çš„è®­ç»ƒæ ·æœ¬</h4><p>å‡è®¾è¾“å…¥ç‰¹å¾çš„ä¸ªæ•°æ˜¯nï¼Œå³ $x_{1}, x_{2}, \ldots, x_{n}$ , æˆ‘ä»¬æ€»å…±æœ‰ m ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œä¸ºäº†ä¹¦å†™æ–¹ä¾¿ï¼Œå‡è®¾ $x_{0}=1$ã€‚è¿™æ ·è®­ç»ƒæ ·æœ¬å¯ä»¥å†™æˆçŸ©é˜µçš„å½¢å¼ï¼Œå³çŸ©é˜µé‡Œæ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œæ€»å…±æœ‰ m è¡Œï¼Œæ¯è¡Œæœ‰ n+1 åˆ—ã€‚</p><blockquote><p>æ€è€ƒï¼šä¸ºä»€ä¹ˆä¸æ˜¯nåˆ—è€Œæ˜¯n+1åˆ—ï¼Ÿç­”æ¡ˆæ˜¯ï¼šæŠŠæ¨¡å‹åç½® $x_{0}$ä¹ŸåŠ å…¥äº†è®­ç»ƒæ ·æœ¬é‡Œã€‚æœ€åæŠŠè®­ç»ƒæ ·æœ¬å†™æˆä¸€ä¸ªçŸ©é˜µï¼Œå¦‚ä¸‹ï¼š</p></blockquote><p>$$<br>\boldsymbol{X}=\left[\begin{array}{ccccc}<br>x_{0}^{(1)} &amp; x_{1}^{(1)} &amp; x_{2}^{(1)} &amp; \dots &amp; x_{n}^{(1)} \<br>x_{0}^{(2)} &amp; x_{1}^{(2)} &amp; x_{2}^{(2)} &amp; \dots &amp; x_{n}^{(2)} \<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \<br>x_{0}^{(m)} &amp; x_{1}^{(m)} &amp; x_{2}^{(m)} &amp; \cdots &amp; x_{n}^{(m)}<br>\end{array}\right], \theta=\left[\begin{array}{c}<br>\theta_{0} \<br>\theta_{1} \<br>\theta_{2} \<br>\vdots \<br>\theta_{n}<br>\end{array}\right]<br>$$</p><p>ç†è§£è®­ç»ƒæ ·æœ¬çŸ©é˜µçš„å…³é”®åœ¨äºç†è§£è¿™äº›ä¸Šæ ‡å’Œä¸‹æ ‡çš„å«ä¹‰ã€‚å…¶ä¸­ï¼Œå¸¦æ‹¬å·çš„ä¸Šæ ‡è¡¨ç¤ºæ ·æœ¬åºå·ï¼Œä»1åˆ°mï¼›ä¸‹æ ‡è¡¨ç¤ºç‰¹å¾åºå·ï¼Œä»0åˆ°nï¼Œå…¶ä¸­ $x_{0}$ ä¸ºå¸¸æ•°1ã€‚</p><blockquote><p>$x_{j}^{(i)}$ è¡¨ç¤ºç¬¬ i ä¸ªè®­ç»ƒæ ·æœ¬çš„ç¬¬ j ä¸ªç‰¹å¾çš„å€¼ã€‚è€Œ $x^{(i)}$ åªæœ‰ä¸Šæ ‡ï¼Œåˆ™è¡¨ç¤ºç¬¬ i ä¸ªè®­ç»ƒæ ·æœ¬æ‰€æ„æˆçš„åˆ—å‘é‡ã€‚</p></blockquote><p>ç»¼ä¸Šï¼Œè®­ç»ƒæ ·æœ¬çš„é¢„æµ‹å€¼ $h_{\theta}(X)$ ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„çŸ©é˜µè¿ç®—å…¬å¼ï¼š</p><p>$$<br>h_{\theta}(X)=X \theta<br>$$</p><h3 id="æŸå¤±å‡½æ•°-1"><a href="#æŸå¤±å‡½æ•°-1" class="headerlink" title="æŸå¤±å‡½æ•°"></a>æŸå¤±å‡½æ•°</h3><p>å¤šå˜é‡çº¿æ€§å›å½’ç®—æ³•çš„æŸå¤±å‡½æ•°ï¼š</p><p>$$<br>J(\theta)=\frac{1}{2 m} \sum_{i=1}^{m}\left(h\left(x^{(i)}\right)-y^{(i)}\right)^{2}<br>$$<br>å…¶ä¸­ï¼Œæ¨¡å‹å‚æ•° $\theta$ ä¸º n+1 ç»´çš„å‘é‡ï¼Œ$h\left(x^{(i)}\right)-y^{(i)}$ æ˜¯é¢„æµ‹å€¼å’Œå®é™…å€¼çš„å·®ï¼Œè¿™ä¸ªå½¢å¼å’Œå•å˜é‡çº¿æ€§å›å½’ç®—æ³•çš„ç±»ä¼¼ã€‚</p><p>æŸå¤±å‡½æ•°æœ‰å…¶å¯¹åº”çš„çŸ©é˜µå½¢å¼ï¼š<br>$$<br>J(\theta)=\frac{1}{2 m}(X \theta-\vec{y})^{T}(X \theta-\vec{y})<br>$$<br>å…¶ä¸­ï¼ŒX ä¸º $m \times(n+1)$ ç»´çš„è®­ç»ƒæ ·æœ¬çŸ©é˜µï¼›ä¸Šæ ‡Tè¡¨ç¤ºè½¬ç½®çŸ©é˜µï¼›$\vec{y}$ è¡¨ç¤ºç”±æ‰€æœ‰çš„è®­ç»ƒæ ·æœ¬çš„è¾“å‡º $y^{(i)}$ æ„æˆçš„å‘é‡ã€‚è¿™ä¸ªå…¬å¼çš„ä¼˜åŠ¿æ˜¯ï¼šæ²¡æœ‰ç´¯åŠ å™¨ï¼Œä¸éœ€è¦å¾ªç¯ï¼Œç›´æ¥ä½¿ç”¨çŸ©é˜µè¿ç®—ï¼Œå°±å¯ä»¥ä¸€æ¬¡æ€§è®¡ç®—å‡ºå¯¹ç‰¹å®šçš„å‚æ•° $\theta$ ä¸‹æ¨¡å‹çš„æ‹ŸåˆæŸå¤±ã€‚</p><h3 id="æ¢¯åº¦ä¸‹é™ç®—æ³•-1"><a href="#æ¢¯åº¦ä¸‹é™ç®—æ³•-1" class="headerlink" title="æ¢¯åº¦ä¸‹é™ç®—æ³•"></a>æ¢¯åº¦ä¸‹é™ç®—æ³•</h3><p>æ ¹æ®å•å˜é‡çº¿æ€§å›å½’ç®—æ³•çš„ä»‹ç»ï¼Œæ¢¯åº¦ä¸‹é™çš„å…¬å¼ä¸ºï¼š<br>$$<br>\theta_{j}=\theta_{j}-\alpha \frac{\partial}{\partial \theta_{j}} J(\theta)<br>$$<br>å…¬å¼ä¸­ï¼Œä¸‹æ ‡ j æ˜¯å‚æ•°çš„åºå·ï¼Œå…¶å€¼ä» 0 åˆ° nï¼› $\alpha$ ä¸ºå­¦ä¹ ç‡ã€‚æŠŠæŸå¤±å‡½æ•°ä»£å…¥ä¸Šå¼ï¼Œåˆ©ç”¨åå¯¼æ•°è®¡ç®—æ³•åˆ™ï¼Œä¸éš¾æ¨å¯¼å‡ºæ¢¯åº¦ä¸‹é™ç®—æ³•çš„å‚æ•°è¿­ä»£å…¬å¼ï¼š<br>$$<br>\theta_{j}=\theta_{j}-\frac{\alpha}{m} \sum_{i=1}^{m}\left(\left(h\left(x^{(i)}\right)-y^{(i)}\right) x_{j}^{(i)}\right)<br>$$<br>æˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸€ä¸‹å•å˜é‡çº¿æ€§å›å½’å‡½æ•°çš„å‚æ•°è¿­ä»£å…¬å¼ã€‚å®é™…ä¸Šå’Œå¤šå˜é‡çº¿æ€§å›å½’å‡½æ•°çš„å‚æ•°è¿­ä»£å…¬å¼æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚æƒŸä¸€çš„åŒºåˆ«å°±æ˜¯å› ä¸º $x_{0}$ ä¸ºå¸¸æ•°1ï¼Œåœ¨å•å˜é‡çº¿æ€§å›å½’ç®—æ³•çš„å‚æ•°è¿­ä»£å…¬å¼ä¸­çœå»äº†ã€‚</p><p>åº”ç”¨è¿™ä¸ªå…¬å¼ç¼–å†™æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œä¸€èˆ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li><p>ç¡®å®šå­¦ä¹ ç‡ï¼š $\alpha$ å¤ªå¤§å¯èƒ½ä¼šä½¿æŸå¤±å‡½æ•°æ— æ³•æ”¶æ•›ï¼Œå¤ªå°åˆ™è®¡ç®—å¤ªå¤šï¼Œæœºå™¨å­¦ä¹ ç®—æ³•æ•ˆç‡å°±æ¯”è¾ƒä½ã€‚</p></li><li><p>å‚æ•°åˆå§‹åŒ–ï¼šæ¯”å¦‚è®©æ‰€æœ‰çš„å‚æ•°éƒ½ä»¥1ä½œä¸ºèµ·å§‹ç‚¹ï¼Œ$\theta_{0}=1, \theta_{1}=1, \dots, \theta_{n}=1$ï¼Œæ ¹æ®é¢„æµ‹å€¼å’ŒæŸå¤±å‡½æ•°ï¼Œå°±å¯ä»¥ç®—å‡ºåœ¨å‚æ•°èµ·å§‹ä½ç½®çš„æŸå¤±ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‚æ•°èµ·å§‹ç‚¹å¯ä»¥æ ¹æ®å®é™…æƒ…å†µçµæ´»é€‰æ‹©ï¼Œä»¥ä¾¿è®©æœºå™¨å­¦ä¹ ç®—æ³•çš„æ€§èƒ½æ›´é«˜ï¼Œæ¯”å¦‚é€‰æ‹©æ¯”è¾ƒé è¿‘æç‚¹çš„ä½ç½®ã€‚</p></li><li><p>è®¡ç®—å‚æ•°çš„ä¸‹ä¸€ç»„å€¼ï¼šæ®æ¢¯åº¦ä¸‹é™å‚æ•°è¿­ä»£å…¬å¼ï¼Œåˆ†åˆ«åŒæ—¶è®¡ç®—å‡ºæ–°çš„ $\theta_{j}$ å€¼ï¼Œè¿›è€Œå¾—åˆ°æ–°çš„é¢„æµ‹å‡½æ•° $h_{\theta}(x)$ ã€‚å†æ ¹æ®æ–°çš„é¢„æµ‹å‡½æ•°ï¼Œä»£å…¥æŸå¤±å‡½æ•°å°±å¯ä»¥ç®—å‡ºæ–°çš„æŸå¤±ã€‚</p></li><li><p>ç¡®å®šæŸå¤±å‡½æ•°æ˜¯å¦æ”¶æ•›ï¼šæ‹¿æ–°çš„å’Œæ—§çš„æŸå¤±è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹æŸå¤±æ˜¯ä¸æ˜¯å˜å¾—è¶Šæ¥è¶Šå°ã€‚å¦‚æœä¸¤æ¬¡æŸå¤±ä¹‹é—´çš„å·®å¼‚å°äºè¯¯å·®èŒƒå›´ï¼Œå³è¯´æ˜å·²ç»éå¸¸é è¿‘æœ€å°æŸå¤±äº†ï¼Œå°±å¯ä»¥è¿‘ä¼¼åœ°è®¤ä¸ºæˆ‘ä»¬æ‰¾åˆ°äº†æœ€å°æŸå¤±ã€‚å¦‚æœä¸¤æ¬¡æŸå¤±ä¹‹é—´çš„å·®å¼‚åœ¨è¯¯å·®èŒƒå›´ä¹‹å¤–ï¼Œé‡å¤æ­¥éª¤ï¼ˆ3ï¼‰ç»§ç»­è®¡ç®—ä¸‹ä¸€ç»„å‚æ•°ç›´åˆ°æ‰¾åˆ°æœ€ä¼˜è§£ã€‚</p></li></ul><h2 id="æ¨¡å‹ä¼˜åŒ–"><a href="#æ¨¡å‹ä¼˜åŒ–" class="headerlink" title="æ¨¡å‹ä¼˜åŒ–"></a>æ¨¡å‹ä¼˜åŒ–</h2><p>çº¿æ€§å›å½’æ¨¡å‹å¸¸ç”¨çš„ä¼˜åŒ–æ–¹æ³•ï¼ŒåŒ…æ‹¬å¢åŠ å¤šé¡¹å¼ç‰¹å¾ä»¥åŠæ•°æ®å½’ä¸€åŒ–å¤„ç†ç­‰ã€‚</p><h3 id="å¤šé¡¹å¼ä¸çº¿æ€§å›å½’"><a href="#å¤šé¡¹å¼ä¸çº¿æ€§å›å½’" class="headerlink" title="å¤šé¡¹å¼ä¸çº¿æ€§å›å½’"></a>å¤šé¡¹å¼ä¸çº¿æ€§å›å½’</h3><p>å½“çº¿æ€§å›å½’æ¨¡å‹å¤ªç®€å•å¯¼è‡´æ¬ æ‹Ÿåˆæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¢åŠ ç‰¹å¾å¤šé¡¹å¼æ¥è®©çº¿æ€§å›å½’æ¨¡å‹æ›´å¥½åœ°æ‹Ÿåˆæ•°æ®ã€‚æ¯”å¦‚æœ‰ä¸¤ä¸ªç‰¹å¾  $x_{1}$ å’Œ $x_{2}$ ï¼Œå¯ä»¥å¢åŠ ä¸¤ä¸ªç‰¹å¾çš„ä¹˜ç§¯ $x_{1} \times x_{2}$ ä½œä¸ºæ–°ç‰¹å¾  $x_{3}$ ã€‚åŒç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¢åŠ  $x_{1}^{2}$ å’Œ $x_{2}^{2}$  åˆ†åˆ«ä½œä¸ºæ–°ç‰¹å¾  $x_{4}$ å’Œ $x_{5}$ ã€‚</p><p>åœ¨ <code>scikit-learn</code> é‡Œï¼Œçº¿æ€§å›å½’æ˜¯ç”±ç±» <code>sklearn.learn_model.LinearRegression</code> å®ç°çš„ï¼Œå¤šé¡¹å¼ç”±ç±»<code>sklearn.preprocessing.PolynomialFeatures</code> å®ç°ã€‚é‚£ä¹ˆè¦æ€æ ·æ·»åŠ å¤šé¡¹å¼ç‰¹å¾å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦ç”¨ä¸€ä¸ªç®¡é“æŠŠä¸¤ä¸ªç±»ä¸²èµ·æ¥ï¼Œå³ç”¨ <code>sklearn.pipeline.Pipeline</code> æŠŠè¿™ä¸¤ä¸ªæ¨¡å‹ä¸²èµ·æ¥ã€‚</p><p>æ¯”å¦‚ä¸‹é¢çš„å‡½æ•°å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªå¤šé¡¹å¼æ‹Ÿåˆï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> PolynomialFeatures<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> Pipeline<span class="token keyword">def</span> <span class="token function">polynomial_model</span><span class="token punctuation">(</span>degree<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    polynomial_features <span class="token operator">=</span> PolynomialFeatures<span class="token punctuation">(</span>degree<span class="token operator">=</span>degree<span class="token punctuation">,</span>include_bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    linear_regression <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span>normalize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># è¿™æ˜¯ä¸€ä¸ªæµæ°´çº¿ï¼Œå…ˆå¢åŠ å¤šé¡¹å¼é˜¶æ•°ï¼Œç„¶åå†ç”¨çº¿æ€§å›å½’ç®—æ³•æ¥æ‹Ÿåˆæ•°æ®</span>    pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"polynomial_features"</span><span class="token punctuation">,</span> polynomial_features<span class="token punctuation">)</span><span class="token punctuation">,</span>                         <span class="token punctuation">(</span><span class="token string">"linear_regression"</span><span class="token punctuation">,</span> linear_regression<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> pipeline<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€ä¸ª Pipeline å¯ä»¥åŒ…å«å¤šä¸ªå¤„ç†èŠ‚ç‚¹ï¼Œåœ¨ scikit-learn é‡Œï¼Œé™¤äº†æœ€åä¸€ä¸ªèŠ‚ç‚¹å¤–ï¼Œå…¶ä»–çš„èŠ‚ç‚¹éƒ½å¿…é¡»å®ç° fit() æ–¹æ³•å’Œ transform() æ–¹æ³•ï¼Œæœ€åä¸€ä¸ªèŠ‚ç‚¹åªéœ€è¦å®ç° fit() æ–¹æ³•å³å¯ã€‚å½“è®­ç»ƒæ ·æœ¬æ•°æ®é€è¿› Pipeline é‡Œè¿›è¡Œå¤„ç†æ—¶ï¼Œå®ƒä¼šé€ä¸ªè°ƒç”¨èŠ‚ç‚¹çš„ fit() æ–¹æ³•å’Œ transform() æ–¹æ³•ï¼Œæœ€åè°ƒç”¨æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„ fit() æ–¹æ³•æ¥æ‹Ÿåˆæ•°æ®ã€‚ç®¡é“çš„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630093109778.png" alt="image-20200630090937011"></p><h3 id="æ•°æ®å½’ä¸€åŒ–"><a href="#æ•°æ®å½’ä¸€åŒ–" class="headerlink" title="æ•°æ®å½’ä¸€åŒ–"></a>æ•°æ®å½’ä¸€åŒ–</h3><p>å½“çº¿æ€§å›å½’æ¨¡å‹æœ‰å¤šä¸ªè¾“å…¥ç‰¹å¾æ—¶ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨å¤šé¡¹å¼æ·»åŠ ç‰¹å¾æ—¶ï¼Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ã€‚æ¯”å¦‚ï¼Œç‰¹å¾</p><p>$x_{1}$ çš„èŒƒå›´åœ¨[1,4]ä¹‹é—´ï¼Œç‰¹å¾ $x_{2}$ çš„èŒƒæ–‡åœ¨[1,2000]ä¹‹é—´ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥è®© $x_{1}$é™¤ä»¥4æ¥ä½œä¸ºæ–°ç‰¹å¾ $x_{1}$ï¼ŒåŒæ—¶è®© $x_{2}$ </p><p>é™¤ä»¥2000æ¥ä½œä¸ºæ–°ç‰¹å¾ $x_{2}$ ï¼Œè¯¥è¿‡ç¨‹ç§°ä¸ºç‰¹å¾ç¼©æ”¾ï¼ˆfeature scalingï¼‰ã€‚å¯ä»¥ä½¿ç”¨ç‰¹å¾ç¼©æ”¾æ¥å¯¹è®­ç»ƒæ ·æœ¬è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œå¤„ç†åçš„ç‰¹å¾èŒƒå›´åœ¨[0,1]ä¹‹é—´ã€‚</p><ul><li>å½’ä¸€åŒ–å¤„ç†çš„ç›®çš„æ˜¯è®©ç®—æ³•æ”¶æ•›æ›´å¿«ï¼Œæå‡æ¨¡å‹æ‹Ÿåˆè¿‡ç¨‹ä¸­çš„è®¡ç®—æ•ˆç‡ã€‚</li><li>è¿›è¡Œå½’ä¸€åŒ–å¤„ç†åï¼Œå½“æœ‰ä¸ªæ–°çš„æ ·æœ¬éœ€è¦è®¡ç®—é¢„æµ‹å€¼æ—¶ï¼Œä¹Ÿéœ€è¦å…ˆè¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œå†é€šè¿‡æ¨¡å‹æ¥è®¡ç®—é¢„æµ‹å€¼ï¼Œè®¡ç®—å‡ºæ¥çš„é¢„æµ‹å€¼è¦å†ä¹˜ä»¥å½’ä¸€åŒ–å¤„ç†çš„ç³»æ•°ï¼Œè¿™æ ·å¾—åˆ°çš„æ•°æ®æ‰æ˜¯çœŸæ­£çš„é¢„æµ‹æ•°æ®ã€‚</li><li>åœ¨ <code>scikit-learn</code> é‡Œï¼Œä½¿ç”¨ <code>LinearRegression</code> è¿›è¡Œçº¿æ€§å›å½’æ—¶ï¼Œå¯ä»¥æŒ‡å®š <code>normalize=True</code> æ¥å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ã€‚</li></ul><h2 id="ç¤ºä¾‹1ï¼šä½¿ç”¨çº¿æ€§å›å½’ç®—æ³•æ‹Ÿåˆæ­£å¼¦å‡½æ•°"><a href="#ç¤ºä¾‹1ï¼šä½¿ç”¨çº¿æ€§å›å½’ç®—æ³•æ‹Ÿåˆæ­£å¼¦å‡½æ•°" class="headerlink" title="ç¤ºä¾‹1ï¼šä½¿ç”¨çº¿æ€§å›å½’ç®—æ³•æ‹Ÿåˆæ­£å¼¦å‡½æ•°"></a>ç¤ºä¾‹1ï¼šä½¿ç”¨çº¿æ€§å›å½’ç®—æ³•æ‹Ÿåˆæ­£å¼¦å‡½æ•°</h2><p>é¦–å…ˆç”Ÿæˆ200ä¸ªåœ¨åŒºé—´ $[2 \pi, 2 \pi]$ å†…çš„æ­£å¼¦å‡½æ•°ä¸Šçš„ç‚¹ï¼Œå¹¶ç»™è¿™äº›ç‚¹åŠ ä¸Šä¸€äº›éšæœºçš„å™ªå£°ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npn_dots <span class="token operator">=</span> <span class="token number">200</span>X <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span> n_dots<span class="token punctuation">)</span>Y <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>X<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span>n_dots<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.1</span><span class="token comment" spellcheck="true"># æŠŠä¸€ä¸ªnç»´å‘é‡è½¬æ¢æˆä¸€ä¸ªn*1ç»´çš„çŸ©é˜µ</span>X <span class="token operator">=</span> X<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>Y <span class="token operator">=</span> Y<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨ <code>PolynomialFeatures</code> å’Œ <code>Pipeline</code> åˆ›å»ºä¸€ä¸ªå¤šé¡¹å¼æ‹Ÿåˆæ¨¡å‹</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> PolynomialFeatures<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> Pipeline<span class="token keyword">def</span> <span class="token function">polynomial_model</span><span class="token punctuation">(</span>degree<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    polynomial_features <span class="token operator">=</span> PolynomialFeatures<span class="token punctuation">(</span>degree<span class="token operator">=</span>degree<span class="token punctuation">,</span>include_bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    linear_regression <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span>normalize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"polynomial_features"</span><span class="token punctuation">,</span> polynomial_features<span class="token punctuation">)</span><span class="token punctuation">,</span>                         <span class="token punctuation">(</span><span class="token string">"linear_regression"</span><span class="token punctuation">,</span> linear_regression<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> pipeline<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ†åˆ«ç”¨2/3/5/10é˜¶å¤šé¡¹å¼æ¥æ‹Ÿåˆæ•°æ®é›†ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_errordegrees <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> d <span class="token keyword">in</span> degrees<span class="token punctuation">:</span>    model <span class="token operator">=</span> polynomial_model<span class="token punctuation">(</span>degree<span class="token operator">=</span>d<span class="token punctuation">)</span>    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>    train_score <span class="token operator">=</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>    mse <span class="token operator">=</span> mean_squared_error<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span>    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"model"</span><span class="token punctuation">:</span> model<span class="token punctuation">,</span> <span class="token string">"degree"</span><span class="token punctuation">:</span> d<span class="token punctuation">,</span> <span class="token string">"score"</span><span class="token punctuation">:</span> train_score<span class="token punctuation">,</span> <span class="token string">"mse"</span><span class="token punctuation">:</span> mse<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">for</span> r <span class="token keyword">in</span> results<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"degree: {}; train score: {}; mean squared error: {}"</span>          <span class="token punctuation">.</span>format<span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token string">"degree"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span><span class="token string">"score"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> r<span class="token punctuation">[</span><span class="token string">"mse"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç®—å‡ºæ¯ä¸ªæ¨¡å‹æ‹Ÿåˆçš„è¯„åˆ†ï¼Œæ­¤å¤–ï¼Œä½¿ç”¨ <code>mean_squared_error</code> ç®—å‡ºå‡æ–¹æ ¹è¯¯å·®ï¼Œå³å®é™…çš„ç‚¹å’Œæ¨¡å‹é¢„ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œå‡æ–¹æ ¹è¯¯å·®è¶Šå°è¯´æ˜æ¨¡å‹æ‹Ÿåˆæ•ˆæœè¶Šå¥½â€”â€”ä¸Šè¿°ä»£ç çš„è¾“å‡ºç»“æœä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">degree<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">;</span> train score<span class="token punctuation">:</span> <span class="token number">0.1543189069883787</span><span class="token punctuation">;</span> mean squared error<span class="token punctuation">:</span> <span class="token number">0.43058829267318416</span>degree<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">;</span> train score<span class="token punctuation">:</span> <span class="token number">0.2755383996826518</span><span class="token punctuation">;</span> mean squared error<span class="token punctuation">:</span> <span class="token number">0.3688679883773196</span>degree<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">;</span> train score<span class="token punctuation">:</span> <span class="token number">0.8982707756590037</span><span class="token punctuation">;</span> mean squared error<span class="token punctuation">:</span> <span class="token number">0.051796609130712795</span>degree<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">;</span> train score<span class="token punctuation">:</span> <span class="token number">0.9935830575581858</span><span class="token punctuation">;</span> mean squared error<span class="token punctuation">:</span> <span class="token number">0.0032672603337543927</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä»è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œå¤šé¡¹å¼é˜¶æ•°è¶Šé«˜ï¼Œæ‹Ÿåˆè¯„åˆ†è¶Šé«˜ï¼Œå‡æ–¹æ ¹è¯¯å·®è¶Šå°ï¼Œæ‹Ÿåˆæ•ˆæœè¶Šå¥½ã€‚</p><p>æŠŠä¸åŒæ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœåœ¨äºŒç»´åæ ‡ä¸Šç”»å‡ºæ¥ï¼Œå¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ä¸åŒé˜¶æ•°çš„å¤šé¡¹å¼çš„æ‹Ÿåˆæ•ˆæœï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>figure <span class="token keyword">import</span> SubplotParamsplt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span>subplotpars<span class="token operator">=</span>SubplotParams<span class="token punctuation">(</span>hspace<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i<span class="token punctuation">,</span>r <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">:</span>    fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"LinearRegression degree={}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>r<span class="token punctuation">[</span><span class="token string">"degree"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'b'</span><span class="token punctuation">,</span>alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>r<span class="token punctuation">[</span><span class="token string">"model"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'r-'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨ <code>SubplotParam</code>s è°ƒæ•´äº†å­å›¾çš„ç«–ç›´é—´è·ï¼Œå¹¶ä¸”ä½¿ç”¨ <code>subplot()</code> å‡½æ•°æŠŠ4ä¸ªæ¨¡å‹çš„æ‹Ÿåˆæƒ…å†µéƒ½ç”»åœ¨åŒä¸€ä¸ªå›¾å½¢ä¸Šã€‚ä¸Šè¿°ä»£ç çš„è¾“å‡ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630090937011.png" alt="image-20200630092742917"></p><p>åœ¨[-2Ï€ï¼Œ2Ï€]åŒºé—´å†…ï¼Œ10é˜¶å¤šé¡¹å¼å¯¹æ•°æ®æ‹Ÿåˆå¾—éå¸¸å¥½ï¼Œæˆ‘ä»¬å¯ä»¥è¯•ç€ç”»å‡ºè¿™10é˜¶æ¨¡å‹åœ¨[-20,20]çš„åŒºåŸŸå†…çš„æ›²çº¿ï¼Œè§‚å¯Ÿä¸€ä¸‹è¯¥æ¨¡å‹çš„æ›²çº¿å’Œæ­£å¼¦å‡½æ•°çš„å·®å¼‚ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>X <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>Y <span class="token operator">=</span> np<span class="token punctuation">.</span>sin<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>model_10 <span class="token operator">=</span> results<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"model"</span><span class="token punctuation">]</span>plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span><span class="token string">'b-'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>model_10<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'r-'</span><span class="token punctuation">)</span>dot1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>dot2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>np<span class="token punctuation">.</span>pi<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>dot1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dot1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>dot2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>dot2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šè¿°ä»£ç çš„è¾“å‡ºç»“æœå¦‚ä¸‹å›¾ï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630100257358.png" alt="image-20200630093109778"></p><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œ10é˜¶å¤šé¡¹å¼æ¨¡å‹åªæœ‰åœ¨åŒºé—´[-2Ï€,2Ï€]ä¹‹é—´å¯¹æ­£å¼¦æ›²çº¿æ‹Ÿåˆè¾ƒå¥½ï¼Œåœ¨æ­¤åŒºé—´ä»¥å¤–ï¼Œä¸¤è€…ç›¸å·®ç”šè¿œã€‚æ­¤æ¡ˆä¾‹å‘Šè¯‰æˆ‘ä»¬ï¼Œæ¯ä¸ªæ¨¡å‹éƒ½æœ‰è‡ªå·±çš„é€‚ç”¨èŒƒå›´ï¼Œåœ¨æ»¡è¶³é€‚ç”¨èŒƒå›´çš„åŸºæœ¬å‰æä¸‹ï¼Œè¦å°½å¯èƒ½å¯»æ‰¾æ‹Ÿåˆç¨‹åº¦æœ€é«˜çš„æ¨¡å‹æ¥ä½¿ç”¨ã€‚</p><h2 id="ç¤ºä¾‹2ï¼šé¢„æµ‹æˆ¿ä»·"><a href="#ç¤ºä¾‹2ï¼šé¢„æµ‹æˆ¿ä»·" class="headerlink" title="ç¤ºä¾‹2ï¼šé¢„æµ‹æˆ¿ä»·"></a>ç¤ºä¾‹2ï¼šé¢„æµ‹æˆ¿ä»·</h2><p>æœ¬èŠ‚ä½¿ç”¨ <code>scikit-learn</code> è‡ªå¸¦çš„æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®æ¥è®­ç»ƒæ¨¡å‹ï¼Œç„¶åç”¨æ¨¡å‹æ¥é¢„æµ‹æˆ¿ä»·ã€‚</p><h3 id="è¾“å…¥ç‰¹å¾"><a href="#è¾“å…¥ç‰¹å¾" class="headerlink" title="è¾“å…¥ç‰¹å¾"></a>è¾“å…¥ç‰¹å¾</h3><p>æˆ¿ä»·å’Œå“ªäº›å› ç´ æœ‰å…³ï¼Ÿå¾ˆå¤šäººå¯èƒ½å¯¹è¿™ä¸ªé—®é¢˜ç‰¹åˆ«æ•æ„Ÿï¼Œéšæ—¶å¯ä»¥åˆ—å‡ºå¾ˆå¤šï¼Œå¦‚æˆ¿å­é¢å­ã€æˆ¿å­åœ°ç†ä½ç½®ã€å‘¨è¾¹æ•™è‚²èµ„æºã€å‘¨è¾¹å•†ä¸šèµ„æºã€æˆ¿å­æœå‘ã€å¹´é™ã€å°åŒºæƒ…å†µç­‰ã€‚åœ¨ <code>scikit-learn</code>çš„æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†é‡Œï¼Œå®ƒæ€»å…±æ”¶é›†äº†13ä¸ªç‰¹å¾ï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><ul><li><p>CRIMï¼šåŸé•‡äººå‡çŠ¯ç½ªç‡ã€‚</p></li><li><p>ZNï¼šåŸé•‡è¶…è¿‡25000å¹³æ–¹è‹±å°ºçš„ä½å®…åŒºåŸŸçš„å åœ°æ¯”ä¾‹ã€‚</p></li><li><p>INDUSï¼šåŸé•‡éé›¶å”®ç”¨åœ°å åœ°æ¯”ä¾‹ã€‚</p></li><li><p>CHASï¼šæ˜¯å¦é è¿‘æ²³è¾¹ï¼Œ1ä¸ºé è¿‘ï¼Œ0ä¸ºè¿œç¦»ã€‚</p></li><li><p>NOXï¼šä¸€æ°§åŒ–æ°®æµ“åº¦</p></li><li><p>RMï¼šæ¯å¥—æˆ¿äº§çš„å¹³å‡æˆ¿é—´ä¸ªæ•°ã€‚</p></li><li><p>AGEï¼šåœ¨1940å¹´ä¹‹å‰å°±ç›–å¥½ï¼Œä¸”ä¸šä¸»è‡ªä½çš„æˆ¿å­çš„æ¯”ä¾‹ã€‚</p></li><li><p>DISï¼šä¸æ³¢å£«é¡¿å¸‚ä¸­å¿ƒçš„è·ç¦»ã€‚</p></li><li><p>RADï¼šå‘¨è¾¹é«˜é€Ÿå…¬è·¯çš„ä¾¿åˆ©æ€§æŒ‡æ•°ã€‚</p></li><li><p>TAXï¼šæ¯10000ç¾å…ƒçš„è´¢äº§ç¨ç‡ã€‚</p></li><li><p>PTRATIOï¼šå°å­¦è€å¸ˆçš„æ¯”ä¾‹ã€‚</p></li><li><p>Bï¼šåŸé•‡é»‘äººçš„æ¯”ä¾‹ã€‚</p></li><li><p>LSTATï¼šåœ°ä½è¾ƒä½çš„äººå£æ¯”ä¾‹ã€‚</p></li></ul><p>ä»è¿™äº›æŒ‡æ ‡é‡Œå¯ä»¥çœ‹åˆ°ä¸­ç¾æŒ‡æ ‡çš„ä¸€äº›å·®å¼‚ã€‚å½“ç„¶ï¼Œè¿™ä¸ªæ•°æ®æ˜¯åœ¨1993å¹´ä¹‹å‰æ”¶é›†çš„ï¼Œå¯èƒ½å’Œç°åœ¨ä¼šæœ‰å·®å¼‚ã€‚ä¸è¦å°çœ‹äº†è¿™äº›æŒ‡æ ‡ï¼Œå®é™…ä¸Šä¸€ä¸ªæ¨¡å‹çš„å¥½åå’Œè¾“å…¥ç‰¹å¾çš„é€‰æ‹©å…³ç³»å¯†åˆ‡ã€‚å¤§å®¶å¯ä»¥æ€è€ƒä¸€ä¸‹ï¼Œå¦‚æœè¦åœ¨ä¸­å›½é¢„æµ‹æˆ¿ä»·ï¼Œä½ ä¼šæ”¶é›†å“ªäº›ç‰¹å¾æ•°æ®ï¼Ÿè¿™äº›ç‰¹å¾æ•°æ®çš„å¯è·å¾—æ€§å¦‚ä½•ï¼Ÿæ”¶é›†æˆæœ¬å¤šé«˜ï¼Ÿ</p><p>å…ˆå¯¼å…¥æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> load_bostonboston <span class="token operator">=</span> load_boston<span class="token punctuation">(</span><span class="token punctuation">)</span>X <span class="token operator">=</span> boston<span class="token punctuation">.</span>datay <span class="token operator">=</span> boston<span class="token punctuation">.</span>target<span class="token keyword">print</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># (506, 13)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¡¨æ˜è¿™ä¸ªæ•°æ®é›†æœ‰506ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æœ‰13ä¸ªç‰¹å¾ã€‚æ•´ä¸ªè®­ç»ƒæ ·æœ¬æ”¾åœ¨ä¸€ä¸ª506*13çš„çŸ©é˜µé‡Œã€‚å¯ä»¥é€šè¿‡X[0]æ¥æŸ¥çœ‹ä¸€ä¸ªæ ·æœ¬æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">6.320e-03</span><span class="token punctuation">,</span> <span class="token number">1.800e+01</span><span class="token punctuation">,</span> <span class="token number">2.310e+00</span><span class="token punctuation">,</span> <span class="token number">0.000e+00</span><span class="token punctuation">,</span> <span class="token number">5.380e-01</span><span class="token punctuation">,</span> <span class="token number">6.575e+00</span><span class="token punctuation">,</span>       <span class="token number">6.520e+01</span><span class="token punctuation">,</span> <span class="token number">4.090e+00</span><span class="token punctuation">,</span> <span class="token number">1.000e+00</span><span class="token punctuation">,</span> <span class="token number">2.960e+02</span><span class="token punctuation">,</span> <span class="token number">1.530e+01</span><span class="token punctuation">,</span> <span class="token number">3.969e+02</span><span class="token punctuation">,</span>       <span class="token number">4.980e+00</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿˜å¯ä»¥é€šè¿‡ <code>boston.features_names</code> æ¥æŸ¥çœ‹è¿™äº›ç‰¹å¾çš„æ ‡ç­¾ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>boston<span class="token punctuation">.</span>feature_names<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'CRIM'</span><span class="token punctuation">,</span> <span class="token string">'ZN'</span><span class="token punctuation">,</span> <span class="token string">'INDUS'</span><span class="token punctuation">,</span> <span class="token string">'CHAS'</span><span class="token punctuation">,</span> <span class="token string">'NOX'</span><span class="token punctuation">,</span> <span class="token string">'RM'</span><span class="token punctuation">,</span> <span class="token string">'AGE'</span><span class="token punctuation">,</span> <span class="token string">'DIS'</span><span class="token punctuation">,</span> <span class="token string">'RAD'</span><span class="token punctuation">,</span>       <span class="token string">'TAX'</span><span class="token punctuation">,</span> <span class="token string">'PTRATIO'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'LSTAT'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'&lt;U7'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆ‘ä»¬å¯ä»¥æŠŠç‰¹å¾å’Œæ•°å€¼å¯¹åº”èµ·æ¥ï¼Œè§‚å¯Ÿä¸€ä¸‹æ•°æ®ã€‚</p><h3 id="æ¨¡å‹è®­ç»ƒ"><a href="#æ¨¡å‹è®­ç»ƒ" class="headerlink" title="æ¨¡å‹è®­ç»ƒ"></a>æ¨¡å‹è®­ç»ƒ</h3><p>åœ¨ <code>scikit-learn</code> é‡Œï¼Œ<code>LinearRegression</code> ç±»å®ç°äº†çº¿æ€§å›å½’ç®—æ³•ã€‚åœ¨å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŠŠæ•°æ®é›†åˆ†æˆä¸¤ä»½ï¼Œä»¥ä¾¿è¯„ä¼°ç®—æ³•çš„å‡†ç¡®æ€§ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_splitX_train<span class="token punctuation">,</span>X_test<span class="token punctuation">,</span>y_train<span class="token punctuation">,</span>y_test<span class="token operator">=</span>train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç”±äºæ•°æ®é‡æ¯”è¾ƒå°ï¼Œæˆ‘ä»¬åªé€‰äº†20%çš„æ ·æœ¬æ¥ä½œä¸ºæµ‹è¯•æ•°æ®é›†ã€‚æ¥ç€ï¼Œè®­ç»ƒæ¨¡å‹å¹¶æµ‹è¯•æ¨¡å‹çš„å‡†ç¡®æ€§è¯„åˆ†ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> time<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegressionmodel <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span>start <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>train_score <span class="token operator">=</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>test_score <span class="token operator">=</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span>y_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"elaspe:{0:.6f};train_score:{1:0.6f};test_score:{2:.6f}"</span>      <span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">,</span>train_score<span class="token punctuation">,</span>test_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬é¡ºä¾¿ç»Ÿè®¡äº†æ¨¡å‹çš„è®­ç»ƒæ—¶é—´ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œç»Ÿè®¡æ¨¡å‹å¯¹è®­ç»ƒæ ·æœ¬çš„å‡†ç¡®æ€§å¾—åˆ†ï¼ˆå³å¯¹è®­ç»ƒæ ·æœ¬æ‹Ÿåˆçš„å¥½åç¨‹åº¦ï¼‰<code>train_score</code>ï¼Œè¿˜æµ‹è¯•äº†æ¨¡å‹å¯¹æµ‹è¯•æ ·æœ¬çš„å¾—åˆ†test_scoreã€‚è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">elaspe<span class="token punctuation">:</span><span class="token number">0.000000</span><span class="token punctuation">;</span>train_score<span class="token punctuation">:</span><span class="token number">0.723941</span><span class="token punctuation">;</span>test_score<span class="token punctuation">:</span><span class="token number">0.795262</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä»å¾—åˆ†æƒ…å†µæ¥çœ‹ï¼Œæ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœä¸€èˆ¬ï¼Œè¿˜æœ‰æ²¡æœ‰åŠæ³•æ¥ä¼˜åŒ–æ¨¡å‹çš„æ‹Ÿåˆæ•ˆæœå‘¢ï¼Ÿ</p><h3 id="æ¨¡å‹ä¼˜åŒ–-1"><a href="#æ¨¡å‹ä¼˜åŒ–-1" class="headerlink" title="æ¨¡å‹ä¼˜åŒ–"></a>æ¨¡å‹ä¼˜åŒ–</h3><p>é¦–å…ˆè§‚å¯Ÿä¸€ä¸‹æ•°æ®ï¼Œç‰¹å¾æ•°æ®çš„èŒƒå›´ç›¸å·®æ¯”è¾ƒå¤§ï¼Œæœ€å°çš„åœ¨$10^{-3}$çº§åˆ«ï¼Œè€Œæœ€å¤§çš„åœ¨$10^{2}$çº§åˆ«ï¼Œçœ‹æ¥æˆ‘ä»¬éœ€è¦å…ˆæŠŠæ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ã€‚å½’ä¸€åŒ–å¤„ç†æœ€ç®€å•çš„æ–¹å¼æ˜¯ï¼Œåˆ›å»ºçº¿æ€§å›å½’æ¨¡å‹æ—¶å¢åŠ normalize=Trueå‚æ•°ï¼š</p><pre class="line-numbers language-python"><code class="language-python">model <span class="token operator">=</span> LinearRegression<span class="token punctuation">(</span>normalize<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“ç„¶ï¼Œæ•°æ®å½’ä¸€åŒ–å¤„ç†åªä¼šåŠ å¿«ç®—æ³•æ”¶æ•›é€Ÿåº¦ï¼Œä¼˜åŒ–ç®—æ³•è®­ç»ƒçš„æ•ˆç‡ï¼Œæ— æ³•æå‡ç®—æ³•çš„å‡†ç¡®æ€§ã€‚</p><p>æ€ä¹ˆæ ·ä¼˜åŒ–æ¨¡å‹çš„å‡†ç¡®æ€§å‘¢ï¼Ÿæˆ‘ä»¬å›åˆ°è®­ç»ƒåˆ†æ•°ä¸Šæ¥ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°æ¨¡å‹é’ˆå¯¹è®­ç»ƒæ ·æœ¬çš„è¯„åˆ†æ¯”è¾ƒä½ï¼ˆtrain_score:0.723941ï¼‰ï¼Œå³æ¨¡å‹å¯¹è®­ç»ƒæ ·æœ¬çš„æ‹Ÿåˆæˆæœ¬æ¯”è¾ƒé«˜ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æ¬ æ‹Ÿåˆç°è±¡ã€‚å›å¿†æˆ‘ä»¬ä¹‹å‰ä»‹ç»çš„ä¼˜åŒ–æ¬ æ‹Ÿåˆæ¨¡å‹çš„æ–¹æ³•ï¼Œä¸€æ˜¯æŒ–æ˜æ›´å¤šçš„è¾“å…¥ç‰¹å¾ï¼Œè€Œæ˜¯å¢åŠ å¤šé¡¹å¼ç‰¹å¾ã€‚åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­é‡Œï¼Œé€šè¿‡ä½¿ç”¨ä½æˆæœ¬çš„æ–¹æ¡ˆâ€”â€”å³å¢åŠ å¤šé¡¹å¼ç‰¹å¾æ¥çœ‹èƒ½å¦ä¼˜åŒ–æ¨¡å‹çš„æ€§èƒ½ã€‚å¢åŠ å¤šé¡¹å¼ç‰¹å¾ï¼Œå…¶å®å°±æ˜¯å¢åŠ æ¨¡å‹çš„å¤æ‚åº¦ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨ä¹‹å‰åˆ›å»ºå¤šé¡¹å¼æ¨¡å‹çš„å‡½æ•° <code>polynomial_model</code>ï¼Œæ¥ç€ï¼Œæˆ‘ä»¬ä½¿ç”¨äºŒé˜¶å¤šé¡¹å¼æ¥æ‹Ÿåˆæ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python">model <span class="token operator">=</span> polynomial_model<span class="token punctuation">(</span>degree<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>start <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>train_score <span class="token operator">=</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span>test_score <span class="token operator">=</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"elaspe:{0:.6f};train_score:{1:0.6f};test_score:{2:.6f}"</span>      <span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">,</span> train_score<span class="token punctuation">,</span> test_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºç»“æœæ˜¯ï¼š</p><pre class="line-numbers language-python"><code class="language-python">elaspe<span class="token punctuation">:</span><span class="token number">0.078125</span><span class="token punctuation">;</span>train_score<span class="token punctuation">:</span><span class="token number">0.930547</span><span class="token punctuation">;</span>test_score<span class="token punctuation">:</span><span class="token number">0.860049</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®­ç»ƒæ ·æœ¬åˆ†æ•°å’Œæµ‹è¯•åˆ†æ•°éƒ½æé«˜äº†ï¼Œçœ‹æ¥æ¨¡å‹ç¡®å®å¾—åˆ°äº†ä¼˜åŒ–ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå¤šé¡¹å¼æ”¹ä¸º3é˜¶çœ‹ä¸€ä¸‹æ•ˆæœï¼š</p><pre class="line-numbers language-python"><code class="language-python">elaspe<span class="token punctuation">:</span><span class="token number">0.093750</span><span class="token punctuation">;</span>train_score<span class="token punctuation">:</span><span class="token number">1.000000</span><span class="token punctuation">;</span>test_score<span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">105.548323</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ”¹ä¸º3é˜¶å¤šé¡¹å¼åï¼Œé’ˆå¯¹è®­ç»ƒæ ·æœ¬çš„åˆ†æ•°è¾¾åˆ°äº†1ï¼Œè€Œé’ˆå¯¹æµ‹è¯•æ ·æœ¬çš„åˆ†æ•°ç¡®å®è´Ÿæ•°ï¼Œè¯´æ˜è¿™ä¸ªæ¨¡å‹è¿‡æ‹Ÿåˆäº†ã€‚</p><p>æ€è€ƒï¼šæˆ‘ä»¬æ€»å…±æœ‰13ä¸ªè¾“å…¥ç‰¹å¾ï¼Œä»ä¸€é˜¶å¤šé¡¹å¼å˜ä¸ºäºŒé˜¶å¤šé¡¹å¼ï¼Œè¾“å…¥ç‰¹å¾ä¸ªæ•°å¢åŠ äº†å¤šå°‘ä¸ªï¼Ÿ<br> å‚è€ƒï¼šäºŒé˜¶å¤šé¡¹å¼å…±æœ‰ï¼š13ä¸ªå•ä¸€çš„ç‰¹å¾ï¼Œ$C_{13}^{2}=78$ ä¸ªä¸¤ä¸¤é…å¯¹çš„ç‰¹å¾ï¼Œ13ä¸ªå„è‡ªå¹³æ–¹çš„ç‰¹å¾ï¼Œå…±è®¡104ä¸ªç‰¹å¾ã€‚æ¯”ä¸€é˜¶å¤šé¡¹å¼çš„13ä¸ªç‰¹å¾å¢åŠ äº†91ä¸ªç‰¹å¾ã€‚</p><h3 id="å­¦ä¹ æ›²çº¿"><a href="#å­¦ä¹ æ›²çº¿" class="headerlink" title="å­¦ä¹ æ›²çº¿"></a>å­¦ä¹ æ›²çº¿</h3><p>æ›´å¥½çš„æ–¹æ³•æ˜¯ç”»å‡ºå­¦ä¹ æ›²çº¿ï¼Œè¿™æ ·å¯¹æ¨¡å‹çš„çŠ¶æ€ä»¥åŠä¼˜åŒ–çš„æ–¹å‘å°±ä¸€ç›®äº†ç„¶ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">from</span> utils <span class="token keyword">import</span> plot_learning_curve<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> ShuffleSplitcv <span class="token operator">=</span> ShuffleSplit<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>title <span class="token operator">=</span> <span class="token string">'Learning Curves (degree={0})'</span>degrees <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>start <span class="token operator">=</span> time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>degrees<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>    plot_learning_curve<span class="token punctuation">(</span>plt<span class="token punctuation">,</span>polynomial_model<span class="token punctuation">(</span>degrees<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>title<span class="token punctuation">.</span>format<span class="token punctuation">(</span>degrees<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                        X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>ylim<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.01</span><span class="token punctuation">,</span><span class="token number">1.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span>cv<span class="token operator">=</span>cv<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'elaspe:{0:.6f}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>time<span class="token punctuation">.</span>process_time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200630092742917.png" alt="image-20200630100257358"></p><p>ä»å­¦ä¹ æ›²çº¿ä¸­å¯ä»¥çœ‹å‡ºï¼Œä¸€é˜¶å¤šé¡¹å¼æ¬ æ‹Ÿåˆï¼Œå› ä¸ºé’ˆå¯¹è®­ç»ƒæ ·æœ¬çš„åˆ†æ•°æ¯”è¾ƒä½ï¼›è€Œä¸‰é˜¶å¤šé¡¹å¼è¿‡æ‹Ÿåˆï¼Œå› ä¸ºé’ˆå¯¹è®­ç»ƒæ ·æœ¬çš„åˆ†æ•°è¾¾åˆ°1ï¼Œå´çœ‹ä¸åˆ°äº¤å‰éªŒè¯æ•°æ®é›†çš„åˆ†æ•°ã€‚é’ˆå¯¹äºŒé˜¶å¤šé¡¹å¼æ‹Ÿåˆçš„æƒ…å†µï¼Œè™½ç„¶æ¯”ä¸€é˜¶å¤šé¡¹å¼çš„æ•ˆæœå¥½ï¼Œä½†ä»å›¾ä¸­å¯ä»¥æ˜æ˜¾åœ°çœ‹å‡ºæ¥ï¼Œé’ˆå¯¹è®­ç»ƒæ•°æ®é›†çš„åˆ†æ•°å’Œé’ˆå¯¹äº¤å‰éªŒè¯æ•°æ®é›†çš„åˆ†æ•°ä¹‹é—´çš„é—´éš”æ¯”è¾ƒå¤§ï¼Œè¿™è¯´æ˜è®­ç»ƒæ ·æœ¬æ•°é‡ä¸å¤Ÿï¼Œæˆ‘ä»¬åº”è¯¥å»é‡‡é›†æ›´å¤šçš„æ•°æ®ï¼Œä»¥æé«˜æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚</p><h2 id="æ‹“å±•é˜…è¯»"><a href="#æ‹“å±•é˜…è¯»" class="headerlink" title="æ‹“å±•é˜…è¯»"></a>æ‹“å±•é˜…è¯»</h2><p>æœ¬èŠ‚å†…å®¹æ¶‰åŠåˆ°è¾ƒå¤šçš„æ•°å­¦çŸ¥è¯†ï¼Œç‰¹åˆ«æ˜¯çŸ©é˜µå’Œåå¯¼æ•°è¿ç®—æ³•åˆ™ã€‚å¦‚æœé˜…è¯»èµ·æ¥æœ‰å›°éš¾ï¼Œå¯ä»¥å…ˆè·³è¿‡ã€‚å¦‚æœæœ‰ä¸€å®šæ•°å­¦åŸºç¡€ï¼Œè¿™äº›çŸ¥è¯†å¯¹ç†è§£ç®—æ³•çš„å®ç°ç»†èŠ‚åŠç®—æ³•çš„æ•ˆç‡æœ‰è¾ƒå¤§çš„å¸®åŠ©ã€‚</p><h3 id="å…¬å¼æ¨å¯¼çš„æ•°å­¦åŸºç¡€"><a href="#å…¬å¼æ¨å¯¼çš„æ•°å­¦åŸºç¡€" class="headerlink" title="å…¬å¼æ¨å¯¼çš„æ•°å­¦åŸºç¡€"></a>å…¬å¼æ¨å¯¼çš„æ•°å­¦åŸºç¡€</h3><p>AIçš„æ•°å­¦åŸºç¡€æœ€ä¸»è¦çš„æ˜¯é«˜ç­‰æ•°å­¦ã€çº¿æ€§ä»£æ•°ã€æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡è¿™ä¸‰é—¨è¯¾ç¨‹ã€‚ä¸‹é¢æ˜¯ç®€æ˜“çš„å…¥é—¨æ–‡ç« ä¾›å‚è€ƒ</p><ul><li>é«˜ç­‰æ•°å­¦ <a href="https://zhuanlan.zhihu.com/p/36311622" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/36311622</a></li><li>çº¿æ€§ä»£æ•° <a href="https://zhuanlan.zhihu.com/p/36584206" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/36584206</a></li><li>æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ <a href="https://zhuanlan.zhihu.com/p/36584335" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/36584335</a></li></ul><h3 id="éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•"><a href="#éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•" class="headerlink" title="éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•"></a>éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•</h3><p>æœ¬ç« ä»‹ç»çš„æ¢¯åº¦ä¸‹é™ç®—æ³•è¿­ä»£å…¬å¼ç§°ä¸ºæ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼ˆBatch Gradient Descentï¼Œç®€ç§°BGDï¼‰ï¼Œç”¨å®ƒå¯¹å‚æ•°è¿›è¡Œä¸€æ¬¡è¿­ä»£è¿ç®—ï¼Œéœ€è¦éå†æ‰€æœ‰çš„è®­ç»ƒæ•°æ®é›†ã€‚å½“è®­ç»ƒæ•°æ®é›†æ¯”è¾ƒå¤§æ—¶ï¼Œå…¶ç®—æ³•çš„æ•ˆç‡ä¼šæ¯”è¾ƒä½ã€‚è€ƒè™‘å¦å¤–ä¸€ä¸ªç®—æ³•ï¼š<br>$$<br>\theta_{j}=\theta_{j}-\alpha\left(\left(h\left(x^{(i)}\right)-y^{(i)}\right) x_{j}^{(i)}\right)<br>$$<br> è¿™ä¸ªç®—æ³•çš„å…³é”®ç‚¹æ˜¯æŠŠç´¯åŠ å™¨å»æ‰ï¼Œä¸å»éå†æ‰€æœ‰çš„æ•°æ®é›†ï¼Œè€Œæ˜¯æ”¹æˆæ¯æ¬¡éšæœºåœ°ä»è®­ç»ƒæ•°æ®é›†ä¸­å–ä¸€ä¸ªæ•°æ®è¿›è¡Œå‚æ•°è¿­ä»£è®¡ç®—ï¼Œè¿™å°±æ˜¯éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼ˆStochastic Gradient Descentï¼Œç®€ç§°SGDï¼‰ã€‚éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•å¯ä»¥å¤§å¤§æé«˜æ¨¡å‹è®­ç»ƒçš„æ•ˆç‡ã€‚</p><h3 id="æ­£è§„æ–¹ç¨‹"><a href="#æ­£è§„æ–¹ç¨‹" class="headerlink" title="æ­£è§„æ–¹ç¨‹"></a>æ­£è§„æ–¹ç¨‹</h3><p>æ¢¯åº¦ä¸‹é™ç®—æ³•é€šè¿‡ä¸æ–­åœ°è¿­ä»£ï¼Œä»è€Œä¸åœåœ°é€¼è¿‘æˆæœ¬å‡½æ•°çš„æœ€å°å€¼æ¥æ±‚è§£æ¨¡å‹çš„å‚æ•°ã€‚å¦å¤–ä¸€ä¸ªæ–¹æ³•æ˜¯ç›´æ¥è®¡ç®—æˆæœ¬å‡½æ•°çš„å¾®åˆ†ï¼Œä»¤å¾®åˆ†ç®—å­ä¸º0ï¼Œæ±‚è§£è¿™ä¸ªæ–¹ç¨‹ï¼Œå³å¯å¾—åˆ°çº¿æ€§å›å½’çš„è§£ã€‚<br> çº¿æ€§å›å½’ç®—æ³•çš„æŸå¤±å‡½æ•°ï¼š<br>$$<br>J(\theta)=\frac{1}{2 m} \sum_{i=0}^{n}\left(h_{\theta}\left(x^{(i)}\right)-y^{(i)}\right)^{2}<br>$$<br>æˆæœ¬å‡½æ•°çš„â€œæ–œç‡â€ä¸º0çš„ç‚¹ï¼Œå³ä¸ºæ¨¡å‹å‚æ•°çš„è§£ã€‚ä»¤$\frac{\partial}{\partial \theta} J(\theta)=0$ï¼Œæ±‚è§£è¿™ä¸ªæ–¹ç¨‹æœ€ç»ˆå¯ä»¥å¾—åˆ°æ¨¡å‹å‚æ•°ï¼š<br>$$<br>\theta=\left(X^{T} X\right)^{-1} X^{T} y<br>$$<br>è¿™å°±æ˜¯æˆ‘ä»¬çš„æ­£è§„æ–¹ç¨‹ã€‚å®ƒé€šè¿‡çŸ©é˜µè¿ç®—ï¼Œç›´æ¥ä»è®­ç»ƒæ ·æœ¬é‡Œæ±‚å‡ºå‚æ•°Î¸çš„å€¼ã€‚å…¶ä¸­Xä¸ºè®­ç»ƒæ ·æœ¬çš„çŸ©é˜µå½¢å¼ï¼Œå®ƒæ˜¯mÃ—nçš„çŸ©é˜µï¼Œyæ˜¯è®­ç»ƒæ ·æœ¬çš„ç»“æœæ•°æ®ï¼Œå®ƒæ˜¯ä¸ªmç»´åˆ—å‘é‡ã€‚æ–¹ç¨‹æ±‚è§£è¿‡ç¨‹å¯å‚é˜…<a href="https://baike.baidu.com/item/%E6%AD%A3%E8%A7%84%E6%96%B9%E7%A8%8B/10001812?fr=aladdin" target="_blank" rel="noopener">ç™¾åº¦ç™¾ç§‘</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MLç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scikit-learnç³»åˆ—äºŒï¼šK-è¿‘é‚»</title>
      <link href="/2020/06/29/scikit-learn-xi-lie-er-k-jin-lin/"/>
      <url>/2020/06/29/scikit-learn-xi-lie-er-k-jin-lin/</url>
      
        <content type="html"><![CDATA[<h2 id="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼"><a href="#é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿-star-å’Œ-fork-ï¼" class="headerlink" title="é¡¹ç›®åœ°å€ä¼ é€é—¨ï¼Œæ¬¢è¿ star å’Œ fork ï¼"></a>é¡¹ç›®åœ°å€<a href="https://github.com/DongZhouGu/scikit-learn-ml" target="_blank" rel="noopener">ä¼ é€é—¨</a>ï¼Œæ¬¢è¿ star å’Œ fork ï¼</h2><h2 id="KNN-æ¦‚è¿°"><a href="#KNN-æ¦‚è¿°" class="headerlink" title="KNN æ¦‚è¿°"></a>KNN æ¦‚è¿°</h2><p>KNNï¼ˆK-Nearest Neighborï¼ŒK-è¿‘é‚»ç®—æ³•ï¼‰ç®—æ³•æ˜¯ä¸€ç§<strong>æœ‰ç›‘ç£</strong>çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå¯ä»¥è§£å†³åˆ†ç±»é—®é¢˜ï¼Œä¹Ÿå¯ä»¥è§£å†³å›å½’é—®é¢˜ã€‚</p><blockquote><p><strong>ä¸€å¥è¯æ€»ç»“: è¿‘æœ±è€…èµ¤è¿‘å¢¨è€…é»‘ï¼</strong> </p></blockquote><p>k -è¿‘é‚»ç®—æ³•çš„è¾“å…¥ä¸ºå®ä¾‹çš„ç‰¹å¾å‘é‡ï¼Œå¯¹åº”äºç‰¹å¾ç©ºé—´çš„ç‚¹ï¼›è¾“å‡ºä¸ºå®ä¾‹çš„ç±»åˆ«ï¼Œå¯ä»¥å–å¤šç±»ã€‚k è¿‘é‚»ç®—æ³•å‡è®¾ç»™å®šä¸€ä¸ªè®­ç»ƒæ•°æ®é›†ï¼Œå…¶ä¸­çš„å®ä¾‹ç±»åˆ«å·²å®šã€‚åˆ†ç±»æ—¶ï¼Œå¯¹æ–°çš„å®ä¾‹ï¼Œæ ¹æ®å…¶ k ä¸ªæœ€è¿‘é‚»çš„è®­ç»ƒå®ä¾‹çš„ç±»åˆ«ï¼Œé€šè¿‡å¤šæ•°è¡¨å†³ç­‰æ–¹å¼è¿›è¡Œé¢„æµ‹ã€‚å› æ­¤ï¼Œkè¿‘é‚»ç®—æ³•ä¸å…·æœ‰æ˜¾å¼çš„å­¦ä¹ è¿‡ç¨‹ã€‚</p><h2 id="KNNç®—æ³•åŸç†"><a href="#KNNç®—æ³•åŸç†" class="headerlink" title="KNNç®—æ³•åŸç†"></a>KNNç®—æ³•åŸç†</h2><p>K-è¿‘é‚»ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯æœªæ ‡è®°æ ·æœ¬çš„ç±»åˆ«ï¼Œç”±è·ç¦»å…¶æœ€è¿‘çš„ K ä¸ªé‚»å±…æŠ•ç¥¨æ¥å†³å®šã€‚</p><p>å‡è®¾ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå·²ç»æ ‡è®°çš„æ•°æ®é›†ï¼Œå³å·²ç»çŸ¥é“äº†æ•°æ®é›†ä¸­æ¯ä¸ªæ ·æœ¬æ‰€å±çš„ç±»åˆ«ã€‚æ­¤æ—¶ï¼Œæœ‰ä¸€ä¸ªæœªæ ‡è®°çš„æ•°æ®æ ·æœ¬ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯é¢„æµ‹å‡ºè¿™ä¸ªæ•°æ®æ ·æœ¬æ‰€å±çš„ç±»åˆ«ã€‚<strong>K-è¿‘é‚»ç®—æ³•çš„åŸç†æ˜¯ï¼Œè®¡ç®—å¾…æ ‡è®°çš„æ•°æ®æ ·æœ¬å’Œæ•°æ®é›†ä¸­æ¯ä¸ªæ ·æœ¬çš„è·ç¦»ï¼Œå–è·ç¦»æœ€è¿‘çš„Kä¸ªæ ·æœ¬ã€‚</strong>å¾…æ ‡è®°çš„æ•°æ®æ ·æœ¬æ‰€å±çš„ç±»åˆ«ï¼Œå°±ç”±è¿™Kä¸ªè·ç¦»æœ€è¿‘çš„æ ·æœ¬æŠ•ç¥¨äº§ç”Ÿã€‚</p><blockquote><p>KNNå·¥ä½œåŸç†</p></blockquote><p>å‡è®¾X_testä¸ºå¾…æ ‡è®°çš„æ•°æ®æ ·æœ¬ï¼ŒX_trainä¸ºå·²æ ‡è®°çš„æ•°æ®é›†ï¼Œç®—æ³•åŸç†çš„ä¼ªä»£ç å¦‚ä¸‹ï¼š</p><ul><li>éå† X_train ä¸­çš„æ‰€æœ‰æ ·æœ¬ï¼Œè®¡ç®—æ¯ä¸ªæ ·æœ¬ä¸ X_test çš„è·ç¦»ï¼Œå¹¶æŠŠè·ç¦»ä¿å­˜åœ¨ Distance æ•°ç»„ä¸­ã€‚</li><li>å¯¹ Distance æ•°ç»„è¿›è¡Œæ’åºï¼Œå–è·ç¦»æœ€è¿‘çš„Kä¸ªç‚¹ï¼Œè®°ä¸º X_knn ã€‚</li><li>åœ¨ X_knn ä¸­ç»Ÿè®¡æ¯ä¸ªç±»åˆ«çš„ä¸ªæ•°ï¼Œå³ class0 åœ¨ X_knn ä¸­æœ‰å‡ ä¸ªæ ·æœ¬ï¼Œclass1 åœ¨ X_knn ä¸­æœ‰å‡ ä¸ªæ ·æœ¬ç­‰ã€‚</li><li>å¾…æ ‡è®°æ ·æœ¬çš„ç±»åˆ«ï¼Œå°±æ˜¯åœ¨ X_knn ä¸­æ ·æœ¬æ•°æœ€å¤šçš„é‚£ä¸ªç±»åˆ«ã€‚</li></ul><blockquote><p>KNNç®—æ³•ä¼˜ç¼ºç‚¹</p></blockquote><ul><li>ä¼˜ç‚¹ï¼šå‡†ç¡®åº¦é«˜ï¼Œå¯¹å¼‚å¸¸å€¼å’Œå™ªå£°æœ‰è¾ƒé«˜çš„å®¹å¿åº¦ã€‚</li><li>ç¼ºç‚¹ï¼šè®¡ç®—å¤æ‚åº¦é«˜ã€ç©ºé—´å¤æ‚åº¦é«˜ï¼Œä»ç®—æ³•åŸç†å¯ä»¥çœ‹å‡ºï¼Œæ¯æ¬¡å¯¹ä¸€ä¸ªæœªæ ‡è®°æ ·æœ¬è¿›è¡Œåˆ†ç±»æ—¶ï¼Œéƒ½éœ€è¦å…¨éƒ¨è®¡ç®—ä¸€éè·ç¦»ã€‚</li></ul><blockquote><p>KNNç®—æ³•å‚æ•°</p></blockquote><p>å…¶ç®—æ³•å‚æ•°æ˜¯Kï¼Œå‚æ•°é€‰æ‹©éœ€è¦æ ¹æ®æ•°æ®æ¥å†³å®šã€‚Kå€¼è¶Šå¤§ï¼Œæ¨¡å‹çš„åå·®è¶Šå¤§ï¼Œå¯¹å™ªå£°æ•°æ®è¶Šä¸æ•æ„Ÿï¼Œå½“Kå€¼å¾ˆå¤§æ—¶ï¼Œå¯èƒ½é€ æˆæ¨¡å‹æ¬ æ‹Ÿåˆï¼›Kå€¼è¶Šå°ï¼Œæ¨¡å‹çš„æ–¹å·®å°±ä¼šè¶Šå¤§ï¼Œå½“Kå€¼å¤ªå°ï¼Œå°±ä¼šé€ æˆæ¨¡å‹è¿‡æ‹Ÿåˆã€‚</p><blockquote><p>KNNç®—æ³•å˜ç§</p></blockquote><p>K-è¿‘é‚»ç®—æ³•æœ‰ä¸€äº›å˜ç§ï¼Œå…¶ä¸­ä¹‹ä¸€å°±æ˜¯å¯ä»¥å¢åŠ é‚»å±…çš„æƒé‡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨è®¡ç®—è·ç¦»æ—¶ï¼Œéƒ½æ˜¯ä½¿ç”¨ç›¸åŒçš„æƒé‡ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é’ˆå¯¹ä¸åŒçš„é‚»å±…æŒ‡å®šä¸åŒçš„æƒé‡ï¼Œå¦‚è·ç¦»è¶Šè¿‘æƒé‡è¶Šé«˜ã€‚è¿™ä¸ªå¯ä»¥é€šè¿‡æŒ‡å®šç®—æ³•çš„weightså‚æ•°æ¥å®ç°ã€‚</p><p>å¦å¤–ä¸€ä¸ªå˜ç§æ˜¯ï¼Œä½¿ç”¨ä¸€å®šåŠå¾„å†…çš„ç‚¹å–ä»£è·ç¦»æœ€è¿‘çš„Kä¸ªç‚¹ã€‚åœ¨ <code>scikit-learn</code> é‡Œï¼Œ<code>RadiusNeighborsClassifier</code> ç±»å®ç°äº†è¿™ä¸ªç®—æ³•çš„å˜ç§ã€‚å½“æ•°æ®é‡‡æ ·ä¸å‡åŒ€æ—¶ï¼Œè¯¥ç®—æ³•å˜ç§å¯ä»¥å–å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</p><h2 id="KNN-é¡¹ç›®æ¡ˆä¾‹"><a href="#KNN-é¡¹ç›®æ¡ˆä¾‹" class="headerlink" title="KNN é¡¹ç›®æ¡ˆä¾‹"></a>KNN é¡¹ç›®æ¡ˆä¾‹</h2><h3 id="æ¡ˆä¾‹1-ä½¿ç”¨KNNç®—æ³•è¿›è¡Œåˆ†ç±»"><a href="#æ¡ˆä¾‹1-ä½¿ç”¨KNNç®—æ³•è¿›è¡Œåˆ†ç±»" class="headerlink" title="æ¡ˆä¾‹1: ä½¿ç”¨KNNç®—æ³•è¿›è¡Œåˆ†ç±»"></a>æ¡ˆä¾‹1: ä½¿ç”¨KNNç®—æ³•è¿›è¡Œåˆ†ç±»</h3><p>å®Œæ•´ä»£ç åœ°å€ï¼š</p><p>åœ¨ <code>scikit-learn</code>é‡Œï¼Œä½¿ç”¨K-è¿‘é‚»ç®—æ³•è¿›è¡Œåˆ†ç±»å¤„ç†çš„æ˜¯ <code>sklearn.neightbors.KNeightborsClassifier</code> ç±»ã€‚</p><h4 id="rainbow-ç”Ÿæˆæ•°æ®é›†"><a href="#rainbow-ç”Ÿæˆæ•°æ®é›†" class="headerlink" title=":rainbow:   ç”Ÿæˆæ•°æ®é›†"></a>:rainbow:   ç”Ÿæˆæ•°æ®é›†</h4><p>æˆ‘ä»¬ä½¿ç”¨ <code>sklearn.datasets.samples_generator</code> åŒ…ä¸‹çš„ <code>make_blobs()</code> å‡½æ•°æ¥ç”Ÿæˆæ•°æ®é›†ï¼Œè¿™é‡Œç”Ÿæˆ60ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œè¿™äº›æ ·æœ¬åˆ†å¸ƒåœ¨ <code>centers</code> å‚æ•°æŒ‡å®šçš„ä¸­å¿ƒç‚¹çš„å‘¨å›´ã€‚<code>cluster_std</code> æ˜¯æ ‡å‡†å·®ï¼Œç”¨æ¥æŒ‡æ˜ç”Ÿæˆçš„ç‚¹åˆ†å¸ƒçš„æ¾æ•£ç¨‹åº¦ã€‚ç”Ÿæˆçš„è®­ç»ƒæ•°æ®é›†æ”¾åœ¨å˜é‡Xé‡Œé¢ï¼Œæ•°æ®é›†çš„ç±»åˆ«æ ‡è®°æ”¾åœ¨ y é‡Œé¢ã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>datasets <span class="token keyword">import</span> make_blobs<span class="token comment" spellcheck="true"># ç”Ÿæˆæ•°æ®</span>centers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span>X<span class="token punctuation">,</span>y <span class="token operator">=</span> make_blobs<span class="token punctuation">(</span>n_samples<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span>centers<span class="token operator">=</span>centers<span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>cluster_std<span class="token operator">=</span><span class="token number">0.60</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>X:  [[ 1.59652373  1.7842681 ] ,[-1.08033247 2.88161526],â€¦]å…±60ä¸ªç‚¹çš„æ¨ªçºµåæ ‡</p><p>y: [1 0 0 1 0 1 1 0 2â€¦1 2 0 1] å…±60ä¸ªç‚¹çš„ç±»åˆ«ï¼Œç”¨0ï¼Œ1ï¼Œ2åˆ†åˆ«è¡¨ç¤ºä»¥å“ªä¸ªä¸­å¿ƒèšåˆ</p></blockquote><p>ä½¿ç”¨ <code>matplotlib</code> åº“ï¼Œå®ƒå¯ä»¥å¾ˆå®¹æ˜“åœ°æŠŠç”Ÿæˆçš„ç‚¹ç”»å‡ºæ¥ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> numpy <span class="token keyword">as</span> npplt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>c <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>centers<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># cmapå°±æ˜¯æŒ‡matplotlib.colors.Colormap,ä¸€ä¸ªåŒ…å«ä¸‰åˆ—çŸ©é˜µçš„è‰²å½©æ˜ å°„è¡¨</span><span class="token comment" spellcheck="true"># ä½¿ç”¨cå’Œcmapæ¥æ˜ å°„é¢œè‰²ï¼Œsä¸ºå½¢çŠ¶çš„å¤§å°</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token operator">=</span>y<span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>cmap<span class="token operator">=</span><span class="token string">'cool'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>c<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>marker<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'black'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200628191906466.png"><p>è¿™äº›ç‚¹çš„åˆ†å¸ƒæƒ…å†µåœ¨åæ ‡è½´ä¸Šä¸€ç›®äº†ç„¶ï¼Œå…¶ä¸­äº”è§’æ˜Ÿçš„ç‚¹å³å„ä¸ªç±»åˆ«çš„ä¸­å¿ƒç‚¹ã€‚</p><h4 id="rainbow-è®­ç»ƒç®—æ³•"><a href="#rainbow-è®­ç»ƒç®—æ³•" class="headerlink" title=":rainbow: è®­ç»ƒç®—æ³•"></a>:rainbow: è®­ç»ƒç®—æ³•</h4><p>ä½¿ç”¨ <code>KNeighborsClassifier</code> æ¥å¯¹ç®—æ³•è¿›è¡Œè®­ç»ƒï¼Œæˆ‘ä»¬é€‰æ‹©çš„å‚æ•°æ˜¯ <code>K=5</code></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifierk <span class="token operator">=</span> <span class="token number">5</span>clf <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span>k<span class="token punctuation">)</span>clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><code>KNeighborsClassifier</code>çš„å‚æ•°ç»†èŠ‚ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">KNeighborsClassifier<span class="token punctuation">(</span>algorithm<span class="token operator">=</span><span class="token string">'auto'</span><span class="token punctuation">,</span> leaf_size<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> metric<span class="token operator">=</span><span class="token string">'minkowski'</span><span class="token punctuation">,</span>           metric_params<span class="token operator">=</span>None<span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> n_neighbors<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> p<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>           weights<span class="token operator">=</span><span class="token string">'uniform'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="rainbow-å¯¹æ ·æœ¬è¿›è¡Œé¢„æµ‹"><a href="#rainbow-å¯¹æ ·æœ¬è¿›è¡Œé¢„æµ‹" class="headerlink" title=":rainbow:  å¯¹æ ·æœ¬è¿›è¡Œé¢„æµ‹"></a>:rainbow:  å¯¹æ ·æœ¬è¿›è¡Œé¢„æµ‹</h4><p>æˆ‘ä»¬è¦é¢„æµ‹çš„æ ·æœ¬æ˜¯[0,2]ï¼Œä½¿ç”¨ <code>kneighbors()</code> æ–¹æ³•ï¼ŒæŠŠè¿™ä¸ªæ ·æœ¬å‘¨å›´è·ç¦»æœ€è¿‘çš„5ä¸ªç‚¹å–å‡ºæ¥ã€‚å–å‡ºæ¥çš„ç‚¹æ˜¯è®­ç»ƒæ ·æœ¬Xé‡Œçš„ç´¢å¼•ï¼Œä»0å¼€å§‹è®¡ç®—ã€‚<br> æ³¨æ„ï¼š<code>kneighbors()</code>æ¥æ”¶ä¸€ä¸ªäºŒç»´æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œæ‰€ä»¥ <code>X_sample</code> éœ€è¦å˜æˆäºŒç»´ã€‚</p><pre class="line-numbers language-python"><code class="language-python">X_sample <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>X_sample <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X_sample<span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">#[[0 2]]</span>y_sample <span class="token operator">=</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>X_sample<span class="token punctuation">)</span>neighbors <span class="token operator">=</span> clf<span class="token punctuation">.</span>kneighbors<span class="token punctuation">(</span>X_sample<span class="token punctuation">,</span>return_distance<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#[[16 20 48  6 23]]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="rainbow-æ ‡è®°æœ€è¿‘çš„5ä¸ªç‚¹"><a href="#rainbow-æ ‡è®°æœ€è¿‘çš„5ä¸ªç‚¹" class="headerlink" title=":rainbow:  æ ‡è®°æœ€è¿‘çš„5ä¸ªç‚¹"></a>:rainbow:  æ ‡è®°æœ€è¿‘çš„5ä¸ªç‚¹</h4><p>æŠŠå¾…é¢„æµ‹çš„æ ·æœ¬ä»¥åŠå’Œå…¶æœ€è¿‘çš„5ä¸ªç‚¹æ ‡è®°å‡ºæ¥</p><pre class="line-numbers language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>y<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'cool'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># æ ·æœ¬</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'^'</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">)</span>   <span class="token comment" spellcheck="true"># ä¸­å¿ƒç‚¹</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_sample<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_sample<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>marker<span class="token operator">=</span><span class="token string">"x"</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'cool'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">#å¾…é¢„æµ‹çš„ç‚¹</span><span class="token comment" spellcheck="true">#é¢„æµ‹ç‚¹ä¸è·ç¦»æœ€è¿‘çš„5ä¸ªæ ·æœ¬çš„è¿çº¿</span><span class="token keyword">for</span> i <span class="token keyword">in</span> neighbors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_sample<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>X_sample<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'k--'</span><span class="token punctuation">,</span>linewidth<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200628204257514.png" alt=""></p><h3 id="æ¡ˆä¾‹2-ä½¿ç”¨KNNç®—æ³•è¿›è¡Œå›å½’æ‹Ÿåˆ"><a href="#æ¡ˆä¾‹2-ä½¿ç”¨KNNç®—æ³•è¿›è¡Œå›å½’æ‹Ÿåˆ" class="headerlink" title="æ¡ˆä¾‹2: ä½¿ç”¨KNNç®—æ³•è¿›è¡Œå›å½’æ‹Ÿåˆ"></a>æ¡ˆä¾‹2: ä½¿ç”¨KNNç®—æ³•è¿›è¡Œå›å½’æ‹Ÿåˆ</h3><p>åˆ†ç±»é—®é¢˜çš„é¢„æµ‹å€¼æ˜¯ç¦»æ•£çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ KNN ç®—æ³•å¯¹è¿ç»­åŒºé—´å†…çš„æ•°å€¼è¿›è¡Œé¢„æµ‹ï¼Œå³è¿›è¡Œå›å½’æ‹Ÿåˆã€‚åœ¨<code>scikit-learn</code>é‡Œé¢ï¼Œä½¿ç”¨KNNç®—æ³•è¿›è¡Œå›å½’æ‹Ÿåˆçš„å®ç°æ˜¯ <code>sklearn.neighbors.KNeighborsRegressor</code> ç±»ã€‚</p><h4 id="rainbow-ç”Ÿæˆæ•°æ®é›†-1"><a href="#rainbow-ç”Ÿæˆæ•°æ®é›†-1" class="headerlink" title=":rainbow:  ç”Ÿæˆæ•°æ®é›†"></a>:rainbow:  ç”Ÿæˆæ•°æ®é›†</h4><p>åœ¨ä½™å¼¦æ›²çº¿çš„åŸºç¡€ä¸ŠåŠ å…¥äº†å™ªå£°ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> npn_dots <span class="token operator">=</span> <span class="token number">40</span><span class="token comment" spellcheck="true"># ç”Ÿæˆ40è¡Œ1åˆ—çš„æœä»â€œ0~5â€å‡åŒ€åˆ†å¸ƒçš„éšæœºæ ·æœ¬</span>X <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span>n_dots<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>y <span class="token operator">=</span> np<span class="token punctuation">.</span>cos<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># ç”Ÿæˆ40è¡Œ1åˆ—çš„æœä»â€œ-0.1~0.1â€å‡åŒ€åˆ†å¸ƒçš„éšæœºè¯¯å·®</span>y <span class="token operator">+=</span> <span class="token number">0.2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span>n_dots<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="rainbow-è®­ç»ƒç®—æ³•-1"><a href="#rainbow-è®­ç»ƒç®—æ³•-1" class="headerlink" title=":rainbow:  è®­ç»ƒç®—æ³•"></a>:rainbow:  è®­ç»ƒç®—æ³•</h4><p>ä½¿ç”¨ <code>KNeighborsRegressor</code> æ¥è®­ç»ƒæ¨¡å‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsRegressork <span class="token operator">=</span> <span class="token number">5</span>knn <span class="token operator">=</span> KNeighborsRegressor<span class="token punctuation">(</span>k<span class="token punctuation">)</span>knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><code>KNeighborsRegressor</code>æ–¹æ³•çš„å‚æ•°ç»†èŠ‚ä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">KNeighborsRegressor<span class="token punctuation">(</span>algorithm<span class="token operator">=</span><span class="token string">'auto'</span><span class="token punctuation">,</span> leaf_size<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> metric<span class="token operator">=</span><span class="token string">'minkowski'</span><span class="token punctuation">,</span>          metric_params<span class="token operator">=</span>None<span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> n_neighbors<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> p<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>          weights<span class="token operator">=</span><span class="token string">'uniform'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥ä½¿ç”¨ <code>score()</code>æ–¹æ³• è®¡ç®—æ‹Ÿåˆæ›²çº¿å¯¹è®­ç»ƒæ ·æœ¬çš„æ‹Ÿåˆå‡†ç¡®æ€§ï¼š</p><pre class="line-numbers language-python"><code class="language-python">knn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token number">0.9596828473009764</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="rainbow-å›å½’æ‹Ÿåˆ"><a href="#rainbow-å›å½’æ‹Ÿåˆ" class="headerlink" title=":rainbow:  å›å½’æ‹Ÿåˆ"></a>:rainbow:  å›å½’æ‹Ÿåˆ</h4><p> ä¸€ä¸ªå¸¸ç”¨çš„æ–¹æ³•æ˜¯ï¼Œåœ¨Xè½´ä¸Šçš„æŒ‡å®šåŒºåŸŸç”Ÿæˆè¶³å¤Ÿå¤šçš„ç‚¹ï¼Œé’ˆå¯¹è¿™äº›è¶³å¤Ÿå¯†é›†çš„ç‚¹ï¼Œä½¿ç”¨è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œå¾—åˆ°é¢„æµ‹å€¼y_predï¼Œç„¶ååœ¨åæ ‡è½´ä¸Šï¼ŒæŠŠæ‰€æœ‰çš„é¢„æµ‹ç‚¹è¿æ¥èµ·æ¥ï¼Œè¿™æ ·å°±ç”»å‡ºäº†æ‹Ÿåˆæ›²çº¿ã€‚<br> ç”Ÿæˆè¶³å¤Ÿå¯†é›†çš„ç‚¹å¹¶è¿›è¡Œé¢„æµ‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">T <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>newaxis<span class="token punctuation">]</span>y_pred <span class="token operator">=</span> knn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>T<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æŠŠè¿™äº›é¢„æµ‹ç‚¹è¿èµ·æ¥ï¼Œæ„æˆæ‹Ÿåˆæ›²çº¿ï¼š</p><pre class="line-numbers language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dpi<span class="token operator">=</span><span class="token number">144</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'g'</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'data'</span><span class="token punctuation">,</span>s<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>T<span class="token punctuation">,</span>y_pred<span class="token punctuation">,</span>c<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">'prediction'</span><span class="token punctuation">,</span>lw<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'tight'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'KNeighborsRegressor (k = %i)'</span> <span class="token operator">%</span> k<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€ç»ˆç”Ÿæˆçš„æ‹Ÿåˆæ›²çº¿å’Œè®­ç»ƒæ ·æœ¬æ•°æ®å¦‚å›¾ï¼Œæ‹Ÿåˆå‡ºæ¥ç¡®å®å’Œ cos æ›²çº¿ç›¸ä¼¼ã€‚</p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200628223010274.png" style="zoom: 67%;"><h3 id="æ¡ˆä¾‹3-ä½¿ç”¨KNNç®—æ³•é¢„æµ‹ç³–å°¿ç—…"><a href="#æ¡ˆä¾‹3-ä½¿ç”¨KNNç®—æ³•é¢„æµ‹ç³–å°¿ç—…" class="headerlink" title="æ¡ˆä¾‹3: ä½¿ç”¨KNNç®—æ³•é¢„æµ‹ç³–å°¿ç—…"></a>æ¡ˆä¾‹3: ä½¿ç”¨KNNç®—æ³•é¢„æµ‹ç³–å°¿ç—…</h3><p>æœ¬èŠ‚ä½¿ç”¨KNNç®—æ³•åŠå…¶å˜ç§ï¼Œå¯¹Pimaå°ç¬¬å®‰äººçš„ç³–å°¿ç—…è¿›è¡Œé¢„æµ‹ã€‚æ•°æ®æ¥æº<a href="">kaggle.com</a>å¤§å®¶å¯ä»¥è‡ªå·±å»ä¸‹è½½ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ <a href="./pima-indians-diabetes/diabetes.csv">ä»“åº“æ–‡ä»¶</a>ã€‚</p><h4 id="rainbow-åŠ è½½æ•°æ®é›†"><a href="#rainbow-åŠ è½½æ•°æ®é›†" class="headerlink" title=":rainbow:åŠ è½½æ•°æ®é›†"></a>:rainbow:åŠ è½½æ•°æ®é›†</h4><p>ä½¿ç”¨PandasåŠ è½½æ•°æ®ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pddata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'./pima-indians-diabetes/diabetes.csv'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'dataset shape {}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">dataset shape <span class="token punctuation">(</span><span class="token number">768</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">:</span>Pregnancies Glucose BloodPressure   SkinThickness   Insulin BMI DiabetesPedigreeFunction    Age Outcome<span class="token number">0</span>   <span class="token number">6</span>   <span class="token number">148</span> <span class="token number">72</span>  <span class="token number">35</span>  <span class="token number">0</span>   <span class="token number">33.6</span>    <span class="token number">0.627</span>   <span class="token number">50</span>  <span class="token number">1</span><span class="token number">1</span>   <span class="token number">1</span>   <span class="token number">85</span>  <span class="token number">66</span>  <span class="token number">29</span>  <span class="token number">0</span>   <span class="token number">26.6</span>    <span class="token number">0.351</span>   <span class="token number">31</span>  <span class="token number">0</span><span class="token number">2</span>   <span class="token number">8</span>   <span class="token number">183</span> <span class="token number">64</span>  <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">23.3</span>    <span class="token number">0.672</span>   <span class="token number">32</span>  <span class="token number">1</span><span class="token number">3</span>   <span class="token number">1</span>   <span class="token number">89</span>  <span class="token number">66</span>  <span class="token number">23</span>  <span class="token number">94</span>  <span class="token number">28.1</span>    <span class="token number">0.167</span>   <span class="token number">21</span>  <span class="token number">0</span><span class="token number">4</span>   <span class="token number">0</span>   <span class="token number">137</span> <span class="token number">40</span>  <span class="token number">35</span>  <span class="token number">168</span> <span class="token number">43.1</span>    <span class="token number">2.288</span>   <span class="token number">33</span>  <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»æ‰“å°å‡ºçš„ä¿¡æ¯å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªæ•°æ®é›†ä¸€å…±æœ‰ 768 ä¸ªæ ·æœ¬ã€8 ä¸ªç‰¹å¾ã€1 ä¸ªæ ‡ç­¾ï¼š</p><p><code>Pregnancies</code>ï¼šæ€€å­•çš„æ¬¡æ•°</p><p><code>Glucose</code>ï¼šè¡€æµ†è‘¡è„ç³–æµ“åº¦ï¼Œé‡‡ç”¨ 2 å°æ—¶å£æœè‘¡è„ç³–è€é‡è¯•éªŒæµ‹å¾—</p><p><code>BloodPressure</code>ï¼šèˆ’å¼ å‹ï¼ˆæ¯«ç±³æ±æŸ±ï¼‰</p><p><code>SkinThickness</code>ï¼šè‚±ä¸‰å¤´è‚Œçš®è‚¤è¤¶çš±åšåº¦ï¼ˆæ¯«ç±³ï¼‰</p><p><code>Insulin</code>ï¼šä¸¤ä¸ªå°æ—¶è¡€æ¸…èƒ°å²›ç´ ï¼ˆ Î¼U /æ¯«å‡ï¼‰</p><p><code>BMI</code>ï¼šèº«ä½“è´¨é‡æŒ‡æ•°ï¼Œä½“é‡é™¤ä»¥èº«é«˜çš„å¹³æ–¹</p><p><code>DiabetesPedigreeFunction</code>ï¼šç³–å°¿ç—…è¡€ç»ŸæŒ‡æ•°ï¼Œç³–å°¿ç—…å’Œå®¶åº­é—ä¼ ç›¸å…³</p><p><code>Age</code>ï¼šå¹´é¾„</p><p><code>Outcome</code>ï¼š0è¡¨ç¤ºæ²¡æœ‰ç³–å°¿ç—…ï¼Œ1è¡¨ç¤ºæœ‰ç³–å°¿ç—…</p><p> æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥è§‚å¯Ÿæ•°æ®é›†é‡Œçš„é˜³æ€§å’Œé˜´æ€§æ ·æœ¬çš„ä¸ªæ•°ï¼š</p><pre class="line-numbers language-python"><code class="language-python">data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Outcome'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¾“å‡ºä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">Outcome<span class="token number">0</span>    <span class="token number">500</span><span class="token number">1</span>    <span class="token number">268</span>dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ï¼Œé˜´æ€§æ ·æœ¬500ä¾‹ï¼Œé˜³æ€§æ ·æœ¬268ä¾‹ã€‚</p><h4 id="rainbow-å¤„ç†æ•°æ®é›†"><a href="#rainbow-å¤„ç†æ•°æ®é›†" class="headerlink" title=":rainbow: å¤„ç†æ•°æ®é›†"></a>:rainbow: å¤„ç†æ•°æ®é›†</h4><p> æ¥ç€éœ€è¦å¯¹æ•°æ®é›†è¿›è¡Œç®€å•å¤„ç†ï¼ŒæŠŠ8ä¸ªç‰¹å¾å€¼åˆ†ç¦»å‡ºæ¥ï¼Œä½œä¸ºè®­ç»ƒæ•°æ®é›†ï¼ŒæŠŠOutcomeåˆ—åˆ†ç¦»å‡ºæ¥ä½œä¸ºç›®æ ‡å€¼ã€‚ç„¶åï¼ŒæŠŠæ•°æ®é›†åˆ’åˆ†ä¸ºè®­ç»ƒæ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†ã€‚</p><pre class="line-numbers language-python"><code class="language-python">X <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span>Y <span class="token operator">=</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_splitX_train<span class="token punctuation">,</span>X_test<span class="token punctuation">,</span>Y_train<span class="token punctuation">,</span>Y_test<span class="token operator">=</span>train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>X_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> X_test<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> Y_train<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> Y_test<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token punctuation">(</span><span class="token number">614</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">154</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">614</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">154</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="rainbow-æ¨¡å‹æ¯”è¾ƒ"><a href="#rainbow-æ¨¡å‹æ¯”è¾ƒ" class="headerlink" title=":rainbow: æ¨¡å‹æ¯”è¾ƒ"></a>:rainbow: æ¨¡å‹æ¯”è¾ƒ</h4><p>åˆ†åˆ«ä½¿ç”¨æ™®é€šçš„KNNç®—æ³•ã€å¸¦æƒé‡çš„KNNç®—æ³•å’ŒæŒ‡å®šåŠå¾„çš„KNNç®—æ³•å¯¹æ•°æ®é›†è¿›è¡Œæ‹Ÿåˆå¹¶è®¡ç®—è¯„åˆ†ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsClassifier<span class="token punctuation">,</span> RadiusNeighborsClassifiermodels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>models<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"KNN"</span><span class="token punctuation">,</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>models<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"KNN with weights"</span><span class="token punctuation">,</span> KNeighborsClassifier<span class="token punctuation">(</span>    n_neighbors<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> weights<span class="token operator">=</span><span class="token string">"distance"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>models<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"Radius Neighbors"</span><span class="token punctuation">,</span> RadiusNeighborsClassifier<span class="token punctuation">(</span>    n_neighbors<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> radius<span class="token operator">=</span><span class="token number">500.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> name<span class="token punctuation">,</span> model <span class="token keyword">in</span> models<span class="token punctuation">:</span>    model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> Y_train<span class="token punctuation">)</span>    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> model<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> Y_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"name: {}; score: {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>results<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>results<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸‰ç§ç®—æ³•çš„æ€§èƒ½å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-python"><code class="language-python">name<span class="token punctuation">:</span> KNN<span class="token punctuation">;</span> score<span class="token punctuation">:</span> <span class="token number">0.7467532467532467</span>name<span class="token punctuation">:</span> KNN <span class="token keyword">with</span> weights<span class="token punctuation">;</span> score<span class="token punctuation">:</span> <span class="token number">0.6818181818181818</span>name<span class="token punctuation">:</span> Radius Neighbors<span class="token punctuation">;</span> score<span class="token punctuation">:</span> <span class="token number">0.6558441558441559</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¸¦æƒé‡çš„KNNç®—æ³•ï¼Œæˆ‘ä»¬é€‰æ‹©äº†è·ç¦»è¶Šè¿‘ã€æƒé‡è¶Šé«˜ã€‚æŒ‡å®šåŠå¾„çš„KNNç®—æ³•çš„åŠå¾„é€‰æ‹©äº†500ã€‚ä»ä¸Šé¢çš„è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œæ™®é€šçš„KNNç®—æ³•æ€§èƒ½æœ€å¥½ã€‚é—®é¢˜æ¥äº†ï¼Œè¿™ä¸ªåˆ¤æ–­å‡†ç¡®ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯ä¸å‡†ç¡®ã€‚å› ä¸ºæˆ‘ä»¬çš„è®­ç»ƒæ ·æœ¬å’Œæµ‹è¯•æ ·æœ¬æ˜¯éšæœºåˆ†é…çš„ï¼Œä¸åŒçš„è®­ç»ƒæ ·æœ¬å’Œæµ‹è¯•æ ·æœ¬ç»„åˆå¯èƒ½å¯¼è‡´è®¡ç®—å‡ºæ¥çš„ç®—æ³•å‡†ç¡®æ€§æ˜¯æœ‰å·®å¼‚çš„ã€‚æˆ‘ä»¬å¯ä»¥è¯•ç€å¤šæ¬¡è¿è¡Œä¸Šé¢çš„ä»£ç ï¼Œè§‚å¯Ÿè¾“å‡ºå€¼æ˜¯å¦æœ‰å˜åŒ–ã€‚</p><p>æ€ä¹ˆæ ·æ›´å‡†ç¡®åœ°å¯¹æ¯”ç®—æ³•å‡†ç¡®æ€§å‘¢ï¼Ÿä¸€ä¸ªæ–¹æ³•æ˜¯ï¼Œå¤šæ¬¡éšæœºåˆ†é…è®­ç»ƒæ•°æ®é›†å’Œäº¤å‰éªŒè¯æ•°æ®é›†ï¼Œç„¶åæ±‚æ¨¡å‹å‡†ç¡®æ€§è¯„åˆ†çš„å¹³å‡å€¼ã€‚æ‰€å¹¸ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä»å¤´å®ç°è¿™ä¸ªè¿‡ç¨‹ï¼Œ<code>scikit-learn</code> æä¾›äº† <code>KFold</code> å’Œ <code>cross_val_score()</code>å‡½æ•°æ¥å¤„ç†è¿™ç§é—®é¢˜ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> KFold<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> cross_val_scoreresults <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> name<span class="token punctuation">,</span> model <span class="token keyword">in</span> models<span class="token punctuation">:</span>    kfold <span class="token operator">=</span> KFold<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>    cv_result <span class="token operator">=</span> cross_val_score<span class="token punctuation">(</span>model<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> cv<span class="token operator">=</span>kfold<span class="token punctuation">)</span>    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> cv_result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"name: {}; cross val score: {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>        results<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>results<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡KFoldæŠŠæ•°æ®é›†åˆ†æˆ10ä»½ï¼Œå…¶ä¸­1ä»½ä¼šä½œä¸ºäº¤å‰éªŒè¯æ•°æ®é›†æ¥è®¡ç®—æ¨¡å‹å‡†ç¡®æ€§ï¼Œå‰©ä½™çš„9ä»½ä½œä¸ºè®­ç»ƒæ•°æ®é›†ã€‚cross_val_score()å‡½æ•°æ€»å…±è®¡ç®—å‡º10æ¬¡ä¸åŒè®­ç»ƒæ•°æ®é›†å’Œäº¤å‰éªŒè¯æ•°æ®é›†ç»„åˆå¾—åˆ°çš„æ¨¡å‹å‡†ç¡®æ€§è¯„åˆ†ï¼Œæœ€åæ±‚å¹³å‡å€¼ã€‚è¿™æ ·çš„è¯„ä»·ç»“æœç›¸å¯¹æ›´å‡†ç¡®ä¸€äº›ã€‚<br> è¾“å‡ºç»“æœä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">name<span class="token punctuation">:</span> KNN<span class="token punctuation">;</span> cross val score<span class="token punctuation">:</span> <span class="token number">0.7147641831852358</span>name<span class="token punctuation">:</span> KNN <span class="token keyword">with</span> weights<span class="token punctuation">;</span> cross val score<span class="token punctuation">:</span> <span class="token number">0.6770505809979495</span>name<span class="token punctuation">:</span> Radius Neighbors<span class="token punctuation">;</span> cross val score<span class="token punctuation">:</span> <span class="token number">0.6497265892002735</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="rainbow-æ¨¡å‹è®­ç»ƒåŠåˆ†æ"><a href="#rainbow-æ¨¡å‹è®­ç»ƒåŠåˆ†æ" class="headerlink" title=":rainbow:æ¨¡å‹è®­ç»ƒåŠåˆ†æ"></a>:rainbow:æ¨¡å‹è®­ç»ƒåŠåˆ†æ</h4><p>é€šè¿‡ä¸Šé¢çš„å¯¹æ¯”æ¥çœ‹ï¼Œæ™®é€šçš„KNNç®—æ³•æ€§èƒ½æ›´ä¼˜ä¸€äº›ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±ä½¿ç”¨æ™®é€šçš„KNNç®—æ³•æ¨¡å‹å¯¹æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œå¹¶æŸ¥çœ‹å¯¹è®­ç»ƒæ ·æœ¬çš„æ‹Ÿåˆæƒ…å†µä»¥åŠå¯¹æµ‹è¯•æ ·æœ¬çš„é¢„æµ‹å‡†ç¡®æ€§æƒ…å†µï¼š</p><pre class="line-numbers language-python"><code class="language-python">knn <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> Y_train<span class="token punctuation">)</span>train_score <span class="token operator">=</span> knn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> Y_train<span class="token punctuation">)</span>test_score <span class="token operator">=</span> knn<span class="token punctuation">.</span>score<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> Y_test<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"train score: {}\ntest score: {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>train_score<span class="token punctuation">,</span> test_score<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºç»“æœä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">train score<span class="token punctuation">:</span> <span class="token number">0.8387622149837134</span>test score<span class="token punctuation">:</span> <span class="token number">0.7337662337662337</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä»è¾“å‡ºä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªé—®é¢˜ã€‚ä¸€æ˜¯å¯¹è®­ç»ƒæ ·æœ¬çš„æ‹Ÿåˆæƒ…å†µä¸ä½³ï¼Œè¯„åˆ†æ‰0.82å¤šï¼Œè¿™è¯´æ˜ç®—æ³•æ¨¡å‹å¤ªç®€å•äº†ï¼Œæ— æ³•å¾ˆå¥½åœ°æ‹Ÿåˆè®­ç»ƒæ ·æœ¬ã€‚äºŒæ˜¯æ¨¡å‹çš„å‡†ç¡®æ€§æ¬ ä½³ï¼Œä¸åˆ°74%çš„é¢„æµ‹å‡†ç¡®æ€§ã€‚æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ç”»å‡ºå­¦ä¹ æ›²çº¿ï¼Œè¯å®ç»“è®ºã€‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> ShuffleSplit<span class="token keyword">from</span> common<span class="token punctuation">.</span>utils <span class="token keyword">import</span> plot_learning_curveknn <span class="token operator">=</span> KNeighborsClassifier<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>cv <span class="token operator">=</span> ShuffleSplit<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>plot_learning_curve<span class="token punctuation">(</span>plt<span class="token punctuation">,</span> knn<span class="token punctuation">,</span> <span class="token string">"Learn Curve for KNN Diabetes"</span><span class="token punctuation">,</span>                     X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> ylim<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.01</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cv<span class="token operator">=</span>cv<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200629101150911.png" style="zoom:67%;"><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºæ¥ï¼Œè®­ç»ƒæ ·æœ¬è¯„åˆ†è¾ƒä½ï¼Œä¸”æµ‹è¯•æ ·æœ¬ä¸è®­ç»ƒæ ·æœ¬è·ç¦»è¾ƒå¤§ï¼Œè¿™æ˜¯å…¸å‹çš„æ¬ æ‹Ÿåˆç°è±¡ã€‚KNNç®—æ³•æ²¡æœ‰æ›´å¥½çš„æªæ–½æ¥è§£å†³æ¬ æ‹Ÿåˆé—®é¢˜ï¼Œæˆ‘ä»¬å­¦å®Œæœ¬ä¹¦çš„å…¶ä»–ç« èŠ‚åï¼Œå¯ä»¥è¯•ç€ç”¨å…¶ä»–ç®—æ³•ï¼ˆå¦‚é€»è¾‘å›å½’ç®—æ³•ã€æ”¯æŒå‘é‡æœºç­‰ï¼‰æ¥å¯¹æ¯”ä¸åŒæ¨¡å‹çš„å‡†ç¡®æ€§æƒ…å†µã€‚</p><h4 id="rainbow-ç‰¹å¾é€‰æ‹©åŠæ•°æ®å¯è§†åŒ–"><a href="#rainbow-ç‰¹å¾é€‰æ‹©åŠæ•°æ®å¯è§†åŒ–" class="headerlink" title=":rainbow:ç‰¹å¾é€‰æ‹©åŠæ•°æ®å¯è§†åŒ–"></a>:rainbow:ç‰¹å¾é€‰æ‹©åŠæ•°æ®å¯è§†åŒ–</h4><p>é‚£æœ‰æ²¡æœ‰ç›´è§‚çš„æ–¹æ³•ï¼Œæ¥æ­ç¤ºå‡ºä¸ºä»€ä¹ˆKNNç®—æ³•ä¸æ˜¯é’ˆå¯¹è¿™ä¸€é—®é¢˜çš„å¥½æ¨¡å‹ï¼Ÿä¸€ä¸ªåŠæ³•æ˜¯æŠŠæ•°æ®ç”»å‡ºæ¥ï¼Œå¯æ˜¯æˆ‘ä»¬æœ‰8ä¸ªç‰¹å¾ï¼Œæ— æ³•åœ¨è¿™ä¹ˆé«˜çš„ç»´åº¦é‡Œç”»å‡ºæ•°æ®ï¼Œå¹¶ç›´è§‚åœ°è§‚å¯Ÿã€‚ä¸€ä¸ªè§£å†³åŠæ³•æ˜¯ç‰¹å¾é€‰æ‹©ï¼Œå³åªé€‰æ‹©2ä¸ªä¸è¾“å‡ºå€¼ç›¸å…³æ€§æœ€å¤§çš„ç‰¹å¾ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨äºŒç»´å¹³é¢ä¸Šç”»å‡ºè¾“å…¥ç‰¹å¾å€¼ä¸è¾“å‡ºå€¼çš„å…³ç³»äº†ã€‚</p><p><code>scikit-learn</code>åœ¨ <code>sklearn.feature_selection</code> åŒ…é‡Œæä¾›äº†ä¸°å¯Œçš„ç‰¹å¾é€‰æ‹©æ–¹æ³•ã€‚æˆ‘ä»¬ä½¿ç”¨ <code>SelectKBest</code> æ¥é€‰æ‹©ç›¸å…³æ€§æœ€å¤§çš„ä¸¤ä¸ªç‰¹å¾ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> SelectKBestselector <span class="token operator">=</span> SelectKBest<span class="token punctuation">(</span>k<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>X_new <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'X_new.shape {}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>X_new<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æŠŠç›¸å…³æ€§æœ€å¤§çš„ä¸¤ä¸ªç‰¹å¾æ”¾åœ¨X_newå˜é‡é‡Œï¼Œè¾“å‡ºç»“æœä¸ºï¼š</p><pre class="line-numbers language-python"><code class="language-python">X_new<span class="token punctuation">.</span>shape <span class="token punctuation">(</span><span class="token number">768</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘ä»¬å¯èƒ½ä¼šå¥½å¥‡ï¼Œç›¸å…³æ€§æœ€å¤§çš„ç‰¹å¾åˆ°åº•æ˜¯å“ªä¸¤ä¸ªï¼Ÿå¯¹æ¯”ä¸€ä¸‹æœ¬èŠ‚å¼€å¤´çš„æ•°æ®å³å¯çŸ¥é“ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯Glucoseï¼ˆè¡€ç³–æµ“åº¦ï¼‰å’ŒBMIï¼ˆèº«ä½“è´¨é‡æŒ‡æ•°ï¼‰ã€‚è¡€ç³–æµ“åº¦å’Œç³–å°¿ç—…çš„å…³ç³»è‡ªä¸å¿…è¯´ï¼Œèº«ä½“è´¨é‡æŒ‡æ•°æ˜¯åæ˜ è‚¥èƒ–ç¨‹åº¦çš„æŒ‡æ ‡ï¼Œä»ä¸šåŠ¡è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬é€‰æ‹©å‡ºæ¥çš„2ä¸ªç›¸å…³æ€§æœ€é«˜çš„ç‰¹å¾è¿˜ç®—åˆç†ã€‚é‚£ä¹ˆ <code>SelectKBest</code> åˆ°åº•ä½¿ç”¨ä»€ä¹ˆç¥å¥‡çš„æ–¹æ³•é€‰æ‹©å‡ºäº†è¿™ä¸¤ä¸ªç›¸å…³æ€§æœ€é«˜çš„ç‰¹å¾å‘¢ï¼Ÿè¯¦æƒ…å‚è€ƒä¸‹ä¸€èŠ‚ã€‚</p><p>æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œå¦‚æœåªä½¿ç”¨è¿™2ä¸ªç›¸å…³æ€§æœ€é«˜çš„ç‰¹å¾çš„è¯ï¼Œ3ç§ä¸åŒçš„KNNç®—æ³•å“ªä¸ªå‡†ç¡®æ€§æ›´é«˜ï¼š</p><pre class="line-numbers language-python"><code class="language-python">results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> name<span class="token punctuation">,</span> model <span class="token keyword">in</span> models<span class="token punctuation">:</span>    kfold <span class="token operator">=</span> KFold<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>    cv_result <span class="token operator">=</span> cross_val_score<span class="token punctuation">(</span>model<span class="token punctuation">,</span> X_new<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> cv<span class="token operator">=</span>kfold<span class="token punctuation">)</span>    results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> cv_result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"name: {}; cross val score: {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>        results<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>results<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ¬¡ä½¿ç”¨X_newä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºå¦‚ä¸‹</p><pre class="line-numbers language-python"><code class="language-python">name<span class="token punctuation">:</span> KNN<span class="token punctuation">;</span> cross val score<span class="token punctuation">:</span> <span class="token number">0.725205058099795</span>name<span class="token punctuation">:</span> KNN <span class="token keyword">with</span> weights<span class="token punctuation">;</span> cross val score<span class="token punctuation">:</span> <span class="token number">0.6900375939849623</span>name<span class="token punctuation">:</span> Radius Neighbors<span class="token punctuation">;</span> cross val score<span class="token punctuation">:</span> <span class="token number">0.6510252904989747</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä»è¾“å‡ºå¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿˜æ˜¯æ™®é€šçš„KNNæ¨¡å‹å‡†ç¡®æ€§è¾ƒé«˜ï¼Œå…¶å‡†ç¡®æ€§ä¹Ÿè¾¾åˆ°äº†å°†è¿‘ 73 %ï¼Œä¸æ‰€æœ‰ç‰¹å¾æ‹¿æ¥ä¸€å—å„¿è®­ç»ƒçš„å‡†ç¡®æ€§å·®ä¸å¤šã€‚è¿™ä¹Ÿä¾§é¢è¯æ˜äº† <code>SelectKBest</code> ç‰¹å¾é€‰æ‹©çš„æœ‰æ•ˆæ€§ã€‚</p><p>å›åˆ°ç›®æ ‡ä¸Šæ¥ï¼Œæˆ‘ä»¬æ˜¯æƒ³çœ‹çœ‹ä¸ºä»€ä¹ˆKNNæ— æ³•å¾ˆå¥½åœ°æ‹Ÿåˆè®­ç»ƒæ ·æœ¬ã€‚ç°åœ¨æˆ‘ä»¬åªæœ‰ 2 ä¸ªç‰¹å¾ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨äºŒç»´åæ ‡ä¸Šç”»å‡ºæ‰€æœ‰çš„è®­ç»ƒæ ·æœ¬ï¼Œè§‚å¯Ÿè¿™äº›æ•°æ®çš„åˆ†å¸ƒæƒ…å†µï¼š</p><pre class="line-numbers language-python"><code class="language-python">plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"BMI"</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Glucose"</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_new<span class="token punctuation">[</span>Y<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_new<span class="token punctuation">[</span>Y<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">#ç”»å‡ºæ ·æœ¬</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X_new<span class="token punctuation">[</span>Y<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X_new<span class="token punctuation">[</span>Y<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'g'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'^'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">#ç”»å‡ºæ ·æœ¬</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/image-20200629102028938.png" style="zoom:67%;"><p>æ¨ªåæ ‡æ˜¯è¡€ç³–å€¼ Glucoseï¼Œçºµåæ ‡æ˜¯BMIå€¼ï¼Œåæ˜ èº«ä½“è‚¥èƒ–æƒ…å†µã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨ä¸­é—´æ•°æ®é›†å¯†é›†çš„åŒºåŸŸï¼Œé˜³æ€§æ ·æœ¬å’Œé˜´æ€§æ ·æœ¬å‡ ä¹é‡å åœ¨ä¸€èµ·äº†ã€‚å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªå¾…é¢„æµ‹çš„æ ·æœ¬åœ¨ä¸­é—´å¯†é›†åŒºåŸŸï¼Œå®ƒçš„é˜³æ€§é‚»å±…å¤šè¿˜æ˜¯é˜´æ€§é‚»å±…å¤šå‘¢ï¼Ÿè¿™çœŸçš„å¾ˆéš¾è¯´ã€‚è¿™æ ·å°±å¯ä»¥ç›´è§‚åœ°çœ‹åˆ°ï¼ŒKNNç®—æ³•åœ¨è¿™ä¸ªç³–å°¿ç—…é¢„æµ‹é—®é¢˜ä¸Šï¼Œæ— æ³•è¾¾åˆ°å¾ˆé«˜çš„é¢„æµ‹å‡†ç¡®æ€§ã€‚</p><h3 id="æ‹“å±•é˜…è¯»"><a href="#æ‹“å±•é˜…è¯»" class="headerlink" title="æ‹“å±•é˜…è¯»"></a>æ‹“å±•é˜…è¯»</h3><p>è¿™é‡Œå†ç»§ç»­å†ä»‹ç»ä¸€ä¸‹ç‰¹å¾é€‰æ‹©æ—¶ï¼Œè®¡ç®—ç›¸å…³æ€§å¤§å°çš„ <code>SelectKBest()</code> å‡½æ•°èƒŒåçš„ç»Ÿè®¡å­¦çŸ¥è¯†ã€‚</p><h4 id="å¦‚ä½•æé«˜KNNç®—æ³•çš„è¿ç®—æ•ˆç‡"><a href="#å¦‚ä½•æé«˜KNNç®—æ³•çš„è¿ç®—æ•ˆç‡" class="headerlink" title="å¦‚ä½•æé«˜KNNç®—æ³•çš„è¿ç®—æ•ˆç‡"></a>å¦‚ä½•æé«˜KNNç®—æ³•çš„è¿ç®—æ•ˆç‡</h4><p>æ ¹æ®ç®—æ³•åŸç†ï¼Œæ¯æ¬¡éœ€è¦é¢„æµ‹ä¸€ä¸ªç‚¹æ—¶ï¼Œæˆ‘ä»¬éƒ½éœ€è¦è®¡ç®—è®­ç»ƒæ•°æ®é›†é‡Œæ¯ä¸ªç‚¹åˆ°è¿™ä¸ªç‚¹çš„è·ç¦»ï¼Œç„¶åé€‰å‡ºè·ç¦»æœ€è¿‘çš„kä¸ªç‚¹è¿›è¡ŒæŠ•ç¥¨ã€‚å½“æ•°æ®é›†å¾ˆå¤§æ—¶ï¼Œè¿™ä¸ªè®¡ç®—æˆæœ¬éå¸¸é«˜ã€‚é’ˆå¯¹$N$ä¸ªæ ·æœ¬ï¼Œ$D$ä¸ªç‰¹å¾çš„æ•°æ®é›†ï¼Œå…¶ç®—æ³•å¤æ‚åº¦ä¸º$O(DN^2)$ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ç§å«<code>K-D Tree</code> çš„æ•°æ®ç»“æ„è¢«å‘æ˜å‡ºæ¥ã€‚ä¸ºäº†é¿å…æ¯æ¬¡éƒ½é‡æ–°è®¡ç®—ä¸€éè·ç¦»ï¼Œç®—æ³•ä¼šæŠŠè·ç¦»ä¿¡æ¯ä¿å­˜åœ¨ä¸€æ£µæ ‘é‡Œï¼Œè¿™æ ·åœ¨è®¡ç®—ä¹‹å‰ä»æ ‘é‡ŒæŸ¥è¯¢è·ç¦»ä¿¡æ¯ï¼Œå°½é‡é¿å…é‡æ–°è®¡ç®—ã€‚å…¶åŸºæœ¬åŸç†æ˜¯ï¼Œå¦‚æœAå’ŒBè·ç¦»å¾ˆè¿œï¼ŒBå’ŒCè·ç¦»å¾ˆè¿‘ï¼Œé‚£ä¹ˆAå’ŒCçš„è·ç¦»ä¹Ÿå¾ˆè¿œã€‚æœ‰äº†è¿™ä¸ªä¿¡æ¯ï¼Œå°±å¯ä»¥åœ¨åˆé€‚çš„æ—¶å€™è·³è¿‡è·ç¦»è¿œçš„ç‚¹ã€‚è¿™æ ·ä¼˜åŒ–åçš„ç®—æ³•å¤æ‚åº¦å¯é™ä½åˆ°$O(DNlog(N))$ã€‚æ„Ÿå…´è¶£çš„è¯»è€…å¯å‚é˜…è®ºæ–‡ï¼šBentley, J.L., Communications of the ACM (1975)ã€‚</p><p>1989å¹´ï¼Œå¦å¤–ä¸€ç§ç§°ä¸º<code>Ball Tree</code>çš„ç®—æ³•ï¼Œåœ¨<code>K-D Tree</code>çš„åŸºç¡€ä¸Šå¯¹æ€§èƒ½è¿›ä¸€æ­¥è¿›è¡Œäº†ä¼˜åŒ–ã€‚æ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥æœç´¢Five balltree construction algorithmsæ¥äº†è§£è¯¦ç»†çš„ç®—æ³•ä¿¡æ¯ã€‚</p><h4 id="ç›¸å…³æ€§æµ‹è¯•"><a href="#ç›¸å…³æ€§æµ‹è¯•" class="headerlink" title="ç›¸å…³æ€§æµ‹è¯•"></a>ç›¸å…³æ€§æµ‹è¯•</h4><p>å…ˆé€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹å‡è®¾æ£€éªŒé—®é¢˜ï¼Œå³åˆ¤æ–­å‡è®¾çš„ç»“è®ºæ˜¯å¦æˆç«‹æˆ–æˆç«‹çš„æ¦‚ç‡æœ‰å¤šé«˜ã€‚å‡è®¾ï¼Œåœ¨ä¸€ä¸ªåŸå¸‚éšæœºé‡‡æ ·åˆ°ç¨‹åºå‘˜å’Œæ€§åˆ«çš„å…³ç³»çš„æ•°æ®ï¼š</p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-0c82f9f4005936fa.png" style="zoom:50%;"><p>å‡è®¾ï¼Œæˆ‘ä»¬çš„ç»“è®ºæ˜¯ç¨‹åºå‘˜å’Œæ€§åˆ«æ— å…³ï¼Œè¿™ä¸ªå‡è®¾ç§°ä¸ºåŸå‡è®¾ï¼ˆnull hypothesisï¼‰ã€‚é—®ï¼šé€šè¿‡æˆ‘ä»¬éšæœºé‡‡æ ·è§‚æµ‹åˆ°çš„æ•°æ®ï¼ŒåŸå‡è®¾æ˜¯å¦æˆç«‹ï¼Œæˆ–è€…è¯´åŸå‡è®¾æˆç«‹çš„æ¦‚ç‡æœ‰å¤šé«˜ï¼Ÿ</p><p><code>å¡æ–¹æ£€éªŒï¼ˆchi-squared testï¼‰</code>æ˜¯æ£€æµ‹å‡è®¾æˆç«‹ä¸å¦çš„ä¸€ä¸ªå¸¸ç”¨çš„å·¥å…·ã€‚å®ƒçš„è®¡ç®—å…¬å¼æ˜¯ï¼š</p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-3a52b648ce9e2196.png" style="zoom:50%;"><p>å…¶ä¸­ï¼Œå¡æ–¹æ£€éªŒçš„å€¼è®°ä¸º ,  $O$ æ˜¯è§‚æµ‹å€¼ï¼Œ$E$  æ˜¯æœŸæœ›å€¼ã€‚é’ˆå¯¹æˆ‘ä»¬çš„ä¾‹å­ï¼Œå¦‚æœåŸå‡è®¾æˆç«‹ï¼Œå³ç¨‹åºå‘˜èŒä¸šå’Œæ€§åˆ«æ— å…³ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœŸæœ›çš„ç”·ç¨‹åºå‘˜æ•°é‡åº”è¯¥ä¸º(14/489) * 242=6.928ï¼Œå¥³ç¨‹åºå‘˜æ•°é‡åº”è¯¥ä¸º(14/489) * 247=7.072ï¼ŒåŒç†å¯å¾—åˆ°æˆ‘ä»¬çš„æœŸæœ›å€¼å¦‚ä¸‹ï¼š</p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-9f2c88dc6a7eeb66.png" style="zoom:50%;"><p> æ ¹æ®å¡æ–¹æ£€éªŒçš„å…¬å¼ï¼Œå¯ä»¥ç®—å‡ºå¡æ–¹å€¼ä¸ºï¼š</p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/17634123-bf0dbd2fd6c8db0c.png" style="zoom:50%;"><p> ç®—å‡ºå¡æ–¹å€¼åï¼Œæ€ä¹ˆåˆ¤æ–­åŸå‡è®¾æˆç«‹çš„æ¦‚ç‡æ˜¯å¤šå°‘å‘¢ï¼Ÿè¿™é‡Œè¿˜æ¶‰åŠåˆ°è‡ªç”±åº¦å’Œå¡æ–¹åˆ†å¸ƒçš„æ¦‚å¿µã€‚ç®€å•åœ°è®²ï¼Œè‡ªç”±åº¦æ˜¯$(r-1)Ã—(c-1)$ï¼Œå…¶ä¸­ r æ˜¯è¡Œæ•°ï¼Œc æ˜¯åˆ—æ•°ï¼Œé’ˆå¯¹æˆ‘ä»¬çš„é—®é¢˜ï¼Œå…¶è‡ªç”±åº¦ä¸º1ã€‚å¡æ–¹åˆ†å¸ƒæ˜¯æŒ‡ï¼Œè‹¥nä¸ªç›¸äº’ç‹¬ç«‹çš„éšæœºå˜é‡å‡æœä»æ­£æ€åˆ†å¸ƒï¼Œåˆ™è¿™ n ä¸ªéšæœºå˜é‡çš„å¹³æ–¹å’Œæ„æˆä¸€æ–°çš„éšæœºå˜é‡ï¼Œå…¶åˆ†å¸ƒè§„å¾‹ç§°ä¸ºå¡æ–¹åˆ†å¸ƒã€‚å¡æ–¹åˆ†å¸ƒçš„å¯†åº¦å‡½æ•°å’Œè‡ªç”±åº¦ç›¸å…³ï¼ŒçŸ¥é“äº†è‡ªç”±åº¦å’Œç›®æ ‡æ¦‚ç‡ï¼Œæˆ‘ä»¬å°±èƒ½æ±‚å‡ºå¡æ–¹å€¼ã€‚</p><p>é’ˆå¯¹æˆ‘ä»¬çš„é—®é¢˜ï¼Œå¯ä»¥æŸ¥è¡¨å¾—åˆ°ï¼Œè‡ªç”±åº¦ä¸º1çš„å¡æ–¹åˆ†å¸ƒï¼Œåœ¨99%å¤„çš„å¡æ–¹å€¼ä¸º6.63ã€‚æˆ‘ä»¬è®¡ç®—å‡ºæ¥çš„å¡æ–¹å€¼ä¸º7.670ã€‚ç”±äº7.67&gt;6.63ï¼Œæ•…æœ‰99%çš„æŠŠæ¡å¯ä»¥æ¨ç¿»åŸå‡è®¾ã€‚æ¢ä¸ªè¯´æ³•ï¼Œå¦‚æœåŸå‡è®¾æˆç«‹ï¼Œå³ç¨‹åºå‘˜èŒä¸šå’Œæ€§åˆ«æ— å…³ï¼Œé‚£ä¹ˆæˆ‘ä»¬éšæœºé‡‡æ ·åˆ°çš„æ•°æ®å‡ºç°çš„æ¦‚ç‡å°†ä½äº1%ã€‚æˆ‘ä»¬å¯ä»¥æœç´¢<code>â€œå¡æ–¹è¡¨â€</code>æˆ–<code>â€œChi Squared Tableâ€</code>æ‰¾åˆ°ä¸åŒè‡ªç”±åº¦å¯¹åº”çš„å¡æ–¹å€¼ã€‚</p><p>å¡æ–¹å€¼çš„å¤§å°å¯ä»¥åæ˜ å˜é‡ä¸ç›®æ ‡å€¼çš„ç›¸å…³æ€§ï¼Œå€¼è¶Šå¤§ï¼Œç›¸å…³æ€§è¶Šå¤§ã€‚åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œ<code>SelectKBest()</code> å‡½æ•°å°±å¯ä»¥è®¡ç®—ä¸åŒç‰¹å¾çš„å¡æ–¹å€¼æ¥åˆ¤æ–­ç‰¹å¾ä¸è¾“å‡ºå€¼çš„ç›¸å…³æ€§å¤§å°ï¼Œä»è€Œå®Œæˆç‰¹å¾é€‰æ‹©ã€‚åœ¨<code>scikit-learn</code>é‡Œï¼Œè®¡ç®—å¡æ–¹å€¼çš„å‡½æ•°æ˜¯ <code>sklearn.feature_selection.chi2()</code>ã€‚é™¤äº†å¡æ–¹æ£€éªŒå¤–ï¼Œè¿˜æœ‰<code>Få€¼æ£€éªŒ</code>ç­‰ç®—æ³•ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥è¯„ä¼°ç‰¹å¾ä¸ç›®æ ‡å€¼çš„ç›¸å…³æ€§ã€‚<code>SelectKBest</code> é»˜è®¤ä½¿ç”¨çš„å°±æ˜¯Få€¼æ£€éªŒç®—æ³•ï¼Œåœ¨<code>scikit-learn</code>é‡Œï¼Œä½¿ç”¨<code>sklearn.feature_selection.f_classif</code>æ¥è®¡ç®—Få€¼ã€‚å…³äºFå€¼ç›¸å…³çš„èµ„æ–™ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥åœ¨è‹±æ–‡ç‰ˆç»´åŸºç™¾ç§‘ä¸Šæœç´¢<code>â€œFisherâ€™sexact testâ€</code>ï¼Œäº†è§£æ›´å¤šä¿¡æ¯ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MLç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scikit-learnç³»åˆ—ä¸€ï¼šæœºå™¨å­¦ä¹ åŸºç¡€</title>
      <link href="/2020/06/28/scikit-learn-xi-lie-yi-ji-qi-xue-xi-ji-chu/"/>
      <url>/2020/06/28/scikit-learn-xi-lie-yi-ji-qi-xue-xi-ji-chu/</url>
      
        <content type="html"><![CDATA[<blockquote><p>è½¬è½½è‡ªä½œè€…: ç‰‡åˆ»1998<br>GitHubåœ°å€:  <a href="https://github.com/apachecn/AiLearning" target="_blank" rel="noopener">https://github.com/apachecn/AiLearning</a></p></blockquote><h2 id="æœºå™¨å­¦ä¹ -æ¦‚è¿°"><a href="#æœºå™¨å­¦ä¹ -æ¦‚è¿°" class="headerlink" title="æœºå™¨å­¦ä¹  æ¦‚è¿°"></a>æœºå™¨å­¦ä¹  æ¦‚è¿°</h2><p><code>æœºå™¨å­¦ä¹ (Machine Learning,ML)</code> æ˜¯ä½¿ç”¨è®¡ç®—æœºæ¥å½°æ˜¾æ•°æ®èƒŒåçš„çœŸå®å«ä¹‰ï¼Œå®ƒä¸ºäº†æŠŠæ— åºçš„æ•°æ®è½¬æ¢æˆæœ‰ç”¨çš„ä¿¡æ¯ã€‚æ˜¯ä¸€é—¨å¤šé¢†åŸŸäº¤å‰å­¦ç§‘ï¼Œæ¶‰åŠæ¦‚ç‡è®ºã€ç»Ÿè®¡å­¦ã€é€¼è¿‘è®ºã€å‡¸åˆ†æã€ç®—æ³•å¤æ‚åº¦ç†è®ºç­‰å¤šé—¨å­¦ç§‘ã€‚ä¸“é—¨ç ”ç©¶è®¡ç®—æœºæ€æ ·æ¨¡æ‹Ÿæˆ–å®ç°äººç±»çš„å­¦ä¹ è¡Œä¸ºï¼Œä»¥è·å–æ–°çš„çŸ¥è¯†æˆ–æŠ€èƒ½ï¼Œé‡æ–°ç»„ç»‡å·²æœ‰çš„çŸ¥è¯†ç»“æ„ä½¿ä¹‹ä¸æ–­æ”¹å–„è‡ªèº«çš„æ€§èƒ½ã€‚<br>å®ƒæ˜¯äººå·¥æ™ºèƒ½çš„æ ¸å¿ƒï¼Œæ˜¯ä½¿è®¡ç®—æœºå…·æœ‰æ™ºèƒ½çš„æ ¹æœ¬é€”å¾„ï¼Œå…¶åº”ç”¨éåŠäººå·¥æ™ºèƒ½çš„å„ä¸ªé¢†åŸŸï¼Œå®ƒä¸»è¦ä½¿ç”¨å½’çº³ã€ç»¼åˆè€Œä¸æ˜¯æ¼”ç»ã€‚</p><ol><li>æµ·é‡çš„æ•°æ®</li><li>è·å–æœ‰ç”¨çš„ä¿¡æ¯</li></ol><h2 id="æœºå™¨å­¦ä¹ -ç ”ç©¶æ„ä¹‰"><a href="#æœºå™¨å­¦ä¹ -ç ”ç©¶æ„ä¹‰" class="headerlink" title="æœºå™¨å­¦ä¹  ç ”ç©¶æ„ä¹‰"></a>æœºå™¨å­¦ä¹  ç ”ç©¶æ„ä¹‰</h2><p>æœºå™¨å­¦ä¹ æ˜¯ä¸€é—¨äººå·¥æ™ºèƒ½çš„ç§‘å­¦ï¼Œè¯¥é¢†åŸŸçš„ä¸»è¦ç ”ç©¶å¯¹è±¡æ˜¯äººå·¥æ™ºèƒ½ï¼Œç‰¹åˆ«æ˜¯å¦‚ä½•åœ¨ç»éªŒå­¦ä¹ ä¸­æ”¹å–„å…·ä½“ç®—æ³•çš„æ€§èƒ½â€ã€‚ â€œæœºå™¨å­¦ä¹ æ˜¯å¯¹èƒ½é€šè¿‡ç»éªŒè‡ªåŠ¨æ”¹è¿›çš„è®¡ç®—æœºç®—æ³•çš„ç ”ç©¶â€ã€‚ â€œæœºå™¨å­¦ä¹ æ˜¯ç”¨æ•°æ®æˆ–ä»¥å¾€çš„ç»éªŒï¼Œä»¥æ­¤ä¼˜åŒ–è®¡ç®—æœºç¨‹åºçš„æ€§èƒ½æ ‡å‡†ã€‚â€ ä¸€ç§ç»å¸¸å¼•ç”¨çš„è‹±æ–‡å®šä¹‰æ˜¯: A computer program is said to learn from experience E with respect to some class of tasks T and performance measure P, if its performance at tasks in T, as measured by P, improves with experience E.</p><p>æœºå™¨å­¦ä¹ å·²ç»æœ‰äº†ååˆ†å¹¿æ³›çš„åº”ç”¨ï¼Œä¾‹å¦‚: æ•°æ®æŒ–æ˜ã€è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€ç”Ÿç‰©ç‰¹å¾è¯†åˆ«ã€æœç´¢å¼•æ“ã€åŒ»å­¦è¯Šæ–­ã€æ£€æµ‹ä¿¡ç”¨å¡æ¬ºè¯ˆã€è¯åˆ¸å¸‚åœºåˆ†æã€DNAåºåˆ—æµ‹åºã€è¯­éŸ³å’Œæ‰‹å†™è¯†åˆ«ã€æˆ˜ç•¥æ¸¸æˆå’Œæœºå™¨äººè¿ç”¨ã€‚</p><h2 id="æœºå™¨å­¦ä¹ -åœºæ™¯"><a href="#æœºå™¨å­¦ä¹ -åœºæ™¯" class="headerlink" title="æœºå™¨å­¦ä¹  åœºæ™¯"></a>æœºå™¨å­¦ä¹  åœºæ™¯</h2><ul><li><p>ä¾‹å¦‚: è¯†åˆ«åŠ¨ç‰©çŒ«</p><ul><li>æ¨¡å¼è¯†åˆ«ï¼ˆå®˜æ–¹æ ‡å‡†ï¼‰: äººä»¬é€šè¿‡å¤§é‡çš„ç»éªŒï¼Œå¾—åˆ°ç»“è®ºï¼Œä»è€Œåˆ¤æ–­å®ƒå°±æ˜¯çŒ«ã€‚</li><li>æœºå™¨å­¦ä¹ ï¼ˆæ•°æ®å­¦ä¹ ï¼‰: äººä»¬é€šè¿‡é˜…è¯»è¿›è¡Œå­¦ä¹ ï¼Œè§‚å¯Ÿå®ƒä¼šå«ã€å°çœ¼ç›ã€ä¸¤åªè€³æœµã€å››æ¡è…¿ã€ä¸€æ¡å°¾å·´ï¼Œå¾—åˆ°ç»“è®ºï¼Œä»è€Œåˆ¤æ–­å®ƒå°±æ˜¯çŒ«ã€‚</li><li>æ·±åº¦å­¦ä¹ ï¼ˆæ·±å…¥æ•°æ®ï¼‰: äººä»¬é€šè¿‡æ·±å…¥äº†è§£å®ƒï¼Œå‘ç°å®ƒä¼šâ€™å–µå–µâ€™çš„å«ã€ä¸åŒç±»çš„çŒ«ç§‘åŠ¨ç‰©å¾ˆç±»ä¼¼ï¼Œå¾—åˆ°ç»“è®ºï¼Œä»è€Œåˆ¤æ–­å®ƒå°±æ˜¯çŒ«ã€‚ï¼ˆæ·±åº¦å­¦ä¹ å¸¸ç”¨é¢†åŸŸ: è¯­éŸ³è¯†åˆ«ã€å›¾åƒè¯†åˆ«ï¼‰</li></ul></li><li><p>æ¨¡å¼è¯†åˆ«ï¼ˆpattern recognitionï¼‰: æ¨¡å¼è¯†åˆ«æ˜¯æœ€å¤è€çš„ï¼ˆä½œä¸ºä¸€ä¸ªæœ¯è¯­è€Œè¨€ï¼Œå¯ä»¥è¯´æ˜¯å¾ˆè¿‡æ—¶çš„ï¼‰ã€‚</p><ul><li>æˆ‘ä»¬æŠŠç¯å¢ƒä¸å®¢ä½“ç»Ÿç§°ä¸ºâ€œæ¨¡å¼â€ï¼Œè¯†åˆ«æ˜¯å¯¹æ¨¡å¼çš„ä¸€ç§è®¤çŸ¥ï¼Œæ˜¯å¦‚ä½•è®©ä¸€ä¸ªè®¡ç®—æœºç¨‹åºå»åšä¸€äº›çœ‹èµ·æ¥å¾ˆâ€œæ™ºèƒ½â€çš„äº‹æƒ…ã€‚</li><li>é€šè¿‡èäºæ™ºæ…§å’Œç›´è§‰åï¼Œé€šè¿‡æ„å»ºç¨‹åºï¼Œè¯†åˆ«ä¸€äº›äº‹ç‰©ï¼Œè€Œä¸æ˜¯äººï¼Œä¾‹å¦‚: è¯†åˆ«æ•°å­—ã€‚</li></ul></li><li><p>æœºå™¨å­¦ä¹ ï¼ˆmachine learningï¼‰: æœºå™¨å­¦ä¹ æ˜¯æœ€åŸºç¡€çš„ï¼ˆå½“ä¸‹åˆåˆ›å…¬å¸å’Œç ”ç©¶å®éªŒå®¤çš„çƒ­ç‚¹é¢†åŸŸä¹‹ä¸€ï¼‰ã€‚</p><ul><li>åœ¨90å¹´ä»£åˆï¼Œäººä»¬å¼€å§‹æ„è¯†åˆ°ä¸€ç§å¯ä»¥æ›´æœ‰æ•ˆåœ°æ„å»ºæ¨¡å¼è¯†åˆ«ç®—æ³•çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯ç”¨æ•°æ®ï¼ˆå¯ä»¥é€šè¿‡å»‰ä»·åŠ³åŠ¨åŠ›é‡‡é›†è·å¾—ï¼‰å»æ›¿æ¢ä¸“å®¶ï¼ˆå…·æœ‰å¾ˆå¤šå›¾åƒæ–¹é¢çŸ¥è¯†çš„äººï¼‰ã€‚</li><li>â€œæœºå™¨å­¦ä¹ â€å¼ºè°ƒçš„æ˜¯ï¼Œåœ¨ç»™è®¡ç®—æœºç¨‹åºï¼ˆæˆ–è€…æœºå™¨ï¼‰è¾“å…¥ä¸€äº›æ•°æ®åï¼Œå®ƒå¿…é¡»åšä¸€äº›äº‹æƒ…ï¼Œé‚£å°±æ˜¯å­¦ä¹ è¿™äº›æ•°æ®ï¼Œè€Œè¿™ä¸ªå­¦ä¹ çš„æ­¥éª¤æ˜¯æ˜ç¡®çš„ã€‚</li><li>æœºå™¨å­¦ä¹ ï¼ˆMachine Learningï¼‰æ˜¯ä¸€é—¨ä¸“é—¨ç ”ç©¶è®¡ç®—æœºæ€æ ·æ¨¡æ‹Ÿæˆ–å®ç°äººç±»çš„å­¦ä¹ è¡Œä¸ºï¼Œä»¥è·å–æ–°çš„çŸ¥è¯†æˆ–æŠ€èƒ½ï¼Œé‡æ–°ç»„ç»‡å·²æœ‰çš„çŸ¥è¯†ç»“æ„ä½¿ä¹‹ä¸æ–­æ”¹å–„è‡ªèº«æ€§èƒ½çš„å­¦ç§‘ã€‚</li></ul></li><li><p>æ·±åº¦å­¦ä¹ ï¼ˆdeep learningï¼‰: æ·±åº¦å­¦ä¹ æ˜¯éå¸¸å´­æ–°å’Œæœ‰å½±å“åŠ›çš„å‰æ²¿é¢†åŸŸï¼Œæˆ‘ä»¬ç”šè‡³ä¸ä¼šå»æ€è€ƒ-åæ·±åº¦å­¦ä¹ æ—¶ä»£ã€‚</p><ul><li>æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ ç ”ç©¶ä¸­çš„ä¸€ä¸ªæ–°çš„é¢†åŸŸï¼Œå…¶åŠ¨æœºåœ¨äºå»ºç«‹ã€æ¨¡æ‹Ÿäººè„‘è¿›è¡Œåˆ†æå­¦ä¹ çš„ç¥ç»ç½‘ç»œï¼Œå®ƒæ¨¡ä»¿äººè„‘çš„æœºåˆ¶æ¥è§£é‡Šæ•°æ®ï¼Œä¾‹å¦‚å›¾åƒï¼Œå£°éŸ³å’Œæ–‡æœ¬ã€‚</li></ul></li><li><p>å‚è€ƒåœ°å€:  </p><ul><li><a href="http://www.csdn.net/article/2015-03-24/2824301" target="_blank" rel="noopener">æ·±åº¦å­¦ä¹  vs æœºå™¨å­¦ä¹  vs æ¨¡å¼è¯†åˆ«</a></li><li><a href="http://baike.baidu.com/link?url=76P-uA4EBrC3G-I__P1tqeO7eoDS709Kp4wYuHxc7GNkz_xn0NxuAtEohbpey7LUa2zUQLJxvIKUx4bnrEfOmsWLKbDmvG1PCoRkJisMTQka6-QReTrIxdYY3v93f55q" target="_blank" rel="noopener">æ·±åº¦å­¦ä¹  ç™¾ç§‘èµ„æ–™</a></li></ul></li></ul><blockquote><p>æœºå™¨å­¦ä¹ å·²åº”ç”¨äºå¤šä¸ªé¢†åŸŸï¼Œè¿œè¿œè¶…å‡ºå¤§å¤šæ•°äººçš„æƒ³è±¡ï¼Œæ¨ªè·¨: è®¡ç®—æœºç§‘å­¦ã€å·¥ç¨‹æŠ€æœ¯å’Œç»Ÿè®¡å­¦ç­‰å¤šä¸ªå­¦ç§‘ã€‚</p></blockquote><ul><li>æœç´¢å¼•æ“: æ ¹æ®ä½ çš„æœç´¢ç‚¹å‡»ï¼Œä¼˜åŒ–ä½ ä¸‹æ¬¡çš„æœç´¢ç»“æœ,æ˜¯æœºå™¨å­¦ä¹ æ¥å¸®åŠ©æœç´¢å¼•æ“åˆ¤æ–­å“ªä¸ªç»“æœæ›´é€‚åˆä½ ï¼ˆä¹Ÿåˆ¤æ–­å“ªä¸ªå¹¿å‘Šæ›´é€‚åˆä½ ï¼‰ã€‚</li><li>åƒåœ¾é‚®ä»¶: ä¼šè‡ªåŠ¨çš„è¿‡æ»¤åƒåœ¾å¹¿å‘Šé‚®ä»¶åˆ°åƒåœ¾ç®±å†…ã€‚</li><li>è¶…å¸‚ä¼˜æƒ åˆ¸: ä½ ä¼šå‘ç°ï¼Œä½ åœ¨è´­ä¹°å°å­©å­å°¿å¸ƒçš„æ—¶å€™ï¼Œå”®è´§å‘˜ä¼šèµ é€ä½ ä¸€å¼ ä¼˜æƒ åˆ¸å¯ä»¥å…‘æ¢6ç½å•¤é…’ã€‚</li><li>é‚®å±€é‚®å¯„: æ‰‹å†™è½¯ä»¶è‡ªåŠ¨è¯†åˆ«å¯„é€è´ºå¡çš„åœ°å€ã€‚</li><li>ç”³è¯·è´·æ¬¾: é€šè¿‡ä½ æœ€è¿‘çš„é‡‘èæ´»åŠ¨ä¿¡æ¯è¿›è¡Œç»¼åˆè¯„å®šï¼Œå†³å®šä½ æ˜¯å¦åˆæ ¼ã€‚</li></ul><h2 id="æœºå™¨å­¦ä¹ -ç»„æˆ"><a href="#æœºå™¨å­¦ä¹ -ç»„æˆ" class="headerlink" title="æœºå™¨å­¦ä¹  ç»„æˆ"></a>æœºå™¨å­¦ä¹  ç»„æˆ</h2><h3 id="ä¸»è¦ä»»åŠ¡"><a href="#ä¸»è¦ä»»åŠ¡" class="headerlink" title="ä¸»è¦ä»»åŠ¡"></a>ä¸»è¦ä»»åŠ¡</h3><ul><li>åˆ†ç±»ï¼ˆclassificationï¼‰: å°†å®ä¾‹æ•°æ®åˆ’åˆ†åˆ°åˆé€‚çš„ç±»åˆ«ä¸­ã€‚<ul><li>åº”ç”¨å®ä¾‹: åˆ¤æ–­ç½‘ç«™æ˜¯å¦è¢«é»‘å®¢å…¥ä¾µï¼ˆäºŒåˆ†ç±» ï¼‰ï¼Œæ‰‹å†™æ•°å­—çš„è‡ªåŠ¨è¯†åˆ«ï¼ˆå¤šåˆ†ç±»ï¼‰</li></ul></li><li>å›å½’ï¼ˆregressionï¼‰: ä¸»è¦ç”¨äºé¢„æµ‹æ•°å€¼å‹æ•°æ®ã€‚<ul><li>åº”ç”¨å®ä¾‹: è‚¡ç¥¨ä»·æ ¼æ³¢åŠ¨çš„é¢„æµ‹ï¼Œæˆ¿å±‹ä»·æ ¼çš„é¢„æµ‹ç­‰ã€‚</li></ul></li></ul><h3 id="ç›‘ç£å­¦ä¹ ï¼ˆsupervised-learningï¼‰"><a href="#ç›‘ç£å­¦ä¹ ï¼ˆsupervised-learningï¼‰" class="headerlink" title="ç›‘ç£å­¦ä¹ ï¼ˆsupervised learningï¼‰"></a>ç›‘ç£å­¦ä¹ ï¼ˆsupervised learningï¼‰</h3><ul><li>å¿…é¡»ç¡®å®šç›®æ ‡å˜é‡çš„å€¼ï¼Œä»¥ä¾¿æœºå™¨å­¦ä¹ ç®—æ³•å¯ä»¥å‘ç°ç‰¹å¾å’Œç›®æ ‡å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚åœ¨ç›‘ç£å­¦ä¹ ä¸­ï¼Œç»™å®šä¸€ç»„æ•°æ®ï¼Œæˆ‘ä»¬çŸ¥é“æ­£ç¡®çš„è¾“å‡ºç»“æœåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼Œå¹¶ä¸”çŸ¥é“åœ¨è¾“å…¥å’Œè¾“å‡ºä¹‹é—´æœ‰ç€ä¸€ä¸ªç‰¹å®šçš„å…³ç³»ã€‚ (åŒ…æ‹¬: åˆ†ç±»å’Œå›å½’)</li><li>æ ·æœ¬é›†: è®­ç»ƒæ•°æ® + æµ‹è¯•æ•°æ®<ul><li>è®­ç»ƒæ ·æœ¬ = ç‰¹å¾(feature) + ç›®æ ‡å˜é‡(label: åˆ†ç±»-ç¦»æ•£å€¼/å›å½’-è¿ç»­å€¼)</li><li>ç‰¹å¾é€šå¸¸æ˜¯è®­ç»ƒæ ·æœ¬é›†çš„åˆ—ï¼Œå®ƒä»¬æ˜¯ç‹¬ç«‹æµ‹é‡å¾—åˆ°çš„ã€‚</li><li>ç›®æ ‡å˜é‡: ç›®æ ‡å˜é‡æ˜¯æœºå™¨å­¦ä¹ é¢„æµ‹ç®—æ³•çš„æµ‹è¯•ç»“æœã€‚<ul><li>åœ¨åˆ†ç±»ç®—æ³•ä¸­ç›®æ ‡å˜é‡çš„ç±»å‹é€šå¸¸æ˜¯æ ‡ç§°å‹(å¦‚: çœŸä¸å‡)ï¼Œè€Œåœ¨å›å½’ç®—æ³•ä¸­é€šå¸¸æ˜¯è¿ç»­å‹(å¦‚: 1~100)ã€‚</li></ul></li></ul></li><li>ç›‘ç£å­¦ä¹ éœ€è¦æ³¨æ„çš„é—®é¢˜: <ul><li>åç½®æ–¹å·®æƒè¡¡</li><li>åŠŸèƒ½çš„å¤æ‚æ€§å’Œæ•°é‡çš„è®­ç»ƒæ•°æ®</li><li>è¾“å…¥ç©ºé—´çš„ç»´æ•°</li><li>å™ªå£°ä¸­çš„è¾“å‡ºå€¼</li></ul></li><li><code>çŸ¥è¯†è¡¨ç¤º</code>: <ul><li>å¯ä»¥é‡‡ç”¨è§„åˆ™é›†çš„å½¢å¼ã€ä¾‹å¦‚: æ•°å­¦æˆç»©å¤§äº90åˆ†ä¸ºä¼˜ç§€ã€‘</li><li>å¯ä»¥é‡‡ç”¨æ¦‚ç‡åˆ†å¸ƒçš„å½¢å¼ã€ä¾‹å¦‚: é€šè¿‡ç»Ÿè®¡åˆ†å¸ƒå‘ç°ï¼Œ90%çš„åŒå­¦æ•°å­¦æˆç»©ï¼Œåœ¨70åˆ†ä»¥ä¸‹ï¼Œé‚£ä¹ˆå¤§äº70åˆ†å®šä¸ºä¼˜ç§€ã€‘</li><li>å¯ä»¥ä½¿ç”¨è®­ç»ƒæ ·æœ¬é›†ä¸­çš„ä¸€ä¸ªå®ä¾‹ã€ä¾‹å¦‚: é€šè¿‡æ ·æœ¬é›†åˆï¼Œæˆ‘ä»¬è®­ç»ƒå‡ºä¸€ä¸ªæ¨¡å‹å®ä¾‹ï¼Œå¾—å‡º å¹´è½»ï¼Œæ•°å­¦æˆç»©ä¸­é«˜ç­‰ï¼Œè°ˆåä¼˜é›…ï¼Œæˆ‘ä»¬è®¤ä¸ºæ˜¯ä¼˜ç§€ã€‘</li></ul></li></ul><h3 id="éç›‘ç£å­¦ä¹ ï¼ˆunsupervised-learningï¼‰"><a href="#éç›‘ç£å­¦ä¹ ï¼ˆunsupervised-learningï¼‰" class="headerlink" title="éç›‘ç£å­¦ä¹ ï¼ˆunsupervised learningï¼‰"></a>éç›‘ç£å­¦ä¹ ï¼ˆunsupervised learningï¼‰</h3><ul><li>åœ¨æœºå™¨å­¦ä¹ ï¼Œæ— ç›‘ç£å­¦ä¹ çš„é—®é¢˜æ˜¯ï¼Œåœ¨æœªåŠ æ ‡ç­¾çš„æ•°æ®ä¸­ï¼Œè¯•å›¾æ‰¾åˆ°éšè—çš„ç»“æ„ã€‚å› ä¸ºæä¾›ç»™å­¦ä¹ è€…çš„å®ä¾‹æ˜¯æœªæ ‡è®°çš„ï¼Œå› æ­¤æ²¡æœ‰é”™è¯¯æˆ–æŠ¥é…¬ä¿¡å·æ¥è¯„ä¼°æ½œåœ¨çš„è§£å†³æ–¹æ¡ˆã€‚</li><li>æ— ç›‘ç£å­¦ä¹ æ˜¯å¯†åˆ‡ç›¸å…³çš„ç»Ÿè®¡æ•°æ®å¯†åº¦ä¼°è®¡çš„é—®é¢˜ã€‚ç„¶è€Œæ— ç›‘ç£å­¦ä¹ è¿˜åŒ…æ‹¬å¯»æ±‚ï¼Œæ€»ç»“å’Œè§£é‡Šæ•°æ®çš„ä¸»è¦ç‰¹ç‚¹ç­‰è¯¸å¤šæŠ€æœ¯ã€‚åœ¨æ— ç›‘ç£å­¦ä¹ ä½¿ç”¨çš„è®¸å¤šæ–¹æ³•æ˜¯åŸºäºç”¨äºå¤„ç†æ•°æ®çš„æ•°æ®æŒ–æ˜æ–¹æ³•ã€‚</li><li>æ•°æ®æ²¡æœ‰ç±»åˆ«ä¿¡æ¯ï¼Œä¹Ÿä¸ä¼šç»™å®šç›®æ ‡å€¼ã€‚</li><li>éç›‘ç£å­¦ä¹ åŒ…æ‹¬çš„ç±»å‹: <ul><li>èšç±»: åœ¨æ— ç›‘ç£å­¦ä¹ ä¸­ï¼Œå°†æ•°æ®é›†åˆ†æˆç”±ç±»ä¼¼çš„å¯¹è±¡ç»„æˆå¤šä¸ªç±»çš„è¿‡ç¨‹ç§°ä¸ºèšç±»ã€‚</li><li>å¯†åº¦ä¼°è®¡: é€šè¿‡æ ·æœ¬åˆ†å¸ƒçš„ç´§å¯†ç¨‹åº¦ï¼Œæ¥ä¼°è®¡ä¸åˆ†ç»„çš„ç›¸ä¼¼æ€§ã€‚</li><li>æ­¤å¤–ï¼Œæ— ç›‘ç£å­¦ä¹ è¿˜å¯ä»¥å‡å°‘æ•°æ®ç‰¹å¾çš„ç»´åº¦ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ä½¿ç”¨äºŒç»´æˆ–ä¸‰ç»´å›¾å½¢æ›´åŠ ç›´è§‚åœ°å±•ç¤ºæ•°æ®ä¿¡æ¯ã€‚</li></ul></li></ul><h3 id="å¼ºåŒ–å­¦ä¹ "><a href="#å¼ºåŒ–å­¦ä¹ " class="headerlink" title="å¼ºåŒ–å­¦ä¹ "></a>å¼ºåŒ–å­¦ä¹ </h3><p>è¿™ä¸ªç®—æ³•å¯ä»¥è®­ç»ƒç¨‹åºåšå‡ºæŸä¸€å†³å®šã€‚ç¨‹åºåœ¨æŸä¸€æƒ…å†µä¸‹å°è¯•æ‰€æœ‰çš„å¯èƒ½è¡ŒåŠ¨ï¼Œè®°å½•ä¸åŒè¡ŒåŠ¨çš„ç»“æœå¹¶è¯•ç€æ‰¾å‡ºæœ€å¥½çš„ä¸€æ¬¡å°è¯•æ¥åšå†³å®šã€‚ å±äºè¿™ä¸€ç±»ç®—æ³•çš„æœ‰é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ã€‚</p><h3 id="è®­ç»ƒè¿‡ç¨‹"><a href="#è®­ç»ƒè¿‡ç¨‹" class="headerlink" title="è®­ç»ƒè¿‡ç¨‹"></a>è®­ç»ƒè¿‡ç¨‹</h3><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E8%AE%AD%E7%BB%83%E8%BF%87%E7%A8%8B.jpg" alt="æœºå™¨å­¦ä¹ è®­ç»ƒè¿‡ç¨‹å›¾"></p><h3 id="ç®—æ³•æ±‡æ€»"><a href="#ç®—æ³•æ±‡æ€»" class="headerlink" title="ç®—æ³•æ±‡æ€»"></a>ç®—æ³•æ±‡æ€»</h3><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/ml_algorithm.jpg" alt="ç®—æ³•æ±‡æ€»"></p><h2 id="æœºå™¨å­¦ä¹ -ä½¿ç”¨"><a href="#æœºå™¨å­¦ä¹ -ä½¿ç”¨" class="headerlink" title="æœºå™¨å­¦ä¹  ä½¿ç”¨"></a>æœºå™¨å­¦ä¹  ä½¿ç”¨</h2><blockquote><p>é€‰æ‹©ç®—æ³•éœ€è¦è€ƒè™‘çš„ä¸¤ä¸ªé—®é¢˜</p></blockquote><ol><li>ç®—æ³•åœºæ™¯<ul><li>é¢„æµ‹æ˜å¤©æ˜¯å¦ä¸‹é›¨ï¼Œå› ä¸ºå¯ä»¥ç”¨å†å²çš„å¤©æ°”æƒ…å†µåšé¢„æµ‹ï¼Œæ‰€ä»¥é€‰æ‹©ç›‘ç£å­¦ä¹ ç®—æ³•</li><li>ç»™ä¸€ç¾¤é™Œç”Ÿçš„äººè¿›è¡Œåˆ†ç»„ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰è¿™äº›äººçš„ç±»åˆ«ä¿¡æ¯ï¼Œæ‰€ä»¥é€‰æ‹©æ— ç›‘ç£å­¦ä¹ ç®—æ³•ã€é€šè¿‡ä»–ä»¬èº«é«˜ã€ä½“é‡ç­‰ç‰¹å¾è¿›è¡Œå¤„ç†ã€‚</li></ul></li><li>éœ€è¦æ”¶é›†æˆ–åˆ†æçš„æ•°æ®æ˜¯ä»€ä¹ˆ</li></ol><blockquote><p>ä¸¾ä¾‹</p></blockquote><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80-%E9%80%89%E6%8B%A9%E7%AE%97%E6%B3%95.jpg" alt="é€‰æ‹©ç®—æ³•å›¾"></p><blockquote><p>æœºå™¨å­¦ä¹  å¼€å‘æµç¨‹</p></blockquote><ol><li>æ”¶é›†æ•°æ®: æ”¶é›†æ ·æœ¬æ•°æ®</li><li>å‡†å¤‡æ•°æ®: æ³¨æ„æ•°æ®çš„æ ¼å¼</li><li>åˆ†ææ•°æ®: ä¸ºäº†ç¡®ä¿æ•°æ®é›†ä¸­æ²¡æœ‰åƒåœ¾æ•°æ®ï¼›<ul><li>å¦‚æœæ˜¯ç®—æ³•å¯ä»¥å¤„ç†çš„æ•°æ®æ ¼å¼æˆ–å¯ä¿¡ä»»çš„æ•°æ®æºï¼Œåˆ™å¯ä»¥è·³è¿‡è¯¥æ­¥éª¤ï¼›</li><li>å¦å¤–è¯¥æ­¥éª¤éœ€è¦äººå·¥å¹²é¢„ï¼Œä¼šé™ä½è‡ªåŠ¨åŒ–ç³»ç»Ÿçš„ä»·å€¼ã€‚</li></ul></li><li>è®­ç»ƒç®—æ³•: [æœºå™¨å­¦ä¹ ç®—æ³•æ ¸å¿ƒ]å¦‚æœä½¿ç”¨æ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œç”±äºä¸å­˜åœ¨ç›®æ ‡å˜é‡å€¼ï¼Œåˆ™å¯ä»¥è·³è¿‡è¯¥æ­¥éª¤</li><li>æµ‹è¯•ç®—æ³•: [æœºå™¨å­¦ä¹ ç®—æ³•æ ¸å¿ƒ]è¯„ä¼°ç®—æ³•æ•ˆæœ</li><li>ä½¿ç”¨ç®—æ³•: å°†æœºå™¨å­¦ä¹ ç®—æ³•è½¬ä¸ºåº”ç”¨ç¨‹åº</li></ol><h2 id="æœºå™¨å­¦ä¹ -æ•°å­¦åŸºç¡€"><a href="#æœºå™¨å­¦ä¹ -æ•°å­¦åŸºç¡€" class="headerlink" title="æœºå™¨å­¦ä¹  æ•°å­¦åŸºç¡€"></a>æœºå™¨å­¦ä¹  æ•°å­¦åŸºç¡€</h2><ul><li>å¾®ç§¯åˆ†</li><li>ç»Ÿè®¡å­¦/æ¦‚ç‡è®º</li><li>çº¿æ€§ä»£æ•°</li></ul><h2 id="æœºå™¨å­¦ä¹ -å·¥å…·"><a href="#æœºå™¨å­¦ä¹ -å·¥å…·" class="headerlink" title="æœºå™¨å­¦ä¹  å·¥å…·"></a>æœºå™¨å­¦ä¹  å·¥å…·</h2><h3 id="Pythonè¯­è¨€"><a href="#Pythonè¯­è¨€" class="headerlink" title="Pythonè¯­è¨€"></a>Pythonè¯­è¨€</h3><ol><li>å¯æ‰§è¡Œä¼ªä»£ç </li><li>Pythonæ¯”è¾ƒæµè¡Œ: ä½¿ç”¨å¹¿æ³›ã€ä»£ç èŒƒä¾‹å¤šã€ä¸°å¯Œæ¨¡å—åº“ï¼Œå¼€å‘å‘¨æœŸçŸ­</li><li>Pythonè¯­è¨€çš„ç‰¹è‰²: æ¸…æ™°ç®€ç»ƒã€æ˜“äºç†è§£</li><li>Pythonè¯­è¨€çš„ç¼ºç‚¹: å”¯ä¸€ä¸è¶³çš„æ˜¯æ€§èƒ½é—®é¢˜</li><li>Pythonç›¸å…³çš„åº“<ul><li>ç§‘å­¦å‡½æ•°åº“: <code>SciPy</code>ã€<code>NumPy</code>(åº•å±‚è¯­è¨€: Cå’ŒFortran)</li><li>ç»˜å›¾å·¥å…·åº“: <code>Matplotlib</code></li><li>æ•°æ®åˆ†æåº“ <code>Pandas</code></li></ul></li></ol><h3 id="æ•°å­¦å·¥å…·"><a href="#æ•°å­¦å·¥å…·" class="headerlink" title="æ•°å­¦å·¥å…·"></a>æ•°å­¦å·¥å…·</h3><ul><li>Matlab</li></ul><h2 id="é™„-æœºå™¨å­¦ä¹ ä¸“ä¸šæœ¯è¯­"><a href="#é™„-æœºå™¨å­¦ä¹ ä¸“ä¸šæœ¯è¯­" class="headerlink" title="é™„: æœºå™¨å­¦ä¹ ä¸“ä¸šæœ¯è¯­"></a>é™„: æœºå™¨å­¦ä¹ ä¸“ä¸šæœ¯è¯­</h2><ul><li>æ¨¡å‹ï¼ˆmodelï¼‰: è®¡ç®—æœºå±‚é¢çš„è®¤çŸ¥</li><li>å­¦ä¹ ç®—æ³•ï¼ˆlearning algorithmï¼‰ï¼Œä»æ•°æ®ä¸­äº§ç”Ÿæ¨¡å‹çš„æ–¹æ³•</li><li>æ•°æ®é›†ï¼ˆdata setï¼‰: ä¸€ç»„è®°å½•çš„åˆé›†</li><li>ç¤ºä¾‹ï¼ˆinstanceï¼‰: å¯¹äºæŸä¸ªå¯¹è±¡çš„æè¿°</li><li>æ ·æœ¬ï¼ˆsampleï¼‰: ä¹Ÿå«ç¤ºä¾‹</li><li>å±æ€§ï¼ˆattributeï¼‰: å¯¹è±¡çš„æŸæ–¹é¢è¡¨ç°æˆ–ç‰¹å¾</li><li>ç‰¹å¾ï¼ˆfeatureï¼‰: åŒå±æ€§</li><li>å±æ€§å€¼ï¼ˆattribute valueï¼‰: å±æ€§ä¸Šçš„å–å€¼</li><li>å±æ€§ç©ºé—´ï¼ˆattribute spaceï¼‰: å±æ€§å¼ æˆçš„ç©ºé—´</li><li>æ ·æœ¬ç©ºé—´/è¾“å…¥ç©ºé—´ï¼ˆsamplespaceï¼‰: åŒå±æ€§ç©ºé—´</li><li>ç‰¹å¾å‘é‡ï¼ˆfeature vectorï¼‰: åœ¨å±æ€§ç©ºé—´é‡Œæ¯ä¸ªç‚¹å¯¹åº”ä¸€ä¸ªåæ ‡å‘é‡ï¼ŒæŠŠä¸€ä¸ªç¤ºä¾‹ç§°ä½œç‰¹å¾å‘é‡</li><li>ç»´æ•°ï¼ˆdimensionalityï¼‰: æè¿°æ ·æœ¬å‚æ•°çš„ä¸ªæ•°ï¼ˆä¹Ÿå°±æ˜¯ç©ºé—´æ˜¯å‡ ç»´çš„ï¼‰</li><li>å­¦ä¹ ï¼ˆlearningï¼‰/è®­ç»ƒï¼ˆtrainingï¼‰: ä»æ•°æ®ä¸­å­¦å¾—æ¨¡å‹</li><li>è®­ç»ƒæ•°æ®ï¼ˆtraining dataï¼‰: è®­ç»ƒè¿‡ç¨‹ä¸­ç”¨åˆ°çš„æ•°æ®</li><li>è®­ç»ƒæ ·æœ¬ï¼ˆtraining sampleï¼‰:è®­ç»ƒç”¨åˆ°çš„æ¯ä¸ªæ ·æœ¬</li><li>è®­ç»ƒé›†ï¼ˆtraining setï¼‰: è®­ç»ƒæ ·æœ¬ç»„æˆçš„é›†åˆ</li><li>å‡è®¾ï¼ˆhypothesisï¼‰: å­¦ä¹ æ¨¡å‹å¯¹åº”äº†å…³äºæ•°æ®çš„æŸç§æ½œåœ¨è§„åˆ™</li><li>çœŸç›¸ï¼ˆground-truthï¼‰:çœŸæ­£å­˜åœ¨çš„æ½œåœ¨è§„å¾‹</li><li>å­¦ä¹ å™¨ï¼ˆlearnerï¼‰: æ¨¡å‹çš„å¦ä¸€ç§å«æ³•ï¼ŒæŠŠå­¦ä¹ ç®—æ³•åœ¨ç»™å®šæ•°æ®å’Œå‚æ•°ç©ºé—´çš„å®ä¾‹åŒ–</li><li>é¢„æµ‹ï¼ˆpredictionï¼‰: åˆ¤æ–­ä¸€ä¸ªä¸œè¥¿çš„å±æ€§</li><li>æ ‡è®°ï¼ˆlabelï¼‰: å…³äºç¤ºä¾‹çš„ç»“æœä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘æ˜¯ä¸€ä¸ªâ€œå¥½äººâ€ã€‚</li><li>æ ·ä¾‹ï¼ˆexampleï¼‰: æ‹¥æœ‰æ ‡è®°çš„ç¤ºä¾‹</li><li>æ ‡è®°ç©ºé—´/è¾“å‡ºç©ºé—´ï¼ˆlabel spaceï¼‰: æ‰€æœ‰æ ‡è®°çš„é›†åˆ</li><li>åˆ†ç±»ï¼ˆclassificationï¼‰: é¢„æµ‹æ˜¯ç¦»æ•£å€¼ï¼Œæ¯”å¦‚æŠŠäººåˆ†ä¸ºå¥½äººå’Œåäººä¹‹ç±»çš„å­¦ä¹ ä»»åŠ¡</li><li>å›å½’ï¼ˆregressionï¼‰: é¢„æµ‹å€¼æ˜¯è¿ç»­å€¼ï¼Œæ¯”å¦‚ä½ çš„å¥½äººç¨‹åº¦è¾¾åˆ°äº†0.9ï¼Œ0.6ä¹‹ç±»çš„</li><li>äºŒåˆ†ç±»ï¼ˆbinary classificationï¼‰: åªæ¶‰åŠä¸¤ä¸ªç±»åˆ«çš„åˆ†ç±»ä»»åŠ¡</li><li>æ­£ç±»ï¼ˆpositive classï¼‰: äºŒåˆ†ç±»é‡Œçš„ä¸€ä¸ª</li><li>åç±»ï¼ˆnegative classï¼‰: äºŒåˆ†ç±»é‡Œçš„å¦å¤–ä¸€ä¸ª</li><li>å¤šåˆ†ç±»ï¼ˆmulti-class classificationï¼‰: æ¶‰åŠå¤šä¸ªç±»åˆ«çš„åˆ†ç±»</li><li>æµ‹è¯•ï¼ˆtestingï¼‰: å­¦ä¹ åˆ°æ¨¡å‹ä¹‹åå¯¹æ ·æœ¬è¿›è¡Œé¢„æµ‹çš„è¿‡ç¨‹</li><li>æµ‹è¯•æ ·æœ¬ï¼ˆtesting sampleï¼‰: è¢«é¢„æµ‹çš„æ ·æœ¬</li><li>èšç±»ï¼ˆclusteringï¼‰: æŠŠè®­ç»ƒé›†ä¸­çš„å¯¹è±¡åˆ†ä¸ºè‹¥å¹²ç»„</li><li>ç°‡ï¼ˆclusterï¼‰: æ¯ä¸€ä¸ªç»„å«ç°‡</li><li>ç›‘ç£å­¦ä¹ ï¼ˆsupervised learningï¼‰: å…¸èŒƒâ€“åˆ†ç±»å’Œå›å½’</li><li>æ— ç›‘ç£å­¦ä¹ ï¼ˆunsupervised learningï¼‰: å…¸èŒƒâ€“èšç±»</li><li>æœªè§ç¤ºä¾‹ï¼ˆunseen instanceï¼‰: â€œæ–°æ ·æœ¬â€œï¼Œæ²¡è®­ç»ƒè¿‡çš„æ ·æœ¬</li><li>æ³›åŒ–ï¼ˆgeneralizationï¼‰èƒ½åŠ›: å­¦å¾—çš„æ¨¡å‹é€‚ç”¨äºæ–°æ ·æœ¬çš„èƒ½åŠ›</li><li>åˆ†å¸ƒï¼ˆdistributionï¼‰: æ ·æœ¬ç©ºé—´çš„å…¨ä½“æ ·æœ¬æœä»çš„ä¸€ç§è§„å¾‹</li><li>ç‹¬ç«‹åŒåˆ†å¸ƒï¼ˆindependent and identically distributedï¼Œç®€ç§°i,i,d.ï¼‰:è·å¾—çš„æ¯ä¸ªæ ·æœ¬éƒ½æ˜¯ç‹¬ç«‹åœ°ä»è¿™ä¸ªåˆ†å¸ƒä¸Šé‡‡æ ·è·å¾—çš„ã€‚</li></ul><h2 id="æœºå™¨å­¦ä¹ åŸºç¡€è¡¥å……"><a href="#æœºå™¨å­¦ä¹ åŸºç¡€è¡¥å……" class="headerlink" title="æœºå™¨å­¦ä¹ åŸºç¡€è¡¥å……"></a>æœºå™¨å­¦ä¹ åŸºç¡€è¡¥å……</h2><h3 id="æ•°æ®é›†çš„åˆ’åˆ†"><a href="#æ•°æ®é›†çš„åˆ’åˆ†" class="headerlink" title="æ•°æ®é›†çš„åˆ’åˆ†"></a>æ•°æ®é›†çš„åˆ’åˆ†</h3><ul><li>è®­ç»ƒé›†ï¼ˆTraining setï¼‰ â€”â€” å­¦ä¹ æ ·æœ¬æ•°æ®é›†ï¼Œé€šè¿‡åŒ¹é…ä¸€äº›å‚æ•°æ¥å»ºç«‹ä¸€ä¸ªæ¨¡å‹ï¼Œä¸»è¦ç”¨æ¥è®­ç»ƒæ¨¡å‹ã€‚ç±»æ¯”è€ƒç ”å‰åšçš„è§£é¢˜å¤§å…¨ã€‚</li><li>éªŒè¯é›†ï¼ˆvalidation setï¼‰ â€”â€” å¯¹å­¦ä¹ å‡ºæ¥çš„æ¨¡å‹ï¼Œè°ƒæ•´æ¨¡å‹çš„å‚æ•°ï¼Œå¦‚åœ¨ç¥ç»ç½‘ç»œä¸­é€‰æ‹©éšè—å•å…ƒæ•°ã€‚éªŒè¯é›†è¿˜ç”¨æ¥ç¡®å®šç½‘ç»œç»“æ„æˆ–è€…æ§åˆ¶æ¨¡å‹å¤æ‚ç¨‹åº¦çš„å‚æ•°ã€‚ç±»æ¯” è€ƒç ”ä¹‹å‰åšçš„æ¨¡æ‹Ÿè€ƒè¯•ã€‚</li><li>æµ‹è¯•é›†ï¼ˆTest setï¼‰ â€”â€” æµ‹è¯•è®­ç»ƒå¥½çš„æ¨¡å‹çš„åˆ†è¾¨èƒ½åŠ›ã€‚ç±»æ¯” è€ƒç ”ã€‚è¿™æ¬¡çœŸçš„æ˜¯ä¸€è€ƒå®šç»ˆèº«ã€‚</li></ul><h3 id="æ¨¡å‹æ‹Ÿåˆç¨‹åº¦"><a href="#æ¨¡å‹æ‹Ÿåˆç¨‹åº¦" class="headerlink" title="æ¨¡å‹æ‹Ÿåˆç¨‹åº¦"></a>æ¨¡å‹æ‹Ÿåˆç¨‹åº¦</h3><ul><li>æ¬ æ‹Ÿåˆï¼ˆUnderfittingï¼‰: æ¨¡å‹æ²¡æœ‰å¾ˆå¥½åœ°æ•æ‰åˆ°æ•°æ®ç‰¹å¾ï¼Œä¸èƒ½å¤Ÿå¾ˆå¥½åœ°æ‹Ÿåˆæ•°æ®ï¼Œå¯¹è®­ç»ƒæ ·æœ¬çš„ä¸€èˆ¬æ€§è´¨å°šæœªå­¦å¥½ã€‚ç±»æ¯”ï¼Œå…‰çœ‹ä¹¦ä¸åšé¢˜è§‰å¾—è‡ªå·±ä»€ä¹ˆéƒ½ä¼šäº†ï¼Œä¸Šäº†è€ƒåœºæ‰çŸ¥é“è‡ªå·±å•¥éƒ½ä¸ä¼šã€‚</li><li>è¿‡æ‹Ÿåˆï¼ˆOverfittingï¼‰: æ¨¡å‹æŠŠè®­ç»ƒæ ·æœ¬å­¦ä¹ â€œå¤ªå¥½äº†â€ï¼Œå¯èƒ½æŠŠä¸€äº›è®­ç»ƒæ ·æœ¬è‡ªèº«çš„ç‰¹æ€§å½“åšäº†æ‰€æœ‰æ½œåœ¨æ ·æœ¬éƒ½æœ‰çš„ä¸€èˆ¬æ€§è´¨ï¼Œå¯¼è‡´æ³›åŒ–èƒ½åŠ›ä¸‹é™ã€‚ç±»æ¯”ï¼Œåšè¯¾åé¢˜å…¨éƒ½åšå¯¹äº†ï¼Œè¶…çº²é¢˜ä¹Ÿéƒ½è®¤ä¸ºæ˜¯è€ƒè¯•å¿…è€ƒé¢˜ç›®ï¼Œä¸Šäº†è€ƒåœºè¿˜æ˜¯å•¥éƒ½ä¸ä¼šã€‚ </li></ul><p>é€šä¿—æ¥è¯´ï¼Œæ¬ æ‹Ÿåˆå’Œè¿‡æ‹Ÿåˆéƒ½å¯ä»¥ç”¨ä¸€å¥è¯æ¥è¯´ï¼Œæ¬ æ‹Ÿåˆå°±æ˜¯: â€œä½ å¤ªå¤©çœŸäº†ï¼â€ï¼Œè¿‡æ‹Ÿåˆå°±æ˜¯: â€œä½ æƒ³å¤ªå¤šäº†ï¼â€ã€‚</p><h3 id="å¸¸è§çš„æ¨¡å‹æŒ‡æ ‡"><a href="#å¸¸è§çš„æ¨¡å‹æŒ‡æ ‡" class="headerlink" title="å¸¸è§çš„æ¨¡å‹æŒ‡æ ‡"></a>å¸¸è§çš„æ¨¡å‹æŒ‡æ ‡</h3><ul><li>æ­£ç¡®ç‡ â€”â€” æå–å‡ºçš„æ­£ç¡®ä¿¡æ¯æ¡æ•° / æå–å‡ºçš„ä¿¡æ¯æ¡æ•°</li><li>å¬å›ç‡ â€”â€” æå–å‡ºçš„æ­£ç¡®ä¿¡æ¯æ¡æ•° / æ ·æœ¬ä¸­çš„ä¿¡æ¯æ¡æ•°</li><li>F å€¼ â€”â€” æ­£ç¡®ç‡ * å¬å›ç‡ * 2 / ï¼ˆæ­£ç¡®ç‡ + å¬å›ç‡ï¼‰ï¼ˆFå€¼å³ä¸ºæ­£ç¡®ç‡å’Œå¬å›ç‡çš„è°ƒå’Œå¹³å‡å€¼ï¼‰</li></ul><p>ä¸¾ä¸ªä¾‹å­å¦‚ä¸‹: </p><p>ä¸¾ä¸ªä¾‹å­å¦‚ä¸‹:<br>æŸæ± å¡˜æœ‰ 1400 æ¡é²¤é±¼ï¼Œ300 åªè™¾ï¼Œ300 åªä¹Œé¾Ÿã€‚ç°åœ¨ä»¥æ•é²¤é±¼ä¸ºç›®çš„ã€‚æ’’äº†ä¸€å¼ ç½‘ï¼Œé€®ä½äº† 700 æ¡é²¤é±¼ï¼Œ200 åª<br>è™¾ï¼Œ 100 åªä¹Œé¾Ÿã€‚é‚£ä¹ˆè¿™äº›æŒ‡æ ‡åˆ†åˆ«å¦‚ä¸‹:<br>æ­£ç¡®ç‡ = 700 / (700 + 200 + 100) = 70%<br>å¬å›ç‡ = 700 / 1400 = 50%<br>F å€¼ = 70% * 50% * 2 / (70% + 50%) = 58.3%</p><h3 id="æ¨¡å‹"><a href="#æ¨¡å‹" class="headerlink" title="æ¨¡å‹"></a>æ¨¡å‹</h3><ul><li>åˆ†ç±»é—®é¢˜ â€”â€” è¯´ç™½äº†å°±æ˜¯å°†ä¸€äº›æœªçŸ¥ç±»åˆ«çš„æ•°æ®åˆ†åˆ°ç°åœ¨å·²çŸ¥çš„ç±»åˆ«ä¸­å»ã€‚æ¯”å¦‚ï¼Œæ ¹æ®ä½ çš„ä¸€äº›ä¿¡æ¯ï¼Œåˆ¤æ–­ä½ æ˜¯é«˜å¯Œå¸…ï¼Œè¿˜æ˜¯ç©·å±Œä¸ã€‚è¯„åˆ¤åˆ†ç±»æ•ˆæœå¥½åçš„ä¸‰ä¸ªæŒ‡æ ‡å°±æ˜¯ä¸Šé¢ä»‹ç»çš„ä¸‰ä¸ªæŒ‡æ ‡: æ­£ç¡®ç‡ï¼Œå¬å›ç‡ï¼ŒFå€¼ã€‚</li><li>å›å½’é—®é¢˜ â€”â€” å¯¹æ•°å€¼å‹è¿ç»­éšæœºå˜é‡è¿›è¡Œé¢„æµ‹å’Œå»ºæ¨¡çš„ç›‘ç£å­¦ä¹ ç®—æ³•ã€‚å›å½’å¾€å¾€ä¼šé€šè¿‡è®¡ç®— è¯¯å·®ï¼ˆErrorï¼‰æ¥ç¡®å®šæ¨¡å‹çš„ç²¾ç¡®æ€§ã€‚</li><li>èšç±»é—®é¢˜ â€”â€” èšç±»æ˜¯ä¸€ç§æ— ç›‘ç£å­¦ä¹ ä»»åŠ¡ï¼Œè¯¥ç®—æ³•åŸºäºæ•°æ®çš„å†…éƒ¨ç»“æ„å¯»æ‰¾è§‚å¯Ÿæ ·æœ¬çš„è‡ªç„¶æ—ç¾¤ï¼ˆå³é›†ç¾¤ï¼‰ã€‚èšç±»é—®é¢˜çš„æ ‡å‡†ä¸€èˆ¬åŸºäºè·ç¦»: ç°‡å†…è·ç¦»ï¼ˆIntra-cluster Distanceï¼‰ å’Œ ç°‡é—´è·ç¦»ï¼ˆInter-cluster Distanceï¼‰ ã€‚ç°‡å†…è·ç¦»æ˜¯è¶Šå°è¶Šå¥½ï¼Œä¹Ÿå°±æ˜¯ç°‡å†…çš„å…ƒç´ è¶Šç›¸ä¼¼è¶Šå¥½ï¼›è€Œç°‡é—´è·ç¦»è¶Šå¤§è¶Šå¥½ï¼Œä¹Ÿå°±æ˜¯è¯´ç°‡é—´ï¼ˆä¸åŒç°‡ï¼‰å…ƒç´ è¶Šä¸ç›¸åŒè¶Šå¥½ã€‚ä¸€èˆ¬çš„ï¼Œè¡¡é‡èšç±»é—®é¢˜ä¼šç»™å‡ºä¸€ä¸ªç»“åˆç°‡å†…è·ç¦»å’Œç°‡é—´è·ç¦»çš„å…¬å¼ã€‚</li></ul><p>ä¸‹é¢è¿™ä¸ªå›¾å¯ä»¥æ¯”è¾ƒç›´è§‚åœ°å±•ç¤ºå‡ºæ¥: </p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/ml_add_2.jpg" alt=""></p><h3 id="ç‰¹å¾å·¥ç¨‹çš„ä¸€äº›å°ä¸œè¥¿"><a href="#ç‰¹å¾å·¥ç¨‹çš„ä¸€äº›å°ä¸œè¥¿" class="headerlink" title="ç‰¹å¾å·¥ç¨‹çš„ä¸€äº›å°ä¸œè¥¿"></a>ç‰¹å¾å·¥ç¨‹çš„ä¸€äº›å°ä¸œè¥¿</h3><ul><li><p>ç‰¹å¾é€‰æ‹© â€”â€” ä¹Ÿå«ç‰¹å¾å­é›†é€‰æ‹©ï¼ˆFSSï¼ŒFeature Subset Selectionï¼‰ã€‚æ˜¯æŒ‡ä»å·²æœ‰çš„ M ä¸ªç‰¹å¾ï¼ˆFeatureï¼‰ä¸­é€‰æ‹© N ä¸ªç‰¹å¾ä½¿å¾—ç³»ç»Ÿçš„ç‰¹å®šæŒ‡æ ‡æœ€ä¼˜åŒ–ï¼Œæ˜¯ä»åŸå§‹ç‰¹å¾ä¸­é€‰æ‹©å‡ºä¸€äº›æœ€æœ‰æ•ˆç‰¹å¾ä»¥é™ä½æ•°æ®é›†ç»´åº¦çš„è¿‡ç¨‹ï¼Œæ˜¯æé«˜ç®—æ³•æ€§èƒ½çš„ä¸€ä¸ªé‡è¦æ‰‹æ®µï¼Œä¹Ÿæ˜¯æ¨¡å¼è¯†åˆ«ä¸­å…³é”®çš„æ•°æ®é¢„å¤„ç†æ­¥éª¤ã€‚</p></li><li><p>ç‰¹å¾æå– â€”â€” ç‰¹å¾æå–æ˜¯è®¡ç®—æœºè§†è§‰å’Œå›¾åƒå¤„ç†ä¸­çš„ä¸€ä¸ªæ¦‚å¿µã€‚å®ƒæŒ‡çš„æ˜¯ä½¿ç”¨è®¡ç®—æœºæå–å›¾åƒä¿¡æ¯ï¼Œå†³å®šæ¯ä¸ªå›¾åƒçš„ç‚¹æ˜¯å¦å±äºä¸€ä¸ªå›¾åƒç‰¹å¾ã€‚ç‰¹å¾æå–çš„ç»“æœæ˜¯æŠŠå›¾åƒä¸Šçš„ç‚¹åˆ†ä¸ºä¸åŒçš„å­é›†ï¼Œè¿™äº›å­é›†å¾€å¾€å±äºå­¤ç«‹çš„ç‚¹ï¼Œè¿ç»­çš„æ›²çº¿æˆ–è€…è¿ç»­çš„åŒºåŸŸã€‚</p></li></ul><p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªç‰¹å¾å·¥ç¨‹çš„å›¾: </p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/ml_add_1.jpg" alt=""></p><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><ul><li><p>Learning rate â€”â€” å­¦ä¹ ç‡ï¼Œé€šä¿—åœ°ç†è§£ï¼Œå¯ä»¥ç†è§£ä¸ºæ­¥é•¿ï¼Œæ­¥å­å¤§äº†ï¼Œå¾ˆå®¹æ˜“é”™è¿‡æœ€ä½³ç»“æœã€‚å°±æ˜¯æœ¬æ¥ç›®æ ‡å°½åœ¨å’«å°ºï¼Œå¯æ˜¯å› ä¸ºæˆ‘è¿ˆçš„æ­¥å­å¾ˆå¤§ï¼Œå´ä¸€ä¸‹å­èµ°è¿‡äº†ã€‚æ­¥å­å°äº†å‘¢ï¼Œå°±æ˜¯åŒæ ·çš„è·ç¦»ï¼Œæˆ‘å´è¦èµ°å¾ˆå¤šå¾ˆå¤šæ­¥ï¼Œè¿™æ ·å¯¼è‡´è®­ç»ƒçš„è€—æ—¶è´¹åŠ›è¿˜ä¸è®¨å¥½ã€‚</p></li><li><p>æœºå™¨å­¦ä¹ çš„æ•°å­¦åŸºç¡€ : <a href="https://zhuanlan.zhihu.com/p/25197792" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/25197792</a></p></li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MLç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexoåšå®¢å¤‡ä»½</title>
      <link href="/2020/06/28/hexo-bo-ke-bei-fen/"/>
      <url>/2020/06/28/hexo-bo-ke-bei-fen/</url>
      
        <content type="html"><![CDATA[<p><a href="https://dongzhougu.github.io/2020/06/27/shi-yong-hexo-da-jian-github-bo-ke/">ä¸Šä¸€ç¯‡æ–‡ç« </a>å·²ç»å…·ä½“è®²è¿°äº†åšå®¢çš„æ­å»ºä¸åŸºæœ¬ä½¿ç”¨ï¼Œæ¥ä¸‹æ¥è®°å½•åšå®¢çš„å¤‡ä»½å·¥ä½œã€‚</p><h4 id="åˆå§‹å¤‡ä»½"><a href="#åˆå§‹å¤‡ä»½" class="headerlink" title="åˆå§‹å¤‡ä»½"></a>åˆå§‹å¤‡ä»½</h4><ul><li><p>åˆ›å»ºä¸€ä¸ªä»“åº“ç”¨æ¥å­˜æ”¾å¤‡ä»½æ–‡ä»¶ï¼Œæˆ‘çš„åå­—é€‰æ‹© <strong><a href="https://github.com/DongZhouGu/Blog-backup" target="_blank" rel="noopener">Blog-backup</a></strong>ï¼Œå‹¾é€‰READMEã€‚</p></li><li><p>å¤åˆ¶ä»“åº“åœ°å€ï¼Œè¿è¡ŒGitå°†ä»“åº“cloneåˆ°æœ¬åœ°ã€‚</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">git</span> clone git@github.com:DongZhouGu/Blog-backup.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>å°†è¦å¤‡ä»½çš„æ–‡ä»¶æ”¾åˆ°æˆ‘ä»¬åˆšæ‰cloneçš„æ–‡ä»¶å¤¹é‡Œé¢ã€‚</p></li><li><p>åœ¨ clone çš„æ–‡ä»¶å¤¹ä¸‹è¿è¡Œ Gitï¼Œä¾æ¬¡è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">git</span> add <span class="token keyword">.</span><span class="token function">git</span> commit  -m  <span class="token string">"åšå®¢å¤‡ä»½"</span>  ï¼ˆæ³¨ï¼šâ€œbackupâ€é‡Œé¢æ¢æˆä½ éœ€è¦ï¼Œå¦‚â€œfirst commitâ€ï¼‰<span class="token function">git</span> push -u origin master   ï¼ˆæ³¨ï¼šæ­¤æ“ä½œç›®çš„æ˜¯æŠŠæœ¬åœ°ä»“åº“pushåˆ°githubä¸Šé¢ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨å¯†é’¥æ­¤æ­¥éª¤éœ€è¦ä½ è¾“å…¥å¸å·å’Œå¯†ç ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li></ul><h4 id="æ›´æ–°å¤‡ä»½"><a href="#æ›´æ–°å¤‡ä»½" class="headerlink" title="æ›´æ–°å¤‡ä»½"></a>æ›´æ–°å¤‡ä»½</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">git</span> add <span class="token keyword">.</span><span class="token function">git</span> commit  -m  <span class="token string">"åšå®¢å¤‡ä»½"</span><span class="token function">git</span> push origin master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> åšå®¢æ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexoåšå®¢ä¼˜åŒ–åŠ é€Ÿ</title>
      <link href="/2020/06/27/hexo-bo-ke-you-hua-jia-su/"/>
      <url>/2020/06/27/hexo-bo-ke-you-hua-jia-su/</url>
      
        <content type="html"><![CDATA[<p><a href="https://dongzhougu.github.io/2020/06/27/shi-yong-hexo-da-jian-github-bo-ke/">ä¸Šä¸€ç¯‡æ–‡ç« </a>å·²ç»å…·ä½“è®²è¿°äº†åšå®¢çš„æ­å»ºä¸åŸºæœ¬ä½¿ç”¨ï¼Œæ¥ä¸‹æ¥è®°å½•ä¸€ä¸‹å¯¹åšå®¢çš„ä¼˜åŒ–çš„å·¥ä½œï¼Œä»<code>å›¾ç‰‡åŠ è½½ä¼˜åŒ–</code>å’Œ <code>PicGo  å›¾åºŠ</code>æ¥ä»‹ç»ã€‚</p><h3 id="å›¾ç‰‡åŠ è½½ä¼˜åŒ–"><a href="#å›¾ç‰‡åŠ è½½ä¼˜åŒ–" class="headerlink" title="å›¾ç‰‡åŠ è½½ä¼˜åŒ–"></a>å›¾ç‰‡åŠ è½½ä¼˜åŒ–</h3><h4 id="æ¦‚å¿µä»‹ç»"><a href="#æ¦‚å¿µä»‹ç»" class="headerlink" title="æ¦‚å¿µä»‹ç»"></a>æ¦‚å¿µä»‹ç»</h4><blockquote><p><code>é¢„åŠ è½½</code>å°±æ˜¯è¿›å…¥é¡¹ç›®å‰æå‰åŠ è½½èµ„æºï¼Œé¿å…åœ¨é¡¹ç›®ä¸­åŠ è½½ç¼“æ…¢ï¼Œå½±å“ç”¨æˆ·ä½“éªŒ</p><p><code>æ‡’åŠ è½½</code>ä¸€èˆ¬æ˜¯å½“å›¾ç‰‡æ»šåŠ¨è¿›å¯è§†çª—å£å†…æ‰åŠ è½½å›¾ç‰‡ï¼Œå¯è§†çª—å£ä¹‹å¤–çš„å›¾ç‰‡åˆ™ä¸åŠ è½½</p></blockquote><p><a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank" rel="noopener">materyä¸»é¢˜</a>  æ•´ä½“é‡‡ç”¨é¢„åŠ è½½æ¨¡å¼ï¼Œè¿™æ ·å¯ä»¥åœ¨æˆ‘ä»¬è®¿é—®å…¶ä»–é¡µé¢çš„æ—¶å€™ä¼šç¨å¾®å¿«ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå¯¹å›¾ç‰‡è¿›è¡Œæ‡’åŠ è½½ï¼Œè¿™æ ·åšæ•ˆæœå°±æ˜¯ htmlã€cssã€js åŠ è½½ä¹‹åï¼Œå›¾ç‰‡å†åŠ è½½ã€‚æ—¢ä¿è¯äº†ç½‘é¡µçš„æ‰“å¼€é€Ÿåº¦ï¼Œä¹Ÿä¸ä¼šå› å›¾ç‰‡çš„åºå¤§ä½“ç§¯è€Œæ‹–ç´¯äº†æ•´ä¸ªé¡µé¢çš„åŠ è½½ã€‚</p><h4 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h4><ul><li><p>åœ¨ Blog æ ¹ç›®å½•æ‰§è¡Œ</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hexo-lazyload-image --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>åœ¨æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> ä¸­æ·»åŠ å¯¹åº”é…ç½®</p><pre class="line-numbers language-bash"><code class="language-bash">lazyload:  enable: <span class="token boolean">true</span>   onlypost: <span class="token boolean">false</span>  <span class="token comment" spellcheck="true"># æ˜¯å¦åªå¯¹æ–‡ç« çš„å›¾ç‰‡åšæ‡’åŠ è½½</span>  loadingImg: <span class="token comment" spellcheck="true"># eg ./images/loading.gif</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h4 id="è®¾ç½®æ’ä»¶"><a href="#è®¾ç½®æ’ä»¶" class="headerlink" title="è®¾ç½®æ’ä»¶"></a>è®¾ç½®æ’ä»¶</h4><ul><li><p>ä¿®æ”¹ <code>/themes/matery/source/js</code> ä¸­çš„ <code>matery.js</code>æ–‡ä»¶,åœ¨ç¬¬108è¡ŒåŠ ä¸Šï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'img[data-original]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">,</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"data-original"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>æ‰“å¼€ <code>/themes/matery/layout/_partial/header.ejs</code>æ–‡ä»¶ï¼Œ</p><p>åœ¨<code>img</code>å’Œ<code>span</code>çš„ä¸¤ä¸ªå¤´åŠ ä¸ª<code>div</code>ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>brand-logo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>&lt;%- url_for() %<span class="token punctuation">></span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>waves-effect waves-light<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>            &lt;% if (theme.logo !== undefined &amp;&amp; theme.logo.length > 0) { %>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>&lt;%<span class="token punctuation">=</span> theme.logo %<span class="token punctuation">></span><span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logo-img<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>LOGO<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">}</span> <span class="token attr-name">%</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>logo-span<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%-</span> <span class="token attr-name">config.title</span> <span class="token attr-name">%</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h4 id="è‡ªå®šä¹‰loadingå›¾ç‰‡"><a href="#è‡ªå®šä¹‰loadingå›¾ç‰‡" class="headerlink" title="è‡ªå®šä¹‰loadingå›¾ç‰‡"></a>è‡ªå®šä¹‰loadingå›¾ç‰‡</h4><p><code>hexo-lazyload-image</code> æ’ä»¶æä¾›äº†è‡ªå®šä¹‰loadingå›¾ç‰‡çš„é€‰é¡¹ï¼Œåœ¨ <code>loadingImg</code> åé…ç½®å›¾ç‰‡çš„è·¯å¾„å³å¯ã€‚</p><h3 id="ä½¿ç”¨PicGoå›¾åºŠ"><a href="#ä½¿ç”¨PicGoå›¾åºŠ" class="headerlink" title="ä½¿ç”¨PicGoå›¾åºŠ"></a>ä½¿ç”¨PicGoå›¾åºŠ</h3><p>PicGo æ˜¯ä¸€æ¬¾å¼€æºçš„å›¾åºŠè½¯ä»¶ï¼Œè¯¥è½¯ä»¶ä¸iPicçš„ä¸åˆ†ä¼¯ä»²ï¼Œæ–‡æ¡£æ”¯æŒä¸­æ–‡ï¼Œæ”¯æŒæ’ä»¶å¼€å‘ã€‚</p><h4 id="å®‰è£…-PicGo"><a href="#å®‰è£…-PicGo" class="headerlink" title="å®‰è£… PicGo"></a>å®‰è£… PicGo</h4><p>ä¸‹è½½åœ°å€ <a href="https://github.com/Molunerfinn/PicGo/releases" target="_blank" rel="noopener">https://github.com/Molunerfinn/PicGo/releases</a> ï¼Œé€‰æ‹©ä¸‹è½½ä¸ç³»ç»ŸåŒ¹é…çš„å®‰è£…åŒ…ï¼Œæ­£å¸¸å®‰è£…å³å¯ã€‚</p><p>ä¸‹è½½é€Ÿåº¦éå¸¸æ…¢ã€‚ã€‚ã€‚å¤‡ç”¨åœ°å€ï¼š<a href="https://pan.baidu.com/s/1t3wookLIEE4NSXuaGABGPg" target="_blank" rel="noopener">é“¾æ¥</a> æå–ç ï¼šbtzt</p><h4 id="åˆ›å»ºGitHubä»“åº“"><a href="#åˆ›å»ºGitHubä»“åº“" class="headerlink" title="åˆ›å»ºGitHubä»“åº“"></a>åˆ›å»ºGitHubä»“åº“</h4><p>åˆ›å»ºä¸€ä¸ªç”¨äºå­˜æ”¾å›¾ç‰‡çš„ä»“åº“ï¼Œä¹‹åä¾æ¬¡ç‚¹å‡» <code>Setting</code> â€”â€” <code>Developer settings</code> â€”â€” <code>Personal access tokens</code>  åˆ›å»ºä¸€ä¸ªtokenï¼Œå¹¶å¤åˆ¶ä¸‹æ¥ã€‚</p><h4 id="é…ç½®-PicGo"><a href="#é…ç½®-PicGo" class="headerlink" title="é…ç½® PicGo"></a>é…ç½® PicGo</h4><p>ä¸‹è½½å®Œæˆåè¿›è¡Œå®‰è£…ï¼Œå®‰è£…å®Œæ¯•åå¼€å§‹é…ç½®ï¼Œå¦‚å›¾ï¼š</p><p><img src="/medias/loading.gif" data-original="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1/20200628130208.png" alt=""></p><p><code>è®¾å®šä»“åº“å</code> æŒ‰ç…§â€œè´¦æˆ·å/ä»“åº“åçš„æ ¼å¼å¡«å†™â€ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ï¼šDongZhouGu/imageuse1</p><p><code>åˆ†æ”¯å</code>ç»Ÿä¸€å¡«å†™â€œmasterâ€ã€‚</p><p><code>è®¾å®šToken</code>å°†ä¹‹å‰çš„Tokenç²˜è´´åœ¨è¿™é‡Œã€‚</p><p><code>æŒ‡å®šå­˜å‚¨è·¯å¾„</code>ç•™ç©ºã€‚</p><p><code>è‡ªå®šä¹‰åŸŸå</code>ä¸Šä¼ å›¾ç‰‡åæˆåŠŸåï¼ŒPicGoä¼šå°†â€œè‡ªå®šä¹‰åŸŸå+ä¸Šä¼ çš„å›¾ç‰‡åâ€ç”Ÿæˆçš„è®¿é—®é“¾æ¥ï¼Œæ”¾åˆ°å‰ªåˆ‡æ¿ä¸Šã€‚é»˜è®¤ç•™ç©ºä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚è¿™é‡Œä¸ºäº†ä½¿ç”¨CDNåŠ å¿«å›¾ç‰‡çš„è®¿é—®é€Ÿåº¦ï¼Œè‡ªå®šä¹‰åŸŸåæˆ‘ä»¬æŒ‰ç…§è¿™æ ·å»å¡«å†™</p><blockquote><p><em><a href="https://cdn.jsdelivr.net/gh/GitHubç”¨æˆ·å/ä»“åº“å" target="_blank" rel="noopener">https://cdn.jsdelivr.net/gh/GitHubç”¨æˆ·å/ä»“åº“å</a></em></p><p>æˆ‘çš„æ˜¯ï¼š<a href="https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1" target="_blank" rel="noopener">https://cdn.jsdelivr.net/gh/dongzhougu/imageuse1</a></p></blockquote><p>ä¹‹åå°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> åšå®¢æ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨Hexoæ­å»ºGithubåšå®¢</title>
      <link href="/2020/06/27/shi-yong-hexo-da-jian-github-bo-ke/"/>
      <url>/2020/06/27/shi-yong-hexo-da-jian-github-bo-ke/</url>
      
        <content type="html"><![CDATA[<p>ä»¥ä¸‹ä¸ºæ­å»ºæœ¬åšå®¢çš„æ•™ç¨‹<strong>(é’ˆå¯¹windows)</strong>ï¼Œè®°å½•ä¸€ä¸‹è‡ªå·±çš„è¿‡ç¨‹ï¼Œä¹Ÿæ–¹ä¾¿æƒ³è¦å»ºç«™çš„å°ä¼™ä¼´å¿«é€Ÿä¸Šæ‰‹ã€‚</p><blockquote><p><code>Github Pages:</code> å¯ä»¥è¢«è®¤ä¸ºæ˜¯ç”¨æˆ·ç¼–å†™çš„ã€æ‰˜ç®¡åœ¨ Github ä¸Šçš„é™æ€ç½‘é¡µã€‚ä½¿ç”¨ Github Pages å¯ä»¥ä¸ºä½ æä¾›ä¸€ä¸ªå…è´¹çš„æœåŠ¡å™¨ï¼Œå…å»äº†è‡ªå·±æ­å»ºæœåŠ¡å™¨å’Œå†™æ•°æ®åº“çš„éº»çƒ¦ã€‚æ­¤å¤–è¿˜å¯ä»¥ç»‘å®šè‡ªå·±çš„åŸŸåã€‚</p><p><code>Hexo</code>: ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ã€‚Hexo ä½¿ç”¨ Markdownï¼ˆæˆ–å…¶ä»–æ¸²æŸ“å¼•æ“ï¼‰è§£ææ–‡ç« ï¼Œåœ¨å‡ ç§’å†…ï¼Œå³å¯åˆ©ç”¨é“ä¸½çš„ä¸»é¢˜ç”Ÿæˆé™æ€ç½‘é¡µã€‚</p></blockquote><p>ä¸‹é¢ä»<strong>æ­å»ºå‰çš„å‡†å¤‡å·¥ä½œ</strong>ï¼Œ<strong>Github éƒ¨ç½²</strong>ï¼Œ<strong>ä¼˜åŒ–è®¾ç½®åšå®¢</strong>(ä½¿ç”¨  <code>matery</code>  ä¸»é¢˜)ä¸‰æ–¹é¢è¯¦ç»†ä»‹ç»ã€‚</p><h3 id="1-æ­å»ºå‰çš„å‡†å¤‡å·¥ä½œ"><a href="#1-æ­å»ºå‰çš„å‡†å¤‡å·¥ä½œ" class="headerlink" title="1. æ­å»ºå‰çš„å‡†å¤‡å·¥ä½œ"></a>1. æ­å»ºå‰çš„å‡†å¤‡å·¥ä½œ</h3><h4 id="1-1-ç¯å¢ƒå®‰è£…"><a href="#1-1-ç¯å¢ƒå®‰è£…" class="headerlink" title="1.1 ç¯å¢ƒå®‰è£…"></a>1.1 ç¯å¢ƒå®‰è£…</h4><ul><li><p>å®‰è£…  <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a>ï¼ˆç‚¹å‡»å‰å¾€å®˜ç½‘ï¼‰ï¼Œè¯·ç¡®ä¿å‹¾é€‰  <strong>Add to PATH</strong>  é€‰é¡¹ï¼ˆé»˜è®¤å·²å‹¾é€‰ï¼‰ï¼Œè¿™é‡Œå¯ä»¥å‚è€ƒ Hexo çš„å®˜æ–¹<a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="noopener">å‚è€ƒæ–‡æ¡£</a>ã€‚</p></li><li><p>å®‰è£…<a href="https://git-scm.com/downloads" target="_blank" rel="noopener">Git</a>(ç‚¹å‡»å‰å¾€å®˜ç½‘)ï¼Œä¸€è·¯é»˜è®¤å®‰è£…å³å¯ã€‚</p></li><li><p>é¼ æ ‡å³é”®ç‚¹å‡»  <code>Git Bash Here</code> ,åˆ†åˆ«ä½¿ç”¨  <code>node -v</code>  å’Œ  <code>npm -v</code>  æ¥éªŒè¯å®‰è£…ï¼Œæ˜¾ç¤ºç‰ˆæœ¬å·åˆ™å®‰è£…æˆåŠŸã€‚</p></li></ul><h4 id="1-2-Hexoå®‰è£…"><a href="#1-2-Hexoå®‰è£…" class="headerlink" title="1.2 Hexoå®‰è£…"></a>1.2 Hexoå®‰è£…</h4><ul><li><p>æ–°å»ºä¸€ä¸ªå­˜æ”¾åšå®¢çš„æ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚  <code>E:\notebook\my_blog</code>ï¼Œåœ¨æ­¤æ–‡ä»¶å¤¹ä¸‹å³é”®ç‚¹å‡»  <code>Git Bash Here</code></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> -g hexo-cli<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®‰è£…å®Œæˆåä½¿ç”¨  <code>hexo -v</code>  æ£€æµ‹æ˜¯å¦å®‰è£…æˆåŠŸ</p></li><li><p>æ‰§è¡Œåˆå§‹åŒ–å¹¶åœ¨æœ¬åœ°æŸ¥çœ‹æ•ˆæœ</p><pre class="line-numbers language-bash"><code class="language-bash">hexo init<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®Œæˆåä½¿ç”¨</p><pre class="line-numbers language-bash"><code class="language-bash">  hexo s<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åä¼šå‡ºæ¥ä¸€æ®µ http å¼€å¤´çš„ç½‘å€ï¼Œæˆ‘ä»¬å¤åˆ¶ä¸‹æ¥ç„¶ååœ¨æµè§ˆå™¨æ‰“å¼€ï¼Œå°±å¯ä»¥çœ‹åˆ°åˆå§‹åŒ–çš„ Hexo çš„é¡µé¢äº†ã€‚</p></li></ul><h3 id="2-Githubéƒ¨ç½²"><a href="#2-Githubéƒ¨ç½²" class="headerlink" title="2. Githubéƒ¨ç½²"></a>2. Githubéƒ¨ç½²</h3><ul><li><p><strong>åˆ›å»ºä¸€ä¸ªä»“åº“</strong>ï¼Œåå­—å¿…é¡»æ˜¯  <code>ç”¨æˆ·å.github.io</code>  ï¼Œç„¶åå‹¾é€‰åˆå§‹åŒ– READMEã€‚æˆ‘ç¬¬ä¸€æ¬¡è®¿é—®ä¸äº†å°±æ˜¯å› ä¸º github ç«Ÿç„¶æ‰“é”™äº†ï¼Œæ‰“é”™äº†ï¼Œæ‰“é”™äº†â€¦</p></li><li><p><strong>åˆ›å»ºä¸€ä¸ªgitç§˜é’¥</strong>ï¼Œç”¨æ¥åœ¨è¿™å°ç”µè„‘ä¸Šé€šè¿‡ git æ“ä½œå®ç°æœ¬åœ°ä»£ç åº“ä¸ Github ä»£ç åº“åŒæ­¥</p><pre class="line-numbers language-bash"><code class="language-bash">$ ssh-keygen -t rsa -C â€œyour_email@youremail.comâ€œ<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>your_email@youremail.com</code>  ä¸ºä½ çš„ Github é‚®ç®±åœ°å€ï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯  <code>gdz678@163.com</code></p><p>ä¸ç®¡å‡ºç°ä»€ä¹ˆä¿¡æ¯ï¼Œåªéœ€è¦å›è½¦å°±å¯ä»¥äº†ã€‚æ¥ç€ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤å°†ç§˜é’¥å¤åˆ¶åˆ°å‰ªåˆ‡æ¿</p><pre class="line-numbers language-bash"><code class="language-bash"> $ clip <span class="token operator">&lt;</span> ~/.ssh/id_rsa.pub<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p><strong>åœ¨ GitHub è´¦æˆ·ä¸­æ·»åŠ ç§˜é’¥</strong>ï¼Œè¿›å…¥ Github çš„è®¾ç½®ï¼Œç‚¹å‡»  <code>Settingsâ€“SSH</code>  â€”â€”  <code>New SSH Key</code>ï¼Œæ·»åŠ åˆšæ‰å¤åˆ¶çš„ç§˜é’¥å³å¯ã€‚</p></li><li><p><strong>æµ‹è¯•</strong>ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼šæ³¨æ„ï¼š<code>git@github.com</code>ä¸è¦åšä»»ä½•æ›´æ”¹ï¼</p><pre class="line-numbers language-bash"><code class="language-bash"> $ <span class="token function">ssh</span> -T git@github.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ ¹æ®è¿”å›ï¼Œè¾“å…¥ <code>yes</code> ä¼šæ˜¾ç¤ºæˆåŠŸæˆæƒ</p></li><li><p><strong>é…ç½® Git ä¸ªäººä¿¡æ¯</strong>ï¼ŒGit ä¼šæ ¹æ®ç”¨æˆ·çš„åå­—å’Œé‚®ç®±æ¥è®°å½•æäº¤ï¼ŒGitHub ä¹Ÿæ˜¯ç”¨è¿™äº›ä¿¡æ¯æ¥åšæƒé™çš„å¤„ç†ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿›è¡Œä¸ªäººä¿¡æ¯çš„è®¾ç½®ï¼ŒæŠŠåç§°å’Œé‚®ç®±æ›¿æ¢æˆä½ è‡ªå·±çš„ï¼Œåå­—å¯ä»¥ä¸æ˜¯ GitHub çš„æ˜µç§°ï¼Œä½†ä¸ºäº†æ–¹ä¾¿è®°å¿†ï¼Œå»ºè®®ä¸ GitHub ä¸€è‡´ã€‚</p><pre class="line-numbers language-bash"><code class="language-bash"> $ <span class="token function">git</span> config --global user.name <span class="token string">"æ­¤å¤„å¡«ä½ çš„ç”¨æˆ·å"</span>   $ <span class="token function">git</span> config --global user.email  <span class="token string">"æ­¤å¤„å¡«ä½ çš„é‚®ç®±"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li><li><p><strong>å°†æœ¬åœ°çš„ Hexo æ–‡ä»¶æ›´æ–°åˆ° Github çš„åº“ä¸­</strong>ï¼Œç™»å½• Github æ‰“å¼€åšå®¢çš„é¡¹ç›®ï¼Œé¼ æ ‡ç§»åˆ° <code>Clone or download</code> æŒ‰é’®ï¼Œé€‰æ‹© <code>Use SSH</code> ä¸€é”®å¤åˆ¶åœ°å€åï¼Œæ‰“å¼€åˆšæ‰åˆ›å»ºçš„åšå®¢æ–‡ä»¶å¤¹ä¸‹çš„ <code>_config.yaml</code>æ–‡ä»¶</p><pre class="line-numbers language-bash"><code class="language-bash">deploy:  type: <span class="token function">git</span>  repo: ä½ å¤åˆ¶çš„åœ°å€  branch: master<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>éƒ¨ç½²åˆ° Github</strong>,é¦–å…ˆå®‰è£…  <code>deployer</code> </p><pre><code> npm install hexo-deployer-git --save</code></pre><p>æ¥ç€æ‰§è¡Œ,åšå®¢å°±éƒ¨ç½²åˆ° Github ä¸Šäº†</p><pre class="line-numbers language-bash"><code class="language-bash"> $ hexo g -d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ€åï¼Œä½ çš„åšå®¢åœ°å€ï¼šhttps://ä½ çš„ç”¨æˆ·å.github.ioï¼Œæ¯”å¦‚æˆ‘çš„æ˜¯ï¼š<a href="https://dongzhougu.github.io">https://dongzhougu.github.io</a> ,ç°åœ¨æ¯ä¸ªäººéƒ½å¯ä»¥é€šè¿‡æ­¤é“¾æ¥è®¿é—®æˆ‘çš„åšå®¢ï¼</p></li></ul><h3 id="3-ä¼˜åŒ–è®¾ç½®åšå®¢"><a href="#3-ä¼˜åŒ–è®¾ç½®åšå®¢" class="headerlink" title="3. ä¼˜åŒ–è®¾ç½®åšå®¢"></a>3. ä¼˜åŒ–è®¾ç½®åšå®¢</h3><h4 id="3-1-å®‰è£…ä¸»é¢˜"><a href="#3-1-å®‰è£…ä¸»é¢˜" class="headerlink" title="3.1 å®‰è£…ä¸»é¢˜"></a>3.1 å®‰è£…ä¸»é¢˜</h4><ul><li><p>å®‰è£… <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank" rel="noopener">Metary</a> ä¸»é¢˜ã€‚cd åˆ° Blog ç›®å½•ä¸‹çš„ <code>Themes</code> æ–‡ä»¶å¤¹</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/blinkfox/hexo-theme-matery.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ç¼–è¾‘ç«™ç‚¹é…ç½®æ–‡ä»¶ <code>_config.yml</code>,ä¿®æ”¹ä¸»é¢˜</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># Extensions</span><span class="token comment" spellcheck="true">## Plugins: https://hexo.io/plugins/</span><span class="token comment" spellcheck="true">## Themes: https://hexo.io/themes/</span>theme: hexo-theme-matery<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li></ul><blockquote><p><strong>ä¸»é¢˜çš„å…·ä½“ç¾åŒ–å’Œè®¾ç½®å¯ä»¥<a href="http://blinkfox.com/2018/09/28/qian-duan/hexo-bo-ke-zhu-ti-zhi-hexo-theme-matery-de-jie-shao/#toc-heading-19" target="_blank" rel="noopener">å‚è€ƒè¿™é‡Œ</a>ã€‚</strong></p></blockquote><h4 id="3-2-å®‰è£…æ’ä»¶"><a href="#3-2-å®‰è£…æ’ä»¶" class="headerlink" title="3.2 å®‰è£…æ’ä»¶"></a>3.2 å®‰è£…æ’ä»¶</h4><p>cdåˆ°åšå®¢çš„æ ¹ç›®å½•ï¼Œåˆ†åˆ«è¿è¡Œä»¥ä¸‹ï¼Œæ¥å®‰è£…æ’ä»¶</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> hexo-generator-feed --save                 <span class="token comment" spellcheck="true">#RSS</span><span class="token function">npm</span> <span class="token function">install</span> hexo-generator-search --save               <span class="token comment" spellcheck="true">#æœç´¢</span><span class="token function">npm</span> <span class="token function">install</span> hexo-prism-plugin --save                   <span class="token comment" spellcheck="true">#ä»£ç é«˜äº®     </span><span class="token function">npm</span> <span class="token function">install</span> hexo-wordcount --save                      <span class="token comment" spellcheck="true">#æ–‡ç« å­—æ•°ç»Ÿè®¡</span><span class="token function">npm</span> i hexo-permalink-pinyin --save<span class="token function">npm</span> <span class="token function">install</span> hexo-filter-github-emojis --save           <span class="token comment" spellcheck="true">#æ·»åŠ emojiè¡¨æƒ…æ”¯æŒ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p><strong>RSS</strong> :  åœ¨æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> ä¸­æ·»åŠ å¯¹åº”é…ç½®</p><pre class="line-numbers language-bash"><code class="language-bash">feed:  type: atom  path: atom.xml  limit: 20  hub:  content:  content_limit: 140  content_limit_delim: <span class="token string">' '</span>  order_by: -date<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æœç´¢</strong> : åœ¨æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> ä¸­æ·»åŠ å¯¹åº”é…ç½®</p><pre class="line-numbers language-bash"><code class="language-bash">search:  path: search.xml  field: post<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p><strong>ä»£ç é«˜äº®</strong> ï¼š ä¿®æ”¹æ ¹ç›®å½•ä¸‹ <code>_config.yml</code> æ–‡ä»¶ä¸­  <code>highlight.enable</code> çš„å€¼ä¸º <code>false</code> ï¼Œå¹¶æ–°å¢ä»¥ä¸‹é…ç½®</p><pre class="line-numbers language-bash"><code class="language-bash">prism_plugin:  mode: <span class="token string">'preprocess'</span>    <span class="token comment" spellcheck="true"># realtime/preprocess</span>  theme: <span class="token string">'tomorrow'</span>  line_number: <span class="token boolean">false</span>    <span class="token comment" spellcheck="true"># default false</span>  custom_css:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>å­—æ•°ç»Ÿè®¡</strong>ï¼šåœ¨æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> ä¸­æ·»åŠ å¯¹åº”é…ç½®</p><pre class="line-numbers language-bash"><code class="language-bash">postInfo:  date: <span class="token boolean">true</span>  update: <span class="token boolean">false</span>  wordCount: <span class="token boolean">false</span>  <span class="token comment" spellcheck="true"># è®¾ç½®æ–‡ç« å­—æ•°ç»Ÿè®¡ä¸º true.</span>  totalCount: <span class="token boolean">false</span> <span class="token comment" spellcheck="true"># è®¾ç½®ç«™ç‚¹æ–‡ç« æ€»å­—æ•°ç»Ÿè®¡ä¸º true.</span>  min2read: <span class="token boolean">false</span>   <span class="token comment" spellcheck="true"># é˜…è¯»æ—¶é•¿.</span>  readCount: <span class="token boolean">false</span>  <span class="token comment" spellcheck="true"># é˜…è¯»æ¬¡æ•°.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æ–‡ç« é“¾æ¥è½¬é™æ€çŸ­åœ°å€</strong>ï¼šåœ¨æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> ä¸­æ·»åŠ å¯¹åº”é…ç½®</p><pre class="line-numbers language-bash"><code class="language-bash">permalink_pinyin:  enable: <span class="token boolean">true</span>  separator: <span class="token string">'-'</span> <span class="token comment" spellcheck="true"># default: '-'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æ·»åŠ emojiè¡¨æƒ…æ”¯æŒ</strong>: åœ¨æ ¹ç›®å½•ä¸‹çš„ <code>_config.yml</code> ä¸­æ·»åŠ å¯¹åº”é…ç½®</p><pre class="line-numbers language-bash"><code class="language-bash">githubEmojis:  enable: <span class="token boolean">true</span>  className: github-emoji  inject: <span class="token boolean">true</span>  styles:  customEmojis:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><ul><li><p><strong>è¯„è®ºç³»ç»Ÿ</strong>ï¼š </p><ul><li>è¯„è®ºç³»ç»Ÿé‡‡ç”¨çš„æ˜¯Valineï¼ŒåŸºäº <a href="https://www.leancloud.cn/" target="_blank" rel="noopener">leancloud</a>ã€‚æ³¨å†Œè´¦å·åå®Œæˆè®¤è¯ï¼Œåˆ›å»ºåº”ç”¨ï¼Œåç§°éšæ„ï¼Œæ¯”å¦‚ blogï¼Œå¤åˆ¶åº”ç”¨çš„ <code>APPID</code> å’Œ <code>APPKey</code> ï¼Œå¡«å…¥ä¸»é¢˜é…ç½®æ–‡ä»¶ä¸­çš„ Valine é…ç½®ä¸­ã€‚</li></ul></li><li><p>éœ€è¦åœ¨ <a href="https://www.leancloud.cn/" target="_blank" rel="noopener">leancloud</a> åº”ç”¨å†…çš„â€œå­˜å‚¨â€é€‰é¡¹ä¸­åˆ›å»º<code>class</code>ï¼Œåç§°ä¸º<code>Comment</code>ï¼Œå¦åˆ™è¯„è®ºç³»ç»Ÿæ— æ³•å·¥ä½œï¼</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># To use it, activate the configuration item and set appId and appKey.</span><span class="token comment" spellcheck="true"># Valine è¯„è®ºæ¨¡å—çš„é…ç½®ï¼Œé»˜è®¤ä¸ºä¸æ¿€æ´»ï¼Œå¦‚è¦ä½¿ç”¨ï¼Œå°±è¯·æ¿€æ´»è¯¥é…ç½®é¡¹ï¼Œå¹¶è®¾ç½® appId å’Œ appKey.</span>valine:  enable: <span class="token boolean">true</span>  appId: *******  appKey: *******  notify: <span class="token boolean">false</span>  verify: <span class="token boolean">false</span>  visitor: <span class="token boolean">true</span>  avatar: <span class="token string">'mm'</span> <span class="token comment" spellcheck="true"># Gravatar style : mm/identicon/monsterid/wavatar/retro/hide</span>  pageSize: 10  placeholder: <span class="token string">'å¿«æ¥äº¤æµå§'</span>  background: /medias/comment_bg.png<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h4 id="3-3-ä»£ç å‹ç¼©"><a href="#3-3-ä»£ç å‹ç¼©" class="headerlink" title="3.3 ä»£ç å‹ç¼©"></a>3.3 ä»£ç å‹ç¼©</h4><p>ä½¿ç”¨gulpæ¥å‹ç¼©ç½‘ç«™çš„èµ„æºï¼ŒåŒ…æ‹¬js,html,css</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å®‰è£…gulp</span><span class="token function">npm</span> <span class="token function">install</span> gulp -g            <span class="token comment" spellcheck="true"># å®‰è£…ç»„ä»¶</span><span class="token function">npm</span> <span class="token function">install</span> gulp-htmlclean gulp-htmlmin gulp-minify-css gulp-uglify gulp-imagemin --save<span class="token comment" spellcheck="true"># é¢å¤–çš„åŠŸèƒ½æ¨¡å—</span><span class="token function">npm</span> <span class="token function">install</span> gulp-debug gulp-clean-css gulp-changed gulp-if gulp-plumber gulp-babel babel-preset-es2015 del @babel/core --save<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ Blog æ ¹ç›®å½•æ–°å»ºæ–‡ä»¶ <code>gulpfile.js</code> ï¼Œå¡«å…¥ä»¥ä¸‹å†…å®¹</p><pre class="line-numbers language-bash"><code class="language-bash">var gulp <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"gulp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var debug <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"gulp-debug"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var cleancss <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"gulp-clean-css"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //csså‹ç¼©ç»„ä»¶var uglify <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"gulp-uglify"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //jså‹ç¼©ç»„ä»¶var htmlmin <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"gulp-htmlmin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //htmlå‹ç¼©ç»„ä»¶var htmlclean <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"gulp-htmlclean"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //htmlæ¸…ç†ç»„ä»¶var changed <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"gulp-changed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //æ–‡ä»¶æ›´æ”¹æ ¡éªŒç»„ä»¶var gulpif <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"gulp-if"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //ä»»åŠ¡ å¸®åŠ©è°ƒç”¨ç»„ä»¶var plumber <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"gulp-plumber"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> //å®¹é”™ç»„ä»¶ï¼ˆå‘ç”Ÿé”™è¯¯ä¸è·³å‡ºä»»åŠ¡ï¼Œå¹¶æŠ¥å‡ºé”™è¯¯å†…å®¹ï¼‰var isScriptAll <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> //æ˜¯å¦å¤„ç†æ‰€æœ‰æ–‡ä»¶ï¼Œ<span class="token punctuation">(</span>true<span class="token operator">|</span>å¤„ç†æ‰€æœ‰æ–‡ä»¶<span class="token punctuation">)</span><span class="token punctuation">(</span>false<span class="token operator">|</span>åªå¤„ç†æœ‰æ›´æ”¹çš„æ–‡ä»¶<span class="token punctuation">)</span>var isDebug <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> //æ˜¯å¦è°ƒè¯•æ˜¾ç¤º ç¼–è¯‘é€šè¿‡çš„æ–‡ä»¶var gulpBabel <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"gulp-babel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var es2015Preset <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"babel-preset-es2015"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var del <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"del"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var Hexo <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">"hexo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>var hexo <span class="token operator">=</span> new Hexo<span class="token punctuation">(</span>process.cwd<span class="token punctuation">(</span><span class="token punctuation">)</span>, <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> // åˆå§‹åŒ–ä¸€ä¸ªhexoå¯¹è±¡// hexo cleangulp.task<span class="token punctuation">(</span><span class="token string">"clean"</span>, <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> del<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"public/**/*"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>// hexo generategulp.task<span class="token punctuation">(</span><span class="token string">"generate"</span>, <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> hexo.init<span class="token punctuation">(</span><span class="token punctuation">)</span>.then<span class="token punctuation">(</span>function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> hexo            .call<span class="token punctuation">(</span><span class="token string">"generate"</span>, <span class="token punctuation">{</span>                watch: <span class="token boolean">false</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span>            .then<span class="token punctuation">(</span>function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> hexo.exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span>            .catch<span class="token punctuation">(</span>function <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> hexo.exit<span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>// Hexo sgulp.task<span class="token punctuation">(</span><span class="token string">"server"</span>, <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> hexo        .init<span class="token punctuation">(</span><span class="token punctuation">)</span>        .then<span class="token punctuation">(</span>function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> hexo.call<span class="token punctuation">(</span><span class="token string">"server"</span>, <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span>        .catch<span class="token punctuation">(</span>function <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>            console.log<span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>// å‹ç¼©publicç›®å½•ä¸‹çš„jsæ–‡ä»¶gulp.task<span class="token punctuation">(</span><span class="token string">"compressJs"</span>, <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> gulp        .src<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"./public/**/*.js"</span>, <span class="token string">"!./public/libs/**"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> //æ’é™¤çš„js        .pipe<span class="token punctuation">(</span>gulpif<span class="token punctuation">(</span><span class="token operator">!</span>isScriptAll, changed<span class="token punctuation">(</span><span class="token string">"./public"</span><span class="token punctuation">))</span><span class="token punctuation">)</span>        .pipe<span class="token punctuation">(</span>gulpif<span class="token punctuation">(</span>isDebug, debug<span class="token punctuation">(</span><span class="token punctuation">{</span> title: <span class="token string">"Compress JS:"</span> <span class="token punctuation">}</span><span class="token punctuation">))</span><span class="token punctuation">)</span>        .pipe<span class="token punctuation">(</span>plumber<span class="token punctuation">(</span><span class="token punctuation">))</span>        .pipe<span class="token punctuation">(</span>            gulpBabel<span class="token punctuation">(</span><span class="token punctuation">{</span>                presets: <span class="token punctuation">[</span>es2015Preset<span class="token punctuation">]</span> // es5æ£€æŸ¥æœºåˆ¶            <span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token punctuation">)</span>        .pipe<span class="token punctuation">(</span>uglify<span class="token punctuation">(</span><span class="token punctuation">))</span> //è°ƒç”¨å‹ç¼©ç»„ä»¶æ–¹æ³•uglify<span class="token punctuation">(</span><span class="token punctuation">)</span>,å¯¹åˆå¹¶çš„æ–‡ä»¶è¿›è¡Œå‹ç¼©        .pipe<span class="token punctuation">(</span>gulp.dest<span class="token punctuation">(</span><span class="token string">"./public"</span><span class="token punctuation">))</span><span class="token punctuation">;</span> //è¾“å‡ºåˆ°ç›®æ ‡ç›®å½•<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>// å‹ç¼©publicç›®å½•ä¸‹çš„cssæ–‡ä»¶gulp.task<span class="token punctuation">(</span><span class="token string">"compressCss"</span>, <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    var option <span class="token operator">=</span> <span class="token punctuation">{</span>        rebase: false,        //advanced: true, //ç±»å‹ï¼šBoolean é»˜è®¤ï¼štrue <span class="token punctuation">[</span>æ˜¯å¦å¼€å¯é«˜çº§ä¼˜åŒ–ï¼ˆåˆå¹¶é€‰æ‹©å™¨ç­‰ï¼‰<span class="token punctuation">]</span>        compatibility: <span class="token string">"ie7"</span> //ä¿ç•™ie7åŠä»¥ä¸‹å…¼å®¹å†™æ³• ç±»å‹ï¼šString é»˜è®¤ï¼š<span class="token string">''</span>or<span class="token string">'*'</span> <span class="token punctuation">[</span>å¯ç”¨å…¼å®¹æ¨¡å¼ï¼› <span class="token string">'ie7'</span>ï¼šIE7å…¼å®¹æ¨¡å¼ï¼Œ<span class="token string">'ie8'</span>ï¼šIE8å…¼å®¹æ¨¡å¼ï¼Œ<span class="token string">'*'</span>ï¼šIE9+å…¼å®¹æ¨¡å¼<span class="token punctuation">]</span>        //keepBreaks: true, //ç±»å‹ï¼šBoolean é»˜è®¤ï¼šfalse <span class="token punctuation">[</span>æ˜¯å¦ä¿ç•™æ¢è¡Œ<span class="token punctuation">]</span>        //keepSpecialComments: <span class="token string">'*'</span> //ä¿ç•™æ‰€æœ‰ç‰¹æ®Šå‰ç¼€ å½“ä½ ç”¨autoprefixerç”Ÿæˆçš„æµè§ˆå™¨å‰ç¼€ï¼Œå¦‚æœä¸åŠ è¿™ä¸ªå‚æ•°ï¼Œæœ‰å¯èƒ½å°†ä¼šåˆ é™¤ä½ çš„éƒ¨åˆ†å‰ç¼€    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> gulp        .src<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"./public/**/*.css"</span>, <span class="token string">"!./public/**/*.min.css"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> //æ’é™¤çš„css        .pipe<span class="token punctuation">(</span>gulpif<span class="token punctuation">(</span><span class="token operator">!</span>isScriptAll, changed<span class="token punctuation">(</span><span class="token string">"./public"</span><span class="token punctuation">))</span><span class="token punctuation">)</span>        .pipe<span class="token punctuation">(</span>gulpif<span class="token punctuation">(</span>isDebug, debug<span class="token punctuation">(</span><span class="token punctuation">{</span> title: <span class="token string">"Compress CSS:"</span> <span class="token punctuation">}</span><span class="token punctuation">))</span><span class="token punctuation">)</span>        .pipe<span class="token punctuation">(</span>plumber<span class="token punctuation">(</span><span class="token punctuation">))</span>        .pipe<span class="token punctuation">(</span>cleancss<span class="token punctuation">(</span>option<span class="token punctuation">))</span>        .pipe<span class="token punctuation">(</span>gulp.dest<span class="token punctuation">(</span><span class="token string">"./public"</span><span class="token punctuation">))</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>// å‹ç¼©publicç›®å½•ä¸‹çš„htmlæ–‡ä»¶gulp.task<span class="token punctuation">(</span><span class="token string">"compressHtml"</span>, <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    var cleanOptions <span class="token operator">=</span> <span class="token punctuation">{</span>        protect: /<span class="token operator">&lt;</span>\<span class="token operator">!</span>--%fooTemplate\b.*?%--<span class="token operator">></span>/g, //å¿½ç•¥å¤„ç†        unprotect: /<span class="token operator">&lt;</span>script <span class="token punctuation">[</span>^<span class="token operator">></span><span class="token punctuation">]</span>*\btype<span class="token operator">=</span><span class="token string">"text\/x-handlebars-template"</span><span class="token punctuation">[</span>\s\S<span class="token punctuation">]</span>+?<span class="token operator">&lt;</span>\/script<span class="token operator">></span>/gi //ç‰¹æ®Šå¤„ç†    <span class="token punctuation">}</span><span class="token punctuation">;</span>    var minOption <span class="token operator">=</span> <span class="token punctuation">{</span>        collapseWhitespace: true, //å‹ç¼©HTML        collapseBooleanAttributes: true, //çœç•¥å¸ƒå°”å±æ€§çš„å€¼ <span class="token operator">&lt;</span>input checked<span class="token operator">=</span><span class="token string">"true"</span>/<span class="token operator">></span> <span class="token operator">==</span><span class="token operator">></span> <span class="token operator">&lt;</span>input /<span class="token operator">></span>        removeEmptyAttributes: true, //åˆ é™¤æ‰€æœ‰ç©ºæ ¼ä½œå±æ€§å€¼ <span class="token operator">&lt;</span>input id<span class="token operator">=</span><span class="token string">""</span> /<span class="token operator">></span> <span class="token operator">==</span><span class="token operator">></span> <span class="token operator">&lt;</span>input /<span class="token operator">></span>        removeScriptTypeAttributes: true, //åˆ é™¤<span class="token operator">&lt;</span>script<span class="token operator">></span>çš„type<span class="token operator">=</span><span class="token string">"text/javascript"</span>        removeStyleLinkTypeAttributes: true, //åˆ é™¤<span class="token operator">&lt;</span>style<span class="token operator">></span>å’Œ<span class="token operator">&lt;</span>link<span class="token operator">></span>çš„type<span class="token operator">=</span><span class="token string">"text/css"</span>        removeComments: true, //æ¸…é™¤HTMLæ³¨é‡Š        minifyJS: true, //å‹ç¼©é¡µé¢JS        minifyCSS: true, //å‹ç¼©é¡µé¢CSS        minifyURLs: <span class="token boolean">true</span> //æ›¿æ¢é¡µé¢URL    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> gulp        .src<span class="token punctuation">(</span><span class="token string">"./public/**/*.html"</span><span class="token punctuation">)</span>        .pipe<span class="token punctuation">(</span>gulpif<span class="token punctuation">(</span>isDebug, debug<span class="token punctuation">(</span><span class="token punctuation">{</span> title: <span class="token string">"Compress HTML:"</span> <span class="token punctuation">}</span><span class="token punctuation">))</span><span class="token punctuation">)</span>        .pipe<span class="token punctuation">(</span>plumber<span class="token punctuation">(</span><span class="token punctuation">))</span>        .pipe<span class="token punctuation">(</span>htmlclean<span class="token punctuation">(</span>cleanOptions<span class="token punctuation">))</span>        .pipe<span class="token punctuation">(</span>htmlmin<span class="token punctuation">(</span>minOption<span class="token punctuation">))</span>        .pipe<span class="token punctuation">(</span>gulp.dest<span class="token punctuation">(</span><span class="token string">"./public"</span><span class="token punctuation">))</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>// é»˜è®¤ä»»åŠ¡gulp.task<span class="token punctuation">(</span>    <span class="token string">"default"</span>,    gulp.series<span class="token punctuation">(</span>        <span class="token string">"clean"</span>,        <span class="token string">"generate"</span>,        gulp.parallel<span class="token punctuation">(</span><span class="token string">"compressHtml"</span>, <span class="token string">"compressCss"</span>, <span class="token string">"compressJs"</span><span class="token punctuation">)</span>    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ ¹ç›®å½•ä¸‹æ‰§è¡Œ <code>gulp</code> å°±ç›¸å½“äº<code>hexo clean &amp;&amp; hexo g</code>ï¼Œå†æŠŠä»£ç å‹ç¼©ã€‚</p><p>å†ä½¿ç”¨ <code>hexo d</code>å³å¯éƒ¨ç½²åˆ° Github</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æ•™ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> åšå®¢æ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
